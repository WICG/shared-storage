<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Shared Storage API</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <link href="https://www.w3.org/StyleSheets/TR/2021/cg-draft" rel="stylesheet">
  <meta content="Bikeshed version 82ce88815, updated Thu Sep 7 16:33:55 2023 -0700" name="generator">
  <link href="https://github.com/WICG/shared-storage" rel="canonical">
  <meta content="919562d41d87acf795f65657898876517c54f63c" name="document-revision">
<style>
/* adapted from .XXX at https://resources.whatwg.org/standard.css */
.todo {
  color: #D50606;
  background: white;
  border: solid #D50606;
}

span.todo {
  padding-top: 0;
  padding-bottom: 0;
}

.todo::before { content: 'TODO: '; }

span.todo::before {
  left: 0;
  top: -0.25em;
}
</style>
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    white-space: pre;
    display: inline-block;
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled[role="button"] { cursor: pointer; }
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    white-space: pre;
    display: inline-block;
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled[role="button"] { cursor: pointer; }
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */

            pre.idl.highlight {
                background: var(--borderedblock-bg, var(--def-bg));
            }
            
</style>
<style>/* Boilerplate: style-syntax-highlighting */

code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */


@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
<style>/* Boilerplate: style-var-click-highlighting */
/*
Colors were chosen in Lab using https://nixsensor.com/free-color-converter/
D50 2deg illuminant, L in [0,100], a and b in [-128, 128]
0 = lab(85,0,85)
1 = lab(85,80,30)
2 = lab(85,-40,40)
3 = lab(85,-50,0)
4 = lab(85,5,15)
5 = lab(85,-10,-50)
6 = lab(85,35,-15)
*/
var { cursor: pointer; }
var.selected0 { background-color: #F4D200; box-shadow: 0 0 0 2px #F4D200; }
var.selected1 { background-color: #FF87A2; box-shadow: 0 0 0 2px #FF87A2; }
var.selected2 { background-color: #96E885; box-shadow: 0 0 0 2px #96E885; }
var.selected3 { background-color: #3EEED2; box-shadow: 0 0 0 2px #3EEED2; }
var.selected4 { background-color: #EACFB6; box-shadow: 0 0 0 2px #EACFB6; }
var.selected5 { background-color: #82DDFF; box-shadow: 0 0 0 2px #82DDFF; }
var.selected6 { background-color: #FFBCF2; box-shadow: 0 0 0 2px #FFBCF2; }
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Shared Storage API</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#CG-DRAFT">Draft Community Group Report</a>, <time class="dt-updated" datetime="2024-06-18">18 June 2024</time></p>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://github.com/WICG/shared-storage">https://github.com/WICG/shared-storage</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/WICG/shared-storage/issues/">GitHub</a>
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:cammie@chromium.org">Camillia Smith Barnes</a> (<a class="p-org org" href="https://google.com">Google</a>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> © 2024 the Contributors to the Shared Storage API Specification, published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>.
A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>Shared Storage is a storage API that is intentionally not partitioned by top-level traversable site (though still partitioned by context origin of course!). To limit cross-site reidentification of users, data in Shared Storage may only be read in a restricted environment that has carefully constructed output gates.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This specification was published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a>.
  It is not a W3C Standard nor is it on the W3C Standards Track.

  Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply.

  Learn more about <a href="http://www.w3.org/community/">W3C Community and Business Groups</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li>
     <a href="#worklet"><span class="secno">2</span> <span class="content">The <code class="idl"><span>SharedStorageWorklet</span></code> Interface</span></a>
     <ol class="toc">
      <li><a href="#run-op-shared-storage-worklet"><span class="secno">2.1</span> <span class="content">Run Operation Methods on <code class="idl"><span>SharedStorageWorklet</span></code></span></a>
      <li>
       <a href="#worklet-monkey-patch"><span class="secno">2.2</span> <span class="content">Monkey Patch for <span>Worklets</span></span></a>
       <ol class="toc">
        <li><a href="#set-up-a-worklet-environment-settings-object-monkey-patch"><span class="secno">2.2.1</span> <span class="content">Monkey Patch for <span>set up a worklet environment settings object</span></span></a>
        <li><a href="#create-a-worklet-global-scope-monkey-patch"><span class="secno">2.2.2</span> <span class="content">Monkey Patch for <span>create a worklet global scope</span></span></a>
        <li><a href="#fetch-a-worklet-script-graph-monkey-patch"><span class="secno">2.2.3</span> <span class="content">Monkey Patch for <span>fetch a worklet script graph</span></span></a>
        <li><a href="#shared-storage-cross-origin-worklet-allowed"><span class="secno">2.2.4</span> <span class="content">The `<span><code>Shared-Storage-Cross-Origin-Worklet-Allowed</code></span>` HTTP response header</span></a>
        <li><a href="#http-fetch-monkey-patch"><span class="secno">2.2.5</span> <span class="content">Monkey Patch for <span>HTTP fetch</span></span></a>
        <li><a href="#add-module-monkey-patch"><span class="secno">2.2.6</span> <span class="content">Monkey Patch for <code class="idl"><span>addModule()</span></code></span></a>
       </ol>
      <li>
       <a href="#global-scope"><span class="secno">2.3</span> <span class="content">The <code class="idl"><span>SharedStorageWorkletGlobalScope</span></code></span></a>
       <ol class="toc">
        <li><a href="#request-destination-monkey-patch"><span class="secno">2.3.1</span> <span class="content">Monkey Patch for request <span>destination</span></span></a>
       </ol>
      <li><a href="#scope-algo"><span class="secno">2.4</span> <span class="content"><code class="idl"><span>SharedStorageWorkletGlobalScope</span></code> algorithms</span></a>
      <li><a href="#reporting"><span class="secno">2.5</span> <span class="content"><code class="idl"><span>SharedStorageUrlWithMetadata</span></code> and Reporting</span></a>
      <li>
       <a href="#budgets"><span class="secno">2.6</span> <span class="content">Entropy Budgets</span></a>
       <ol class="toc">
        <li><a href="#nav-budget"><span class="secno">2.6.1</span> <span class="content">Navigation Entropy Budget</span></a>
        <li><a href="#report-budget"><span class="secno">2.6.2</span> <span class="content">Reporting Entropy Budget</span></a>
       </ol>
     </ol>
    <li>
     <a href="#backend"><span class="secno">3</span> <span class="content">Shared Storage’s Backend</span></a>
     <ol class="toc">
      <li><a href="#storage-monkey-patch"><span class="secno">3.1</span> <span class="content">Monkey Patch for the <span>Storage Model</span></span></a>
      <li><a href="#database"><span class="secno">3.2</span> <span class="content">The <span>Shared Storage Database</span></span></a>
      <li><a href="#database-algorithms"><span class="secno">3.3</span> <span class="content">The <span>Database</span> Algorithms</span></a>
     </ol>
    <li>
     <a href="#shared-storage-interface"><span class="secno">4</span> <span class="content">The <code class="idl"><span>SharedStorage</span></code> Interface</span></a>
     <ol class="toc">
      <li>
       <a href="#window"><span class="secno">4.1</span> <span class="content">The <code class="idl"><span>WindowSharedStorage</span></code> interface</span></a>
       <ol class="toc">
        <li><a href="#window-setter"><span class="secno">4.1.1</span> <span class="content">Window Setter/Deleter Methods</span></a>
        <li><a href="#run-op-shared-storage"><span class="secno">4.1.2</span> <span class="content">Run Operation Methods on <code class="idl"><span>WindowSharedStorage</span></code></span></a>
        <li><a href="#create-a-new-worklet-via-shared-storage"><span class="secno">4.1.3</span> <span class="content">Create a new worklet via <code class="idl"><span>WindowSharedStorage</span></code></span></a>
       </ol>
      <li><a href="#extension"><span class="secno">4.2</span> <span class="content">Extension to the <code class="idl"><span>Window</span></code> interface</span></a>
      <li>
       <a href="#worklet-shared-storage"><span class="secno">4.3</span> <span class="content">The <code class="idl"><span>WorkletSharedStorage</span></code> interface</span></a>
       <ol class="toc">
        <li><a href="#worklet-setter"><span class="secno">4.3.1</span> <span class="content">Worklet Setter/Deleter Methods</span></a>
        <li><a href="#getter"><span class="secno">4.3.2</span> <span class="content">Getter Methods</span></a>
        <li><a href="#iteration"><span class="secno">4.3.3</span> <span class="content">Iteration</span></a>
       </ol>
     </ol>
    <li><a href="#http"><span class="secno">5</span> <span class="content">Triggering Operations Via HTTP Response Header</span></a>
    <li>
     <a href="#html-monkeypatches"><span class="secno">6</span> <span class="content">HTML Monkey Patches</span></a>
     <ol class="toc">
      <li><a href="#html-attr"><span class="secno">6.1</span> <span class="content"><code class="idl"><span>sharedStorageWritable</span></code> &amp; <code><span>sharedstoragewritable</span></code> Attributes</span></a>
      <li>
       <a href="#html-algo"><span class="secno">6.2</span> <span class="content">HTML Algorithm Modifications</span></a>
       <ol class="toc">
        <li><a href="#mod-update-img"><span class="secno">6.2.1</span> <span class="content">Modification to <span>Update the image data</span> Algorithm</span></a>
        <li><a href="#mod-create-nav"><span class="secno">6.2.2</span> <span class="content">Modification to <span>Create navigation params by fetching</span> Algorithm</span></a>
       </ol>
     </ol>
    <li>
     <a href="#fetch-monkeypatches"><span class="secno">7</span> <span class="content">Fetch Monkey Patches</span></a>
     <ol class="toc">
      <li><a href="#fetch-attr"><span class="secno">7.1</span> <span class="content"><code class="idl"><span>sharedStorageWritable</span></code> Key</span></a>
      <li>
       <a href="#mod-fetch-algo"><span class="secno">7.2</span> <span class="content">Fetch Algorithm Modifications</span></a>
       <ol class="toc">
        <li><a href="#mod-request-con"><span class="secno">7.2.1</span> <span class="content">Modification to the <span>Request Constructor</span> Algorithm</span></a>
        <li><a href="#mod-http-net-fetch"><span class="secno">7.2.2</span> <span class="content">Modification to <span>HTTP network or cache fetch</span> Algorithm</span></a>
        <li><a href="#mod-http-fetch"><span class="secno">7.2.3</span> <span class="content">Modification to <span>HTTP fetch</span> Algorithm</span></a>
       </ol>
      <li>
       <a href="#headers"><span class="secno">7.3</span> <span class="content">Shared Storage HTTP Headers</span></a>
       <ol class="toc">
        <li><a href="#request-header"><span class="secno">7.3.1</span> <span class="content"><span>`<code><span>Sec-Shared-Storage-Writable</span></code>`</span> Request Header</span></a>
        <li><a href="#response-header"><span class="secno">7.3.2</span> <span class="content"><span>`<code><span>Shared-Storage-Write</span></code>`</span> Response Header</span></a>
       </ol>
      <li><a href="#ss-fetch-algo"><span class="secno">7.4</span> <span class="content">Shared Storage Fetch-Related Algorithms</span></a>
     </ol>
    <li><a href="#permission"><span class="secno">8</span> <span class="content">Permissions Policy Integration</span></a>
    <li><a href="#clear"><span class="secno">9</span> <span class="content">Clear Site Data Integration</span></a>
    <li><a href="#privacy"><span class="secno">10</span> <span class="content">Privacy Considerations</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
    <em>This section is not normative.</em> 
   <p>In order to prevent cross-site user tracking, browsers are partitioning all forms of storage by <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-top" id="ref-for-nav-top">top-level traversable</a> site; see <a data-link-type="dfn" href="https://privacycg.github.io/storage-partitioning/#client-side-storage-partitioning" id="ref-for-client-side-storage-partitioning">Client-Side Storage Partitioning</a>. But, there are many <a data-link-type="dfn" href="https://github.com/WICG/shared-storage#example-scenarios" id="ref-for-example-scenarios">legitimate use cases</a> currently relying on unpartitioned storage.</p>
   <p>This document introduces a new storage API that is intentionally not partitioned by <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-top" id="ref-for-nav-top①">top-level traversable</a> site (though still partitioned by context origin), in order to serve a number of the use cases needing unpartitioned storage. To limit cross-site reidentification of users, data in Shared Storage may only be read in a restricted environment, called a worklet, and any output from the worklet is in the form of a <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element">fenced frame</a> or a <a data-link-type="dfn" href="https://github.com/patcg-individual-drafts/private-aggregation-api/blob/main/README.md#private-aggregation" id="ref-for-private-aggregation">private aggregation report</a>. Over time, there may be additional ouput gates included in the standard.</p>
   <div class="example" id="example-baea556b">
    <a class="self-link" href="#example-baea556b"></a> <code>a.example</code> randomly assigns users to groups in a way that is consistent cross-site. 
    <p>Inside an <code>a.example</code> iframe:</p>
<pre class="lang-js highlight"><c- a>function</c-> generateSeed<c- p>()</c-> <c- p>{</c-> … <c- p>}</c->
<c- k>await</c-> window<c- p>.</c->sharedStorage<c- p>.</c->worklet<c- p>.</c->addModule<c- p>(</c-><c- t>'experiment.js'</c-><c- p>);</c->

<c- c1>// Only write a cross-site seed to a.example’s storage if there isn’t one yet.</c->
window<c- p>.</c->sharedStorage<c- p>.</c->set<c- p>(</c-><c- t>'seed'</c-><c- p>,</c-> generateSeed<c- p>(),</c-> <c- p>{</c-> ignoreIfPresent<c- o>:</c-> <c- kc>true</c-> <c- p>});</c->

<c- a>let</c-> fencedFrameConfig <c- o>=</c-> <c- k>await</c-> window<c- p>.</c->sharedStorage<c- p>.</c->selectURL<c- p>(</c->
  <c- t>'select-url-for-experiment'</c-><c- p>,</c->
  <c- p>[</c->
    <c- p>{</c->url<c- o>:</c-> <c- u>"blob:https://a.example/123…"</c-><c- p>,</c-> reportingMetadata<c- o>:</c-> <c- p>{</c-><c- u>"click"</c-><c- o>:</c-> <c- u>"https://report.example/1..."</c-><c- p>}},</c->
    <c- p>{</c->url<c- o>:</c-> <c- u>"blob:https://b.example/abc…"</c-><c- p>,</c-> reportingMetadata<c- o>:</c-> <c- p>{</c-><c- u>"click"</c-><c- o>:</c-> <c- u>"https://report.example/a..."</c-><c- p>}},</c->
    <c- p>{</c->url<c- o>:</c-> <c- u>"blob:https://c.example/789…"</c-><c- p>}</c->
  <c- p>],</c->
  <c- p>{</c-> data<c- o>:</c-> <c- p>{</c-> name<c- o>:</c-> <c- t>'experimentA'</c-> <c- p>}</c-> <c- p>}</c->
<c- p>);</c->

<c- c1>// Assumes that the fenced frame 'my-fenced-frame' has already been attached.</c->
document<c- p>.</c->getElementById<c- p>(</c-><c- t>'my-fenced-frame'</c-><c- p>).</c->config <c- o>=</c-> fencedFrameConfig<c- p>;</c->
</pre>
    <p>inside the <code>experiment.js</code> worklet script:</p>
<pre class="lang-js highlight"><c- a>class</c-> SelectURLOperation <c- p>{</c->
  hash<c- p>(</c->experimentName<c- p>,</c-> seed<c- p>)</c-> <c- p>{</c-> … <c- p>}</c->

  <c- k>async</c-> run<c- p>(</c->urls<c- p>,</c-> data<c- p>)</c-> <c- p>{</c->
    <c- a>const</c-> seed <c- o>=</c-> <c- k>await</c-> <c- k>this</c-><c- p>.</c->sharedStorage<c- p>.</c->get<c- p>(</c-><c- t>'seed'</c-><c- p>);</c->
    <c- k>return</c-> hash<c- p>(</c->data<c- p>.</c->name<c- p>,</c-> seed<c- p>)</c-> <c- o>%</c-> urls<c- p>.</c->length<c- p>;</c->
  <c- p>}</c->
<c- p>}</c->
register<c- p>(</c-><c- t>'select-url-for-experiment'</c-><c- p>,</c-> SelectURLOperation<c- p>);</c->
</pre>
   </div>
   <h2 class="heading settled" data-level="2" id="worklet"><span class="secno">2. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet">SharedStorageWorklet</a></code> Interface</span><a class="self-link" href="#worklet"></a></h2>
    The <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet①">SharedStorageWorklet</a></code> object allows developers to supply <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#module-script" id="ref-for-module-script">module scripts</a> to process <a data-link-type="dfn" href="#shared-storage" id="ref-for-shared-storage">Shared Storage</a> data and then output the result through one or more of the output gates. Currently there are two output gates, the <a data-link-type="dfn" href="https://github.com/patcg-individual-drafts/private-aggregation-api/blob/main/README.md#private-aggregation" id="ref-for-private-aggregation①">private aggregation</a> output gate and the <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl">URL-selection</a></code> output gate. 
<pre class="idl highlight def"><c- b>typedef</c-> (<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString"><c- b>USVString</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="https://wicg.github.io/fenced-frame/#fencedframeconfig" id="ref-for-fencedframeconfig"><c- n>FencedFrameConfig</c-></a>) <dfn class="dfn-paneled idl-code" data-dfn-type="typedef" data-export id="typedefdef-sharedstorageresponse"><code><c- g>SharedStorageResponse</c-></code></dfn>;
</pre>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="sharedstorageworklet"><code><c- g>SharedStorageWorklet</c-></code></dfn> : <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/worklets.html#worklet" id="ref-for-worklet"><c- n>Worklet</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#typedefdef-sharedstorageresponse" id="ref-for-typedefdef-sharedstorageresponse"><c- n>SharedStorageResponse</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl①"><c- g>selectURL</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorageWorklet/selectURL(name, urls, options), SharedStorageWorklet/selectURL(name, urls)" data-dfn-type="argument" data-export id="dom-sharedstorageworklet-selecturl-name-urls-options-name"><code><c- g>name</c-></code><a class="self-link" href="#dom-sharedstorageworklet-selecturl-name-urls-options-name"></a></dfn>,
                               <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array" id="ref-for-idl-frozen-array"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-sharedstorageurlwithmetadata" id="ref-for-dictdef-sharedstorageurlwithmetadata"><c- n>SharedStorageUrlWithMetadata</c-></a>> <dfn class="idl-code" data-dfn-for="SharedStorageWorklet/selectURL(name, urls, options), SharedStorageWorklet/selectURL(name, urls)" data-dfn-type="argument" data-export id="dom-sharedstorageworklet-selecturl-name-urls-options-urls"><code><c- g>urls</c-></code><a class="self-link" href="#dom-sharedstorageworklet-selecturl-name-urls-options-urls"></a></dfn>,
                               <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sharedstoragerunoperationmethodoptions" id="ref-for-dictdef-sharedstoragerunoperationmethodoptions"><c- n>SharedStorageRunOperationMethodOptions</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorageWorklet/selectURL(name, urls, options), SharedStorageWorklet/selectURL(name, urls)" data-dfn-type="argument" data-export id="dom-sharedstorageworklet-selecturl-name-urls-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-sharedstorageworklet-selecturl-name-urls-options-options"></a></dfn> = {});
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any"><c- b>any</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-sharedstorageworklet-run" id="ref-for-dom-sharedstorageworklet-run"><c- g>run</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorageWorklet/run(name, options), SharedStorageWorklet/run(name)" data-dfn-type="argument" data-export id="dom-sharedstorageworklet-run-name-options-name"><code><c- g>name</c-></code><a class="self-link" href="#dom-sharedstorageworklet-run-name-options-name"></a></dfn>,
                   <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sharedstoragerunoperationmethodoptions" id="ref-for-dictdef-sharedstoragerunoperationmethodoptions①"><c- n>SharedStorageRunOperationMethodOptions</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorageWorklet/run(name, options), SharedStorageWorklet/run(name)" data-dfn-type="argument" data-export id="dom-sharedstorageworklet-run-name-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-sharedstorageworklet-run-name-options-options"></a></dfn> = {});
};
</pre>
   <p>Each <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet②">SharedStorageWorklet</a></code> has an associated boolean <dfn class="dfn-paneled" data-dfn-for="SharedStorageWorklet" data-dfn-type="dfn" data-noexport id="sharedstorageworklet-addmodule-initiated">addModule initiated</dfn>, initialized to false.</p>
   <p>Each <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet③">SharedStorageWorklet</a></code> has an associated boolean <dfn class="dfn-paneled" data-dfn-for="SharedStorageWorklet" data-dfn-type="dfn" data-noexport id="sharedstorageworklet-cross-origin-worklet-allowed">cross-origin worklet allowed</dfn>, initialized to false.</p>
   <p>Each <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet④">SharedStorageWorklet</a></code> has an associated boolean <dfn class="dfn-paneled" data-dfn-for="SharedStorageWorklet" data-dfn-type="dfn" data-noexport id="sharedstorageworklet-is-cross-origin-worklet">is cross-origin worklet</dfn>, initialized to false.</p>
   <p>Because adding multiple <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#module-script" id="ref-for-module-script①">module scripts</a> via <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule">addModule()</a></code> for the same <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet⑤">SharedStorageWorklet</a></code> would give the caller the ability to store data from <a data-link-type="dfn" href="#shared-storage" id="ref-for-shared-storage①">Shared Storage</a> in global variables defined in the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#module-script" id="ref-for-module-script②">module scripts</a> and then exfiltrate the data through later call(s) to <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule①">addModule()</a></code>, each <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet⑥">SharedStorageWorklet</a></code> can only call <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule②">addModule()</a></code> once. The <a data-link-type="dfn" href="#sharedstorageworklet-addmodule-initiated" id="ref-for-sharedstorageworklet-addmodule-initiated">addModule initiated</a> boolean makes it possible to enforce this restriction.</p>
   <p>When <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule③">addModule()</a></code> is called for a worklet, it will run <a data-link-type="dfn" href="#check-if-addmodule-is-allowed-and-update-state" id="ref-for-check-if-addmodule-is-allowed-and-update-state">check if addModule is allowed and update state</a>, and if the result is "DisallowedDueToNonPreferenceError", or if the result is "DisallowedDueToPreferenceError" and the worklet’s <a data-link-type="dfn" href="#sharedstorageworklet-is-cross-origin-worklet" id="ref-for-sharedstorageworklet-is-cross-origin-worklet">is cross-origin worklet</a> is false, it will cause <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule④">addModule()</a></code> to fail, as detailed in the <a href="#add-module-monkey-patch">§ 2.2.6 Monkey Patch for addModule()</a>.</p>
   <div class="algorithm" data-algorithm="check if user preference setting allows access to shared storage">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="check-if-user-preference-setting-allows-access-to-shared-storage">check if user preference setting allows access to shared storage</dfn> given an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object">environment settings object</a> <var>environment</var> and an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin">origin</a> <var>origin</var>, run the following step: 
    <ol>
     <li data-md>
      <p>Using values available in <var>environment</var> and <var>origin</var> as needed, perform an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined">implementation-defined</a> algorithm to return either true or false.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="determine whether shared storage is allowed by context">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="determine-whether-shared-storage-is-allowed-by-context">determine whether shared storage is allowed by context</dfn>, given an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object①">environment settings object</a> <var>environment</var>, an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin①">origin</a> <var>origin</var>, and a boolean <var>allowedInOpaqueOriginContext</var>, run these steps: 
    <ol>
     <li data-md>
      <p>If <var>environment</var> is not a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context">secure context</a>, then return false.</p>
     <li data-md>
      <p>If <var>allowedInOpaqueOriginContext</var> is false and <var>environment</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin">origin</a> is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque" id="ref-for-concept-origin-opaque">opaque origin</a>, then return false.</p>
     <li data-md>
      <p>If <var>origin</var> is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque" id="ref-for-concept-origin-opaque①">opaque origin</a>, then return false.</p>
     <li data-md>
      <p>Let <var>globalObject</var> be the <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm">current realm</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global">global object</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert">Assert</a>: <var>globalObject</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window">Window</a></code> or a <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope">SharedStorageWorkletGlobalScope</a></code>.</p>
     <li data-md>
      <p>If <var>globalObject</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window①">Window</a></code>, and if the result of running <a data-link-type="dfn" href="https://www.w3.org/TR/permissions-policy/#algo-is-feature-enabled" id="ref-for-algo-is-feature-enabled">Is feature enabled in document for origin?</a> on "<a data-link-type="dfn" href="#permissionspolicy-shared-storage" id="ref-for-permissionspolicy-shared-storage">shared-storage</a>", <var>globalObject</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" id="ref-for-concept-document-window">associated document</a>, and <var>origin</var> returns false, then return false.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#obtain-a-site" id="ref-for-obtain-a-site">obtain a site</a> with <var>origin</var> is not <a data-link-type="dfn" href="https://github.com/privacysandbox/attestation#enrolled" id="ref-for-enrolled">enrolled</a>, then return false.</p>
     <li data-md>
      <p>Return true.</p>
    </ol>
   </div>
   <div class="note" role="note">
     Here are the scenarios where the algorithms <a data-link-type="dfn" href="#determine-whether-shared-storage-is-allowed-by-context" id="ref-for-determine-whether-shared-storage-is-allowed-by-context">determine whether shared storage is allowed by context</a> and <a data-link-type="dfn" href="#check-if-user-preference-setting-allows-access-to-shared-storage" id="ref-for-check-if-user-preference-setting-allows-access-to-shared-storage">check if user preference setting allows access to shared storage</a> are used: 
    <ul>
     <li data-md>
      <p>For each method under <a href="#window-setter">§ 4.1.1 Window Setter/Deleter Methods</a>, <var>environment</var> is the current context, and <var>origin</var> is <var>environment</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin①">origin</a>.</p>
     <li data-md>
      <p>For creating a worklet, <var>environment</var> is the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object②">environment settings object</a> associated with the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window②">Window</a></code> that created the worklet, and <var>origin</var> is the module script url’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin">origin</a>.</p>
     <li data-md>
      <p>For running operations on a worklet (from a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window③">Window</a></code>), and for each method under <a href="#worklet-setter">§ 4.3.1 Worklet Setter/Deleter Methods</a> (from <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①">SharedStorageWorkletGlobalScope</a></code>), <var>environment</var> is the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object③">environment settings object</a> associated with the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window④">Window</a></code> that created the worklet, and <var>origin</var> is the worklet’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#concept-worklet-global-scopes" id="ref-for-concept-worklet-global-scopes">global scopes</a>[0]'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-global-object-realm" id="ref-for-concept-global-object-realm">realm</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object">settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin②">origin</a>.</p>
     <li data-md>
      <p>For <a href="#ss-fetch-algo">§ 7.4 Shared Storage Fetch-Related Algorithms</a>, <var>environment</var> is the request’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-window" id="ref-for-concept-request-window">window</a>, and <var>origin</var> is the request’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url">current URL</a>'s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin①">origin</a>.</p>
     <li data-md>
      <p>For <a href="#ss-fetch-algo">§ 7.4 Shared Storage Fetch-Related Algorithms</a>, for <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-createworklet" id="ref-for-dom-windowsharedstorage-createworklet">createWorklet()</a></code> called with a cross-origin worklet script, and for <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl②">selectURL()</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-run" id="ref-for-dom-sharedstorageworklet-run①">run()</a></code> that operate on a cross-origin worklet created from <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-createworklet" id="ref-for-dom-windowsharedstorage-createworklet①">createWorklet()</a></code>, <var>allowedInOpaqueOriginContext</var> is true. For other methods, <var>allowedInOpaqueOriginContext</var> is false.</p>
    </ul>
   </div>
   <div class="algorithm" data-algorithm="check if addModule is allowed and update state">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="check-if-addmodule-is-allowed-and-update-state">check if addModule is allowed and update state</dfn> given a <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet⑦">SharedStorageWorklet</a></code> <var>worklet</var> and a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url">URL</a> <var>moduleURLRecord</var>, run the following steps: 
    <ol>
     <li data-md>
      <p>If <var>worklet</var>’s <a data-link-type="dfn" href="#sharedstorageworklet-addmodule-initiated" id="ref-for-sharedstorageworklet-addmodule-initiated①">addModule initiated</a> is true, return "DisallowedDueToNonPreferenceError".</p>
     <li data-md>
      <p>Set <var>worklet</var>’s <a data-link-type="dfn" href="#sharedstorageworklet-addmodule-initiated" id="ref-for-sharedstorageworklet-addmodule-initiated②">addModule initiated</a> to true.</p>
     <li data-md>
      <p>Let <var>workletOrigin</var> be <var>moduleURLRecord</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin②">origin</a>.</p>
     <li data-md>
      <p>Let <var>isCrossOriginWorklet</var> be false.</p>
     <li data-md>
      <p>If <var>workletOrigin</var> and the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object" id="ref-for-current-settings-object">current settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin③">origin</a> are not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#same-origin" id="ref-for-same-origin">same origin</a>, then set <var>isCrossOriginWorklet</var> to true.</p>
     <li data-md>
      <p>Let <var>allowedInOpaqueOriginContext</var> be <var>isCrossOriginWorklet</var>.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#determine-whether-shared-storage-is-allowed-by-context" id="ref-for-determine-whether-shared-storage-is-allowed-by-context①">determine whether shared storage is allowed by context</a> given the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object" id="ref-for-current-settings-object①">current settings object</a>, <var>workletOrigin</var>, and <var>allowedInOpaqueOriginContext</var> is false, return "DisallowedDueToNonPreferenceError".</p>
     <li data-md>
      <p>Set <var>worklet</var>’s <a data-link-type="dfn" href="#sharedstorageworklet-is-cross-origin-worklet" id="ref-for-sharedstorageworklet-is-cross-origin-worklet①">is cross-origin worklet</a> to <var>isCrossOriginWorklet</var>.</p>
     <li data-md>
      <p>If <var>worklet</var>’s <a data-link-type="dfn" href="#sharedstorageworklet-cross-origin-worklet-allowed" id="ref-for-sharedstorageworklet-cross-origin-worklet-allowed">cross-origin worklet allowed</a> is false, and if <var>worklet</var>’s <a data-link-type="dfn" href="#sharedstorageworklet-is-cross-origin-worklet" id="ref-for-sharedstorageworklet-is-cross-origin-worklet②">is cross-origin worklet</a> is true, return "DisallowedDueToNonPreferenceError".</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#check-if-user-preference-setting-allows-access-to-shared-storage" id="ref-for-check-if-user-preference-setting-allows-access-to-shared-storage①">check if user preference setting allows access to shared storage</a> given the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object" id="ref-for-current-settings-object②">current settings object</a> and <var>workletOrigin</var> is false, return "DisallowedDueToPreferenceError".</p>
     <li data-md>
      <p>Return "Allowed".</p>
    </ol>
   </div>
   <p>Moreover, each <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet⑧">SharedStorageWorklet</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#concept-worklet-global-scopes" id="ref-for-concept-worklet-global-scopes①">list of global scopes</a>, initially empty, can contain at most one instance of its <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#worklet-global-scope-type" id="ref-for-worklet-global-scope-type">worklet global scope type</a>, the <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope②">SharedStorageWorkletGlobalScope</a></code>.</p>
   <h3 class="heading settled" data-level="2.1" id="run-op-shared-storage-worklet"><span class="secno">2.1. </span><span class="content">Run Operation Methods on <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet⑨">SharedStorageWorklet</a></code></span><a class="self-link" href="#run-op-shared-storage-worklet"></a></h3>
   <div class="algorithm" data-algorithm="get the select-url result index">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="get-the-select-url-result-index">get the select-url result index</dfn>, given <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet①⓪">SharedStorageWorklet</a></code> <var>worklet</var>, <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②">DOMString</a></code> <var>operationName</var>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list">list</a> of <code class="idl"><a data-link-type="idl" href="#dictdef-sharedstorageurlwithmetadata" id="ref-for-dictdef-sharedstorageurlwithmetadata①">SharedStorageUrlWithMetadata</a></code>s <var>urlList</var>, and <code class="idl"><a data-link-type="idl" href="#dictdef-sharedstoragerunoperationmethodoptions" id="ref-for-dictdef-sharedstoragerunoperationmethodoptions②">SharedStorageRunOperationMethodOptions</a></code> <var>options</var>: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise②">promise</a>.</p>
     <li data-md>
      <p>Let <var>window</var> be <var>worklet</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object">relevant settings object</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert①">Assert</a>: <var>window</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window⑤">Window</a></code>.</p>
     <li data-md>
      <p>If <var>window</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window-bc" id="ref-for-window-bc">browsing context</a> is null, then return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>window</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" id="ref-for-concept-document-window①">associated document</a> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#fully-active" id="ref-for-fully-active">fully active</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①">TypeError</a></code>.</p>
     <li data-md>
      <p>Return <var>promise</var>, and immediately <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#obtain-a-worklet-agent" id="ref-for-obtain-a-worklet-agent">obtain a worklet agent</a> given <var>window</var> and run the rest of these steps in that agent:</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert②">Assert</a>: <var>worklet</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#concept-worklet-global-scopes" id="ref-for-concept-worklet-global-scopes②">global scopes</a>'s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size">size</a> is 1.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert③">Assert</a>: <var>worklet</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-module-map" id="ref-for-concept-workerglobalscope-module-map">module map</a> is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-is-empty" id="ref-for-map-is-empty">empty</a>.</p>
       <li data-md>
        <p>Let <var>globalScope</var> be <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this">this</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#concept-worklet-global-scopes" id="ref-for-concept-worklet-global-scopes③">global scopes</a>[0].</p>
       <li data-md>
        <p>Let <var>operationMap</var> be <var>globalScope</var>’s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-operation-map" id="ref-for-sharedstorageworkletglobalscope-operation-map">operation map</a>.</p>
       <li data-md>
        <p>If <var>operationMap</var> does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists">contain</a> <var>operationName</var>, then <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task">queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source">DOM manipulation task source</a>, given <var>window</var>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②">TypeError</a></code>, and abort these steps.</p>
        <p class="note" role="note"><span class="marker">Note:</span> This could happen if <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworkletglobalscope-register" id="ref-for-dom-sharedstorageworkletglobalscope-register">register()</a></code> was never called with <var>operationName</var>.</p>
       <li data-md>
        <p>Let <var>operation</var> be <var>operationMap</var>[<var>operationName</var>].</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert④">Assert</a>: <var>operation</var>’s <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-associated-realm" id="ref-for-dfn-associated-realm">associated realm</a> is <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①">this</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm" id="ref-for-concept-relevant-realm">relevant realm</a>.</p>
       <li data-md>
        <p>Let <var>argumentsList</var> be the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①">list</a> « <var>urlList</var> ».</p>
       <li data-md>
        <p>If <var>options</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①">contains</a> <var>data</var>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append">append</a> <var>data</var> to <var>argumentsList</var>.</p>
       <li data-md>
        <p>Let <var>index</var> be the result of <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function">invoking</a> <var>operation</var> with <var>argumentsList</var>.</p>
       <li data-md>
        <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#an-exception-was-thrown" id="ref-for-an-exception-was-thrown">an exception was thrown</a>, then <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task①">queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source①">DOM manipulation task source</a>, given <var>window</var>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject①">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③">TypeError</a></code>, and abort these steps.</p>
        <p class="note" role="note"><span class="marker">Note:</span> This indicates that either <var>operationCtor</var>’s run() method encounters an error (where <var>operationCtor</var> is the parameter in <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworkletglobalscope-register" id="ref-for-dom-sharedstorageworkletglobalscope-register①">register()</a></code>), or the result <var>index</var> is a non-integer value, which violates the selectURL() protocol, and we don’t know which url should be selected.</p>
       <li data-md>
        <p>If <var>index</var> is greater than <var>urlList</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size①">size</a>, then <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task②">queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source②">DOM manipulation task source</a>, given <var>window</var>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject②">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror④">TypeError</a></code>, and abort these steps.</p>
        <p class="note" role="note"><span class="marker">Note:</span> The result index is beyond the input urls' size. This violates the selectURL() protocol, and we don’t know which url should be selected.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task③">Queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source③">DOM manipulation task source</a>, given <var>window</var>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve">resolve</a> <var>promise</var> with <var>index</var>.</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="selectURL(name, urls, options)" data-algorithm-for="SharedStorageWorklet">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="SharedStorageWorklet" data-dfn-type="method" data-export data-lt="selectURL(name, urls, options)|selectURL(name, urls)" id="dom-sharedstorageworklet-selecturl"><code>selectURL(<var>name</var>, <var>urls</var>, <var>options</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>resultPromise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise③">promise</a>.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②">this</a>'s <a data-link-type="dfn" href="#sharedstorageworklet-addmodule-initiated" id="ref-for-sharedstorageworklet-addmodule-initiated③">addModule initiated</a> is false, then return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑤">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>window</var> be <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this③">this</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object①">relevant settings object</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert⑤">Assert</a>: <var>window</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window⑥">Window</a></code>.</p>
     <li data-md>
      <p>Let <var>context</var> be <var>window</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window-bc" id="ref-for-window-bc①">browsing context</a>.</p>
     <li data-md>
      <p>If <var>context</var> is null, then return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with③">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑥">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>document</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-document" id="ref-for-nav-document">active document</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert⑥">Assert</a>: <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this④">this</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#concept-worklet-global-scopes" id="ref-for-concept-worklet-global-scopes④">global scopes</a>'s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size②">size</a> is 1.</p>
     <li data-md>
      <p>Let <var>globalScope</var> be <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑤">this</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#concept-worklet-global-scopes" id="ref-for-concept-worklet-global-scopes⑤">global scopes</a>[0].</p>
     <li data-md>
      <p>Let <var>workletOrigin</var> be <var>globalScope</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-global-object-realm" id="ref-for-concept-global-object-realm①">realm</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object①">settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin④">origin</a>.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="https://www.w3.org/TR/permissions-policy/#algo-is-feature-enabled" id="ref-for-algo-is-feature-enabled①">Is feature enabled in document for origin?</a> on "<a data-link-type="dfn" href="#permissionspolicy-shared-storage-select-url" id="ref-for-permissionspolicy-shared-storage-select-url">shared-storage-select-url</a>", <var>document</var>, and <var>workletOrigin</var> returns false, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with④">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑦">TypeError</a></code>.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑥">this</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#concept-worklet-global-scopes" id="ref-for-concept-worklet-global-scopes⑥">global scopes</a> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-empty" id="ref-for-list-empty">empty</a>, then return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑤">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑧">TypeError</a></code>.</p>
      <p class="note" role="note"><span class="marker">Note:</span> This can happen if either <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-selecturl" id="ref-for-dom-windowsharedstorage-selecturl">selectURL()</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl③">selectURL()</a></code> is called before <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule⑤">addModule()</a></code>.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-check-whether-addmodule-is-finished" id="ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished">check whether addModule is finished</a> for <var>globalScope</var> is false, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑥">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑨">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>urls</var> is empty or if <var>urls</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size③">size</a> is greater than 8, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑦">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①⓪">TypeError</a></code>.</p>
      <p class="note" role="note"><span class="marker">Note:</span> 8 is chosen here so that each call of <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl④">selectURL()</a></code> can leak at most log2(8) = 3 bits of information when the result fenced frame is clicked. It’s not a lot of information per-call.</p>
     <li data-md>
      <p>Let <var>urlList</var> be an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list②">list</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate" id="ref-for-map-iterate">For each</a> <var>urlWithMetadata</var> in <var>urls</var>:</p>
      <ol>
       <li data-md>
        <p>If <var>urlWithMetadata</var> has no field "<code>url</code>", return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑧">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①①">TypeError</a></code>.</p>
       <li data-md>
        <p>Otherwise, let <var>urlString</var> be <var>urlWithMetadata</var>["<code>url</code>"].</p>
       <li data-md>
        <p>Let <var>serializedUrl</var> be the result of running <a data-link-type="dfn" href="#get-the-canonical-url-string-if-valid" id="ref-for-get-the-canonical-url-string-if-valid">get the canonical URL string if valid</a> with <var>urlString</var>.</p>
       <li data-md>
        <p>If <var>serializedUrl</var> is undefined, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑨">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①②">TypeError</a></code>.</p>
       <li data-md>
        <p>Otherwise, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append①">append</a> <var>serializedUrl</var> to <var>urlList</var>.</p>
       <li data-md>
        <p>If <var>urlWithMetadata</var> has field "<code>reportingMetadata</code>":</p>
        <ol>
         <li data-md>
          <p>Let <var>reportingMetadata</var> be <var>urlWithMetadata</var>["<code>reportingMetadata</code>"].</p>
         <li data-md>
          <p>If the result of running <a data-link-type="dfn" href="#validate-reporting-metadata" id="ref-for-validate-reporting-metadata">validate reporting metadata</a> with <var>reportingMetadata</var> is false, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject③">reject</a> <var>resultPromise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①③">TypeError</a></code> and abort these steps.</p>
        </ol>
      </ol>
     <li data-md>
      <p>Let <var>fencedFrameConfigMapping</var> be <var>window</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" id="ref-for-concept-document-window②">associated document</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#node-navigable" id="ref-for-node-navigable">node navigable</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-traversable" id="ref-for-nav-traversable">traversable navigable</a>'s <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#traversable-navigable-fenced-frame-config-mapping" id="ref-for-traversable-navigable-fenced-frame-config-mapping">fenced frame config mapping</a>.</p>
     <li data-md>
      <p>Let <var>pendingConfig</var> be a new <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#fenced-frame-config" id="ref-for-fenced-frame-config">fenced frame config</a>.</p>
     <li data-md>
      <p>Let <var>urn</var> be the result of running <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#fenced-frame-config-mapping-store-a-pending-config" id="ref-for-fenced-frame-config-mapping-store-a-pending-config">store a pending config</a> on <var>fencedFrameConfigMapping</var> with <var>pendingConfig</var>.</p>
     <li data-md>
      <p>If <var>urn</var> is failure, then return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①⓪">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①④">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>window</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object②">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>allowedInOpaqueOriginContext</var> be <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑦">this</a>'s <a data-link-type="dfn" href="#sharedstorageworklet-is-cross-origin-worklet" id="ref-for-sharedstorageworklet-is-cross-origin-worklet③">is cross-origin worklet</a>.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#determine-whether-shared-storage-is-allowed-by-context" id="ref-for-determine-whether-shared-storage-is-allowed-by-context②">determine whether shared storage is allowed by context</a> given <var>environment</var>, <var>workletOrigin</var>, and <var>allowedInOpaqueOriginContext</var> is false, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①①">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①⑤">TypeError</a></code>.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#check-if-user-preference-setting-allows-access-to-shared-storage" id="ref-for-check-if-user-preference-setting-allows-access-to-shared-storage②">check if user preference setting allows access to shared storage</a> given <var>environment</var> and <var>workletOrigin</var> is false:</p>
      <ol>
       <li data-md>
        <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑧">this</a>'s <a data-link-type="dfn" href="#sharedstorageworklet-is-cross-origin-worklet" id="ref-for-sharedstorageworklet-is-cross-origin-worklet④">is cross-origin worklet</a> is false, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①②">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①⑥">TypeError</a></code>.</p>
      </ol>
     <li data-md>
      <p>If <var>options</var>["<code>resolveToConfig</code>"] is true, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve①">resolve</a> <var>resultPromise</var> with <var>pendingConfig</var>.</p>
     <li data-md>
      <p>Otherwise, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve②">resolve</a> <var>resultPromise</var> with <var>urn</var>.</p>
     <li data-md>
      <p>Let <var>indexPromise</var> be the result of running <a data-link-type="dfn" href="#get-the-select-url-result-index" id="ref-for-get-the-select-url-result-index">get the select-url result index</a>, given <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑨">this</a>, <var>name</var>, <var>urlList</var>, and <var>options</var>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#upon-fulfillment" id="ref-for-upon-fulfillment">Upon fulfillment</a> of <var>indexPromise</var> with <var>resultIndex</var>, perform the following steps:</p>
      <ol>
       <li data-md>
        <p>Let <var>site</var> be the result of running <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#obtain-a-site" id="ref-for-obtain-a-site①">obtain a site</a> with <var>document</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document-origin" id="ref-for-concept-document-origin">origin</a>.</p>
       <li data-md>
        <p>Let <var>remainingBudget</var> be the result of running <a data-link-type="dfn" href="#determine-remaining-navigation-budget" id="ref-for-determine-remaining-navigation-budget">determine remaining navigation budget</a> with <var>environment</var> and <var>site</var>.</p>
       <li data-md>
        <p>Let <var>pendingBits</var> be the logarithm base 2 of <var>urlList</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size④">size</a>.</p>
       <li data-md>
        <p>If <var>pendingBits</var> is greather than <var>remainingBudget</var>, set <var>resultIndex</var> to <a data-link-type="dfn" href="#default-index" id="ref-for-default-index">default index</a>.</p>
       <li data-md>
        <p>Let <var>finalConfig</var> be a new <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#fenced-frame-config" id="ref-for-fenced-frame-config①">fenced frame config</a>.</p>
       <li data-md>
        <p>Set <var>finalConfig</var>’s <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#fenced-frame-config-mapped-url" id="ref-for-fenced-frame-config-mapped-url">mapped url</a> to <var>urlList</var>[<var>resultIndex</var>].</p>
       <li data-md>
        <p>Set <var>finalConfig</var>’s <span class="todo">a "pending shared storage budget debit" field</span> to <var>pendingBits</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#fenced-frame-config-mapping-finalize-a-pending-config" id="ref-for-fenced-frame-config-mapping-finalize-a-pending-config">Finalize a pending config</a> on <var>fencedFrameConfigMapping</var> with <var>urn</var> and <var>finalConfig</var>.</p>
       <li data-md>
        <p>Let <var>resultURLWithMetadata</var> be <var>urls</var>[<var>resultIndex</var>].</p>
       <li data-md>
        <p>If <var>resultURLWithMetadata</var> has field "<code>reportingMetadata</code>", run <a data-link-type="dfn" href="#register-reporting-metadata" id="ref-for-register-reporting-metadata">register reporting metadata</a> with <var>resultURLWithMetadata</var>["<code>reportingMetadata</code>"].</p>
       <li data-md>
        <p>If <var>options</var>["<code>keepAlive</code>"] is false, run <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#terminate-a-worklet-global-scope" id="ref-for-terminate-a-worklet-global-scope">terminate a worklet global scope</a> with <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①⓪">this</a>.</p>
      </ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#upon-rejection" id="ref-for-upon-rejection">Upon rejection</a> of <var>indexPromise</var>, perform the following steps:</p>
      <ol>
       <li data-md>
        <p>Let <var>finalConfig</var> be a new <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#fenced-frame-config" id="ref-for-fenced-frame-config②">fenced frame config</a>.</p>
       <li data-md>
        <p>Set <var>finalConfig</var>’s <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#fenced-frame-config-mapped-url" id="ref-for-fenced-frame-config-mapped-url①">mapped url</a> to <var>urlList</var>[<a data-link-type="dfn" href="#default-index" id="ref-for-default-index①">default index</a>].</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#fenced-frame-config-mapping-finalize-a-pending-config" id="ref-for-fenced-frame-config-mapping-finalize-a-pending-config①">Finalize a pending config</a> on <var>fencedFrameConfigMapping</var> with <var>urn</var> and <var>finalConfig</var>.</p>
       <li data-md>
        <p>If <var>options</var>["<code>keepAlive</code>"] is false, run <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#terminate-a-worklet-global-scope" id="ref-for-terminate-a-worklet-global-scope①">terminate a worklet global scope</a> with <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①①">this</a>.</p>
      </ol>
     <li data-md>
      <p>Return <var>resultPromise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="run(name, options)" data-algorithm-for="SharedStorageWorklet">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="SharedStorageWorklet" data-dfn-type="method" data-export data-lt="run(name, options)|run(name)" id="dom-sharedstorageworklet-run"><code>run(<var>name</var>, <var>options</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise④">promise</a>.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①②">this</a>'s <a data-link-type="dfn" href="#sharedstorageworklet-addmodule-initiated" id="ref-for-sharedstorageworklet-addmodule-initiated④">addModule initiated</a> is false, then return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①③">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①⑦">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>window</var> be <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①③">this</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object③">relevant settings object</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert⑦">Assert</a>: <var>window</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window⑦">Window</a></code>.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①④">this</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#concept-worklet-global-scopes" id="ref-for-concept-worklet-global-scopes⑦">global scopes</a> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-empty" id="ref-for-list-empty①">empty</a>, then return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①④">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①⑧">TypeError</a></code>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert⑧">Assert</a>: <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①⑤">this</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#concept-worklet-global-scopes" id="ref-for-concept-worklet-global-scopes⑧">global scopes</a>'s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size⑤">size</a> is 1.</p>
     <li data-md>
      <p>Let <var>globalScope</var> be <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①⑥">this</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#concept-worklet-global-scopes" id="ref-for-concept-worklet-global-scopes⑨">global scopes</a>[0].</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-check-whether-addmodule-is-finished" id="ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished①">check whether addModule is finished</a> for <var>globalScope</var> is false, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①⑤">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①⑨">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>workletOrigin</var> be <var>globalScope</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-global-object-realm" id="ref-for-concept-global-object-realm②">realm</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object②">settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin⑤">origin</a>.</p>
     <li data-md>
      <p>Let <var>allowedInOpaqueOriginContext</var> be <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①⑦">this</a>'s <a data-link-type="dfn" href="#sharedstorageworklet-is-cross-origin-worklet" id="ref-for-sharedstorageworklet-is-cross-origin-worklet⑤">is cross-origin worklet</a>.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#determine-whether-shared-storage-is-allowed-by-context" id="ref-for-determine-whether-shared-storage-is-allowed-by-context③">determine whether shared storage is allowed by context</a> given <var>window</var>, <var>workletOrigin</var>, and <var>allowedInOpaqueOriginContext</var> is false, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject④">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②⓪">TypeError</a></code>.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#check-if-user-preference-setting-allows-access-to-shared-storage" id="ref-for-check-if-user-preference-setting-allows-access-to-shared-storage③">check if user preference setting allows access to shared storage</a> given <var>window</var> and <var>workletOrigin</var> is false:</p>
      <ol>
       <li data-md>
        <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①⑧">this</a>'s <a data-link-type="dfn" href="#sharedstorageworklet-is-cross-origin-worklet" id="ref-for-sharedstorageworklet-is-cross-origin-worklet⑥">is cross-origin worklet</a> is false, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject⑤">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②①">TypeError</a></code>.</p>
       <li data-md>
        <p>Else, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve③">resolve</a> <var>promise</var> with undefined.</p>
       <li data-md>
        <p>Return <var>promise</var>.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>, and immediately <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#obtain-a-worklet-agent" id="ref-for-obtain-a-worklet-agent①">obtaining a worklet agent</a> given <var>window</var> and run the rest of these steps in that agent:</p>
      <p class="note" role="note"><span class="marker">Note:</span> The <var>promise</var>’s resolution should be before and not depend on the execution inside <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope③">SharedStorageWorkletGlobalScope</a></code>. This is because shared storage is a type of unpartitioned storage, and a <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope④">SharedStorageWorkletGlobalScope</a></code> can have access to cross-site data, which shouldn’t be leaked via <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-run" id="ref-for-dom-sharedstorageworklet-run②">run()</a></code> (via its success/error result).</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task④">Queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source④">DOM manipulation task source</a>, given <var>window</var>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve④">resolve</a> <var>promise</var> with undefined.</p>
       <li data-md>
        <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①⑨">this</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-module-map" id="ref-for-concept-workerglobalscope-module-map①">module map</a> is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-is-empty" id="ref-for-map-is-empty①">empty</a>:</p>
        <ol>
         <li data-md>
          <p>Let <var>operationMap</var> be <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②⓪">this</a>'s <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope⑤">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-operation-map" id="ref-for-sharedstorageworkletglobalscope-operation-map①">operation map</a>.</p>
         <li data-md>
          <p>If <var>operationMap</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists②">contains</a> <var>name</var>:</p>
          <ol>
           <li data-md>
            <p>Let <var>operation</var> be <var>operationMap</var>[<var>name</var>].</p>
           <li data-md>
            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert⑨">Assert</a>: <var>operation</var>’s <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-associated-realm" id="ref-for-dfn-associated-realm①">associated realm</a> is <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②①">this</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm" id="ref-for-concept-relevant-realm①">relevant realm</a>.</p>
           <li data-md>
            <p>If <var>options</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists③">contains</a> <var>data</var>:</p>
            <ol>
             <li data-md>
              <p>Let <var>argumentsList</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list③">list</a>.</p>
             <li data-md>
              <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append②">Append</a> <var>data</var> to <var>argumentsList</var>.</p>
             <li data-md>
              <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function①">Invoke</a> <var>operation</var> with <var>argumentsList</var>.</p>
            </ol>
           <li data-md>
            <p>Otherwise, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function②">invoke</a> <var>operation</var> without any arguments list.</p>
          </ol>
        </ol>
       <li data-md>
        <p>If <var>options</var>["<code>keepAlive</code>"] is false:</p>
        <ol>
         <li data-md>
          <p>Wait for <var>operation</var> to finish running, if applicable.</p>
         <li data-md>
          <p>Run <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#terminate-a-worklet-global-scope" id="ref-for-terminate-a-worklet-global-scope②">terminate a worklet global scope</a> with <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②②">this</a>.</p>
        </ol>
      </ol>
    </ol>
   </div>
   <h3 class="heading settled" data-level="2.2" id="worklet-monkey-patch"><span class="secno">2.2. </span><span class="content">Monkey Patch for <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#worklets" id="ref-for-worklets">Worklets</a></span><a class="self-link" href="#worklet-monkey-patch"></a></h3>
   <p>This specification will make some modifications to the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#worklets" id="ref-for-worklets①">Worklet</a> standard to accommodate the needs of Shared Storage.</p>
   <h4 class="heading settled" data-level="2.2.1" id="set-up-a-worklet-environment-settings-object-monkey-patch"><span class="secno">2.2.1. </span><span class="content">Monkey Patch for <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#set-up-a-worklet-environment-settings-object" id="ref-for-set-up-a-worklet-environment-settings-object">set up a worklet environment settings object</a></span><a class="self-link" href="#set-up-a-worklet-environment-settings-object-monkey-patch"></a></h4>
   <p>The <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#set-up-a-worklet-environment-settings-object" id="ref-for-set-up-a-worklet-environment-settings-object①">set up a worklet environment settings object</a> algorithm will need to include an additional parameter: <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#worklet" id="ref-for-worklet①">Worklet</a></code> <var>worklet</var>. The step that defines the <var>settingsObject</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin⑥">origin</a> should be modified as follows:</p>
   <ol start="6">
    <li data-md>
     <p>Let <var>settingsObject</var> be a new <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object④">environment settings object</a> whose algorithms are defined as follows:</p>
     <p>......</p>
     <p><b>The <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin⑦">origin</a></b></p>
     <ol>
      <li data-md>
       <p>Let <var>workletGlobalScope</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global①">global object</a> of <var>realmExecutionContext</var>’s Realm component.</p>
      <li data-md>
       <p>If <var>workletGlobalScope</var> is not <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope⑥">SharedStorageWorkletGlobalScope</a></code>, return <var>origin</var>.</p>
      <li data-md>
       <p>Let <var>pendingAddedModules</var> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-clone" id="ref-for-list-clone">clone</a> of <var>worklet</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#concept-worklet-added-modules-list" id="ref-for-concept-worklet-added-modules-list">added modules list</a>.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert①⓪">Assert</a>: <var>pendingAddedModules</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size⑥">size</a> is 1.</p>
      <li data-md>
       <p>Let <var>moduleURL</var> be <var>pendingAddedModules</var>[0].</p>
      <li data-md>
       <p>Return <var>moduleURL</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin③">origin</a>.</p>
     </ol>
     <p>......</p>
   </ol>
   <h4 class="heading settled" data-level="2.2.2" id="create-a-worklet-global-scope-monkey-patch"><span class="secno">2.2.2. </span><span class="content">Monkey Patch for <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#create-a-worklet-global-scope" id="ref-for-create-a-worklet-global-scope">create a worklet global scope</a></span><a class="self-link" href="#create-a-worklet-global-scope-monkey-patch"></a></h4>
   <p>The <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#create-a-worklet-global-scope" id="ref-for-create-a-worklet-global-scope①">create a worklet global scope</a> algorithm will need to be modified to pass in the <var>worklet</var> parameter:</p>
   <ol start="5">
    <li data-md>
     <p>Let <var>insideSettings</var> be the result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#set-up-a-worklet-environment-settings-object" id="ref-for-set-up-a-worklet-environment-settings-object②">setting up a worklet environment settings object</a> given <var>realmExecutionContext</var>, <var>outsideSettings</var>, and <var>worklet</var>.</p>
   </ol>
   <h4 class="heading settled" data-level="2.2.3" id="fetch-a-worklet-script-graph-monkey-patch"><span class="secno">2.2.3. </span><span class="content">Monkey Patch for <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-worklet-script-graph" id="ref-for-fetch-a-worklet-script-graph">fetch a worklet script graph</a></span><a class="self-link" href="#fetch-a-worklet-script-graph-monkey-patch"></a></h4>
   <p>The algorithm <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-worklet-script-graph" id="ref-for-fetch-a-worklet-script-graph①">fetch a worklet script graph</a> calls into the <a href="https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-worklet/module-worker-script-graph">fetch a worklet/module worker script graph</a> algorithm, which takes in an algorithm parameter <var>processCustomFetchResponse</var>. The definition of that <var>processCustomFetchResponse</var> parameter will need to include the following step before the step "5. <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch" id="ref-for-concept-fetch">Fetch</a> <var>request</var>, ...":</p>
   <ol start="5">
    <li data-md>
     <p>If <var>fetchClient</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global">global object</a> is <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope⑦">SharedStorageWorkletGlobalScope</a></code>:</p>
     <ol>
      <li data-md>
       <p>Set <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-redirect-mode" id="ref-for-concept-request-redirect-mode">redirect mode</a> to "<code>error</code>".</p>
       <p class="note" role="note"><span class="marker">Note:</span> For shared storage, redirects are disallowed for the module script request. With this restriction, it’s possible to define and to use the algorithm that gets the <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object③">settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin⑧">origin</a> (as described in <a href="#set-up-a-worklet-environment-settings-object-monkey-patch">§ 2.2.1 Monkey Patch for set up a worklet environment settings object</a>) as soon as the <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope⑧">SharedStorageWorkletGlobalScope</a></code> is created, as the origin won’t change. This restriction may be removed in a future iteration of the design. If redirects become allowed, presumably, the algorithm that gets the <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object④">settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin⑨">origin</a> should be updated to return the final request’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url">URL</a>'s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin④">origin</a> after receiving the final request’s response, and the user preference checkings shall only be done after that point.</p>
     </ol>
   </ol>
   <h4 class="heading settled" data-level="2.2.4" id="shared-storage-cross-origin-worklet-allowed"><span class="secno">2.2.4. </span><span class="content">The `<dfn class="dfn-paneled" data-dfn-type="http-header" data-export id="http-headerdef-shared-storage-cross-origin-worklet-allowed"><code>Shared-Storage-Cross-Origin-Worklet-Allowed</code></dfn>` HTTP response header</span><a class="self-link" href="#shared-storage-cross-origin-worklet-allowed"></a></h4>
   <p>The `<a data-link-type="http-header" href="#http-headerdef-shared-storage-cross-origin-worklet-allowed" id="ref-for-http-headerdef-shared-storage-cross-origin-worklet-allowed"><code>Shared-Storage-Cross-Origin-Worklet-Allowed</code></a>` HTTP response header, along with the traditional CORS headers, can be used to grant a cross-origin site the permission to create a worklet under the module script’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①">URL</a>'s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin⑤">origin</a>, and to run subsequent operations on the worklet.</p>
   <p>Cross-origin worklets rely on CORS as a baseline permission mechanism to indicate trusted external origins. However, CORS alone is insufficient for worklet creation. Unlike simple resource sharing, worklets allow the creator site to execute JavaScript within the context of the target origin. To ensure security, an additional header, `<a data-link-type="http-header" href="#http-headerdef-shared-storage-cross-origin-worklet-allowed" id="ref-for-http-headerdef-shared-storage-cross-origin-worklet-allowed①"><code>Shared-Storage-Cross-Origin-Worklet-Allowed</code></a>`, is required.</p>
   <h4 class="heading settled" data-level="2.2.5" id="http-fetch-monkey-patch"><span class="secno">2.2.5. </span><span class="content">Monkey Patch for <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-http-fetch" id="ref-for-concept-http-fetch">HTTP fetch</a></span><a class="self-link" href="#http-fetch-monkey-patch"></a></h4>
    The following step will be added to the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-http-fetch" id="ref-for-concept-http-fetch①">HTTP fetch</a> steps, before checking the redirect status (i.e. "6. If <var>internalResponse</var>’s status is a redirect status, ..."): 
   <ol>
    <li data-md>
     <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination">destination</a> is "sharedstorageworklet":</p>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert①①">Assert</a>: <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin">origin</a> is not "<code>client</code>".</p>
      <li data-md>
       <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin①">origin</a> and <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url①">URL</a>'s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin⑥">origin</a> are not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#same-origin" id="ref-for-same-origin①">same origin</a>:</p>
       <ol>
        <li data-md>
         <p>Let <var>headers</var> be <var>internalResponse</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list">header list</a>.</p>
        <li data-md>
         <p>Let <var>allowed</var> be the result of running <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-get-structured-header" id="ref-for-concept-header-list-get-structured-header">get a structured field value</a> algorithm given `<a data-link-type="http-header" href="#http-headerdef-shared-storage-cross-origin-worklet-allowed" id="ref-for-http-headerdef-shared-storage-cross-origin-worklet-allowed②"><code>Shared-Storage-Cross-Origin-Worklet-Allowed</code></a>`, "item", and <var>headers</var> as input.</p>
        <li data-md>
         <p>If <var>allowed</var> is false, then return a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error" id="ref-for-concept-network-error">network error</a>.</p>
       </ol>
     </ol>
   </ol>
   <p class="note" role="note"><span class="marker">Note:</span> It is the responsibility of the site serving the module script to carefully consider the security implications: when the module script’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url②">URL</a>'s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin⑦">origin</a> and the worklet’s creator <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window⑧">Window</a></code> origin are not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#same-origin" id="ref-for-same-origin②">same origin</a>, by sending permissive CORS headers and the `<a data-link-type="http-header" href="#http-headerdef-shared-storage-cross-origin-worklet-allowed" id="ref-for-http-headerdef-shared-storage-cross-origin-worklet-allowed③"><code>Shared-Storage-Cross-Origin-Worklet-Allowed</code></a>` header on the module script response, the server will be granting the worklet’s creation and subsequent operations on the worklet. For example, the worklet’s creator <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window⑨">Window</a></code> could poison and use up the worklet origin’s <a data-link-type="dfn" href="#calling-site-remaining-navigation-budget" id="ref-for-calling-site-remaining-navigation-budget">remaining navigation budget</a> by calling <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl⑤">selectURL()</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-run" id="ref-for-dom-sharedstorageworklet-run③">run()</a></code>, where the worklet origin is the global scope’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-global-object-realm" id="ref-for-concept-global-object-realm③">realm</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object⑤">settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin①⓪">origin</a>.</p>
   <h4 class="heading settled" data-level="2.2.6" id="add-module-monkey-patch"><span class="secno">2.2.6. </span><span class="content">Monkey Patch for <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule⑥">addModule()</a></code></span><a class="self-link" href="#add-module-monkey-patch"></a></h4>
   <p>The <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule⑦">addModule()</a></code> method steps for <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#worklet" id="ref-for-worklet②">Worklet</a></code> will need to include the following step before the step "Let <var>promise</var> be a new promise":</p>
   <ol start="4">
    <li data-md>
     <p>If <var>this</var> is of type <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet①①">SharedStorageWorklet</a></code>:</p>
     <ol>
      <li data-md>
       <p>Let <var>addModuleAllowedResult</var> be the result of running <a data-link-type="dfn" href="#check-if-addmodule-is-allowed-and-update-state" id="ref-for-check-if-addmodule-is-allowed-and-update-state①">check if addModule is allowed and update state</a> given <var>this</var> and <var>moduleURLRecord</var>.</p>
      <li data-md>
       <p>If <var>addModuleAllowedResult</var> is "DisallowedDueToNonPreferenceError":</p>
       <ol>
        <li data-md>
         <p>Return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①⑥">a promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②②">TypeError</a></code>.</p>
       </ol>
      <li data-md>
       <p>Else if <var>addModuleAllowedResult</var> is "DisallowedDueToPreferenceError":</p>
       <ol>
        <li data-md>
         <p>If <var>this</var>’s <a data-link-type="dfn" href="#sharedstorageworklet-is-cross-origin-worklet" id="ref-for-sharedstorageworklet-is-cross-origin-worklet⑦">is cross-origin worklet</a> is false, then return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①⑦">a promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②③">TypeError</a></code>.</p>
       </ol>
      <li data-md>
       <p>Else:</p>
       <ol>
        <li data-md>
         <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert①②">Assert</a>: <var>addModuleAllowedResult</var> is "Allowed".</p>
       </ol>
     </ol>
   </ol>
   <div class="note" role="note">
     On user preferences error, <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule⑧">addModule()</a></code> will be aborted at an early stage. However, the error will only be exposed to the caller for a same-origin worklet (i.e. where the initiator document’s origin is same-origin with the module script’s origin). For a cross-origin worklet, the error will be hidden. This is to prevent a caller from knowing which origins the user has disabled shared storage for via preferences (if a per-origin preference exists for that browser vendor). 
    <p>A caller may still use timing attacks to know this information, but this is a minor security/privacy issue, as in reality very few users would set such preferences, and doing a wide search would incur a significant performance cost spinning up the worklets.</p>
    <p>This rationale also applies to the handling for user preferences error for <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl⑥">selectURL()</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-run" id="ref-for-dom-sharedstorageworklet-run④">run()</a></code>.</p>
   </div>
   <p>The penultimate step (i.e. the final indented step), currently "If <var>pendingTasks</var> is 0, then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve⑤">resolve</a> <var>promise</var>.", should be updated to:</p>
   <ol start="2">
    <li data-md>
     <p>If <var>pendingTasks</var> is 0, perform the following steps:</p>
     <ol>
      <li data-md>
       <p>If <var>workletGlobalScope</var> has an associated boolean <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-addmodule-success" id="ref-for-sharedstorageworkletglobalscope-addmodule-success">addModule success</a>, set <var>workletGlobalScope</var>’s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-addmodule-success" id="ref-for-sharedstorageworkletglobalscope-addmodule-success①">addModule success</a> to true.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve⑥">Resolve</a> <var>promise</var>.</p>
     </ol>
   </ol>
   <p><span class="todo">Add additional monkey patch pieces for out-of-process worklets.</span></p>
   <h3 class="heading settled" data-level="2.3" id="global-scope"><span class="secno">2.3. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope⑨">SharedStorageWorkletGlobalScope</a></code></span><a class="self-link" href="#global-scope"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet①②">SharedStorageWorklet</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#worklet-global-scope-type" id="ref-for-worklet-global-scope-type①">worklet global scope type</a> is <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①⓪">SharedStorageWorkletGlobalScope</a></code>.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet①③">SharedStorageWorklet</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#worklet-destination-type" id="ref-for-worklet-destination-type">worklet destination type</a> is "sharedstorageworklet".</p>
   <h4 class="heading settled" data-level="2.3.1" id="request-destination-monkey-patch"><span class="secno">2.3.1. </span><span class="content">Monkey Patch for request <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination①">destination</a></span><a class="self-link" href="#request-destination-monkey-patch"></a></h4>
   <p>The fetch request’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination②">destination</a> field should additionally include "sharedstorageworklet" as a valid value.</p>
<pre class="idl highlight def"><c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-runfunctionforsharedstorageselecturloperation"><code><c- g>RunFunctionForSharedStorageSelectURLOperation</c-></code></dfn> = <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise⑤"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>>(<a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence" id="ref-for-idl-sequence"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString①"><c- b>USVString</c-></a>> <dfn class="idl-code" data-dfn-for="RunFunctionForSharedStorageSelectURLOperation" data-dfn-type="argument" data-export id="dom-runfunctionforsharedstorageselecturloperation-urls"><code><c- g>urls</c-></code><a class="self-link" href="#dom-runfunctionforsharedstorageselecturloperation-urls"></a></dfn>, <c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any①"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="RunFunctionForSharedStorageSelectURLOperation" data-dfn-type="argument" data-export id="dom-runfunctionforsharedstorageselecturloperation-data"><code><c- g>data</c-></code><a class="self-link" href="#dom-runfunctionforsharedstorageselecturloperation-data"></a></dfn>);
</pre>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①"><c- g>Exposed</c-></a>=<c- n>SharedStorageWorklet</c->, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Global" id="ref-for-Global"><c- g>Global</c-></a>=<a data-link-type="idl-name" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet①④"><c- n>SharedStorageWorklet</c-></a>]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="sharedstorageworkletglobalscope"><code><c- g>SharedStorageWorkletGlobalScope</c-></code></dfn> : <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/worklets.html#workletglobalscope" id="ref-for-workletglobalscope"><c- n>WorkletGlobalScope</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-sharedstorageworkletglobalscope-register" id="ref-for-dom-sharedstorageworkletglobalscope-register②"><c- g>register</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString③"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorageWorkletGlobalScope/register(name, operationCtor)" data-dfn-type="argument" data-export id="dom-sharedstorageworkletglobalscope-register-name-operationctor-name"><code><c- g>name</c-></code><a class="self-link" href="#dom-sharedstorageworkletglobalscope-register-name-operationctor-name"></a></dfn>,
                     <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#Function" id="ref-for-Function"><c- n>Function</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorageWorkletGlobalScope/register(name, operationCtor)" data-dfn-type="argument" data-export id="dom-sharedstorageworkletglobalscope-register-name-operationctor-operationctor"><code><c- g>operationCtor</c-></code><a class="self-link" href="#dom-sharedstorageworkletglobalscope-register-name-operationctor-operationctor"></a></dfn>);

  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#workletsharedstorage" id="ref-for-workletsharedstorage"><c- n>WorkletSharedStorage</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="SharedStorageWorkletGlobalScope" data-dfn-type="attribute" data-export data-readonly data-type="WorkletSharedStorage" id="dom-sharedstorageworkletglobalscope-sharedstorage"><code><c- g>sharedStorage</c-></code></dfn>;
};
</pre>
   <p>Each <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①①">SharedStorageWorkletGlobalScope</a></code> has an associated <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object⑤">environment settings object</a> <dfn class="dfn-paneled" data-dfn-for="SharedStorageWorkletGlobalScope" data-dfn-type="dfn" data-noexport id="sharedstorageworkletglobalscope-outside-settings">outside settings</dfn>, which is the associated <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet①⑤">SharedStorageWorklet</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object④">relevant settings object</a>.</p>
   <p>Each <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①②">SharedStorageWorkletGlobalScope</a></code> has an associated <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean" id="ref-for-boolean">boolean</a> <dfn class="dfn-paneled" data-dfn-for="SharedStorageWorkletGlobalScope" data-dfn-type="dfn" data-noexport id="sharedstorageworkletglobalscope-addmodule-success">addModule success</dfn>, which is initialized to false.</p>
   <p>Each <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①③">SharedStorageWorkletGlobalScope</a></code> also has an associated <dfn class="dfn-paneled" data-dfn-for="SharedStorageWorkletGlobalScope" data-dfn-type="dfn" data-noexport id="sharedstorageworkletglobalscope-operation-map">operation map</dfn>, which is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map">map</a>, initially empty, of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string">strings</a> (denoting operation names) to <a data-link-type="dfn" href="https://drafts.csswg.org/css-syntax-3/#function" id="ref-for-function">functions</a>.</p>
   <p>Each <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①④">SharedStorageWorkletGlobalScope</a></code> also has an associated <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage①">WorkletSharedStorage</a></code> instance, with the <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-sharedstorage-getter" id="ref-for-sharedstorageworkletglobalscope-sharedstorage-getter">sharedStorage getter</a> algorithm as described below.</p>
   <h3 class="heading settled" data-level="2.4" id="scope-algo"><span class="secno">2.4. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①⑤">SharedStorageWorkletGlobalScope</a></code> algorithms</span><a class="self-link" href="#scope-algo"></a></h3>
   <div class="algorithm" data-algorithm="register(name, operationCtor)" data-algorithm-for="SharedStorageWorkletGlobalScope">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="SharedStorageWorkletGlobalScope" data-dfn-type="method" data-export id="dom-sharedstorageworkletglobalscope-register"><code>register(<var>name</var>, <var>operationCtor</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>If <var>name</var> is missing or empty, throw a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②④">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>operationMap</var> be this <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①⑥">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-operation-map" id="ref-for-sharedstorageworkletglobalscope-operation-map②">operation map</a>.</p>
     <li data-md>
      <p>If <var>operationMap</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists④">contains</a> an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry" id="ref-for-map-entry">entry</a> with <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-key" id="ref-for-map-key">key</a> <var>name</var>, throw a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②⑤">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>operationCtor</var> is missing, throw a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②⑥">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>operationClassInstance</var> be the result of <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#construct-a-callback-function" id="ref-for-construct-a-callback-function">constructing</a> <var>operationCtor</var>, with no arguments.</p>
     <li data-md>
      <p>Let <var>runFunction</var> be <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-get-o-p" id="ref-for-sec-get-o-p">Get</a>(<var>operationClassInstance</var>, "<code>run</code>"). Rethrow any exceptions.</p>
     <li data-md>
      <p>Let <var>runIDLFunction</var> be the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string-convert" id="ref-for-javascript-string-convert">converting</a> <var>runFunction</var> to a Web IDL <code class="idl"><a data-link-type="idl" href="#callbackdef-runfunctionforsharedstorageselecturloperation" id="ref-for-callbackdef-runfunctionforsharedstorageselecturloperation">RunFunctionForSharedStorageSelectURLOperation</a></code> instance.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set">Set</a> the value of <var>operationMap</var>[<var>name</var>] to <var>runIDLFunction</var>.</p>
    </ol>
   </div>
   <p class="issue" id="issue-ec8d9fc9"><a class="self-link" href="#issue-ec8d9fc9"></a> The "name" and "operationCtor" cannot be missing here given WebIDL. Should just check for default/empty values. <a href="https://github.com/WICG/shared-storage/issues/151">[Issue #151]</a></p>
   <div class="algorithm" data-algorithm="sharedStorage getter" data-algorithm-for="SharedStorageWorkletGlobalScope">
     The <dfn class="dfn-paneled" data-dfn-for="SharedStorageWorkletGlobalScope" data-dfn-type="dfn" data-noexport id="sharedstorageworkletglobalscope-sharedstorage-getter"><code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworkletglobalscope-sharedstorage" id="ref-for-dom-sharedstorageworkletglobalscope-sharedstorage">sharedStorage</a></code> getter</dfn> steps are: 
    <ol>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②③">this</a>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-addmodule-success" id="ref-for-sharedstorageworkletglobalscope-addmodule-success②">addModule success</a> is true, return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②④">this</a>'s <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworkletglobalscope-sharedstorage" id="ref-for-dom-sharedstorageworkletglobalscope-sharedstorage①">sharedStorage</a></code>.</p>
     <li data-md>
      <p>Otherwise, throw a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②⑦">TypeError</a></code>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="check whether addModule is finished" data-algorithm-for="SharedStorageWorkletGlobalScope">
     To <dfn class="dfn-paneled" data-dfn-for="SharedStorageWorkletGlobalScope" data-dfn-type="dfn" data-noexport id="sharedstorageworkletglobalscope-check-whether-addmodule-is-finished">check whether addModule is finished</dfn>, the step is: 
    <ol>
     <li data-md>
      <p>Return the value of <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-addmodule-success" id="ref-for-sharedstorageworkletglobalscope-addmodule-success③">addModule success</a>.</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="2.5" id="reporting"><span class="secno">2.5. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#dictdef-sharedstorageurlwithmetadata" id="ref-for-dictdef-sharedstorageurlwithmetadata②">SharedStorageUrlWithMetadata</a></code> and Reporting</span><a class="self-link" href="#reporting"></a></h3>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-sharedstorageurlwithmetadata"><code><c- g>SharedStorageUrlWithMetadata</c-></code></dfn> {
  <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString②"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="SharedStorageUrlWithMetadata" data-dfn-type="dict-member" data-export data-type="USVString " id="dom-sharedstorageurlwithmetadata-url"><code><c- g>url</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object"><c- b>object</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="SharedStorageUrlWithMetadata" data-dfn-type="dict-member" data-export data-type="object " id="dom-sharedstorageurlwithmetadata-reportingmetadata"><code><c- g>reportingMetadata</c-></code></dfn>;
};
</pre>
   <p>If a <code class="idl"><a data-link-type="idl" href="#dictdef-sharedstorageurlwithmetadata" id="ref-for-dictdef-sharedstorageurlwithmetadata③">SharedStorageUrlWithMetadata</a></code> <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-dictionary" id="ref-for-dfn-dictionary">dictionary</a> contains a non-<a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-is-empty" id="ref-for-map-is-empty②">empty</a> <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageurlwithmetadata-reportingmetadata" id="ref-for-dom-sharedstorageurlwithmetadata-reportingmetadata">reportingMetadata</a></code> <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object①">object</a></code> in the form of a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-dictionary" id="ref-for-dfn-dictionary①">dictionary</a> whose <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-getting-the-keys" id="ref-for-map-getting-the-keys">keys</a> are <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dictdef-fenceevent" id="ref-for-dictdef-fenceevent">FenceEvent</a></code>'s <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-eventtype" id="ref-for-dom-fenceevent-eventtype">eventType</a></code>s and whose <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-getting-the-values" id="ref-for-map-getting-the-values">values</a> are <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①">strings</a> that parse to valid <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url③">URLs</a>, then these <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-eventtype" id="ref-for-dom-fenceevent-eventtype①">eventType</a></code>-<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url④">URL</a> pairs will be <a data-link-type="dfn" href="#register-reporting-metadata" id="ref-for-register-reporting-metadata①">registered</a> for later access within any <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element①">fenced frame</a> that loads the <code class="idl"><a data-link-type="idl" href="#typedefdef-sharedstorageresponse" id="ref-for-typedefdef-sharedstorageresponse①">SharedStorageResponse</a></code> resulting from this <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl⑦">selectURL()</a></code> call.</p>
   <p class="issue" id="issue-3af1d5c1"><a class="self-link" href="#issue-3af1d5c1"></a> <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageurlwithmetadata-reportingmetadata" id="ref-for-dom-sharedstorageurlwithmetadata-reportingmetadata①">reportingMetadata</a></code> should be a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-dictionary" id="ref-for-dfn-dictionary②">dictionary</a>. <a href="https://github.com/WICG/shared-storage/issues/141">[Issue #141]</a></p>
   <p>Inside a <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element②">fenced frame</a> with <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-eventtype" id="ref-for-dom-fenceevent-eventtype②">eventType</a></code>-<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑤">URL</a> pairs that have been <a data-link-type="dfn" href="#register-reporting-metadata" id="ref-for-register-reporting-metadata②">registered</a> through <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl⑧">selectURL()</a></code> with <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageurlwithmetadata-reportingmetadata" id="ref-for-dom-sharedstorageurlwithmetadata-reportingmetadata②">reportingMetadata</a></code> <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object②">object</a></code>s, if <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dom-fence-reportevent" id="ref-for-dom-fence-reportevent">reportEvent()</a></code> is called on a <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dictdef-fenceevent" id="ref-for-dictdef-fenceevent①">FenceEvent</a></code> with a <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-destination" id="ref-for-dom-fenceevent-destination">destination</a></code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain">containing</a> "<code>shared-storage-select-url</code>" and that <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dictdef-fenceevent" id="ref-for-dictdef-fenceevent②">FenceEvent</a></code>'s corresponding <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-eventtype" id="ref-for-dom-fenceevent-eventtype③">eventType</a></code> is triggered, then the <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dictdef-fenceevent" id="ref-for-dictdef-fenceevent③">FenceEvent</a></code>'s <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-eventdata" id="ref-for-dom-fenceevent-eventdata">eventData</a></code> will be sent as a <a data-link-type="dfn" href="https://w3c.github.io/beacon/#beacon" id="ref-for-beacon">beacon</a> to the registered <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑥">URL</a> for that <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-eventtype" id="ref-for-dom-fenceevent-eventtype④">eventType</a></code>.</p>
   <div class="algorithm" data-algorithm="validate reporting metadata">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="validate-reporting-metadata">validate reporting metadata</dfn>, given an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object③">object</a></code> <var>reportingMetadata</var>, run the following steps: 
    <ol>
     <li data-md>
      <p>If <var>reportingMetadata</var> is not a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-dictionary" id="ref-for-dfn-dictionary③">dictionary</a>, return false.</p>
     <li data-md>
      <p>If <var>reportingMetadata</var> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-is-empty" id="ref-for-map-is-empty③">empty</a>, return true.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate" id="ref-for-map-iterate①">For each</a> <var>eventType</var> → <var>urlString</var> of <var>reportingMetadata</var>, if the result of running <a data-link-type="dfn" href="#get-the-canonical-url-string-if-valid" id="ref-for-get-the-canonical-url-string-if-valid①">get the canonical URL string if valid</a> with <var>urlString</var> is undefined, return false.</p>
     <li data-md>
      <p>Return true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="get the canonical URL string if valid">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="get-the-canonical-url-string-if-valid">get the canonical URL string if valid</dfn>, given a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string②">string</a> <var>urlString</var>, run the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>url</var> be the result of running a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser" id="ref-for-concept-url-parser">URL parser</a> on <var>urlString</var>.</p>
     <li data-md>
      <p>If <var>url</var> is not a valid <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑦">URL</a>, return undefined.</p>
     <li data-md>
      <p>Otherwise, return the result of running a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer">URL serializer</a> on <var>url</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="register reporting metadata">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="register-reporting-metadata">register reporting metadata</dfn>, given an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object④">object</a></code> <var>reportingMetadata</var> and a <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#fenced-frame-config" id="ref-for-fenced-frame-config③">fenced frame config</a> <var>fencedFrameConfigStruct</var>, run the following steps: 
    <ol>
     <li data-md>
      <p>If <var>reportingMetadata</var> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-is-empty" id="ref-for-map-is-empty④">empty</a>, return.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert①③">Assert</a>: <var>reportingMetadata</var> is a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-dictionary" id="ref-for-dfn-dictionary④">dictionary</a>.</p>
     <li data-md>
      <p>Let <var>reportingUrlMap</var> be an <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-is-empty" id="ref-for-map-is-empty⑤">empty</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map①">map</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate" id="ref-for-map-iterate②">For each</a> <var>eventType</var> → <var>urlString</var> of <var>reportingMetadata</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>url</var> be the result of running a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser" id="ref-for-concept-url-parser①">URL parser</a> on <var>urlString</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert①④">Assert</a>: <var>url</var> is a valid <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑧">URL</a>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set①">Set</a> <var>reportingUrlMap</var>[<var>eventType</var>] to <var>url</var>.</p>
      </ol>
    </ol>
    <p class="issue" id="issue-451ee8b5"><a class="self-link" href="#issue-451ee8b5"></a> Store <var>reportingUrlMap</var> inside a <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#fencedframetype-fenced-frame-reporter" id="ref-for-fencedframetype-fenced-frame-reporter">fenced frame reporter</a> class associated with <var>fencedFrameConfigStruct</var>. Both of these still need to be added to the draft <a data-link-type="biblio" href="#biblio-fenced-frame" title="Fenced Frame">[Fenced-Frame]</a>. <a href="https://github.com/WICG/shared-storage/issues/144">[Issue #144]</a></p>
   </div>
   <h3 class="heading settled" data-level="2.6" id="budgets"><span class="secno">2.6. </span><span class="content">Entropy Budgets</span><a class="self-link" href="#budgets"></a></h3>
   <p>Because <a data-link-type="dfn" href="https://en.wikipedia.org/wiki/Entropy_(information_theory)#bits-of-entropy" id="ref-for-bits-of-entropy">bits of entropy</a> can leak via <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl⑨">selectURL()</a></code>, the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent">user agent</a> will need to maintain budgets to limit these leaks.</p>
   <h4 class="heading settled" data-level="2.6.1" id="nav-budget"><span class="secno">2.6.1. </span><span class="content">Navigation Entropy Budget</span><a class="self-link" href="#nav-budget"></a></h4>
   <p>If a user <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#tracking-user-activation" id="ref-for-tracking-user-activation">activates</a> a <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element③">fenced frame</a> whose <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document">node document</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#concept-document-bc" id="ref-for-concept-document-bc">browsing context</a>'s <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#browsing-context-fenced-frame-config-instance" id="ref-for-browsing-context-fenced-frame-config-instance">fenced frame config instance</a> was generated by <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl①⓪">selectURL()</a></code> and thereby initiates a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-top" id="ref-for-nav-top②">top-level traversable</a> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigate">navigation</a>, this will reveal to the landing page that its <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑨">URL</a> was selected, which is a leak in <a data-link-type="dfn" href="https://en.wikipedia.org/wiki/Entropy_(information_theory)#entropy-bits" id="ref-for-entropy-bits">entropy bits</a> of up to logarithm base 2 of the number of input <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①⓪">URLs</a> for the call to <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl①①">selectURL()</a></code>. To mitigate this, a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent①">user agent</a> will set a per-<a data-link-type="dfn" href="#calling-site" id="ref-for-calling-site">calling site</a> <a data-link-type="dfn" href="#navigation-entropy-allowance" id="ref-for-navigation-entropy-allowance">navigation entropy allowance</a>.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="calling-site">calling site</dfn> for <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl①②">selectURL()</a></code> is a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#site" id="ref-for-site">site</a>.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="navigation-entropy-allowance">navigation entropy allowance</dfn> is a maximum allowance of <a data-link-type="dfn" href="https://en.wikipedia.org/wiki/Entropy_(information_theory)#entropy-bits" id="ref-for-entropy-bits①">entropy bits</a> that are permitted to leak via <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element④">fenced frames</a> initiating <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-top" id="ref-for-nav-top③">top-level traversable</a> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigate①">navigations</a> during a given <a data-link-type="dfn" href="#navigation-budget-epoch" id="ref-for-navigation-budget-epoch">navigation budget epoch</a> for a given calling <a data-link-type="dfn" href="#calling-site" id="ref-for-calling-site①">calling site</a>. This <a data-link-type="dfn" href="#navigation-entropy-allowance" id="ref-for-navigation-entropy-allowance①">allowance</a> is defined by the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent②">user agent</a> and is <a data-link-type="dfn" href="#calling-site" id="ref-for-calling-site②">calling site</a>-agnostic.</p>
   <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent③">user agent</a> will define a fixed predetermined <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration" id="ref-for-dfn-duration">duration</a> <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="navigation-budget-lifetime">navigation budget lifetime</dfn>.</p>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="navigation-budget-epoch">navigation budget epoch</dfn> is any interval of time whose <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration" id="ref-for-dfn-duration①">duration</a> is the <a data-link-type="dfn" href="#navigation-budget-lifetime" id="ref-for-navigation-budget-lifetime">navigation budget lifetime</a>.</p>
   <p>To keep track of how this <a data-link-type="dfn" href="#navigation-entropy-allowance" id="ref-for-navigation-entropy-allowance②">navigation entropy allowance</a> is used, the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent④">user agent</a> uses a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="shared-storage-navigation-budget-table">shared storage navigation budget table</dfn>, which is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map②">map</a> of <a data-link-type="dfn" href="#calling-site" id="ref-for-calling-site③">calling sites</a> to <a data-link-type="dfn" href="#navigation-entropy-ledger" id="ref-for-navigation-entropy-ledger">navigation entropy ledgers</a>.</p>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="navigation-entropy-ledger">navigation entropy ledger</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list④">list</a> of <a data-link-type="dfn" href="#bit-debit" id="ref-for-bit-debit">bit debits</a>.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="bit-debit">bit debit</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct">struct</a> with the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item">items</a>:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="bit debit" data-dfn-type="dfn" data-noexport id="bit-debit-bits">bits</dfn>
    <dd data-md>
     <p>a double</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="bit debit" data-dfn-type="dfn" data-noexport id="bit-debit-timestamp">timestamp</dfn>
    <dd data-md>
     <p>a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/hr-time/#dom-domhighrestimestamp" id="ref-for-dom-domhighrestimestamp">DOMHighResTimeStamp</a></code> (from the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unix-epoch" id="ref-for-dfn-unix-epoch">Unix Epoch</a>)</p>
   </dl>
   <p><a data-link-type="dfn" href="#bit-debit" id="ref-for-bit-debit①">Bit debits</a> whose <a data-link-type="dfn" href="#bit-debit-timestamp" id="ref-for-bit-debit-timestamp">timestamps</a> precede the start of the current <a data-link-type="dfn" href="#navigation-budget-epoch" id="ref-for-navigation-budget-epoch①">navigation budget epoch</a> are said to be <dfn class="dfn-paneled" data-dfn-for="bit debit" data-dfn-type="dfn" data-noexport id="bit-debit-expired">expired</dfn>.</p>
   <p>When a leak occurs, its value in <a data-link-type="dfn" href="https://en.wikipedia.org/wiki/Entropy_(information_theory)#entropy-bits" id="ref-for-entropy-bits②">entropy bits</a> is calculated and stored for that <a data-link-type="dfn" href="#calling-site" id="ref-for-calling-site④">calling site</a>, along with the current time as a <a data-link-type="dfn" href="#bit-debit-timestamp" id="ref-for-bit-debit-timestamp①">timestamp</a>, together as a <a data-link-type="dfn" href="#bit-debit" id="ref-for-bit-debit②">bit debit</a> in the <a data-link-type="dfn" href="#shared-storage-navigation-budget-table" id="ref-for-shared-storage-navigation-budget-table">shared storage navigation budget table</a>.</p>
   <p>A <a data-link-type="dfn" href="#calling-site" id="ref-for-calling-site⑤">calling site</a>'s <dfn class="dfn-paneled" data-dfn-for="calling site" data-dfn-type="dfn" data-noexport id="calling-site-remaining-navigation-budget">remaining navigation budget</dfn> is the <a data-link-type="dfn" href="#navigation-entropy-allowance" id="ref-for-navigation-entropy-allowance③">navigation entropy allowance</a> minus any <a data-link-type="dfn" href="#bit-debit" id="ref-for-bit-debit③">bit debits</a> whose <a data-link-type="dfn" href="#bit-debit-timestamp" id="ref-for-bit-debit-timestamp②">timestamps</a> are within the current <a data-link-type="dfn" href="#navigation-budget-epoch" id="ref-for-navigation-budget-epoch②">navigation budget epoch</a>.</p>
   <p><code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl①③">selectURL()</a></code>'s argument "<code>urls</code>" is its <dfn class="dfn-paneled" data-dfn-for="selectURL" data-dfn-type="dfn" data-noexport id="selecturl-input-url-list">input URL list</dfn>.</p>
   <p>When a <a data-link-type="dfn" href="#calling-site" id="ref-for-calling-site⑥">calling site</a> has insufficient <a data-link-type="dfn" href="#calling-site-remaining-navigation-budget" id="ref-for-calling-site-remaining-navigation-budget①">remaining navigation budget</a>, <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl①④">selectURL()</a></code> will return a <code class="idl"><a data-link-type="idl" href="#typedefdef-sharedstorageresponse" id="ref-for-typedefdef-sharedstorageresponse②">SharedStorageResponse</a></code> (i.e. either a <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#fencedframeconfig" id="ref-for-fencedframeconfig①">FencedFrameConfig</a></code> or a <a data-link-type="dfn" href="https://www.ietf.org/rfc/rfc4122.txt#urn-uuid" id="ref-for-urn-uuid">urn uuid</a>) for the <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageurlwithmetadata-url" id="ref-for-dom-sharedstorageurlwithmetadata-url">url</a></code> in the <code class="idl"><a data-link-type="idl" href="#dictdef-sharedstorageurlwithmetadata" id="ref-for-dictdef-sharedstorageurlwithmetadata④">SharedStorageUrlWithMetadata</a></code> at the <a data-link-type="dfn" href="#default-index" id="ref-for-default-index②">default index</a> in its <a data-link-type="dfn" href="#selecturl-input-url-list" id="ref-for-selecturl-input-url-list">input URL list</a>.</p>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="default-index">default index</dfn> for a call to <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl①⑤">selectURL()</a></code> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined①">implementation-defined</a> in such a way that it is independent from the result of the registered operation class’s "<code>run</code>" method.</p>
   <p class="issue" id="issue-eaab2bb9"><a class="self-link" href="#issue-eaab2bb9"></a> Methods can’t have state attached to them. Many definitions in this section needs improving. <a href="https://github.com/WICG/shared-storage/issues/147">[Issue #147]</a></p>
   <div class="example" id="example-8fff774a">
    <a class="self-link" href="#example-8fff774a"></a> The <a data-link-type="dfn" href="#default-index" id="ref-for-default-index③">default index</a> could be defined to be 0. 
    <p>In this case, whenever the registered operation class’s "<code>run</code>" method encounters an error, or whenever there is insufficient <a data-link-type="dfn" href="#calling-site-remaining-navigation-budget" id="ref-for-calling-site-remaining-navigation-budget②">remaining navigation budget</a>, the "<code>run</code>" method would return 0, and hence <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl①⑥">selectURL()</a></code> would return a <code class="idl"><a data-link-type="idl" href="#typedefdef-sharedstorageresponse" id="ref-for-typedefdef-sharedstorageresponse③">SharedStorageResponse</a></code> for the first <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageurlwithmetadata-url" id="ref-for-dom-sharedstorageurlwithmetadata-url①">url</a></code> in its <a data-link-type="dfn" href="#selecturl-input-url-list" id="ref-for-selecturl-input-url-list①">input URL list</a>.</p>
   </div>
   <div class="example" id="example-10ddf013">
    <a class="self-link" href="#example-10ddf013"></a> The <a data-link-type="dfn" href="#default-index" id="ref-for-default-index④">default index</a> could be defined to be <a data-link-type="dfn" href="#selecturl-input-url-list" id="ref-for-selecturl-input-url-list②">input URL list</a>'s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size⑦">size</a> − 1. 
    <p>In this case, whenever the registered operation class’s "<code>run</code>" method encounters an error, or whenever there is insufficient <a data-link-type="dfn" href="#calling-site-remaining-navigation-budget" id="ref-for-calling-site-remaining-navigation-budget③">remaining navigation budget</a>, <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl①⑦">selectURL()</a></code> would return a <code class="idl"><a data-link-type="idl" href="#typedefdef-sharedstorageresponse" id="ref-for-typedefdef-sharedstorageresponse④">SharedStorageResponse</a></code> for the last <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageurlwithmetadata-url" id="ref-for-dom-sharedstorageurlwithmetadata-url②">url</a></code> in its <a data-link-type="dfn" href="#selecturl-input-url-list" id="ref-for-selecturl-input-url-list③">input URL list</a>.</p>
   </div>
   <div class="algorithm" data-algorithm="determine remaining navigation budget">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="determine-remaining-navigation-budget">determine remaining navigation budget</dfn>, given an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object⑥">environment settings object</a> <var>environment</var> and a <a data-link-type="dfn" href="#calling-site" id="ref-for-calling-site⑦">calling site</a> <var>site</var>, run the following steps: 
    <ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert①⑤">Assert</a>: <var>site</var> is not an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque" id="ref-for-concept-origin-opaque②">opaque origin</a>.</p>
     <li data-md>
      <p>Let <var>maxBits</var> be the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent⑤">user agent</a>'s <a data-link-type="dfn" href="#navigation-entropy-allowance" id="ref-for-navigation-entropy-allowance④">navigation entropy allowance</a>.</p>
     <li data-md>
      <p>If the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent⑥">user agent</a>'s <a data-link-type="dfn" href="#shared-storage-navigation-budget-table" id="ref-for-shared-storage-navigation-budget-table①">shared storage navigation budget table</a> does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists⑤">contain</a> <var>site</var>, then return <var>maxBits</var>.</p>
     <li data-md>
      <p>Otherwise, let <var>ledger</var> be <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent⑦">user agent</a>'s <a data-link-type="dfn" href="#shared-storage-navigation-budget-table" id="ref-for-shared-storage-navigation-budget-table②">shared storage navigation budget table</a>[<var>site</var>].</p>
     <li data-md>
      <p>Let <var>debitSum</var> be 0.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate" id="ref-for-map-iterate③">For each</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-item" id="ref-for-list-item">item</a> <var>bitDebit</var> in <var>ledger</var>, do the following steps:</p>
      <ol>
       <li data-md>
        <p>Let <var>debit</var> be <var>bitDebit</var>’s <a data-link-type="dfn" href="#bit-debit-bits" id="ref-for-bit-debit-bits">bits</a>.</p>
       <li data-md>
        <p>If the result of running <a data-link-type="dfn" href="#check-whether-a-bit-debit-is-expired" id="ref-for-check-whether-a-bit-debit-is-expired">check whether a bit debit is expired</a> with <var>environment</var> and <var>bitDebit</var> is false, then increment <var>debitSum</var> by <var>debit</var>.</p>
      </ol>
     <li data-md>
      <p>Return <var>maxBits</var> − <var>debitSum</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="check whether a bit debit is expired">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="check-whether-a-bit-debit-is-expired">check whether a bit debit is expired</dfn>, given an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object⑦">environment settings object</a> <var>environment</var> and a <a data-link-type="dfn" href="#bit-debit" id="ref-for-bit-debit④">bit debit</a> <var>bitDebit</var>, run the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>epochLength</var> be the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent⑧">user agent</a>'s <a data-link-type="dfn" href="#navigation-budget-lifetime" id="ref-for-navigation-budget-lifetime①">navigation budget lifetime</a>.</p>
     <li data-md>
      <p>Let <var>currentTime</var> be <var>environment</var>’s <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-eso-current-wall-time" id="ref-for-dfn-eso-current-wall-time">current wall time</a>.</p>
     <li data-md>
      <p>Let <var>threshold</var> be <var>currentTime</var> − <var>epochLength</var>.</p>
     <li data-md>
      <p>If <var>bitDebit</var>’s <a data-link-type="dfn" href="#bit-debit-timestamp" id="ref-for-bit-debit-timestamp③">timestamp</a> is less than <var>threshold</var>, return true.</p>
     <li data-md>
      <p>Otherwise, return false.</p>
    </ol>
   </div>
   <p>A <a data-link-type="dfn" href="#bit-debit" id="ref-for-bit-debit⑤">bit debit</a> will need to be <a data-link-type="dfn" href="#charge-shared-storage-navigation-budget" id="ref-for-charge-shared-storage-navigation-budget">charged</a> to the <a data-link-type="dfn" href="#shared-storage-navigation-budget-table" id="ref-for-shared-storage-navigation-budget-table③">shared storage navigation budget table</a> for each <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-top" id="ref-for-nav-top④">top-level traversable</a> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigate②">navigation</a> initiated by a <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element⑤">fenced frame</a> whose <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document①">node document</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#concept-document-bc" id="ref-for-concept-document-bc①">browsing context</a>'s <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#browsing-context-fenced-frame-config-instance" id="ref-for-browsing-context-fenced-frame-config-instance①">fenced frame config instance</a> was generated via <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl①⑧">selectURL()</a></code>, as this can leak cross-site data. Since the <a data-link-type="dfn" href="#bit-debit-bits" id="ref-for-bit-debit-bits①">bits</a> to charge is calculated during the call to <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl①⑨">selectURL()</a></code> but only actually recorded in the <a data-link-type="dfn" href="#shared-storage-navigation-budget-table" id="ref-for-shared-storage-navigation-budget-table④">shared storage navigation budget table</a> if and when the resulting fenced frame initiates a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-top" id="ref-for-nav-top⑤">top-level traversable</a> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#beginning-navigation" id="ref-for-beginning-navigation">navigation</a>, the <a data-link-type="dfn" href="#bit-debit-bits" id="ref-for-bit-debit-bits②">bits</a> must be stored as a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="pending-shared-storage-budget-debit">pending shared storage budget debit</dfn> in the corresponding fenced frame’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document②">node document</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#concept-document-bc" id="ref-for-concept-document-bc②">browsing context</a>'s <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#browsing-context-fenced-frame-config-instance" id="ref-for-browsing-context-fenced-frame-config-instance②">fenced frame config instance</a> until this time.</p>
   <p class="issue" id="issue-e3244203"><a class="self-link" href="#issue-e3244203"></a> Move the definition of <a data-link-type="dfn" href="#pending-shared-storage-budget-debit" id="ref-for-pending-shared-storage-budget-debit">pending shared storage budget debit</a> to <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#browsing-context-fenced-frame-config-instance" id="ref-for-browsing-context-fenced-frame-config-instance③">fenced frame config instance</a> in the draft <a data-link-type="biblio" href="#biblio-fenced-frame" title="Fenced Frame">[Fenced-Frame]</a> specification. <a href="https://github.com/WICG/shared-storage/issues/148">[Issue #148]</a></p>
   <p>Between <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#beginning-navigation" id="ref-for-beginning-navigation①">beginning navigation</a> and <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#ending-navigation" id="ref-for-ending-navigation">ending navigation</a>, a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent⑨">user agent</a> will perform the <a data-link-type="dfn" href="#charge-shared-storage-navigation-budget" id="ref-for-charge-shared-storage-navigation-budget①">charge shared storage navigation budget</a> algorithm.</p>
   <p class="issue" id="issue-2c9003c1"><a class="self-link" href="#issue-2c9003c1"></a> Need to find a better way to specify timing of the navigation budget charging. <a href="https://github.com/WICG/shared-storage/issues/138">[Issue #138]</a></p>
   <p class="issue" id="issue-3534ecb9"><a class="self-link" href="#issue-3534ecb9"></a> The boolean <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="shared-storage-navigation-budget-charged">shared storage navigation budget charged</dfn> have not yet been added to <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#browsing-context-fenced-frame-config-instance" id="ref-for-browsing-context-fenced-frame-config-instance④">fenced frame config instance</a> in the draft <a data-link-type="biblio" href="#biblio-fenced-frame" title="Fenced Frame">[Fenced-Frame]</a> specification. Some form of them will be added, although their names are subject to bikeshedding. Fix the names when they are added. <a href="https://github.com/WICG/shared-storage/issues/149">[Issue #149]</a></p>
   <div class="algorithm" data-algorithm="charge shared storage navigation budget">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="charge-shared-storage-navigation-budget">charge shared storage navigation budget</dfn> during a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#beginning-navigation" id="ref-for-beginning-navigation②">navigation</a> with <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#navigable" id="ref-for-navigable">navigable</a> <var>navigable</var> and <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document">Document</a></code> <var>sourceDocument</var>, run the following steps: 
    <ol>
     <li data-md>
      <p>If <var>navigable</var> is not a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-top" id="ref-for-nav-top⑥">top-level traversable</a>, return.</p>
     <li data-md>
      <p>Let <var>currentNavigable</var> be <var>sourceDocument</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#node-navigable" id="ref-for-node-navigable①">node navigable</a>.</p>
     <li data-md>
      <p>While <var>currentNavigable</var> is not null:</p>
      <ol>
       <li data-md>
        <p>Let <var>site</var> be the result of running <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#obtain-a-site" id="ref-for-obtain-a-site②">obtain a site</a> with <var>currentNavigable</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-document" id="ref-for-nav-document①">active document</a>'s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document-origin" id="ref-for-concept-document-origin①">origin</a>.</p>
       <li data-md>
        <p>Let <var>instance</var> be <var>currentNavigable</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document③">node document</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#concept-document-bc" id="ref-for-concept-document-bc③">browsing context</a>'s <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#browsing-context-fenced-frame-config-instance" id="ref-for-browsing-context-fenced-frame-config-instance⑤">fenced frame config instance</a>.</p>
       <li data-md>
        <p>Set <var>currentNavigable</var> to <var>currentNavigable</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-parent" id="ref-for-nav-parent">parent</a>.</p>
       <li data-md>
        <p>If <var>instance</var> is null or <var>site</var> is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque" id="ref-for-concept-origin-opaque③">opaque origin</a>, then <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue">continue</a>.</p>
       <li data-md>
        <p>Let <var>pendingBits</var> be <var>instance</var>’s <a data-link-type="dfn" href="#pending-shared-storage-budget-debit" id="ref-for-pending-shared-storage-budget-debit①">pending shared storage budget debit</a>.</p>
       <li data-md>
        <p>If <var>pendingBits</var> is not greater than 0, or if <var>instance</var>’s <a data-link-type="dfn" href="#shared-storage-navigation-budget-charged" id="ref-for-shared-storage-navigation-budget-charged">shared storage navigation budget charged</a> is true, then <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue①">continue</a>.</p>
       <li data-md>
        <p>Let <var>ledger</var> be <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent①⓪">user agent</a>'s <a data-link-type="dfn" href="#shared-storage-navigation-budget-table" id="ref-for-shared-storage-navigation-budget-table⑤">shared storage navigation budget table</a>[<var>site</var>].</p>
       <li data-md>
        <p>Let <var>bitDebit</var> be a new <a data-link-type="dfn" href="#bit-debit" id="ref-for-bit-debit⑥">bit debit</a>.</p>
       <li data-md>
        <p>Set <var>bitDebit</var>’s <a data-link-type="dfn" href="#bit-debit-bits" id="ref-for-bit-debit-bits③">bits</a> to <var>pendingBits</var>.</p>
       <li data-md>
        <p>Let <var>currentTime</var> be the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-current-wall-time" id="ref-for-dfn-current-wall-time">current wall time</a>.</p>
       <li data-md>
        <p>Set <var>bitDebit</var>’s <a data-link-type="dfn" href="#bit-debit-timestamp" id="ref-for-bit-debit-timestamp④">timestamp</a> to <var>currentTime</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append③">Append</a> <var>bitDebit</var> to <var>ledger</var>.</p>
       <li data-md>
        <p>Set <var>instance</var>’s <a data-link-type="dfn" href="#shared-storage-navigation-budget-charged" id="ref-for-shared-storage-navigation-budget-charged①">shared storage navigation budget charged</a> to true.</p>
      </ol>
    </ol>
   </div>
   <h4 class="heading settled" data-level="2.6.2" id="report-budget"><span class="secno">2.6.2. </span><span class="content">Reporting Entropy Budget</span><a class="self-link" href="#report-budget"></a></h4>
   <p>Likewise, each time a call to <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dom-fence-reportevent" id="ref-for-dom-fence-reportevent①">reportEvent()</a></code> from a <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element⑥">fenced frame</a> originating via <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl②⓪">selectURL()</a></code> whose <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-destination" id="ref-for-dom-fenceevent-destination①">destination</a></code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain①">contains</a> "<code>shared-storage-select-url</code>" and whose <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-eventtype" id="ref-for-dom-fenceevent-eventtype⑤">eventType</a></code> is triggered, there is a leak of up to logarithm base 2 of the number of main input <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①①">URLs</a> <a data-link-type="dfn" href="https://en.wikipedia.org/wiki/Entropy_(information_theory)#entropy-bits" id="ref-for-entropy-bits③">entropy bits</a>. The <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent①①">user agent</a> will need to set a per-<a data-link-type="dfn" href="#page-load" id="ref-for-page-load">page load</a> <a data-link-type="dfn" href="#reporting-entropy-allowance" id="ref-for-reporting-entropy-allowance">reporting entropy allowance</a> to restrict the information leaked, with <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="page-load">page load</dfn> referring to a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-top" id="ref-for-nav-top⑦">top-level traversable</a>'s (i.e. primary main frame’s) lifecycle.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="reporting-entropy-allowance">reporting entropy allowance</dfn> is a maximum allowance of <a data-link-type="dfn" href="https://en.wikipedia.org/wiki/Entropy_(information_theory)#entropy-bits" id="ref-for-entropy-bits④">entropy bits</a> that are permitted to leak via <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dom-fence-reportevent" id="ref-for-dom-fence-reportevent②">reportEvent()</a></code> during a given page load. This <a data-link-type="dfn" href="#reporting-entropy-allowance" id="ref-for-reporting-entropy-allowance①">allowance</a> is defined by the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent①②">user agent</a>.</p>
   <p>Each <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-top" id="ref-for-nav-top⑧">top-level traversable</a> will have a new <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-double" id="ref-for-idl-double">double</a></code> <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="shared-storage-reporting-budget">shared storage reporting budget</dfn> associated to it which will be initialized with the value of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent①③">user agent</a>'s <a data-link-type="dfn" href="#reporting-entropy-allowance" id="ref-for-reporting-entropy-allowance②">reporting entropy allowance</a> upon <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-top" id="ref-for-nav-top⑨">top-level traversable</a>'s creation.</p>
   <p>When <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dom-fence-reportevent" id="ref-for-dom-fence-reportevent③">reportEvent()</a></code> is called with a <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-destination" id="ref-for-dom-fenceevent-destination②">destination</a></code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain②">containing</a> "<code>shared-storage-select-url</code>", it will be necessary to <a data-link-type="dfn" href="#charge-shared-storage-reporting-budget" id="ref-for-charge-shared-storage-reporting-budget">charge shared storage reporting budget</a> as below.</p>
   <p class="issue" id="issue-82e0fec0"><a class="self-link" href="#issue-82e0fec0"></a> Move this to <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dom-fence-reportevent" id="ref-for-dom-fence-reportevent④">reportEvent()</a></code> in <a data-link-type="biblio" href="#biblio-fenced-frame" title="Fenced Frame">[Fenced-Frame]</a>. <a href="https://github.com/WICG/shared-storage/issues/150">[Issue #150]</a></p>
   <div class="algorithm" data-algorithm="determine reporting budget to charge">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="determine-reporting-budget-to-charge">determine reporting budget to charge</dfn>, given a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①">Document</a></code> <var>sourceDocument</var>, run the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>debitSum</var> be 0.</p>
     <li data-md>
      <p>Let <var>currentNavigable</var> be <var>sourceDocument</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#node-navigable" id="ref-for-node-navigable②">node navigable</a>.</p>
     <li data-md>
      <p>While <var>currentNavigable</var> is not null:</p>
      <ol>
       <li data-md>
        <p>Let <var>instance</var> be <var>currentNavigable</var>’s <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#source-snapshot-params-initiator-fenced-frame-config-instance" id="ref-for-source-snapshot-params-initiator-fenced-frame-config-instance">initiator fenced frame config instance</a>.</p>
       <li data-md>
        <p>Set <var>currentNavigable</var> to <var>currentNavigable</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-parent" id="ref-for-nav-parent①">parent</a>.</p>
       <li data-md>
        <p>If <var>instance</var> is null, then <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue②">continue</a>.</p>
       <li data-md>
        <p>Let <var>pendingBits</var> be <var>instance</var>’s <a data-link-type="dfn" href="#pending-shared-storage-budget-debit" id="ref-for-pending-shared-storage-budget-debit②">pending shared storage budget debit</a>.</p>
       <li data-md>
        <p>If <var>pendingBits</var> is greater than 0 and if <var>instance</var>’s <a data-link-type="dfn" href="#shared-storage-reporting-budget-charged" id="ref-for-shared-storage-reporting-budget-charged">shared storage reporting budget charged</a> is false, increment <var>debitSum</var> by <var>pendingBits</var>.</p>
      </ol>
     <li data-md>
      <p>Return <var>debitSum</var>.</p>
    </ol>
   </div>
   <p class="issue" id="issue-2c90d642"><a class="self-link" href="#issue-2c90d642"></a> The boolean <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="shared-storage-reporting-budget-charged">shared storage reporting budget charged</dfn> have not yet been added to <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#browsing-context-fenced-frame-config-instance" id="ref-for-browsing-context-fenced-frame-config-instance⑥">fenced frame config instance</a> in the draft <a data-link-type="biblio" href="#biblio-fenced-frame" title="Fenced Frame">[Fenced-Frame]</a> specification. Some form of them will be added, although their names are subject to bikeshedding. Fix the names when they are added. <a href="https://github.com/WICG/shared-storage/issues/149">[Issue #149]</a></p>
   <div class="algorithm" data-algorithm="charge shared storage reporting budget">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="charge-shared-storage-reporting-budget">charge shared storage reporting budget</dfn> given a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②">Document</a></code> <var>sourceDocument</var>, run the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>toCharge</var> be the result of running <a data-link-type="dfn" href="#determine-reporting-budget-to-charge" id="ref-for-determine-reporting-budget-to-charge">determine reporting budget to charge</a> with <var>sourceDocument</var>.</p>
     <li data-md>
      <p>Let <var>currentNavigable</var> be <var>sourceDocument</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#node-navigable" id="ref-for-node-navigable③">node navigable</a>.</p>
     <li data-md>
      <p>Let <var>topNode</var> be the result of running <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#nav-top" id="ref-for-nav-top①⓪">get the top-level traversable</a> for <var>currentNavigable</var>.</p>
     <li data-md>
      <p>If <var>topNode</var>’s <a data-link-type="dfn" href="#shared-storage-reporting-budget" id="ref-for-shared-storage-reporting-budget">shared storage reporting budget</a> is less than <var>toCharge</var>, return false.</p>
     <li data-md>
      <p>While <var>currentNavigable</var> is not null:</p>
      <ol>
       <li data-md>
        <p>Let <var>instance</var> be <var>currentNavigable</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document④">node document</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#concept-document-bc" id="ref-for-concept-document-bc④">browsing context</a>'s <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#browsing-context-fenced-frame-config-instance" id="ref-for-browsing-context-fenced-frame-config-instance⑦">fenced frame config instance</a>.</p>
       <li data-md>
        <p>If <var>instance</var> is not null and if <var>instance</var>’s <a data-link-type="dfn" href="#pending-shared-storage-budget-debit" id="ref-for-pending-shared-storage-budget-debit③">pending shared storage budget debit</a> is greater than 0, set <var>instance</var>’s <a data-link-type="dfn" href="#shared-storage-reporting-budget-charged" id="ref-for-shared-storage-reporting-budget-charged①">shared storage reporting budget charged</a> to true.</p>
       <li data-md>
        <p>Set <var>currentNavigable</var> to <var>currentNavigable</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-parent" id="ref-for-nav-parent②">parent</a>.</p>
      </ol>
     <li data-md>
      <p>Decrement <var>topNode</var>’s <a data-link-type="dfn" href="#shared-storage-reporting-budget" id="ref-for-shared-storage-reporting-budget①">shared storage reporting budget</a> by <var>toCharge</var>.</p>
     <li data-md>
      <p>Return true.</p>
    </ol>
   </div>
   <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent①④">user agent</a> may wish to set a timer to periodically <a data-link-type="dfn" href="#purge-expired-bit-debits-from-all-navigation-entropy-ledgers" id="ref-for-purge-expired-bit-debits-from-all-navigation-entropy-ledgers">purge expired bit debits from all navigation entropy ledgers</a>, as the <a data-link-type="dfn" href="#bit-debit-expired" id="ref-for-bit-debit-expired">expired</a> <a data-link-type="dfn" href="#bit-debit" id="ref-for-bit-debit⑦">bit debits</a> will no longer be needed.</p>
   <div class="algorithm" data-algorithm="purge expired bit debits from all navigation entropy ledgers">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="purge-expired-bit-debits-from-all-navigation-entropy-ledgers">purge expired bit debits from all navigation entropy ledgers</dfn>, run the following steps: 
    <ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate" id="ref-for-map-iterate④">For each</a> <var>origin</var> → <var>ledger</var> of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent①⑤">user agent</a>'s <a data-link-type="dfn" href="#shared-storage-navigation-budget-table" id="ref-for-shared-storage-navigation-budget-table⑥">shared storage navigation budget table</a>:</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate" id="ref-for-map-iterate⑤">For each</a> <var>bitDebit</var> in <var>ledger</var>, if the result of running <a data-link-type="dfn" href="#check-whether-a-bit-debit-is-expired" id="ref-for-check-whether-a-bit-debit-is-expired①">check whether a bit debit is expired</a> with <var>bitDebit</var> is true, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove">remove</a> <var>bitDebit</var> from <var>ledger</var>.</p>
      </ol>
    </ol>
   </div>
   <h2 class="heading settled" data-level="3" id="backend"><span class="secno">3. </span><span class="content">Shared Storage’s Backend</span><a class="self-link" href="#backend"></a></h2>
    The Shared Storage API will integrate into the <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#model" id="ref-for-model">Storage API</a> as below, via <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#registered-storage-endpoints" id="ref-for-registered-storage-endpoints">registering</a> a new <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-endpoint" id="ref-for-storage-endpoint">storage endpoint</a>. 
   <h3 class="heading settled" data-level="3.1" id="storage-monkey-patch"><span class="secno">3.1. </span><span class="content">Monkey Patch for the <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#model" id="ref-for-model①">Storage Model</a></span><a class="self-link" href="#storage-monkey-patch"></a></h3>
   <p>This standard will add a new <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-type" id="ref-for-storage-type">storage type</a> "<code>shared</code>" to the <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#model" id="ref-for-model②">Storage Model</a>.</p>
   <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent①⑥">user agent</a> holds a <a data-link-type="dfn" href="#shared-storage-shed" id="ref-for-shared-storage-shed">shared storage shed</a> for <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-endpoint" id="ref-for-storage-endpoint①">storage endpoints</a> of <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-type" id="ref-for-storage-type①">type</a> "<code>shared</code>".</p>
   <p>This standard will also <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#registered-storage-endpoints" id="ref-for-registered-storage-endpoints①">register</a> a <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-endpoint" id="ref-for-storage-endpoint②">storage endpoint</a> of <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-type" id="ref-for-storage-type②">type</a> "<code>shared</code>" with <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-identifier" id="ref-for-storage-identifier">storage identifier</a> "<code>sharedStorage</code>" and <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-endpoint-quota" id="ref-for-storage-endpoint-quota">quota</a> <code>5</code><sup><code>4</code></sup> <code>*</code> <code>2</code><sup><code>16</code></sup> bytes (i.e. 39.0625 mebibytes).</p>
   <p><span class="todo">This <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-endpoint-quota" id="ref-for-storage-endpoint-quota①">quota</a> is calculated from the current implementation. Consider bringing the current implementation in line with the spec for <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-endpoint" id="ref-for-storage-endpoint③">storage endpoints</a> "<code>localStorage</code>" and "<code>sessionStorage</code>", i.e. <code>5 * 2</code><sup><code>20</code></sup> bytes. For example, decreasing the per-origin entry limit from 10,000 to 1,280 would achieve this.</span></p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="shared-storage-shed">shared storage shed</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map③">map</a> of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin②">origins</a> to <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-shelf" id="ref-for-storage-shelf">storage shelves</a>. It is initially empty.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Unlike <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-shed" id="ref-for-storage-shed">storage sheds</a>, whose keys are <a data-link-type="dfn" href="https://w3c.github.io/ServiceWorker/#service-worker-registration-storage-key" id="ref-for-service-worker-registration-storage-key">storage keys</a>, <a data-link-type="dfn" href="#shared-storage-shed" id="ref-for-shared-storage-shed①">shared storage sheds</a> use <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin③">origins</a> as keys directly. <a data-link-type="dfn" href="#shared-storage" id="ref-for-shared-storage②">Shared storage</a> will be intentionally excluded from <a data-link-type="dfn" href="https://privacycg.github.io/storage-partitioning/#client-side-storage-partitioning" id="ref-for-client-side-storage-partitioning①">client-side storage partitioning</a>.</p>
   <p>For each <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-shelf" id="ref-for-storage-shelf①">storage shelf</a> in a <a data-link-type="dfn" href="#shared-storage-shed" id="ref-for-shared-storage-shed②">shared storage shed</a>, the <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-shelf" id="ref-for-storage-shelf②">storage shelf</a>'s <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#bucket-map" id="ref-for-bucket-map">bucket map</a> currently has only a single key of "<code>default</code>".</p>
   <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent①⑦">user agent</a>'s <a data-link-type="dfn" href="#shared-storage-shed" id="ref-for-shared-storage-shed③">shared storage shed</a> holds all <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="shared-storage">shared storage</dfn> data.</p>
   <div class="algorithm" data-algorithm="obtain a shared storage shelf">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-a-shared-storage-shelf">obtain a shared storage shelf</dfn>, given a <a data-link-type="dfn" href="#shared-storage-shed" id="ref-for-shared-storage-shed④">shared storage shed</a> <var>shed</var>, an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object⑧">environment settings object</a> <var>environment</var>, and an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin④">origin</a> <var>origin</var>, run these steps: 
    <ol>
     <li data-md>
      <p>Let <var>allowedInOpaqueOriginContext</var> be false.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#determine-whether-shared-storage-is-allowed-by-context" id="ref-for-determine-whether-shared-storage-is-allowed-by-context④">determine whether shared storage is allowed by context</a> given <var>environment</var>, <var>origin</var>, and <var>allowedInOpaqueOriginContext</var> is false, then return failure.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#check-if-user-preference-setting-allows-access-to-shared-storage" id="ref-for-check-if-user-preference-setting-allows-access-to-shared-storage④">check if user preference setting allows access to shared storage</a> given <var>environment</var> and <var>origin</var> is false, then return failure.</p>
     <li data-md>
      <p>If <var>shed</var>[origin] does not exist, then set <var>shed</var>[origin] to the result of running <a data-link-type="dfn" href="#create-a-shared-storage-shelf" id="ref-for-create-a-shared-storage-shelf">create a shared storage shelf</a> with <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-type" id="ref-for-storage-type③">type</a> "<code>shared</code>".</p>
     <li data-md>
      <p>Return <var>shed</var>[<var>origin</var>].</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="create a shared storage shelf">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="create-a-shared-storage-shelf">create a shared storage shelf</dfn>, run these steps: 
    <ol>
     <li data-md>
      <p>Let <var>shelf</var> be a new <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-shelf" id="ref-for-storage-shelf③">storage shelf</a>.</p>
     <li data-md>
      <p>Set <var>shelf</var>’s <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#bucket-map" id="ref-for-bucket-map①">bucket map</a>["<code>default</code>"] to the result of running <a data-link-type="dfn" href="#create-a-shared-storage-bucket" id="ref-for-create-a-shared-storage-bucket">create a shared storage bucket</a>.</p>
     <li data-md>
      <p>Return <var>shelf</var>.</p>
    </ol>
   </div>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="shared-storage-bucket">shared storage bucket</dfn> is a <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-bucket" id="ref-for-storage-bucket">storage bucket</a> in one of a <a data-link-type="dfn" href="#shared-storage-shed" id="ref-for-shared-storage-shed⑤">shared storage shed</a>'s <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-shelf" id="ref-for-storage-shelf④">shelves</a>.</p>
   <div class="algorithm" data-algorithm="create a shared storage bucket">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="create-a-shared-storage-bucket">create a shared storage bucket</dfn>, run these steps: 
    <ol>
     <li data-md>
      <p>Let <var>endpoint</var> be the <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-endpoint" id="ref-for-storage-endpoint④">storage endpoint</a> with <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-identifier" id="ref-for-storage-identifier①">storage identifier</a> "<code>sharedStorage</code>".</p>
     <li data-md>
      <p>Let <var>bucket</var> be a new <a data-link-type="dfn" href="#shared-storage-bucket" id="ref-for-shared-storage-bucket">shared storage bucket</a>.</p>
     <li data-md>
      <p>Set <var>bucket</var>’s <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#bottle-map" id="ref-for-bottle-map">bottle map</a>["<code>sharedStorage</code>"] to a new <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-bottle" id="ref-for-storage-bottle">storage bottle</a> whose <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-bottle-quota" id="ref-for-storage-bottle-quota">quota</a> is <var>endpoint</var>’s <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-endpoint-quota" id="ref-for-storage-endpoint-quota②">quota</a>.</p>
     <li data-md>
      <p>Return <var>bucket</var>.</p>
    </ol>
   </div>
   <p class="note" role="note"><span class="marker">Note:</span> Currently, a <a data-link-type="dfn" href="#shared-storage-bucket" id="ref-for-shared-storage-bucket①">shared storage bucket</a>'s <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#bottle-map" id="ref-for-bottle-map①">bottle map</a> has <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-size" id="ref-for-map-size">size</a> <code>1</code>, since there is only one <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-endpoint" id="ref-for-storage-endpoint⑤">storage endpoint</a> <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#registered-storage-endpoints" id="ref-for-registered-storage-endpoints②">registered</a> with <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-type" id="ref-for-storage-type④">type</a> "<code>shared</code>".</p>
   <div class="algorithm" data-algorithm="obtain a shared storage bottle map">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-a-shared-storage-bottle-map">obtain a shared storage bottle map</dfn>, given an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object⑨">environment settings object</a> <var>environment</var> and an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin⑤">origin</a> <var>origin</var>, run these steps: 
    <ol>
     <li data-md>
      <p>Let <var>shed</var> be the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent①⑧">user agent</a>'s <a data-link-type="dfn" href="#shared-storage-shed" id="ref-for-shared-storage-shed⑥">shared storage shed</a>.</p>
     <li data-md>
      <p>Let <var>shelf</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-shelf" id="ref-for-obtain-a-shared-storage-shelf">obtain a shared storage shelf</a> with <var>shed</var>, <var>environment</var>, and <var>origin</var>.</p>
     <li data-md>
      <p>If <var>shelf</var> is failure, then return failure.</p>
     <li data-md>
      <p>Let <var>bucket</var> be <var>shelf</var>’s <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#bucket-map" id="ref-for-bucket-map②">bucket map</a>["<code>default</code>"].</p>
     <li data-md>
      <p>Let <var>bottle</var> be <var>bucket</var>’s <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#bottle-map" id="ref-for-bottle-map②">bottle map</a>["<code>sharedStorage</code>"].</p>
     <li data-md>
      <p>Let <var>proxyMap</var> be a new <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-proxy-map" id="ref-for-storage-proxy-map">storage proxy map</a> whose <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-proxy-map-backing-map" id="ref-for-storage-proxy-map-backing-map">backing map</a> is <var>bottle</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map④">map</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append">Append</a> <var>proxyMap</var> to <var>bottle</var>’s <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-bottle-proxy-map-reference-set" id="ref-for-storage-bottle-proxy-map-reference-set">proxy map reference set</a>.</p>
     <li data-md>
      <p>Return <var>proxyMap</var>.</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="3.2" id="database"><span class="secno">3.2. </span><span class="content">The <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database">Shared Storage Database</a></span><a class="self-link" href="#database"></a></h3>
   <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#browsing-context" id="ref-for-browsing-context">browsing context</a> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="shared-storage-database">shared storage database</dfn>, which provides methods to <a data-link-type="dfn" href="#shared-storage-database-store-an-entry-in-the-database" id="ref-for-shared-storage-database-store-an-entry-in-the-database">store</a>, <a data-link-type="dfn" href="#shared-storage-database-retrieve-an-entry-from-the-database" id="ref-for-shared-storage-database-retrieve-an-entry-from-the-database">retrieve</a>, <a data-link-type="dfn" href="#shared-storage-database-delete-an-entry-from-the-database" id="ref-for-shared-storage-database-delete-an-entry-from-the-database">delete</a>, <a data-link-type="dfn" href="#shared-storage-database-clear-all-entries-in-the-database" id="ref-for-shared-storage-database-clear-all-entries-in-the-database">clear</a>, and <a data-link-type="dfn" href="#shared-storage-database-purge-expired-entries-from-the-database" id="ref-for-shared-storage-database-purge-expired-entries-from-the-database">purge expired</a> data, and additional methods as below. The data in the <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database①">database</a> take the form of <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry">entries</a>.</p>
   <p>Each <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database②">shared storage database</a> has a <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-shared-storage-database-queue">shared storage database queue</dfn>, which is the result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#starting-a-new-parallel-queue" id="ref-for-starting-a-new-parallel-queue">starting a new parallel queue</a>. This <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue">queue</a> is used to run each of the <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database③">shared storage database</a>'s methods when calls to them are initiated from that <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#browsing-context" id="ref-for-browsing-context①">browsing context</a>.</p>
   <p>Each <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-entry">entry</dfn> consists of a <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key">key</a> and a <a data-link-type="dfn" href="#entry-value-struct" id="ref-for-entry-value-struct">value struct</a>.</p>
   <p>An <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry①">entry</a>'s <dfn class="dfn-paneled" data-dfn-for="entry" data-dfn-type="dfn" data-noexport id="entry-key">key</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string③">string</a>.</p>
   <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent①⑨">User agents</a> may specify the <dfn class="dfn-paneled" data-dfn-for="key" data-dfn-type="dfn" data-noexport id="key-maximum-length">maximum length</dfn> of a <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key①">key</a>.</p>
   <p>Since <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key②">keys</a> are used to organize and efficiently retrieve <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry②">entries</a>, <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key③">keys</a> must appear at most once in any given <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database④">shared storage database</a>.</p>
   <p>An <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry③">entry</a>'s <dfn class="dfn-paneled" data-dfn-for="entry" data-dfn-type="dfn" data-noexport id="entry-value-struct">value struct</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct①">struct</a> composed of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string④">string</a> <dfn class="dfn-paneled" data-dfn-for="value struct" data-dfn-type="dfn" data-noexport id="value-struct-value">value</dfn> and <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/hr-time/#dom-domhighrestimestamp" id="ref-for-dom-domhighrestimestamp①">DOMHighResTimeStamp</a></code> <dfn class="dfn-paneled" data-dfn-for="value struct" data-dfn-type="dfn" data-noexport id="value-struct-last-updated">last updated</dfn> (from the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unix-epoch" id="ref-for-dfn-unix-epoch①">Unix Epoch</a>).</p>
   <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent②⓪">User agents</a> may specify the <dfn class="dfn-paneled" data-dfn-for="value" data-dfn-type="dfn" data-noexport id="value-maximum-length">maximum length</dfn> of a <a data-link-type="dfn" href="#value-struct-value" id="ref-for-value-struct-value">value</a>.</p>
   <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent②①">User agents</a> may specify a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="default-entry-lifetime">default entry lifetime</dfn>, the default <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration" id="ref-for-dfn-duration②">duration</a> between when an <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry④">entry</a> is <a data-link-type="dfn" href="#shared-storage-database-store-an-entry-in-the-database" id="ref-for-shared-storage-database-store-an-entry-in-the-database①">stored</a> and when it expires. If the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent②②">user agent</a> specifies a <a data-link-type="dfn" href="#default-entry-lifetime" id="ref-for-default-entry-lifetime">default entry lifetime</a>, then it should have a timer periodically <a data-link-type="dfn" href="#shared-storage-database-purge-expired-entries-from-the-database" id="ref-for-shared-storage-database-purge-expired-entries-from-the-database①">purge expired entries from the database</a>.</p>
   <h3 class="heading settled" data-level="3.3" id="database-algorithms"><span class="secno">3.3. </span><span class="content">The <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database⑤">Database</a> Algorithms</span><a class="self-link" href="#database-algorithms"></a></h3>
   <div class="algorithm" data-algorithm="store an entry in the database" data-algorithm-for="shared storage database">
     To <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-store-an-entry-in-the-database">store an entry in the database</dfn>, given a <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①">shared storage database queue</a> <var>queue</var>, a <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-proxy-map" id="ref-for-storage-proxy-map①">storage proxy map</a> <var>databaseMap</var>, an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object①⓪">environment settings object</a> <var>environment</var>, a <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key④">key</a> <var>key</var>, and a <a data-link-type="dfn" href="#value-struct-value" id="ref-for-value-struct-value①">value</a> <var>value</var>, run the following steps on <var>queue</var>: 
    <ol>
     <li data-md>
      <p>Let <var>valueStruct</var> be a new <a data-link-type="dfn" href="#entry-value-struct" id="ref-for-entry-value-struct①">value struct</a>.</p>
     <li data-md>
      <p>Set <var>valueStruct</var>’s <a data-link-type="dfn" href="#value-struct-value" id="ref-for-value-struct-value②">value</a> to <var>value</var>.</p>
     <li data-md>
      <p>Let <var>currentTime</var> be the <var>environment</var>’s <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-eso-current-wall-time" id="ref-for-dfn-eso-current-wall-time①">current wall time</a>.</p>
     <li data-md>
      <p>Set <var>valueStruct</var>’s <a data-link-type="dfn" href="#value-struct-last-updated" id="ref-for-value-struct-last-updated">last updated</a> to <var>currentTime</var>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set②">Set</a> <var>databaseMap</var>[<var>key</var>] to <var>valueStruct</var>.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#an-exception-was-thrown" id="ref-for-an-exception-was-thrown①">an exception was thrown</a>, then return false.</p>
      <p class="note" role="note"><span class="marker">Note:</span> Errors with <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-proxy-map" id="ref-for-storage-proxy-map②">storage proxy map</a> <var>databaseMap</var>’s methods are possible depending on its implementation.</p>
     <li data-md>
      <p>Otherwise, return true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="retrieve an entry from the database" data-algorithm-for="shared storage database">
     To <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-retrieve-an-entry-from-the-database">retrieve an entry from the database</dfn>, given a <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue②">shared storage database queue</a> <var>queue</var>, a <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-proxy-map" id="ref-for-storage-proxy-map③">storage proxy map</a> <var>databaseMap</var>, an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object①①">environment settings object</a> <var>environment</var>, and a <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key⑤">key</a> <var>key</var>, run the following steps on <var>queue</var>: 
    <ol>
     <li data-md>
      <p>If <var>databaseMap</var> does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists⑥">contain</a> <var>key</var>, return undefined.</p>
     <li data-md>
      <p>Let <var>valueStruct</var> be the result of running <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-get" id="ref-for-map-get">Get</a> on <var>databaseMap</var> with <var>key</var>.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#an-exception-was-thrown" id="ref-for-an-exception-was-thrown②">an exception was thrown</a>, then return failure.</p>
      <p class="note" role="note"><span class="marker">Note:</span> Errors with <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-proxy-map" id="ref-for-storage-proxy-map④">storage proxy map</a> <var>databaseMap</var>’s methods are possible depending on its implementation.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#shared-storage-database-determine-whether-an-entry-is-expired" id="ref-for-shared-storage-database-determine-whether-an-entry-is-expired">determine whether an entry is expired</a> with <var>environment</var> and <var>valueStruct</var> is true, return undefined.</p>
     <li data-md>
      <p>Return <var>valueStruct</var>’s <a data-link-type="dfn" href="#value-struct-value" id="ref-for-value-struct-value③">value</a>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="delete an entry from the database" data-algorithm-for="shared storage database">
     To <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-delete-an-entry-from-the-database">delete an entry from the database</dfn>, given a <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue③">shared storage database queue</a> <var>queue</var>, a <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-proxy-map" id="ref-for-storage-proxy-map⑤">storage proxy map</a> <var>databaseMap</var>, and a <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key⑥">key</a> <var>key</var>, run the following steps on <var>queue</var>: 
    <ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-remove" id="ref-for-map-remove">Remove</a> <var>databaseMap</var>[<var>key</var>].</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#an-exception-was-thrown" id="ref-for-an-exception-was-thrown③">an exception was thrown</a>, then return false.</p>
      <p class="note" role="note"><span class="marker">Note:</span> Errors with <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-proxy-map" id="ref-for-storage-proxy-map⑥">storage proxy map</a> <var>databaseMap</var>’s methods are possible depending on its implementation.</p>
     <li data-md>
      <p>Return true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="clear all entries in the database" data-algorithm-for="shared storage database">
     To <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-clear-all-entries-in-the-database">clear all entries in the database</dfn>, given a <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue④">shared storage database queue</a> <var>queue</var> and a <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-proxy-map" id="ref-for-storage-proxy-map⑦">storage proxy map</a> <var>databaseMap</var>, run the following steps on <var>queue</var>: 
    <ol>
     <li data-md>
      <p>Run <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-clear" id="ref-for-map-clear">Clear</a> on <var>databaseMap</var>.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#an-exception-was-thrown" id="ref-for-an-exception-was-thrown④">an exception was thrown</a>, then return false.</p>
      <p class="note" role="note"><span class="marker">Note:</span> Errors with <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-proxy-map" id="ref-for-storage-proxy-map⑧">storage proxy map</a> <var>databaseMap</var>’s methods are possible depending on its implementation.</p>
     <li data-md>
      <p>Return true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="retrieve all entries from the database" data-algorithm-for="shared storage database">
     To <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-retrieve-all-entries-from-the-database">retrieve all entries from the database</dfn>, given a <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue⑤">shared storage database queue</a> <var>queue</var> and a <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-proxy-map" id="ref-for-storage-proxy-map⑨">storage proxy map</a> <var>databaseMap</var>, run the following steps on <var>queue</var>: 
    <ol>
     <li data-md>
      <p>Let <var>values</var> be the result of running <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-getting-the-values" id="ref-for-map-getting-the-values①">getting the values</a> on <var>databaseMap</var>.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#an-exception-was-thrown" id="ref-for-an-exception-was-thrown⑤">an exception was thrown</a>, then return failure.</p>
      <p class="note" role="note"><span class="marker">Note:</span> Errors with <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-proxy-map" id="ref-for-storage-proxy-map①⓪">storage proxy map</a> <var>databaseMap</var>’s methods are possible depending on its implementation.</p>
     <li data-md>
      <p>Return <var>values</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="count entries in the database" data-algorithm-for="shared storage database">
     To <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-count-entries-in-the-database">count entries in the database</dfn>, given a <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue⑥">shared storage database queue</a> <var>queue</var> and a <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-proxy-map" id="ref-for-storage-proxy-map①①">storage proxy map</a> <var>databaseMap</var>, run the following steps on <var>queue</var>: 
    <ol>
     <li data-md>
      <p>Let <var>size</var> be <var>databaseMap</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-size" id="ref-for-map-size①">size</a>.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#an-exception-was-thrown" id="ref-for-an-exception-was-thrown⑥">an exception was thrown</a>, then return failure.</p>
      <p class="note" role="note"><span class="marker">Note:</span> Errors with <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-proxy-map" id="ref-for-storage-proxy-map①②">storage proxy map</a> <var>databaseMap</var>’s members are possible depending on its implementation.</p>
     <li data-md>
      <p>Return <var>size</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="purge expired entries from the database" data-algorithm-for="shared storage database">
     To <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-purge-expired-entries-from-the-database">purge expired entries from the database</dfn>, given a <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue⑦">shared storage database queue</a> <var>queue</var>, a <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-proxy-map" id="ref-for-storage-proxy-map①③">storage proxy map</a> <var>databaseMap</var>, and an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object①②">environment settings object</a> <var>environment</var>, run the following steps on <var>queue</var>: 
    <ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate" id="ref-for-map-iterate⑥">For each</a> <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key⑦">key</a> <var>key</var> in <var>databaseMap</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>valueStruct</var> be the result of running <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-get" id="ref-for-map-get①">Get</a> on <var>databaseMap</var> with <var>key</var>.</p>
       <li data-md>
        <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#an-exception-was-thrown" id="ref-for-an-exception-was-thrown⑦">an exception was thrown</a>, then return false.</p>
       <li data-md>
        <p>If the result of running <a data-link-type="dfn" href="#shared-storage-database-determine-whether-an-entry-is-expired" id="ref-for-shared-storage-database-determine-whether-an-entry-is-expired①">determine whether an entry is expired</a> with <var>environment</var> and <var>valueStruct</var> is true, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-remove" id="ref-for-map-remove①">Remove</a> <var>databaseMap</var>[<var>key</var>].</p>
       <li data-md>
        <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#an-exception-was-thrown" id="ref-for-an-exception-was-thrown⑧">an exception was thrown</a>, then return false.</p>
      </ol>
     <li data-md>
      <p>Return true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="determine whether an entry is expired" data-algorithm-for="shared storage database">
    <p>To <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-determine-whether-an-entry-is-expired">determine whether an entry is expired</dfn>, given an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object①③">environment settings object</a> <var>environment</var> and a <a data-link-type="dfn" href="#entry-value-struct" id="ref-for-entry-value-struct②">value struct</a> <var>valueStruct</var>, run the following steps:</p>
    <ol>
     <li data-md>
      <p>Let <var>lastUpdated</var> be <var>valueStruct</var>’s <a data-link-type="dfn" href="#value-struct-last-updated" id="ref-for-value-struct-last-updated①">last updated</a>.</p>
     <li data-md>
      <p>Let <var>lifetime</var> be <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent②③">user agent</a>'s <a data-link-type="dfn" href="#default-entry-lifetime" id="ref-for-default-entry-lifetime①">default entry lifetime</a>.</p>
     <li data-md>
      <p>Let <var>expiration</var> be the sum of <var>lastUpdated</var> and <var>lifetime</var>.</p>
     <li data-md>
      <p>Let <var>currentTime</var> be the <var>environment</var>’s <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-eso-current-wall-time" id="ref-for-dfn-eso-current-wall-time②">current wall time</a>.</p>
     <li data-md>
      <p>If <var>expiration</var> is less than or equal to <var>currentTime</var>, return true.</p>
     <li data-md>
      <p>Otherwise, return false.</p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="4" id="shared-storage-interface"><span class="secno">4. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#sharedstorage" id="ref-for-sharedstorage">SharedStorage</a></code> Interface</span><a class="self-link" href="#shared-storage-interface"></a></h2>
    The <code class="idl"><a data-link-type="idl" href="#sharedstorage" id="ref-for-sharedstorage①">SharedStorage</a></code> interface is the base for derived interfaces <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage">WindowSharedStorage</a></code> and <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage②">WorkletSharedStorage</a></code>, which are exposed to the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window①⓪">Window</a></code> and the <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet①⑥">SharedStorageWorklet</a></code>, respectively. 
   <p>Methods that allow the setting and/or deleting of data are exposed to both the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window①①">Window</a></code> and the <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet①⑦">SharedStorageWorklet</a></code> and hence are declared in the base <code class="idl"><a data-link-type="idl" href="#sharedstorage" id="ref-for-sharedstorage②">SharedStorage</a></code> interface, although their implementations may vary depending on their <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment" id="ref-for-environment">environment</a>. This makes it possible to modify the data in Shared Storage from multiple contexts.</p>
   <p>Meanwhile, methods for posting operations to run inside <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①⑦">SharedStorageWorkletGlobalScope</a></code> (i.e. <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl②①">selectURL()</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-run" id="ref-for-dom-sharedstorageworklet-run⑤">run()</a></code>), along with the <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-worklet" id="ref-for-dom-windowsharedstorage-worklet">worklet</a></code> attribute which is used to call <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule⑨">addModule()</a></code>, are declared in <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage①">WindowSharedStorage</a></code> and exposed to the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window①②">Window</a></code> only, as these are the means by which the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window①③">Window</a></code> interacts with the <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet①⑧">SharedStorageWorklet</a></code>.</p>
   <p>On the other hand, methods for getting data from the <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database⑥">shared storage database</a> are declared in <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage③">WorkletSharedStorage</a></code> and exposed to the <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet①⑨">SharedStorageWorklet</a></code> only, in order to carefully control the flow of data read from the <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database⑦">database</a>.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed②"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>SharedStorageWorklet</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="sharedstorage"><code><c- g>SharedStorage</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise⑥"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any②"><c- b>any</c-></a>> <dfn class="idl-code" data-dfn-for="SharedStorage" data-dfn-type="method" data-export data-lt="set(key, value, options)|set(key, value)" id="dom-sharedstorage-set"><code><c- g>set</c-></code><a class="self-link" href="#dom-sharedstorage-set"></a></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString④"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorage/set(key, value, options), SharedStorage/set(key, value)" data-dfn-type="argument" data-export id="dom-sharedstorage-set-key-value-options-key"><code><c- g>key</c-></code><a class="self-link" href="#dom-sharedstorage-set-key-value-options-key"></a></dfn>,
                   <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑤"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorage/set(key, value, options), SharedStorage/set(key, value)" data-dfn-type="argument" data-export id="dom-sharedstorage-set-key-value-options-value"><code><c- g>value</c-></code><a class="self-link" href="#dom-sharedstorage-set-key-value-options-value"></a></dfn>,
                   <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sharedstoragesetmethodoptions" id="ref-for-dictdef-sharedstoragesetmethodoptions"><c- n>SharedStorageSetMethodOptions</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorage/set(key, value, options), SharedStorage/set(key, value)" data-dfn-type="argument" data-export id="dom-sharedstorage-set-key-value-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-sharedstorage-set-key-value-options-options"></a></dfn> = {});
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise⑦"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any③"><c- b>any</c-></a>> <dfn class="idl-code" data-dfn-for="SharedStorage" data-dfn-type="method" data-export data-lt="append(key, value)" id="dom-sharedstorage-append"><code><c- g>append</c-></code><a class="self-link" href="#dom-sharedstorage-append"></a></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑥"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorage/append(key, value)" data-dfn-type="argument" data-export id="dom-sharedstorage-append-key-value-key"><code><c- g>key</c-></code><a class="self-link" href="#dom-sharedstorage-append-key-value-key"></a></dfn>,
                      <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑦"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorage/append(key, value)" data-dfn-type="argument" data-export id="dom-sharedstorage-append-key-value-value"><code><c- g>value</c-></code><a class="self-link" href="#dom-sharedstorage-append-key-value-value"></a></dfn>);
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise⑧"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any④"><c- b>any</c-></a>> <dfn class="idl-code" data-dfn-for="SharedStorage" data-dfn-type="method" data-export data-lt="delete(key)" id="dom-sharedstorage-delete"><code><c- g>delete</c-></code><a class="self-link" href="#dom-sharedstorage-delete"></a></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑧"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorage/delete(key)" data-dfn-type="argument" data-export id="dom-sharedstorage-delete-key-key"><code><c- g>key</c-></code><a class="self-link" href="#dom-sharedstorage-delete-key-key"></a></dfn>);
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise⑨"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any⑤"><c- b>any</c-></a>> <dfn class="idl-code" data-dfn-for="SharedStorage" data-dfn-type="method" data-export data-lt="clear()" id="dom-sharedstorage-clear"><code><c- g>clear</c-></code><a class="self-link" href="#dom-sharedstorage-clear"></a></dfn>();
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-sharedstoragesetmethodoptions"><code><c- g>SharedStorageSetMethodOptions</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean"><c- b>boolean</c-></a> <dfn class="idl-code" data-default="false" data-dfn-for="SharedStorageSetMethodOptions" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-sharedstoragesetmethodoptions-ignoreifpresent"><code><c- g>ignoreIfPresent</c-></code><a class="self-link" href="#dom-sharedstoragesetmethodoptions-ignoreifpresent"></a></dfn> = <c- b>false</c->;
};
</pre>
   <h3 class="heading settled" data-level="4.1" id="window"><span class="secno">4.1. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage②">WindowSharedStorage</a></code> interface</span><a class="self-link" href="#window"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage③">WindowSharedStorage</a></code> interface is as follows.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed③"><c- g>Exposed</c-></a>=(<c- n>Window</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="windowsharedstorage"><code><c- g>WindowSharedStorage</c-></code></dfn> : <a data-link-type="idl-name" href="#sharedstorage" id="ref-for-sharedstorage③"><c- n>SharedStorage</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①⓪"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#typedefdef-sharedstorageresponse" id="ref-for-typedefdef-sharedstorageresponse⑤"><c- n>SharedStorageResponse</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-windowsharedstorage-selecturl" id="ref-for-dom-windowsharedstorage-selecturl①"><c- g>selectURL</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑨"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="WindowSharedStorage/selectURL(name, urls, options), WindowSharedStorage/selectURL(name, urls)" data-dfn-type="argument" data-export id="dom-windowsharedstorage-selecturl-name-urls-options-name"><code><c- g>name</c-></code><a class="self-link" href="#dom-windowsharedstorage-selecturl-name-urls-options-name"></a></dfn>,
                               <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array" id="ref-for-idl-frozen-array①"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-sharedstorageurlwithmetadata" id="ref-for-dictdef-sharedstorageurlwithmetadata⑤"><c- n>SharedStorageUrlWithMetadata</c-></a>> <dfn class="idl-code" data-dfn-for="WindowSharedStorage/selectURL(name, urls, options), WindowSharedStorage/selectURL(name, urls)" data-dfn-type="argument" data-export id="dom-windowsharedstorage-selecturl-name-urls-options-urls"><code><c- g>urls</c-></code><a class="self-link" href="#dom-windowsharedstorage-selecturl-name-urls-options-urls"></a></dfn>,
                               <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sharedstoragerunoperationmethodoptions" id="ref-for-dictdef-sharedstoragerunoperationmethodoptions③"><c- n>SharedStorageRunOperationMethodOptions</c-></a> <dfn class="idl-code" data-dfn-for="WindowSharedStorage/selectURL(name, urls, options), WindowSharedStorage/selectURL(name, urls)" data-dfn-type="argument" data-export id="dom-windowsharedstorage-selecturl-name-urls-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-windowsharedstorage-selecturl-name-urls-options-options"></a></dfn> = {});
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①①"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any⑥"><c- b>any</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-windowsharedstorage-run" id="ref-for-dom-windowsharedstorage-run"><c- g>run</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①⓪"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="WindowSharedStorage/run(name, options), WindowSharedStorage/run(name)" data-dfn-type="argument" data-export id="dom-windowsharedstorage-run-name-options-name"><code><c- g>name</c-></code><a class="self-link" href="#dom-windowsharedstorage-run-name-options-name"></a></dfn>,
                   <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sharedstoragerunoperationmethodoptions" id="ref-for-dictdef-sharedstoragerunoperationmethodoptions④"><c- n>SharedStorageRunOperationMethodOptions</c-></a> <dfn class="idl-code" data-dfn-for="WindowSharedStorage/run(name, options), WindowSharedStorage/run(name)" data-dfn-type="argument" data-export id="dom-windowsharedstorage-run-name-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-windowsharedstorage-run-name-options-options"></a></dfn> = {});

  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①②"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet②⓪"><c- n>SharedStorageWorklet</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-windowsharedstorage-createworklet" id="ref-for-dom-windowsharedstorage-createworklet②"><c- g>createWorklet</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString③"><c- b>USVString</c-></a> <dfn class="idl-code" data-dfn-for="WindowSharedStorage/createWorklet(moduleURL, options), WindowSharedStorage/createWorklet(moduleURL)" data-dfn-type="argument" data-export id="dom-windowsharedstorage-createworklet-moduleurl-options-moduleurl"><code><c- g>moduleURL</c-></code><a class="self-link" href="#dom-windowsharedstorage-createworklet-moduleurl-options-moduleurl"></a></dfn>, <c- b>optional</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/worklets.html#workletoptions" id="ref-for-workletoptions"><c- n>WorkletOptions</c-></a> <dfn class="idl-code" data-dfn-for="WindowSharedStorage/createWorklet(moduleURL, options), WindowSharedStorage/createWorklet(moduleURL)" data-dfn-type="argument" data-export id="dom-windowsharedstorage-createworklet-moduleurl-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-windowsharedstorage-createworklet-moduleurl-options-options"></a></dfn> = {});

  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet②①"><c- n>SharedStorageWorklet</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="WindowSharedStorage" data-dfn-type="attribute" data-export data-readonly data-type="SharedStorageWorklet" id="dom-windowsharedstorage-worklet"><code><c- g>worklet</c-></code></dfn>;
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-sharedstoragerunoperationmethodoptions"><code><c- g>SharedStorageRunOperationMethodOptions</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object⑤"><c- b>object</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorageRunOperationMethodOptions" data-dfn-type="dict-member" data-export data-type="object " id="dom-sharedstoragerunoperationmethodoptions-data"><code><c- g>data</c-></code><a class="self-link" href="#dom-sharedstoragerunoperationmethodoptions-data"></a></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean①"><c- b>boolean</c-></a> <dfn class="idl-code" data-default="false" data-dfn-for="SharedStorageRunOperationMethodOptions" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-sharedstoragerunoperationmethodoptions-resolvetoconfig"><code><c- g>resolveToConfig</c-></code><a class="self-link" href="#dom-sharedstoragerunoperationmethodoptions-resolvetoconfig"></a></dfn> = <c- b>false</c->;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean②"><c- b>boolean</c-></a> <dfn class="idl-code" data-default="false" data-dfn-for="SharedStorageRunOperationMethodOptions" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-sharedstoragerunoperationmethodoptions-keepalive"><code><c- g>keepAlive</c-></code><a class="self-link" href="#dom-sharedstoragerunoperationmethodoptions-keepalive"></a></dfn> = <c- b>false</c->;
};
</pre>
   <h4 class="heading settled" data-level="4.1.1" id="window-setter"><span class="secno">4.1.1. </span><span class="content">Window Setter/Deleter Methods</span><a class="self-link" href="#window-setter"></a></h4>
   <div class="algorithm" data-algorithm="set(key, value, options)" data-algorithm-for="WindowSharedStorage">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WindowSharedStorage" data-dfn-type="method" data-export id="dom-windowsharedstorage-set"><code>set(<var>key</var>, <var>value</var>, <var>options</var>)</code></dfn> method step is: 
    <ol>
     <li data-md>
      <p>Return the result of running <a data-link-type="dfn" href="#windowsharedstorage-set-a-key-value-pair" id="ref-for-windowsharedstorage-set-a-key-value-pair">set a key-value pair</a> on <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage④">WindowSharedStorage</a></code>, <var>key</var>, <var>value</var>, and <var>options</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="append(key, value)" data-algorithm-for="WindowSharedStorage">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WindowSharedStorage" data-dfn-type="method" data-export id="dom-windowsharedstorage-append"><code>append(<var>key</var>, <var>value</var>)</code></dfn> method step is: 
    <ol>
     <li data-md>
      <p>Return the result of running <a data-link-type="dfn" href="#windowsharedstorage-append-a-key-value-pair" id="ref-for-windowsharedstorage-append-a-key-value-pair">append a key-value pair</a> on <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage⑤">WindowSharedStorage</a></code>, <var>key</var>, and <var>value</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="delete(key)" data-algorithm-for="WindowSharedStorage">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WindowSharedStorage" data-dfn-type="method" data-export id="dom-windowsharedstorage-delete"><code>delete(<var>key</var>)</code></dfn> method step is: 
    <ol>
     <li data-md>
      <p>Return the result of running <a data-link-type="dfn" href="#windowsharedstorage-delete-a-key" id="ref-for-windowsharedstorage-delete-a-key">delete a key</a> on <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage⑥">WindowSharedStorage</a></code> and <var>key</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="clear()" data-algorithm-for="WindowSharedStorage">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WindowSharedStorage" data-dfn-type="method" data-export id="dom-windowsharedstorage-clear"><code>clear()</code></dfn> method step is: 
    <ol>
     <li data-md>
      <p>Return the result of running <a data-link-type="dfn" href="#windowsharedstorage-clear-all-keys" id="ref-for-windowsharedstorage-clear-all-keys">clear all keys</a> on <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage⑦">WindowSharedStorage</a></code>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="set a key-value pair" data-algorithm-for="WindowSharedStorage">
     To <dfn class="dfn-paneled" data-dfn-for="WindowSharedStorage" data-dfn-type="dfn" data-noexport id="windowsharedstorage-set-a-key-value-pair">set a key-value pair</dfn>, given <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage⑧">WindowSharedStorage</a></code> <var>sharedStorage</var>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string⑤">string</a> <var>key</var>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string⑥">string</a> <var>value</var>, and <code class="idl"><a data-link-type="idl" href="#dictdef-sharedstoragesetmethodoptions" id="ref-for-dictdef-sharedstoragesetmethodoptions①">SharedStorageSetMethodOptions</a></code> <var>options</var>, perform the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise①③">promise</a>.</p>
     <li data-md>
      <p>If <var>key</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length">length</a> exceeds the <a data-link-type="dfn" href="#key-maximum-length" id="ref-for-key-maximum-length">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①⑧">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②⑧">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>value</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length①">length</a> exceeds the <a data-link-type="dfn" href="#value-maximum-length" id="ref-for-value-maximum-length">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①⑨">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②⑨">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>context</var> be <var>sharedStorage</var>’s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window①④">Window</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window-bc" id="ref-for-window-bc②">browsing context</a>.</p>
     <li data-md>
      <p>If <var>context</var> is null, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②⓪">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③⓪">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object⑤">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>databaseMap</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-bottle-map" id="ref-for-obtain-a-shared-storage-bottle-map">obtain a shared storage bottle map</a> given <var>environment</var> and <var>environment</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin①①">origin</a>.</p>
     <li data-md>
      <p>If <var>databaseMap</var> is failure, then return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②①">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③①">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database⑧">database</a>'s <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue⑧">shared storage database queue</a>.</p>
     <li data-md>
      <p>Let <var>realm</var> be the <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm①">current realm</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>If <var>options</var>["<code>ignoreIfPresent</code>"] is true and the result of running <a data-link-type="dfn" href="#shared-storage-database-retrieve-an-entry-from-the-database" id="ref-for-shared-storage-database-retrieve-an-entry-from-the-database①">retrieve an entry from the database</a> with <var>queue</var>, <var>databaseMap</var>, <var>environment</var>, and <var>key</var> is not undefined:</p>
        <ol>
         <li data-md>
          <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task⑤">Queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source⑤">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global②">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve⑦">resolve</a> <var>promise</var> with undefined.</p>
         <li data-md>
          <p>Abort these steps.</p>
        </ol>
       <li data-md>
        <p>Run <a data-link-type="dfn" href="#shared-storage-database-store-an-entry-in-the-database" id="ref-for-shared-storage-database-store-an-entry-in-the-database②">store an entry in the database</a> with <var>queue</var>, <var>databaseMap</var>, <var>environment</var>, <var>key</var>, and <var>value</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task⑥">Queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source⑥">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global③">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve⑧">resolve</a> <var>promise</var> with undefined.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="append a key-value pair" data-algorithm-for="WindowSharedStorage">
     To <dfn class="dfn-paneled" data-dfn-for="WindowSharedStorage" data-dfn-type="dfn" data-noexport id="windowsharedstorage-append-a-key-value-pair">append a key-value pair</dfn>, given <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage⑨">WindowSharedStorage</a></code> <var>sharedStorage</var>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string⑦">string</a> <var>key</var>, and <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string⑧">string</a> <var>value</var>, perform the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise①④">promise</a>.</p>
     <li data-md>
      <p>If <var>key</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length②">length</a> exceeds the <a data-link-type="dfn" href="#key-maximum-length" id="ref-for-key-maximum-length①">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②②">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③②">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>value</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length③">length</a> exceeds the <a data-link-type="dfn" href="#value-maximum-length" id="ref-for-value-maximum-length①">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②③">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③③">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>context</var> be <var>sharedStorage</var>’s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window①⑤">Window</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window-bc" id="ref-for-window-bc③">browsing context</a>.</p>
     <li data-md>
      <p>If <var>context</var> is null, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②④">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③④">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window①">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object⑥">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>databaseMap</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-bottle-map" id="ref-for-obtain-a-shared-storage-bottle-map①">obtain a shared storage bottle map</a> given <var>environment</var> and <var>environment</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin①②">origin</a>.</p>
     <li data-md>
      <p>If <var>databaseMap</var> is failure, then return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②⑤">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③⑤">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database⑨">database</a>'s <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue⑨">shared storage database queue</a>.</p>
     <li data-md>
      <p>Let <var>realm</var> be the <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm②">current realm</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps①">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>currentValue</var> be the result of running <a data-link-type="dfn" href="#shared-storage-database-retrieve-an-entry-from-the-database" id="ref-for-shared-storage-database-retrieve-an-entry-from-the-database②">retrieve an entry from the database</a> with <var>queue</var>, <var>databaseMap</var>, <var>environment</var>, and <var>key</var>.</p>
       <li data-md>
        <p>If <var>currentValue</var> is failure:</p>
        <ol>
         <li data-md>
          <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task⑦">Queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source⑦">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global④">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve⑨">resolve</a> <var>promise</var> with undefined.</p>
         <li data-md>
          <p>Abort these steps.</p>
        </ol>
       <li data-md>
        <p>If <var>currentValue</var> is not undefined:</p>
        <ol>
         <li data-md>
          <p>Let <var>list</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑤">list</a>.</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append④">Append</a> <var>currentValue</var> to <var>list</var>.</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append⑤">Append</a> <var>value</var> to <var>list</var>.</p>
         <li data-md>
          <p>Set <var>value</var> to the result of running <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-concatenate" id="ref-for-string-concatenate">concatenate</a> on <var>list</var>.</p>
        </ol>
       <li data-md>
        <p>Run <a data-link-type="dfn" href="#shared-storage-database-store-an-entry-in-the-database" id="ref-for-shared-storage-database-store-an-entry-in-the-database③">store an entry in the database</a> with <var>queue</var>, <var>databaseMap</var>, <var>environment</var>, <var>key</var>, and <var>value</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task⑧">Queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source⑧">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global⑤">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve①⓪">resolve</a> <var>promise</var> with undefined.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="delete a key" data-algorithm-for="WindowSharedStorage">
     To <dfn class="dfn-paneled" data-dfn-for="WindowSharedStorage" data-dfn-type="dfn" data-noexport id="windowsharedstorage-delete-a-key">delete a key</dfn>, given <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage①⓪">WindowSharedStorage</a></code> <var>sharedStorage</var> and <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string⑨">string</a> <var>key</var>, perform the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise①⑤">promise</a>.</p>
     <li data-md>
      <p>If <var>key</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length④">length</a> exceeds the <a data-link-type="dfn" href="#key-maximum-length" id="ref-for-key-maximum-length②">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②⑥">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③⑥">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>context</var> be <var>sharedStorage</var>’s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window①⑥">Window</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window-bc" id="ref-for-window-bc④">browsing context</a>.</p>
     <li data-md>
      <p>If <var>context</var> is null, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②⑦">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③⑦">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window②">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object⑦">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>databaseMap</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-bottle-map" id="ref-for-obtain-a-shared-storage-bottle-map②">obtain a shared storage bottle map</a> given <var>environment</var> and <var>environment</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin①③">origin</a>.</p>
     <li data-md>
      <p>If <var>databaseMap</var> is failure, then return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②⑧">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③⑧">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database①⓪">database</a>'s <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①⓪">shared storage database queue</a>.</p>
     <li data-md>
      <p>Let <var>realm</var> be the <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm③">current realm</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps②">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>Run <a data-link-type="dfn" href="#shared-storage-database-delete-an-entry-from-the-database" id="ref-for-shared-storage-database-delete-an-entry-from-the-database①">delete an entry from the database</a> with <var>queue</var>, <var>environment</var>, and <var>key</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task⑨">Queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source⑨">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global⑥">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve①①">resolve</a> <var>promise</var> with undefined.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="clear all keys" data-algorithm-for="WindowSharedStorage">
     To <dfn class="dfn-paneled" data-dfn-for="WindowSharedStorage" data-dfn-type="dfn" data-noexport id="windowsharedstorage-clear-all-keys">clear all keys</dfn>, given <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage①①">WindowSharedStorage</a></code> <var>sharedStorage</var>, perform the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise①⑥">promise</a>.</p>
     <li data-md>
      <p>Let <var>context</var> be <var>sharedStorage</var>’s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window①⑦">Window</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window-bc" id="ref-for-window-bc⑤">browsing context</a>.</p>
     <li data-md>
      <p>If <var>context</var> is null, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②⑨">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③⑨">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window③">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object⑧">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>databaseMap</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-bottle-map" id="ref-for-obtain-a-shared-storage-bottle-map③">obtain a shared storage bottle map</a> given <var>environment</var> and <var>environment</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin①④">origin</a></p>
     <li data-md>
      <p>If <var>databaseMap</var> is failure, then return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with③⓪">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror④⓪">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database①①">database</a>'s <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①①">shared storage database queue</a>.</p>
     <li data-md>
      <p>Let <var>realm</var> be the <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm④">current realm</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps③">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>Run <a data-link-type="dfn" href="#shared-storage-database-clear-all-entries-in-the-database" id="ref-for-shared-storage-database-clear-all-entries-in-the-database①">clear all entries in the database</a> with <var>queue</var> and <var>environment</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task①⓪">Queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source①⓪">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global⑦">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve①②">resolve</a> <var>promise</var> with undefined.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="4.1.2" id="run-op-shared-storage"><span class="secno">4.1.2. </span><span class="content">Run Operation Methods on <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage①②">WindowSharedStorage</a></code></span><a class="self-link" href="#run-op-shared-storage"></a></h4>
   <div class="algorithm" data-algorithm="selectURL(name, urls, options)" data-algorithm-for="WindowSharedStorage">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WindowSharedStorage" data-dfn-type="method" data-export data-lt="selectURL(name, urls, options)|selectURL(name, urls)" id="dom-windowsharedstorage-selecturl"><code>selectURL(<var>name</var>, <var>urls</var>, <var>options</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>sharedStorage</var> be <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②⑤">this</a>.</p>
     <li data-md>
      <p>Return <var>sharedStorage</var>.<code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-worklet" id="ref-for-dom-windowsharedstorage-worklet①">worklet</a></code>.<code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl②②">selectURL</a></code>(<var>name</var>, <var>urls</var>, <var>options</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="run(name, options)" data-algorithm-for="WindowSharedStorage">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WindowSharedStorage" data-dfn-type="method" data-export data-lt="run(name, options)|run(name)" id="dom-windowsharedstorage-run"><code>run(<var>name</var>, <var>options</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>sharedStorage</var> be <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②⑥">this</a>.</p>
     <li data-md>
      <p>Return <var>sharedStorage</var>.<code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-worklet" id="ref-for-dom-windowsharedstorage-worklet②">worklet</a></code>.<code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-run" id="ref-for-dom-sharedstorageworklet-run⑥">run</a></code>(<var>name</var>, <var>options</var>).</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="4.1.3" id="create-a-new-worklet-via-shared-storage"><span class="secno">4.1.3. </span><span class="content">Create a new worklet via <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage①③">WindowSharedStorage</a></code></span><a class="self-link" href="#create-a-new-worklet-via-shared-storage"></a></h4>
   <div class="algorithm" data-algorithm="createWorklet(moduleURL, options)" data-algorithm-for="WindowSharedStorage">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WindowSharedStorage" data-dfn-type="method" data-export data-lt="createWorklet(moduleURL, options)|createWorklet(moduleURL)" id="dom-windowsharedstorage-createworklet"><code>createWorklet(<var>moduleURL</var>, <var>options</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>sharedStorageWorklet</var> be a new <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet②②">SharedStorageWorklet</a></code>.</p>
     <li data-md>
      <p>Set <var>sharedStorageWorklet</var>’s <a data-link-type="dfn" href="#sharedstorageworklet-cross-origin-worklet-allowed" id="ref-for-sharedstorageworklet-cross-origin-worklet-allowed①">cross-origin worklet allowed</a> to true.</p>
     <li data-md>
      <p>Let <var>addModulePromise</var> be the result of invoking sharedStorageWorklet.<code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule①⓪">addModule</a></code>(<var>moduleURL</var>, <var>options</var>).</p>
     <li data-md>
      <p>Let <var>resultPromise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise①⑦">promise</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#upon-fulfillment" id="ref-for-upon-fulfillment①">Upon fulfillment</a> of <var>addModulePromise</var>, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve①③">resolve</a> <var>resultPromise</var> to <var>sharedStorageWorklet</var>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#upon-rejection" id="ref-for-upon-rejection①">Upon rejection</a> of <var>addModulePromise</var>, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject⑥">reject</a> <var>resultPromise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror④①">TypeError</a></code>.</p>
     <li data-md>
      <p>Return <var>resultPromise</var>.</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="4.2" id="extension"><span class="secno">4.2. </span><span class="content">Extension to the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window①⑧">Window</a></code> interface</span><a class="self-link" href="#extension"></a></h3>
   <p>Each <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window①⑨">Window</a></code> object has an associated <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage①④">WindowSharedStorage</a></code> instance <code class="idl"><a data-link-type="idl" href="#dom-window-sharedstorage" id="ref-for-dom-window-sharedstorage">sharedStorage</a></code>, which is created alongside the .<code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window②⓪">Window</a></code> if <a data-link-type="dfn" href="#shared-storage" id="ref-for-shared-storage③">Shared Storage</a> is enabled, with the <a data-link-type="dfn" href="#window-sharedstorage-getter" id="ref-for-window-sharedstorage-getter">getter</a> below.</p>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window②①"><c- g>Window</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext"><c- g>SecureContext</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#windowsharedstorage" id="ref-for-windowsharedstorage①⑤"><c- n>WindowSharedStorage</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="Window" data-dfn-type="attribute" data-export data-readonly data-type="WindowSharedStorage?" id="dom-window-sharedstorage"><code><c- g>sharedStorage</c-></code></dfn>;
};
</pre>
   <div class="algorithm" data-algorithm="sharedStorage getter" data-algorithm-for="Window">
     The <dfn class="dfn-paneled" data-dfn-for="Window" data-dfn-type="dfn" data-noexport id="window-sharedstorage-getter"><code class="idl"><a data-link-type="idl" href="#dom-window-sharedstorage" id="ref-for-dom-window-sharedstorage①">sharedStorage</a></code> getter</dfn> steps are: 
    <ol>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②⑦">this</a> is <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#fully-active" id="ref-for-fully-active①">fully active</a>, return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②⑧">this</a>'s <code class="idl"><a data-link-type="idl" href="#dom-window-sharedstorage" id="ref-for-dom-window-sharedstorage②">sharedStorage</a></code>.</p>
     <li data-md>
      <p>Otherwise, return null.</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="4.3" id="worklet-shared-storage"><span class="secno">4.3. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage④">WorkletSharedStorage</a></code> interface</span><a class="self-link" href="#worklet-shared-storage"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage⑤">WorkletSharedStorage</a></code> interface is as follows.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed④"><c- g>Exposed</c-></a>=(<c- n>SharedStorageWorklet</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="workletsharedstorage"><code><c- g>WorkletSharedStorage</c-></code></dfn> : <a data-link-type="idl-name" href="#sharedstorage" id="ref-for-sharedstorage④"><c- n>SharedStorage</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①⑧"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①①"><c- b>DOMString</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-workletsharedstorage-get" id="ref-for-dom-workletsharedstorage-get"><c- g>get</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①②"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="WorkletSharedStorage/get(key)" data-dfn-type="argument" data-export id="dom-workletsharedstorage-get-key-key"><code><c- g>key</c-></code><a class="self-link" href="#dom-workletsharedstorage-get-key-key"></a></dfn>);
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①⑨"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long①"><c- b>unsigned</c-> <c- b>long</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-workletsharedstorage-length" id="ref-for-dom-workletsharedstorage-length"><c- g>length</c-></a>();
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise②⓪"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double" id="ref-for-idl-double①"><c- b>double</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-workletsharedstorage-remainingbudget" id="ref-for-dom-workletsharedstorage-remainingbudget"><c- g>remainingBudget</c-></a>();

  <c- b>async</c-> <c- b>iterable</c->&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①③"><c- b>DOMString</c-></a>, <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①④"><c- b>DOMString</c-></a>>;
};
</pre>
   <h4 class="heading settled" data-level="4.3.1" id="worklet-setter"><span class="secno">4.3.1. </span><span class="content">Worklet Setter/Deleter Methods</span><a class="self-link" href="#worklet-setter"></a></h4>
   <div class="algorithm" data-algorithm="set(key, value, options)" data-algorithm-for="WorkletSharedStorage">
     The <dfn class="idl-code" data-dfn-for="WorkletSharedStorage" data-dfn-type="method" data-export id="dom-workletsharedstorage-set"><code>set(<var>key</var>, <var>value</var>, <var>options</var>)</code><a class="self-link" href="#dom-workletsharedstorage-set"></a></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise②①">promise</a>.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-check-whether-addmodule-is-finished" id="ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished②">check whether addModule is finished</a> for <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage⑥">WorkletSharedStorage</a></code>'s associated <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①⑧">SharedStorageWorkletGlobalScope</a></code> is false, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with③①">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror④②">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>key</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length⑤">length</a> exceeds the <a data-link-type="dfn" href="#key-maximum-length" id="ref-for-key-maximum-length③">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with③②">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror④③">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>value</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length⑥">length</a> exceeds the <a data-link-type="dfn" href="#value-maximum-length" id="ref-for-value-maximum-length②">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with③③">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror④④">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage⑦">WorkletSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①⑨">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-outside-settings" id="ref-for-sharedstorageworkletglobalscope-outside-settings">outside settings</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context" id="ref-for-concept-environment-target-browsing-context">target browsing context</a>.</p>
     <li data-md>
      <p>If <var>context</var> is null, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with③④">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror④⑤">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window④">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" id="ref-for-concept-document-window③">associated document</a> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#fully-active" id="ref-for-fully-active②">fully active</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with③⑤">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror④⑥">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window⑤">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object⑨">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>realm</var> be the <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm⑤">current realm</a>.</p>
     <li data-md>
      <p>Let <var>databaseMap</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-bottle-map" id="ref-for-obtain-a-shared-storage-bottle-map④">obtain a shared storage bottle map</a> given <var>environment</var> and <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object⑥">settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin①⑤">origin</a>.</p>
     <li data-md>
      <p>If <var>databaseMap</var> is failure, then return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with③⑥">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror④⑦">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database①②">database</a>'s <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①②">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps④">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>If <var>options</var>["<code>ignoreIfPresent</code>"] is true:</p>
        <ol>
         <li data-md>
          <p>Let <var>currentValue</var> be the result of running <a data-link-type="dfn" href="#shared-storage-database-retrieve-an-entry-from-the-database" id="ref-for-shared-storage-database-retrieve-an-entry-from-the-database③">retrieve an entry from the database</a> with <var>queue</var>, <var>databaseMap</var>, <var>environment</var>, and <var>key</var>.</p>
         <li data-md>
          <p>If <var>currentValue</var> is failure:</p>
          <ol>
           <li data-md>
            <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task①①">Queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source①①">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global⑧">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject⑦">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror④⑧">TypeError</a></code>.</p>
           <li data-md>
            <p>Abort these steps.</p>
          </ol>
         <li data-md>
          <p>If <var>currentValue</var> is not undefined:</p>
          <ol>
           <li data-md>
            <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task①②">Queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source①②">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global⑨">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve①④">resolve</a> <var>promise</var> with undefined.</p>
           <li data-md>
            <p>Abort these steps.</p>
          </ol>
        </ol>
       <li data-md>
        <p>If the result of running <a data-link-type="dfn" href="#shared-storage-database-store-an-entry-in-the-database" id="ref-for-shared-storage-database-store-an-entry-in-the-database④">store an entry in the database</a> with <var>queue</var>, <var>databaseMap</var>, <var>environment</var>, <var>key</var>, and <var>value</var> is false, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task①③">queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source①③">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global①⓪">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject⑧">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror④⑨">TypeError</a></code>.</p>
       <li data-md>
        <p>Otherwise, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task①④">queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source①④">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global①①">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve①⑤">resolve</a> <var>promise</var> with undefined.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="append(key, value)" data-algorithm-for="WorkletSharedStorage">
     The <dfn class="idl-code" data-dfn-for="WorkletSharedStorage" data-dfn-type="method" data-export id="dom-workletsharedstorage-append"><code>append(<var>key</var>, <var>value</var>)</code><a class="self-link" href="#dom-workletsharedstorage-append"></a></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise②②">promise</a>.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-check-whether-addmodule-is-finished" id="ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished③">check whether addModule is finished</a> for <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage⑧">WorkletSharedStorage</a></code>'s associated <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope②⓪">SharedStorageWorkletGlobalScope</a></code> is false, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with③⑦">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑤⓪">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>key</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length⑦">length</a> exceeds the <a data-link-type="dfn" href="#key-maximum-length" id="ref-for-key-maximum-length④">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with③⑧">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑤①">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>value</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length⑧">length</a> exceeds the <a data-link-type="dfn" href="#value-maximum-length" id="ref-for-value-maximum-length③">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with③⑨">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑤②">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage⑨">WorkletSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope②①">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-outside-settings" id="ref-for-sharedstorageworkletglobalscope-outside-settings①">outside settings</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context" id="ref-for-concept-environment-target-browsing-context①">target browsing context</a>.</p>
     <li data-md>
      <p>If <var>context</var> is null, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with④⓪">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑤③">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window⑥">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" id="ref-for-concept-document-window④">associated document</a> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#fully-active" id="ref-for-fully-active③">fully active</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with④①">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑤④">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window⑦">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object①⓪">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>realm</var> be the <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm⑥">current realm</a>.</p>
     <li data-md>
      <p>Let <var>databaseMap</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-bottle-map" id="ref-for-obtain-a-shared-storage-bottle-map⑤">obtain a shared storage bottle map</a> given <var>environment</var> and <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object⑦">settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin①⑥">origin</a>.</p>
     <li data-md>
      <p>If <var>databaseMap</var> is failure, then return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with④②">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑤⑤">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database①③">database</a>'s <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①③">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps⑤">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>currentValue</var> be the result of running <a data-link-type="dfn" href="#shared-storage-database-retrieve-an-entry-from-the-database" id="ref-for-shared-storage-database-retrieve-an-entry-from-the-database④">retrieve an entry from the database</a> with <var>queue</var>, <var>databaseMap</var>, <var>environment</var>, and <var>key</var>.</p>
       <li data-md>
        <p>If <var>currentValue</var> is failure:</p>
        <ol>
         <li data-md>
          <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task①⑤">Queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source①⑤">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global①②">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject⑨">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑤⑥">TypeError</a></code>.</p>
         <li data-md>
          <p>Abort these steps.</p>
        </ol>
       <li data-md>
        <p>If <var>currentValue</var> is not undefined:</p>
        <ol>
         <li data-md>
          <p>Let <var>list</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑥">list</a>.</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append⑥">Append</a> <var>currentValue</var> to <var>list</var>.</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append⑦">Append</a> <var>value</var> to <var>list</var>.</p>
         <li data-md>
          <p>Set <var>value</var> to the result of running <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-concatenate" id="ref-for-string-concatenate①">concatenate</a> on <var>list</var>.</p>
        </ol>
       <li data-md>
        <p>If the result of running <a data-link-type="dfn" href="#shared-storage-database-store-an-entry-in-the-database" id="ref-for-shared-storage-database-store-an-entry-in-the-database⑤">store an entry in the database</a> with <var>queue</var>, <var>databaseMap</var>, <var>environment</var>, <var>key</var>, and <var>value</var> is false, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task①⑥">queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source①⑥">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global①③">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject①⓪">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑤⑦">TypeError</a></code>.</p>
       <li data-md>
        <p>Otherwise, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task①⑦">queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source①⑦">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global①④">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve①⑥">resolve</a> <var>promise</var> with undefined.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="delete(key)" data-algorithm-for="WorkletSharedStorage">
     The <dfn class="idl-code" data-dfn-for="WorkletSharedStorage" data-dfn-type="method" data-export id="dom-workletsharedstorage-delete"><code>delete(<var>key</var>)</code><a class="self-link" href="#dom-workletsharedstorage-delete"></a></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise②③">promise</a>.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-check-whether-addmodule-is-finished" id="ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished④">check whether addModule is finished</a> for <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage①⓪">WorkletSharedStorage</a></code>'s associated <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope②②">SharedStorageWorkletGlobalScope</a></code> is false, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with④③">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑤⑧">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>key</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length⑨">length</a> exceeds the <a data-link-type="dfn" href="#key-maximum-length" id="ref-for-key-maximum-length⑤">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with④④">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑤⑨">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage①①">WorkletSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope②③">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-outside-settings" id="ref-for-sharedstorageworkletglobalscope-outside-settings②">outside settings</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context" id="ref-for-concept-environment-target-browsing-context②">target browsing context</a>.</p>
     <li data-md>
      <p>If <var>context</var> is null, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with④⑤">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑥⓪">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window⑧">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" id="ref-for-concept-document-window⑤">associated document</a> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#fully-active" id="ref-for-fully-active④">fully active</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with④⑥">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑥①">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window⑨">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object①①">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>realm</var> be the <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm⑦">current realm</a>.</p>
     <li data-md>
      <p>Let <var>databaseMap</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-bottle-map" id="ref-for-obtain-a-shared-storage-bottle-map⑥">obtain a shared storage bottle map</a> given <var>environment</var> and <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object⑧">settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin①⑦">origin</a>.</p>
     <li data-md>
      <p>If <var>databaseMap</var> is failure, then return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with④⑦">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑥②">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database①④">database</a>'s <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①④">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps⑥">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>If the result of running <a data-link-type="dfn" href="#shared-storage-database-delete-an-entry-from-the-database" id="ref-for-shared-storage-database-delete-an-entry-from-the-database②">delete an entry from the database</a> with <var>queue</var>, <var>environment</var>, and <var>key</var> is false, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task①⑧">queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source①⑧">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global①⑤">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject①①">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑥③">TypeError</a></code>.</p>
       <li data-md>
        <p>Otherwise, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task①⑨">queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source①⑨">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global①⑥">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve①⑦">resolve</a> <var>promise</var> with undefined.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="clear()" data-algorithm-for="WorkletSharedStorage">
     The <dfn class="idl-code" data-dfn-for="WorkletSharedStorage" data-dfn-type="method" data-export id="dom-workletsharedstorage-clear"><code>clear()</code><a class="self-link" href="#dom-workletsharedstorage-clear"></a></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise②④">promise</a>.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-check-whether-addmodule-is-finished" id="ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished⑤">check whether addModule is finished</a> for <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage①②">WorkletSharedStorage</a></code>'s associated <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope②④">SharedStorageWorkletGlobalScope</a></code> is false, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with④⑧">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑥④">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage①③">WorkletSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope②⑤">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-outside-settings" id="ref-for-sharedstorageworkletglobalscope-outside-settings③">outside settings</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context" id="ref-for-concept-environment-target-browsing-context③">target browsing context</a>.</p>
     <li data-md>
      <p>If <var>context</var> is null, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with④⑨">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑥⑤">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window①⓪">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" id="ref-for-concept-document-window⑥">associated document</a> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#fully-active" id="ref-for-fully-active⑤">fully active</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑤⓪">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑥⑥">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window①①">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object①②">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>realm</var> be the <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm⑧">current realm</a>.</p>
     <li data-md>
      <p>Let <var>databaseMap</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-bottle-map" id="ref-for-obtain-a-shared-storage-bottle-map⑦">obtain a shared storage bottle map</a> given <var>environment</var> and <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object⑨">settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin①⑧">origin</a>.</p>
     <li data-md>
      <p>If <var>databaseMap</var> is failure, then return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑤①">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑥⑦">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database①⑤">database</a>'s <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①⑤">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps⑦">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>If the result of running <a data-link-type="dfn" href="#shared-storage-database-clear-all-entries-in-the-database" id="ref-for-shared-storage-database-clear-all-entries-in-the-database②">clear all entries in the database</a> with <var>queue</var> and <var>environment</var> is false, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task②⓪">queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source②⓪">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global①⑦">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject①②">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑥⑧">TypeError</a></code>.</p>
       <li data-md>
        <p>Otherwise, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task②①">queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source②①">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global①⑧">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve①⑧">resolve</a> <var>promise</var> with undefined.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="4.3.2" id="getter"><span class="secno">4.3.2. </span><span class="content">Getter Methods</span><a class="self-link" href="#getter"></a></h4>
   <div class="algorithm" data-algorithm="get(key)" data-algorithm-for="WorkletSharedStorage">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WorkletSharedStorage" data-dfn-type="method" data-export id="dom-workletsharedstorage-get"><code>get(<var>key</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise②⑤">promise</a>.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-check-whether-addmodule-is-finished" id="ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished⑥">check whether addModule is finished</a> for <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage①④">WorkletSharedStorage</a></code>'s associated <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope②⑥">SharedStorageWorkletGlobalScope</a></code> is false, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑤②">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑥⑨">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>key</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length①⓪">length</a> exceeds the <a data-link-type="dfn" href="#key-maximum-length" id="ref-for-key-maximum-length⑥">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑤③">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑦⓪">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage①⑤">WorkletSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope②⑦">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-outside-settings" id="ref-for-sharedstorageworkletglobalscope-outside-settings④">outside settings</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context" id="ref-for-concept-environment-target-browsing-context④">target browsing context</a>.</p>
     <li data-md>
      <p>If <var>context</var> is null, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑤④">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑦①">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window①②">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" id="ref-for-concept-document-window⑦">associated document</a> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#fully-active" id="ref-for-fully-active⑥">fully active</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑤⑤">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑦②">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window①③">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object①③">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>realm</var> be the <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm⑨">current realm</a>.</p>
     <li data-md>
      <p>Let <var>databaseMap</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-bottle-map" id="ref-for-obtain-a-shared-storage-bottle-map⑧">obtain a shared storage bottle map</a> given <var>environment</var> and <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object①⓪">settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin①⑨">origin</a>.</p>
     <li data-md>
      <p>If <var>databaseMap</var> is failure, then return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑤⑥">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑦③">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database①⑥">database</a>'s <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①⑥">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps⑧">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>value</var> be the result of running <a data-link-type="dfn" href="#shared-storage-database-retrieve-an-entry-from-the-database" id="ref-for-shared-storage-database-retrieve-an-entry-from-the-database⑤">retrieve an entry from the database</a> with <var>queue</var>, <var>databaseMap</var>, <var>environment</var>, and <var>key</var>.</p>
       <li data-md>
        <p>If <var>value</var> is failure, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task②②">queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source②②">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global①⑨">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject①③">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑦④">TypeError</a></code>.</p>
       <li data-md>
        <p>Otherwise, if <var>value</var> is undefined, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task②③">queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source②③">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global②⓪">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve①⑨">resolve</a> <var>promise</var> with undefined.</p>
       <li data-md>
        <p>Otherwise, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task②④">queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source②④">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global②①">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve②⓪">resolve</a> <var>promise</var> with <var>value</var>.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="length()" data-algorithm-for="WorkletSharedStorage">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WorkletSharedStorage" data-dfn-type="method" data-export id="dom-workletsharedstorage-length"><code>length()</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise②⑥">promise</a>.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-check-whether-addmodule-is-finished" id="ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished⑦">check whether addModule is finished</a> for <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage①⑥">WorkletSharedStorage</a></code>'s associated <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope②⑧">SharedStorageWorkletGlobalScope</a></code> is false, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑤⑦">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑦⑤">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage①⑦">WorkletSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope②⑨">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-outside-settings" id="ref-for-sharedstorageworkletglobalscope-outside-settings⑤">outside settings</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context" id="ref-for-concept-environment-target-browsing-context⑤">target browsing context</a>.</p>
     <li data-md>
      <p>If <var>context</var> is null, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑤⑧">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑦⑥">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window①④">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" id="ref-for-concept-document-window⑧">associated document</a> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#fully-active" id="ref-for-fully-active⑦">fully active</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑤⑨">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑦⑦">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window①⑤">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object①④">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>realm</var> be the <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm①⓪">current realm</a>.</p>
     <li data-md>
      <p>Let <var>databaseMap</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-bottle-map" id="ref-for-obtain-a-shared-storage-bottle-map⑨">obtain a shared storage bottle map</a> given <var>environment</var> and <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object①①">settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin②⓪">origin</a>.</p>
     <li data-md>
      <p>If <var>databaseMap</var> is failure, then return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑥⓪">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑦⑧">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database①⑦">database</a>'s <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①⑦">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps⑨">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>numEntries</var> be the result of running <a data-link-type="dfn" href="#shared-storage-database-count-entries-in-the-database" id="ref-for-shared-storage-database-count-entries-in-the-database">count entries in the database</a> with <var>queue</var> and <var>environment</var>.</p>
       <li data-md>
        <p>If <var>numEntries</var> is failure, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task②⑤">queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source②⑤">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global②②">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject①④">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑦⑨">TypeError</a></code>.</p>
       <li data-md>
        <p>Otherwise, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task②⑥">queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source②⑥">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global②③">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve②①">resolve</a> <var>promise</var> with <var>numEntries</var>.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="remainingBudget()" data-algorithm-for="WorkletSharedStorage">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WorkletSharedStorage" data-dfn-type="method" data-export id="dom-workletsharedstorage-remainingbudget"><code>remainingBudget()</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise②⑦">promise</a>.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-check-whether-addmodule-is-finished" id="ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished⑧">check whether addModule is finished</a> for <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage①⑧">WorkletSharedStorage</a></code>'s associated <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope③⓪">SharedStorageWorkletGlobalScope</a></code> is false, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑥①">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑧⓪">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage①⑨">WorkletSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope③①">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-outside-settings" id="ref-for-sharedstorageworkletglobalscope-outside-settings⑥">outside settings</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context" id="ref-for-concept-environment-target-browsing-context⑥">target browsing context</a>.</p>
     <li data-md>
      <p>If <var>context</var> is null, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑥②">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑧①">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window①⑥">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" id="ref-for-concept-document-window⑨">associated document</a> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#fully-active" id="ref-for-fully-active⑧">fully active</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑥③">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑧②">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window①⑦">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object①⑤">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>realm</var> be the <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm①①">current realm</a>.</p>
     <li data-md>
      <p>Let <var>allowedInOpaqueOriginContext</var> be false.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#determine-whether-shared-storage-is-allowed-by-context" id="ref-for-determine-whether-shared-storage-is-allowed-by-context⑤">determine whether shared storage is allowed by context</a> given <var>environment</var>, <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object①②">settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin②①">origin</a>, and <var>allowedInOpaqueOriginContext</var> is false, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑥④">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑧③">TypeError</a></code>.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#check-if-user-preference-setting-allows-access-to-shared-storage" id="ref-for-check-if-user-preference-setting-allows-access-to-shared-storage⑤">check if user preference setting allows access to shared storage</a> given <var>environment</var> and <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object①③">settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin②②">origin</a> is false, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑥⑤">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑧④">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>site</var> be the result of running <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#obtain-a-site" id="ref-for-obtain-a-site③">obtain a site</a> with <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object①④">settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin②③">origin</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert①⑥">Assert</a>: <var>site</var> is not an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque" id="ref-for-concept-origin-opaque④">opaque origin</a>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database①⑧">database</a>'s <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①⑧">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps①⓪">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>remainingBudget</var> be the result of running <a data-link-type="dfn" href="#determine-remaining-navigation-budget" id="ref-for-determine-remaining-navigation-budget①">determine remaining navigation budget</a> with <var>site</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve②②">Resolve</a> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task②⑦">queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source②⑦">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global②④">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve②③">resolve</a> <var>promise</var> with <var>remainingBudget</var>.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="4.3.3" id="iteration"><span class="secno">4.3.3. </span><span class="content">Iteration</span><a class="self-link" href="#iteration"></a></h4>
   <p>Each <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage②⓪">WorkletSharedStorage</a></code> <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-async-iterable" id="ref-for-idl-async-iterable">async iterator</a> instance has a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#queue" id="ref-for-queue">queue</a> <dfn class="dfn-paneled" data-dfn-for="WorkletSharedStorageIterator" data-dfn-type="dfn" data-noexport id="workletsharedstorageiterator-pending-entries">pending entries</dfn> of <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry⑤">entries</a>, initially <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-empty" id="ref-for-list-empty②">empty</a>.</p>
   <p>Each <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage②①">WorkletSharedStorage</a></code> <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-async-iterable" id="ref-for-idl-async-iterable①">async iterator</a> instance also has a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean③">boolean</a></code> <dfn class="dfn-paneled" data-dfn-for="WorkletSharedStorageIterator" data-dfn-type="dfn" data-noexport id="workletsharedstorageiterator-error">error</dfn>, initially false.</p>
   <p>The <a data-link-type="dfn" href="#workletsharedstorageiterator-asynchronous-iterator-initialization-steps" id="ref-for-workletsharedstorageiterator-asynchronous-iterator-initialization-steps">asynchronous iterator initialization steps</a> and <a data-link-type="dfn" href="#workletsharedstorageiterator-get-the-next-iteration-result" id="ref-for-workletsharedstorageiterator-get-the-next-iteration-result">get the next iteration result</a> algorithms defined below correspond to those referred to as the <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#asynchronous-iterator-initialization-steps" id="ref-for-asynchronous-iterator-initialization-steps">asynchronous iterator initialization steps</a> and <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-get-the-next-iteration-result" id="ref-for-dfn-get-the-next-iteration-result">get the next iteration result</a> algorithms in the <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#introduction" id="ref-for-introduction">Web IDL Standard</a>.</p>
   <div class="algorithm" data-algorithm="asynchronous iterator initialization steps" data-algorithm-for="WorkletSharedStorageIterator">
     The <dfn class="dfn-paneled" data-dfn-for="WorkletSharedStorageIterator" data-dfn-type="dfn" data-noexport id="workletsharedstorageiterator-asynchronous-iterator-initialization-steps">asynchronous iterator initialization steps</dfn> for a <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage②②">WorkletSharedStorage</a></code> <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-async-iterable" id="ref-for-idl-async-iterable②">async iterator</a> <var>iterator</var> are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise②⑧">promise</a>.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-check-whether-addmodule-is-finished" id="ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished⑨">check whether addModule is finished</a> for <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage②③">WorkletSharedStorage</a></code>'s associated <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope③②">SharedStorageWorkletGlobalScope</a></code> is false, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑥⑥">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑧⑤">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage②④">WorkletSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope③③">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-outside-settings" id="ref-for-sharedstorageworkletglobalscope-outside-settings⑦">outside settings</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context" id="ref-for-concept-environment-target-browsing-context⑦">target browsing context</a>.</p>
     <li data-md>
      <p>If <var>context</var> is null, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑥⑦">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑧⑥">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window①⑧">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" id="ref-for-concept-document-window①⓪">associated document</a> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#fully-active" id="ref-for-fully-active⑨">fully active</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑥⑧">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑧⑦">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window" id="ref-for-nav-window①⑨">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object①⑥">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>realm</var> be the <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm①②">current realm</a>.</p>
     <li data-md>
      <p>Let <var>databaseMap</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-bottle-map" id="ref-for-obtain-a-shared-storage-bottle-map①⓪">obtain a shared storage bottle map</a> given <var>environment</var> and <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object①⑤">settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin②④">origin</a>.</p>
     <li data-md>
      <p>If <var>databaseMap</var> is failure, then return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑥⑨">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑧⑧">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database①⑨">database</a>'s <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①⑨">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps①①">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>entries</var> be the result of running <a data-link-type="dfn" href="#shared-storage-database-retrieve-all-entries-from-the-database" id="ref-for-shared-storage-database-retrieve-all-entries-from-the-database">retrieve all entries from the database</a> with <var>queue</var> and <var>environment</var>.</p>
       <li data-md>
        <p>If <var>entries</var> is failure, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task②⑧">queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source②⑧">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global②⑤">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject①⑤">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑧⑨">TypeError</a></code>.</p>
       <li data-md>
        <p>Otherwise, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task②⑨">queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source②⑨">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global②⑥">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve②④">resolve</a> <var>promise</var> with <var>entries</var>.</p>
      </ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#upon-fulfillment" id="ref-for-upon-fulfillment②">Upon fulfillment</a> of <var>promise</var>, run the following:</p>
      <ol>
       <li data-md>
        <p>Let <var>promiseEntries</var> be the value of <var>promise</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate" id="ref-for-map-iterate⑦">For each</a> <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry⑥">entry</a> <var>entry</var> in <var>promiseEntries</var>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#queue-enqueue" id="ref-for-queue-enqueue">enqueue</a> <var>entry</var> in <var>iterator</var>’s <a data-link-type="dfn" href="#workletsharedstorageiterator-pending-entries" id="ref-for-workletsharedstorageiterator-pending-entries">pending entries</a>.</p>
      </ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#upon-rejection" id="ref-for-upon-rejection②">Upon rejection</a> of <var>promise</var>, set <var>iterator</var>’s <a data-link-type="dfn" href="#workletsharedstorageiterator-error" id="ref-for-workletsharedstorageiterator-error">error</a> to true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="get the next iteration result" data-algorithm-for="WorkletSharedStorageIterator">
     To<dfn class="dfn-paneled" data-dfn-for="WorkletSharedStorageIterator" data-dfn-type="dfn" data-noexport id="workletsharedstorageiterator-get-the-next-iteration-result">get the next iteration result</dfn>, given a <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage②⑤">WorkletSharedStorage</a></code>'s <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-async-iterable" id="ref-for-idl-async-iterable③">async iterator</a> <var>iterator</var>, run the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise②⑨">promise</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps①②">Enqueue the following steps</a>:</p>
      <ol>
       <li data-md>
        <p>If <var>iterator</var>’s <a data-link-type="dfn" href="#workletsharedstorageiterator-error" id="ref-for-workletsharedstorageiterator-error①">error</a> is true, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑦⓪">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑨⓪">TypeError</a></code>.</p>
       <li data-md>
        <p>If <var>iterator</var>’s <a data-link-type="dfn" href="#workletsharedstorageiterator-pending-entries" id="ref-for-workletsharedstorageiterator-pending-entries①">pending entries</a> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-empty" id="ref-for-list-empty③">empty</a>:</p>
        <ol>
         <li data-md>
          <p>Create an object <var>doneObject</var>.</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task③⓪">Queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source③⓪">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global②⑦">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve②⑤">resolve</a> <var>promise</var> with <var>doneObject</var>.</p>
         <li data-md>
          <p>Abort these steps.</p>
        </ol>
       <li data-md>
        <p>Otherwise, let <var>entry</var> be the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#queue-dequeue" id="ref-for-queue-dequeue">dequeueing</a> from <var>iterator</var>’s <a data-link-type="dfn" href="#workletsharedstorageiterator-pending-entries" id="ref-for-workletsharedstorageiterator-pending-entries②">pending entries</a>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task③①">Queue a global task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" id="ref-for-dom-manipulation-task-source③①">DOM manipulation task source</a>, given <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global②⑧">global object</a>, to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve②⑥">resolve</a> <var>promise</var> with <var>entry</var>.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="5" id="http"><span class="secno">5. </span><span class="content">Triggering Operations Via HTTP Response Header</span><a class="self-link" href="#http"></a></h2>
   <p>While setter and deleter operations (e.g.. <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-set" id="ref-for-dom-windowsharedstorage-set">set()</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-append" id="ref-for-dom-windowsharedstorage-append">append()</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-delete" id="ref-for-dom-windowsharedstorage-delete">delete()</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-clear" id="ref-for-dom-windowsharedstorage-clear">clear()</a></code>) can be initiated via the above APIs for <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window②②">Window</a></code> or <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope③④">SharedStorageWorkletGlobalScope</a></code>, setter/deleter operations can alternatively be triggered via HTTP <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response">response</a> <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header" id="ref-for-concept-header">header</a>.</p>
   <p>This will require monkey patches to the HTML and Fetch specifications.</p>
   <h2 class="heading settled" data-level="6" id="html-monkeypatches"><span class="secno">6. </span><span class="content">HTML Monkey Patches</span><a class="self-link" href="#html-monkeypatches"></a></h2>
   <h3 class="heading settled" data-level="6.1" id="html-attr"><span class="secno">6.1. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#dom-htmlsharedstoragewritableelementutils-sharedstoragewritable" id="ref-for-dom-htmlsharedstoragewritableelementutils-sharedstoragewritable">sharedStorageWritable</a></code> &amp; <code><a data-link-type="element-sub" href="#element-attrdef-iframe-sharedstoragewritable" id="ref-for-element-attrdef-iframe-sharedstoragewritable">sharedstoragewritable</a></code> Attributes</span><a class="self-link" href="#html-attr"></a></h3>
   <p>Define the following <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#interface-mixin" id="ref-for-interface-mixin">interface mixin</a> and include it in the IDL <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-interface" id="ref-for-dfn-interface">interfaces</a> for <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#htmliframeelement" id="ref-for-htmliframeelement">HTMLIFrameElement</a></code> and <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#htmlimageelement" id="ref-for-htmlimageelement">HTMLImageElement</a></code>:</p>
<pre class="idl highlight def"><c- b>interface</c-> <c- b>mixin</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="htmlsharedstoragewritableelementutils"><code><c- g>HTMLSharedStorageWritableElementUtils</c-></code></dfn> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactions"><c- g>CEReactions</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext①"><c- g>SecureContext</c-></a>] <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean④"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="HTMLSharedStorageWritableElementUtils" data-dfn-type="attribute" data-export data-type="boolean" id="dom-htmlsharedstoragewritableelementutils-sharedstoragewritable"><code><c- g>sharedStorageWritable</c-></code></dfn>;
};

<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#htmliframeelement" id="ref-for-htmliframeelement①"><c- n>HTMLIFrameElement</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="#htmlsharedstoragewritableelementutils" id="ref-for-htmlsharedstoragewritableelementutils"><c- n>HTMLSharedStorageWritableElementUtils</c-></a>;
<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/embedded-content.html#htmlimageelement" id="ref-for-htmlimageelement①"><c- n>HTMLImageElement</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="#htmlsharedstoragewritableelementutils" id="ref-for-htmlsharedstoragewritableelementutils①"><c- n>HTMLSharedStorageWritableElementUtils</c-></a>;
</pre>
   <p>Add the following <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#boolean-attributes" id="ref-for-boolean-attributes">boolean content attributes</a>:</p>
   <dl>
    <dt data-md><code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element" id="ref-for-the-iframe-element">iframe</a></code>
    <dd data-md>
     <p><dfn class="dfn-paneled" data-dfn-for="iframe" data-dfn-type="element-attr" data-export id="element-attrdef-iframe-sharedstoragewritable"><code>sharedstoragewritable</code></dfn></p>
    <dt data-md><code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element" id="ref-for-the-img-element">img</a></code>
    <dd data-md>
     <p><dfn class="dfn-paneled" data-dfn-for="img" data-dfn-type="element-attr" data-export id="element-attrdef-img-sharedstoragewritable"><code>sharedstoragewritable</code></dfn></p>
   </dl>
   <p>The IDL attribute <code class="idl"><a data-link-type="idl" href="#dom-htmlsharedstoragewritableelementutils-sharedstoragewritable" id="ref-for-dom-htmlsharedstoragewritableelementutils-sharedstoragewritable①">sharedStorageWritable</a></code> must <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-dom-interfaces.html#reflect" id="ref-for-reflect">reflect</a> the respective <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#concept-element-attributes" id="ref-for-concept-element-attributes">content attribute</a> of the same name.</p>
   <h3 class="heading settled" data-level="6.2" id="html-algo"><span class="secno">6.2. </span><span class="content">HTML Algorithm Modifications</span><a class="self-link" href="#html-algo"></a></h3>
   <h4 class="heading settled" data-level="6.2.1" id="mod-update-img"><span class="secno">6.2.1. </span><span class="content">Modification to <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/images.html#update-the-image-data" id="ref-for-update-the-image-data">Update the image data</a> Algorithm</span><a class="self-link" href="#mod-update-img"></a></h4>
   <div class="algorithm" data-algorithm="modification-to-update-the-image-data">
     Modify <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/images.html#update-the-image-data" id="ref-for-update-the-image-data①">update the image data</a> as follows: 
    <p>After the step</p>
    <blockquote>
     <p>Set <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#request-priority" id="ref-for-request-priority">priority</a> to the current state...</p>
    </blockquote>
    <p>add the step</p>
    <ol>
     <li data-md>
      <p>If the element has the <code><a data-link-type="element-sub" href="#element-attrdef-img-sharedstoragewritable" id="ref-for-element-attrdef-img-sharedstoragewritable">sharedstoragewritable</a></code> attribute present, set <var>request</var>’s <a data-link-type="dfn" href="#request-shared-storage-writable" id="ref-for-request-shared-storage-writable">shared storage writable</a> to true.</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="6.2.2" id="mod-create-nav"><span class="secno">6.2.2. </span><span class="content">Modification to <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#create-navigation-params-by-fetchin" id="ref-for-create-navigation-params-by-fetchin">Create navigation params by fetching</a> Algorithm</span><a class="self-link" href="#mod-create-nav"></a></h4>
   <div class="algorithm" data-algorithm="modification-to-create-navigation-params-by-fetching">
     Modify <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#create-navigation-params-by-fetchin" id="ref-for-create-navigation-params-by-fetchin①">create navigation params by fetching</a> as follows: 
    <p>After the step</p>
    <blockquote>
     <p>Let <var>request</var> be a new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-request" id="ref-for-concept-request-request">request</a>, with ...</p>
    </blockquote>
    <p>add the step</p>
    <ol>
     <li data-md>
      <p>If <var>navigable</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-container" id="ref-for-nav-container">container</a> is an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element" id="ref-for-the-iframe-element①">iframe</a></code> element, and if it has a <code><a data-link-type="element-sub" href="#element-attrdef-iframe-sharedstoragewritable" id="ref-for-element-attrdef-iframe-sharedstoragewritable①">sharedstoragewritable</a></code> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#concept-element-attributes" id="ref-for-concept-element-attributes①">content attribute</a>, then set <var>request</var>’s <a data-link-type="dfn" href="#request-shared-storage-writable" id="ref-for-request-shared-storage-writable①">shared storage writable</a> to true.</p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="7" id="fetch-monkeypatches"><span class="secno">7. </span><span class="content">Fetch Monkey Patches</span><a class="self-link" href="#fetch-monkeypatches"></a></h2>
   <h3 class="heading settled" data-level="7.1" id="fetch-attr"><span class="secno">7.1. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#dom-requestinit-sharedstoragewritable" id="ref-for-dom-requestinit-sharedstoragewritable">sharedStorageWritable</a></code> Key</span><a class="self-link" href="#fetch-attr"></a></h3>
   <p>A <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request">request</a> has an associated <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean" id="ref-for-boolean①">boolean</a> <dfn class="dfn-paneled" data-dfn-for="request" data-dfn-type="dfn" data-noexport id="request-shared-storage-writable">shared storage writable</dfn>. Unless stated otherwise it is false.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#requestinit" id="ref-for-requestinit">RequestInit</a></code> dictionary contains a <code class="idl"><a data-link-type="idl" href="#dom-requestinit-sharedstoragewritable" id="ref-for-dom-requestinit-sharedstoragewritable①">sharedStorageWritable</a></code> key:</p>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>dictionary</c-> <a class="idl-code" data-link-type="dictionary" href="https://fetch.spec.whatwg.org/#requestinit" id="ref-for-requestinit①"><c- g>RequestInit</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean⑤"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="RequestInit" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-requestinit-sharedstoragewritable"><code><c- g>sharedStorageWritable</c-></code></dfn>;
};
</pre>
   <h3 class="heading settled" data-level="7.2" id="mod-fetch-algo"><span class="secno">7.2. </span><span class="content">Fetch Algorithm Modifications</span><a class="self-link" href="#mod-fetch-algo"></a></h3>
   <h4 class="heading settled" data-level="7.2.1" id="mod-request-con"><span class="secno">7.2.1. </span><span class="content">Modification to the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#dom-request" id="ref-for-dom-request">Request Constructor</a> Algorithm</span><a class="self-link" href="#mod-request-con"></a></h4>
   <div class="algorithm" data-algorithm="modification-to-request-constructor">
     Modify the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#dom-request" id="ref-for-dom-request①">new Request(input, init) constructor</a> as follows: 
    <p>Before the step</p>
    <blockquote>
     <p>Set this’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-request" id="ref-for-concept-request-request①">request</a> to <var>request</var>.</p>
    </blockquote>
    <p>add the step</p>
    <ol>
     <li data-md>
      <p>If <var>init</var>["<code class="idl"><a data-link-type="idl" href="#dom-requestinit-sharedstoragewritable" id="ref-for-dom-requestinit-sharedstoragewritable②">sharedStorageWritable</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists⑦">exists</a>, then set <var>request</var>’s <a data-link-type="dfn" href="#request-shared-storage-writable" id="ref-for-request-shared-storage-writable②">shared storage writable</a> to it.</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="7.2.2" id="mod-http-net-fetch"><span class="secno">7.2.2. </span><span class="content">Modification to <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-http-network-or-cache-fetch" id="ref-for-concept-http-network-or-cache-fetch">HTTP network or cache fetch</a> Algorithm</span><a class="self-link" href="#mod-http-net-fetch"></a></h4>
   <div class="algorithm" data-algorithm="modification-to-http-network-or-cache-fetch">
     Modify the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-http-network-or-cache-fetch" id="ref-for-concept-http-network-or-cache-fetch①">HTTP network or cache fetch</a> algorithm as follows: 
    <p>Before the step</p>
    <blockquote>
     <p>Modify <var>httpRequest</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-header-list" id="ref-for-concept-request-header-list">header list</a> per HTTP. ...</p>
    </blockquote>
    <p>add the step</p>
    <ol>
     <li data-md>
      <p><a data-link-type="dfn" href="#append-or-modify-a-sec-shared-storage-writable-request-header" id="ref-for-append-or-modify-a-sec-shared-storage-writable-request-header">Append or modify a Sec-Shared-Storage-Writable request header</a> for <var>httpRequest</var>.</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="7.2.3" id="mod-http-fetch"><span class="secno">7.2.3. </span><span class="content">Modification to <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-http-fetch" id="ref-for-concept-http-fetch②">HTTP fetch</a> Algorithm</span><a class="self-link" href="#mod-http-fetch"></a></h4>
   <div class="algorithm" data-algorithm="modification-to-http-fetch">
     Modify the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-http-fetch" id="ref-for-concept-http-fetch③">HTTP fetch</a> algorithm as follows: 
    <p>Before the step</p>
    <blockquote>
     <p>If <var>internalResponse</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-status" id="ref-for-concept-response-status">status</a> is a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#redirect-status" id="ref-for-redirect-status">redirect status</a>: ...</p>
    </blockquote>
    <p>add the step</p>
    <ol>
     <li data-md>
      <p><a data-link-type="dfn" href="#handle-a-shared-storage-write-response" id="ref-for-handle-a-shared-storage-write-response">Handle a Shared-Storage-Write response</a>, given <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①">response</a> <var>internalResponse</var> and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①">request</a> <var>request</var> as input.</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="7.3" id="headers"><span class="secno">7.3. </span><span class="content">Shared Storage HTTP Headers</span><a class="self-link" href="#headers"></a></h3>
   <h4 class="heading settled" data-level="7.3.1" id="request-header"><span class="secno">7.3.1. </span><span class="content"><span>`<code><a data-link-type="http-header" href="#http-headerdef-sec-shared-storage-writable" id="ref-for-http-headerdef-sec-shared-storage-writable">Sec-Shared-Storage-Writable</a></code>`</span> Request Header</span><a class="self-link" href="#request-header"></a></h4>
   <p>This specification defines a <dfn class="dfn-paneled" data-dfn-type="http-header" data-export id="http-headerdef-sec-shared-storage-writable">Sec-Shared-Storage-Writable</dfn> HTTP <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②">request</a> <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header" id="ref-for-concept-header①">header</a>.</p>
   <p>The <span>`<code><a data-link-type="http-header" href="#http-headerdef-sec-shared-storage-writable" id="ref-for-http-headerdef-sec-shared-storage-writable①">Sec-Shared-Storage-Writable</a></code>`</span> <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③">request</a> <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header" id="ref-for-concept-header②">header</a> is a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#specify" id="ref-for-specify">Structured Header</a> whose value must be a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#boolean" id="ref-for-boolean②">Boolean</a>.</p>
   <p>When a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request④">request</a> sets <span>`<code><a data-link-type="http-header" href="#http-headerdef-sec-shared-storage-writable" id="ref-for-http-headerdef-sec-shared-storage-writable②">Sec-Shared-Storage-Writable</a></code>`</span> to true its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②">response</a> will be able to write to <a data-link-type="dfn" href="#shared-storage" id="ref-for-shared-storage④">shared storage</a>.</p>
   <h4 class="heading settled" data-level="7.3.2" id="response-header"><span class="secno">7.3.2. </span><span class="content"><span>`<code><a data-link-type="http-header" href="#http-headerdef-shared-storage-write" id="ref-for-http-headerdef-shared-storage-write">Shared-Storage-Write</a></code>`</span> Response Header</span><a class="self-link" href="#response-header"></a></h4>
   <p>This specification defines a <dfn class="dfn-paneled" data-dfn-type="http-header" data-export id="http-headerdef-shared-storage-write">Shared-Storage-Write</dfn> HTTP <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response③">response</a> <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header" id="ref-for-concept-header③">header</a>.</p>
   <p>The <span>`<code><a data-link-type="http-header" href="#http-headerdef-shared-storage-write" id="ref-for-http-headerdef-shared-storage-write①">Shared-Storage-Write</a></code>`</span> <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response④">response</a> <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header" id="ref-for-concept-header④">header</a> is a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#specify" id="ref-for-specify①">Structured Header</a> whose value must be a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#list" id="ref-for-list⑦">List</a>. The following list members are defined. <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#token" id="ref-for-token">Tokens</a> and <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#string" id="ref-for-string①⓪">Strings</a> holding the same sequence of characters are considered equivalent. <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#binary" id="ref-for-binary">Byte Sequences</a> representing <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-encode" id="ref-for-utf-8-encode">UTF-8 encoded</a> bytes are also allowed, in order to provide functionality for writing and deleting non-<a data-link-type="dfn" href="https://infra.spec.whatwg.org#ascii-code-point" id="ref-for-ascii-code-point">ASCII</a> <a data-link-type="dfn" href="https://w3c.github.io/i18n-glossary/#dfn-unicode" id="ref-for-dfn-unicode">Unicode</a> keys and values via HTTP headers.</p>
   <p>Unknown list members, including types that are neither strings nor <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#binary" id="ref-for-binary①">Byte Sequences</a>, are skipped, and the rest of the list is processed as if they weren’t present. Members are also skipped if they’re missing required <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#param" id="ref-for-param">parameters</a> or those parameters have unexpected types.</p>
   <ul>
    <li data-md>
     <p><code>set</code></p>
     <ul>
      <li data-md>
       <p>Required <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#param" id="ref-for-param①">parameters</a>:</p>
       <ul>
        <li data-md>
         <p><code>key</code> (<a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#token" id="ref-for-token①">Token</a>, <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#string" id="ref-for-string①①">String</a>, or <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#binary" id="ref-for-binary②">Byte Sequence</a>)</p>
        <li data-md>
         <p><code>value</code> (<a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#token" id="ref-for-token②">Token</a>, <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#string" id="ref-for-string①②">String</a>, or <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#binary" id="ref-for-binary③">Byte Sequence</a>)</p>
       </ul>
      <li data-md>
       <p>Optional <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#param" id="ref-for-param②">parameter</a>:</p>
       <ul>
        <li data-md>
         <p><code>ignore_if_present</code> (<a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#boolean" id="ref-for-boolean③">Boolean</a>)</p>
       </ul>
      <li data-md>
       <p>If the <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#param" id="ref-for-param③">parameter</a> value of <code>ignore_if_present</code> is null or false, or if the <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#param" id="ref-for-param④">parameter</a> value of <code>key</code> does not already exist in the <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database②⓪">shared storage database</a> for the responding server’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin⑥">origin</a>, <code>set</code> writes the <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry⑦">entry</a> consisting of the <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#param" id="ref-for-param⑤">parameter</a> values for <code>key</code> and <code>value</code>, as the <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry⑧">entry</a>'s <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key⑧">key</a> and <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry⑨">entry</a>'s <a data-link-type="dfn" href="#entry-value-struct" id="ref-for-entry-value-struct③">value struct</a>'s <a data-link-type="dfn" href="#value-struct-value" id="ref-for-value-struct-value④">value</a> respectively, in the <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database②①">shared storage database</a> for the responding server’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin⑦">origin</a>.</p>
      <li data-md>
       <p>If the <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#param" id="ref-for-param⑥">parameter</a> value of <code>ignore_if_present</code> is true and the <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#param" id="ref-for-param⑦">parameter</a> value of <code>key</code> already exists in the <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database②②">shared storage database</a> for the responding server’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin⑧">origin</a>, then <code>set</code> is a no-op.</p>
     </ul>
    <li data-md>
     <p><code>append</code></p>
     <ul>
      <li data-md>
       <p>Required <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#param" id="ref-for-param⑧">parameters</a>:</p>
       <ul>
        <li data-md>
         <p><code>key</code> (<a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#token" id="ref-for-token③">Token</a>, <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#string" id="ref-for-string①③">String</a>, or <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#binary" id="ref-for-binary④">Byte Sequence</a>)</p>
        <li data-md>
         <p><code>value</code> (<a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#token" id="ref-for-token④">Token</a>, <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#string" id="ref-for-string①④">String</a>, or <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#binary" id="ref-for-binary⑤">Byte Sequence</a>)</p>
       </ul>
      <li data-md>
       <p>If the <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#param" id="ref-for-param⑨">parameter</a> value of <code>key</code> already exists in the <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database②③">shared storage database</a> for the responding server’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin⑨">origin</a>, then <code>append</code> updates the <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key⑨">key</a>'s <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry①⓪">entry</a>'s <a data-link-type="dfn" href="#entry-value-struct" id="ref-for-entry-value-struct④">value struct</a>'s <a data-link-type="dfn" href="#value-struct-value" id="ref-for-value-struct-value⑤">value</a> by appending the <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#param" id="ref-for-param①⓪">parameter</a> value for <code>value</code> to it.</p>
      <li data-md>
       <p>If the <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#param" id="ref-for-param①①">parameter</a> value of <code>key</code> does not already exist in the <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database②④">shared storage database</a> for the responding server’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin①⓪">origin</a>, <code>append</code> is equivalent to <code>set</code> with <code>ignore_if_present</code> false, i.e. <code>append</code> writes the <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry①①">entry</a> consisting of the <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#param" id="ref-for-param①②">parameter</a> values for <code>key</code> and <code>value</code>, as the <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry①②">entry</a>'s <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key①⓪">key</a> and <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry①③">entry</a>'s <a data-link-type="dfn" href="#entry-value-struct" id="ref-for-entry-value-struct⑤">value struct</a>'s <a data-link-type="dfn" href="#value-struct-value" id="ref-for-value-struct-value⑥">value</a> respectively, in the <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database②⑤">shared storage database</a> for the responding server’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin①①">origin</a>.</p>
     </ul>
    <li data-md>
     <p><code>delete</code></p>
     <ul>
      <li data-md>
       <p>Required <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#param" id="ref-for-param①③">parameter</a>:</p>
       <ul>
        <li data-md>
         <p><code>key</code> (<a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#token" id="ref-for-token⑤">Token</a>, <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#string" id="ref-for-string①⑤">String</a>, or <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#binary" id="ref-for-binary⑥">Byte Sequence</a>)</p>
       </ul>
      <li data-md>
       <p><code>delete</code> erases any <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry①④">entry</a> in the <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database②⑥">shared storage database</a> for the responding server’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin①②">origin</a> for which the <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key①①">key</a> is equal to the <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#param" id="ref-for-param①④">parameter</a> value of <code>key</code>.</p>
     </ul>
    <li data-md>
     <p><code>clear</code></p>
     <ul>
      <li data-md>
       <p><code>clear</code> erases all <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry①⑤">entries</a> in the <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database②⑦">shared storage database</a> for the responding server’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin①③">origin</a>.</p>
     </ul>
   </ul>
   <p class="note" role="note"><span class="marker">Note:</span> We allow <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#binary" id="ref-for-binary⑦">Byte Sequences</a> in order to accommodate Unicode keys and values. Any <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#binary" id="ref-for-binary⑧">Byte Sequence</a> will be assumed to be <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-encode" id="ref-for-utf-8-encode①">UTF-8 encoded</a> and will fail to parse otherwise.</p>
   <p><span class="todo">Add examples.</span></p>
   <h3 class="heading settled" data-level="7.4" id="ss-fetch-algo"><span class="secno">7.4. </span><span class="content">Shared Storage Fetch-Related Algorithms</span><a class="self-link" href="#ss-fetch-algo"></a></h3>
   <div class="algorithm" data-algorithm="determine whether a request can currently use shared storage">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="determine-whether-a-request-can-currently-use-shared-storage">determine whether a request can currently use shared storage</dfn>, given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑤">request</a> <var>request</var>, perform the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>window</var> to <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-window" id="ref-for-concept-request-window①">window</a>.</p>
     <li data-md>
      <p>If <var>window</var> is not an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object①④">environment settings object</a> whose <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global②⑨">global object</a> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window②③">Window</a></code>, return false.</p>
     <li data-md>
      <p>Let <var>allowedInOpaqueOriginContext</var> be true.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#determine-whether-shared-storage-is-allowed-by-context" id="ref-for-determine-whether-shared-storage-is-allowed-by-context⑥">determine whether shared storage is allowed by context</a> given <var>window</var>, <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url①">current URL</a>'s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin⑧">origin</a>, and <var>allowedInOpaqueOriginContext</var> is false, return false.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#check-if-user-preference-setting-allows-access-to-shared-storage" id="ref-for-check-if-user-preference-setting-allows-access-to-shared-storage⑥">check if user preference setting allows access to shared storage</a> given <var>window</var> and <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url②">current URL</a>'s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin⑨">origin</a> is false, return false.</p>
    </ol>
    <p class="issue" id="issue-9d2a534a"><a class="self-link" href="#issue-9d2a534a"></a> The <a data-link-type="dfn" href="#determine-whether-a-request-can-currently-use-shared-storage" id="ref-for-determine-whether-a-request-can-currently-use-shared-storage">determine whether a request can currently use shared storage</a> algorithm needs to take into account "opt-in features", as articulated in <a href="https://github.com/w3c/webappsec-permissions-policy/pull/499">https://github.com/w3c/webappsec-permissions-policy/pull/499</a>.</p>
   </div>
   <div class="algorithm" data-algorithm="append or modify a Sec-Shared-Storage-Writable request header">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="append-or-modify-a-sec-shared-storage-writable-request-header">append or modify a Sec-Shared-Storage-Writable request header</dfn>, given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑥">request</a> <var>request</var>, perform the following steps: 
    <ol>
     <li data-md>
      <p>If <var>request</var>’s <a data-link-type="dfn" href="#request-shared-storage-writable" id="ref-for-request-shared-storage-writable③">shared storage writable</a> is not true, then return.</p>
      <p class="note" role="note"><span class="marker">Note:</span> On a redirect, it is possible for <var>request</var>’s <a data-link-type="dfn" href="#request-shared-storage-writable" id="ref-for-request-shared-storage-writable④">shared storage writable</a> to be true, but for the redirect not to have permission to use shared storage, making the result of running <a data-link-type="dfn" href="#determine-whether-a-request-can-currently-use-shared-storage" id="ref-for-determine-whether-a-request-can-currently-use-shared-storage①">determine whether a request can currently use shared storage</a> on <var>request</var> false.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#determine-whether-a-request-can-currently-use-shared-storage" id="ref-for-determine-whether-a-request-can-currently-use-shared-storage②">determine whether a request can currently use shared storage</a> on <var>request</var> is false, <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-delete" id="ref-for-concept-header-list-delete">delete</a> <span>`<code><a data-link-type="http-header" href="#http-headerdef-sec-shared-storage-writable" id="ref-for-http-headerdef-sec-shared-storage-writable③">Sec-Shared-Storage-Writable</a></code>`</span> from <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-header-list" id="ref-for-concept-request-header-list①">header list</a>.</p>
     <li data-md>
      <p>Otherwise, <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-set-structured-header" id="ref-for-concept-header-list-set-structured-header">set a structured field value</a> (<span>`<code><a data-link-type="http-header" href="#http-headerdef-sec-shared-storage-writable" id="ref-for-http-headerdef-sec-shared-storage-writable④">Sec-Shared-Storage-Writable</a></code>`</span>, true) in <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-header-list" id="ref-for-concept-request-header-list②">header list</a>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="handle a Shared-Storage-Write response">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-a-shared-storage-write-response">handle a Shared-Storage-Write response</dfn>, given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response⑤">response</a> <var>response</var> and a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑦">request</a> <var>request</var>, perform the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>sharedStorageWritable</var> the result of running <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-get-structured-header" id="ref-for-concept-header-list-get-structured-header①">get a structured field value</a> algorithm given <span>`<code><a data-link-type="http-header" href="#http-headerdef-sec-shared-storage-writable" id="ref-for-http-headerdef-sec-shared-storage-writable⑤">Sec-Shared-Storage-Writable</a></code>`</span>, "<code>item</code>", and <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-header-list" id="ref-for-concept-request-header-list③">header list</a> as input.</p>
     <li data-md>
      <p>If <var>sharedStorageWritable</var> is null, or <var>sharedStorageWritable</var> is not a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#boolean" id="ref-for-boolean④">Boolean</a>, or the value of <var>sharedStorageWritable</var> is false, return.</p>
     <li data-md>
      <p>Let <var>window</var> to <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-window" id="ref-for-concept-request-window②">window</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert①⑦">Assert</a>: <var>window</var> is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object①⑤">environment settings object</a> whose <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global③⓪">global object</a> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window②④">Window</a></code>.</p>
     <li data-md>
      <p>Let <var>sharedStorage</var> be <var>window</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global③①">global object</a>'s <code class="idl"><a data-link-type="idl" href="#dom-window-sharedstorage" id="ref-for-dom-window-sharedstorage③">sharedStorage</a></code>.</p>
     <li data-md>
      <p>If <var>sharedStorage</var> is null, then return.</p>
     <li data-md>
      <p>Let <var>list</var> be <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list①">header list</a>.</p>
     <li data-md>
      <p>Let <var>operationsToParse</var> be the result of running <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-get-structured-header" id="ref-for-concept-header-list-get-structured-header②">get a structured field value</a> algorithm given <span>`<code><a data-link-type="http-header" href="#http-headerdef-shared-storage-write" id="ref-for-http-headerdef-shared-storage-write②">Shared-Storage-Write</a></code>`</span>, "<code>list</code>", and <var>list</var> as input.</p>
     <li data-md>
      <p>If <var>operationsToParse</var> is null or <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-empty" id="ref-for-list-empty④">empty</a>, then return.</p>
     <li data-md>
      <p>For each tuple (<var>item</var>, <var>parameters</var>) in <var>operationsToParse</var>, perform the following steps:</p>
      <ol>
       <li data-md>
        <p>If <var>item</var> is an <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#inner-list" id="ref-for-inner-list">Inner List</a>, continue.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert①⑧">Assert</a>: <var>item</var> is an <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#item" id="ref-for-item">Bare Item</a>.</p>
       <li data-md>
        <p>Let <var>operationString</var> be the result of running <a data-link-type="dfn" href="#get-the-string-value" id="ref-for-get-the-string-value">get the string value</a> for <var>item</var>.</p>
       <li data-md>
        <p>If <var>operationString</var> is failure, continue.</p>
       <li data-md>
        <p>Switch on <var>operationString</var>:</p>
        <dl class="switch">
         <dt> If <var>operationString</var> is "<code>clear</code>": 
         <dd>
           Perform the following steps: 
          <ol>
           <li data-md>
            <p>Run <a data-link-type="dfn" href="#windowsharedstorage-clear-all-keys" id="ref-for-windowsharedstorage-clear-all-keys①">clear all keys</a> on <var>sharedStorage</var>.</p>
           <li data-md>
            <p>Continue.</p>
          </ol>
         <dt> If <var>operationString</var> is "<code>delete</code>": 
         <dd>
           Perform the following steps: 
          <ol>
           <li data-md>
            <p>Let <var>key</var> be the result of running <a data-link-type="dfn" href="#obtain-a-string-like-parameter-value" id="ref-for-obtain-a-string-like-parameter-value">obtain a string-like parameter value</a> with <var>parameters</var> and "<code>key</code>".</p>
           <li data-md>
            <p>If <var>key</var> is not null, run <a data-link-type="dfn" href="#windowsharedstorage-delete-a-key" id="ref-for-windowsharedstorage-delete-a-key①">delete a key</a> on <var>sharedStorage</var> with <var>key</var>.</p>
           <li data-md>
            <p>Continue.</p>
          </ol>
         <dt> If <var>operationString</var> is "<code>append</code>": 
         <dd>
           Perform the following steps: 
          <ol>
           <li data-md>
            <p>Let <var>key</var> be the result of running <a data-link-type="dfn" href="#obtain-a-string-like-parameter-value" id="ref-for-obtain-a-string-like-parameter-value①">obtain a string-like parameter value</a> with <var>parameters</var> and "<code>key</code>".</p>
           <li data-md>
            <p>If <var>key</var> is null, continue.</p>
           <li data-md>
            <p>Let <var>value</var> be the result of running <a data-link-type="dfn" href="#obtain-a-string-like-parameter-value" id="ref-for-obtain-a-string-like-parameter-value②">obtain a string-like parameter value</a> with <var>parameters</var> and "<code>value</code>".</p>
           <li data-md>
            <p>If <var>value</var> is not null, run <a data-link-type="dfn" href="#windowsharedstorage-append-a-key-value-pair" id="ref-for-windowsharedstorage-append-a-key-value-pair①">append a key-value pair</a> on <var>sharedStorage</var> with <var>key</var> and <var>value</var>.</p>
           <li data-md>
            <p>Continue.</p>
          </ol>
         <dt> If <var>operationString</var> is "<code>set</code>": 
         <dd>
           Perform the following steps: 
          <ol>
           <li data-md>
            <p>Let <var>key</var> be the result of running <a data-link-type="dfn" href="#obtain-a-string-like-parameter-value" id="ref-for-obtain-a-string-like-parameter-value③">obtain a string-like parameter value</a> with <var>parameters</var> and "<code>key</code>".</p>
           <li data-md>
            <p>If <var>key</var> is null, continue.</p>
           <li data-md>
            <p>Let <var>value</var> be the result of running <a data-link-type="dfn" href="#obtain-a-string-like-parameter-value" id="ref-for-obtain-a-string-like-parameter-value④">obtain a string-like parameter value</a> with <var>parameters</var> and "<code>value</code>".</p>
           <li data-md>
            <p>If <var>value</var> is null, continue.</p>
           <li data-md>
            <p>Let <var>options</var> be a new <code class="idl"><a data-link-type="idl" href="#dictdef-sharedstoragesetmethodoptions" id="ref-for-dictdef-sharedstoragesetmethodoptions②">SharedStorageSetMethodOptions</a></code>.</p>
           <li data-md>
            <p>If the result of running <a data-link-type="dfn" href="#obtain-a-boolean-parameter-value" id="ref-for-obtain-a-boolean-parameter-value">obtain a boolean parameter value</a> with <var>parameters</var> and "<code>ignore_if_present</code>" is true, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set③">set</a> <var>options</var>["<code>ignoreIfPresent</code>"] to true..</p>
           <li data-md>
            <p>Run <a data-link-type="dfn" href="#windowsharedstorage-set-a-key-value-pair" id="ref-for-windowsharedstorage-set-a-key-value-pair①">set a key-value pair</a> on <var>sharedStorage</var> with <var>key</var>, <var>value</var>, and <var>options</var>.</p>
           <li data-md>
            <p>Continue.</p>
          </ol>
         <dt> If <var>operationString</var> is anything else: 
         <dd> Continue. 
        </dl>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="check if string-like">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="check-if-string-like">check if string-like</dfn> for a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#item" id="ref-for-item①">Bare Item</a> <var>item</var>, do the following: 
    <ol>
     <li data-md>
      <p>If the <var>item</var> is a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#string" id="ref-for-string①⑥">String</a>, <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#token" id="ref-for-token⑥">Token</a>, or <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#binary" id="ref-for-binary⑨">Byte Sequence</a>, return true.</p>
     <li data-md>
      <p>Otherwise, return false.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="get the string value">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="get-the-string-value">get the string value</dfn> for a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#item" id="ref-for-item②">Bare Item</a> <var>item</var>, do the following: 
    <ol>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#check-if-string-like" id="ref-for-check-if-string-like">check if string-like</a> on <var>item</var> is false, return failure.</p>
     <li data-md>
      <p>Switch on the type of <var>item</var>:</p>
      <dl class="switch">
       <dt> If <var>item</var> is a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#token" id="ref-for-token⑦">Token</a>: 
       <dt> If <var>item</var> is a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#string" id="ref-for-string①⑦">String</a>: 
       <dd>
         Perform the following steps: 
        <ol>
         <li data-md>
          <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert①⑨">Assert</a>: <var>item</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string">ASCII string</a>.</p>
         <li data-md>
          <p>Return <var>item</var>.</p>
        </ol>
       <dt> If <var>item</var> is a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#binary" id="ref-for-binary①⓪">Byte Sequence</a>: 
       <dd>
         Perform the following steps: 
        <ol>
         <li data-md>
          <p>Let <var>fromUTF8</var> be the result of running <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-decode" id="ref-for-utf-8-decode">UTF-8 decode</a> on <var>item</var>.</p>
         <li data-md>
          <p>If <var>fromUTF8</var> is an error, return null.</p>
         <li data-md>
          <p>Return <var>fromUTF8</var>.</p>
        </ol>
      </dl>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="obtain a string-like parameter value">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-a-string-like-parameter-value">obtain a string-like parameter value</dfn>, given a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#param" id="ref-for-param①⑤">parameters map</a> <var>parameters</var> and a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#token" id="ref-for-token⑧">Token</a> <var>paramKey</var>, perform the following steps: 
    <ol>
     <li data-md>
      <p>If <var>parameters</var> does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists⑧">contain</a> <var>paramKey</var>, return null.</p>
     <li data-md>
      <p>If the result of <a data-link-type="dfn" href="#check-if-string-like" id="ref-for-check-if-string-like①">check if string-like</a> for <var>parameters</var>[<var>paramKey</var>] is false, return null.</p>
     <li data-md>
      <p>Return the result of running <a data-link-type="dfn" href="#get-the-string-value" id="ref-for-get-the-string-value①">get the string value</a> for <var>parameters</var>[<var>paramKey</var>].</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="obtain a boolean parameter value">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-a-boolean-parameter-value">obtain a boolean parameter value</dfn>, given a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#param" id="ref-for-param①⑥">parameters map</a> <var>parameters</var> and a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#token" id="ref-for-token⑨">Token</a> <var>paramKey</var>, perform the following steps: 
    <ol>
     <li data-md>
      <p>If <var>parameters</var> does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists⑨">contain</a> <var>paramKey</var>, return null.</p>
     <li data-md>
      <p>If <var>parameters</var>[<var>paramKey</var>] is not a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc8941.html#boolean" id="ref-for-boolean⑤">Boolean</a>, return null.</p>
     <li data-md>
      <p>Return <var>parameters</var>[<var>paramKey</var>].</p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="8" id="permission"><span class="secno">8. </span><span class="content">Permissions Policy Integration</span><a class="self-link" href="#permission"></a></h2>
   <p>This specification defines a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature" id="ref-for-policy-controlled-feature">policy-controlled feature</a> identified by the string "<dfn class="dfn-paneled" data-dfn-for="PermissionsPolicy" data-dfn-type="dfn" data-noexport id="permissionspolicy-shared-storage">shared-storage</dfn>," along with a second <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature" id="ref-for-policy-controlled-feature①">policy-controlled feature</a> identified by "<dfn class="dfn-paneled" data-dfn-for="PermissionsPolicy" data-dfn-type="dfn" data-noexport id="permissionspolicy-shared-storage-select-url">shared-storage-select-url</dfn>".</p>
   <p>"<a data-link-type="dfn" href="#permissionspolicy-shared-storage" id="ref-for-permissionspolicy-shared-storage①">shared-storage</a>" gates access to Shared Storage in general, whereas "<a data-link-type="dfn" href="#permissionspolicy-shared-storage-select-url" id="ref-for-permissionspolicy-shared-storage-select-url①">shared-storage-select-url</a>" adds an exra permission layer to <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworklet-selecturl" id="ref-for-dom-sharedstorageworklet-selecturl②③">selectURL()</a></code>. For each of these, the default allowlist is *.</p>
   <h2 class="heading settled" data-level="9" id="clear"><span class="secno">9. </span><span class="content">Clear Site Data Integration</span><a class="self-link" href="#clear"></a></h2>
    <span class="todo">Add details for Clear Site Data integration.</span> 
   <h2 class="heading settled" data-level="10" id="privacy"><span class="secno">10. </span><span class="content">Privacy Considerations</span><a class="self-link" href="#privacy"></a></h2>
   <p>The Shared Storage API attempts to provide the ability to use cross-site data for a range of use cases in a way that better protects user privacy than the use of third-party cookies. Shared Storage’s main privacy safeguard is that read access of the data stored in its storage may only occur within an embedder’s <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet②③">SharedStorageWorklet</a></code>. Well-defined limits restrict output of data from the <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet②④">SharedStorageWorklet</a></code> to a minimum.</p>
   <p>In particular, an embedder can select a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①②">URL</a> from a short list of <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①③">URL</a>s based on data in their shared storage and then display the result in a <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element⑦">fenced frame</a>. The embedder will not be able to know which <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①④">URL</a> was chosen except through specifc mechanisms that will be better-mitigated in the longer term. Currently, a few bits of entropy can leak each time that the user clicks on the <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element⑧">fenced frame</a> to initiate a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-top" id="ref-for-nav-top①①">top-level traversable</a> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigate③">navigation</a> and/or the <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element⑨">fenced frame</a> calls the <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dom-fence-reportevent" id="ref-for-dom-fence-reportevent⑤">reportEvent()</a></code> API.</p>
   <p>An embedder is also able to send aggregatable reports through the <a data-link-type="dfn" href="https://github.com/patcg-individual-drafts/private-aggregation-api/blob/main/README.md#private-aggregation" id="ref-for-private-aggregation②">Private Aggregation Service</a>, which adds noise in order to achieve differential privacy, uses a time delay to send reports, imposes limits on the number of reports sent, and processes the reports into aggregate data so that individual privacy is protected.</p>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification. </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a> 
    <p>This is an example of an informative example. </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this: </p>
   <p class="note" role="note">Note, this is an informative note.</p>
  </div>
<script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#sharedstorageworklet-addmodule-initiated">addModule initiated</a><span>, in § 2</span>
   <li><a href="#sharedstorageworkletglobalscope-addmodule-success">addModule success</a><span>, in § 2.3.1</span>
   <li><a href="#windowsharedstorage-append-a-key-value-pair">append a key-value pair</a><span>, in § 4.1.1</span>
   <li>
    append(key, value)
    <ul>
     <li><a href="#dom-sharedstorage-append">method for SharedStorage</a><span>, in § 4</span>
     <li><a href="#dom-windowsharedstorage-append">method for WindowSharedStorage</a><span>, in § 4.1.1</span>
     <li><a href="#dom-workletsharedstorage-append">method for WorkletSharedStorage</a><span>, in § 4.3.1</span>
    </ul>
   <li><a href="#append-or-modify-a-sec-shared-storage-writable-request-header">append or modify a Sec-Shared-Storage-Writable request header</a><span>, in § 7.4</span>
   <li><a href="#workletsharedstorageiterator-asynchronous-iterator-initialization-steps">asynchronous iterator initialization steps</a><span>, in § 4.3.3</span>
   <li><a href="#bit-debit">bit debit</a><span>, in § 2.6.1</span>
   <li><a href="#bit-debit-bits">bits</a><span>, in § 2.6.1</span>
   <li><a href="#calling-site">calling site</a><span>, in § 2.6.1</span>
   <li><a href="#charge-shared-storage-navigation-budget">charge shared storage navigation budget</a><span>, in § 2.6.1</span>
   <li><a href="#charge-shared-storage-reporting-budget">charge shared storage reporting budget</a><span>, in § 2.6.2</span>
   <li><a href="#check-if-addmodule-is-allowed-and-update-state">check if addModule is allowed and update state</a><span>, in § 2</span>
   <li><a href="#check-if-string-like">check if string-like</a><span>, in § 7.4</span>
   <li><a href="#check-if-user-preference-setting-allows-access-to-shared-storage">check if user preference setting allows access to shared storage</a><span>, in § 2</span>
   <li><a href="#check-whether-a-bit-debit-is-expired">check whether a bit debit is expired</a><span>, in § 2.6.1</span>
   <li><a href="#sharedstorageworkletglobalscope-check-whether-addmodule-is-finished">check whether addModule is finished</a><span>, in § 2.4</span>
   <li>
    clear()
    <ul>
     <li><a href="#dom-sharedstorage-clear">method for SharedStorage</a><span>, in § 4</span>
     <li><a href="#dom-windowsharedstorage-clear">method for WindowSharedStorage</a><span>, in § 4.1.1</span>
     <li><a href="#dom-workletsharedstorage-clear">method for WorkletSharedStorage</a><span>, in § 4.3.1</span>
    </ul>
   <li><a href="#shared-storage-database-clear-all-entries-in-the-database">clear all entries in the database</a><span>, in § 3.3</span>
   <li><a href="#windowsharedstorage-clear-all-keys">clear all keys</a><span>, in § 4.1.1</span>
   <li><a href="#shared-storage-database-count-entries-in-the-database">count entries in the database</a><span>, in § 3.3</span>
   <li><a href="#create-a-shared-storage-bucket">create a shared storage bucket</a><span>, in § 3.1</span>
   <li><a href="#create-a-shared-storage-shelf">create a shared storage shelf</a><span>, in § 3.1</span>
   <li><a href="#dom-windowsharedstorage-createworklet">createWorklet(moduleURL)</a><span>, in § 4.1.3</span>
   <li><a href="#dom-windowsharedstorage-createworklet">createWorklet(moduleURL, options)</a><span>, in § 4.1.3</span>
   <li><a href="#sharedstorageworklet-cross-origin-worklet-allowed">cross-origin worklet allowed</a><span>, in § 2</span>
   <li><a href="#dom-sharedstoragerunoperationmethodoptions-data">data</a><span>, in § 4.1</span>
   <li><a href="#default-entry-lifetime">default entry lifetime</a><span>, in § 3.2</span>
   <li><a href="#default-index">default index</a><span>, in § 2.6.1</span>
   <li><a href="#windowsharedstorage-delete-a-key">delete a key</a><span>, in § 4.1.1</span>
   <li><a href="#shared-storage-database-delete-an-entry-from-the-database">delete an entry from the database</a><span>, in § 3.3</span>
   <li>
    delete(key)
    <ul>
     <li><a href="#dom-sharedstorage-delete">method for SharedStorage</a><span>, in § 4</span>
     <li><a href="#dom-windowsharedstorage-delete">method for WindowSharedStorage</a><span>, in § 4.1.1</span>
     <li><a href="#dom-workletsharedstorage-delete">method for WorkletSharedStorage</a><span>, in § 4.3.1</span>
    </ul>
   <li><a href="#determine-remaining-navigation-budget">determine remaining navigation budget</a><span>, in § 2.6.1</span>
   <li><a href="#determine-reporting-budget-to-charge">determine reporting budget to charge</a><span>, in § 2.6.2</span>
   <li><a href="#shared-storage-database-determine-whether-an-entry-is-expired">determine whether an entry is expired</a><span>, in § 3.3</span>
   <li><a href="#determine-whether-a-request-can-currently-use-shared-storage">determine whether a request can currently use shared storage</a><span>, in § 7.4</span>
   <li><a href="#determine-whether-shared-storage-is-allowed-by-context">determine whether shared storage is allowed by context</a><span>, in § 2</span>
   <li><a href="#shared-storage-database-entry">entry</a><span>, in § 3.2</span>
   <li><a href="#workletsharedstorageiterator-error">error</a><span>, in § 4.3.3</span>
   <li><a href="#bit-debit-expired">expired</a><span>, in § 2.6.1</span>
   <li><a href="#dom-workletsharedstorage-get">get(key)</a><span>, in § 4.3.2</span>
   <li><a href="#get-the-canonical-url-string-if-valid">get the canonical URL string if valid</a><span>, in § 2.5</span>
   <li><a href="#workletsharedstorageiterator-get-the-next-iteration-result">get the next iteration result</a><span>, in § 4.3.3</span>
   <li><a href="#get-the-select-url-result-index">get the select-url result index</a><span>, in § 2.1</span>
   <li><a href="#get-the-string-value">get the string value</a><span>, in § 7.4</span>
   <li><a href="#handle-a-shared-storage-write-response">handle a Shared-Storage-Write response</a><span>, in § 7.4</span>
   <li><a href="#htmlsharedstoragewritableelementutils">HTMLSharedStorageWritableElementUtils</a><span>, in § 6.1</span>
   <li><a href="#dom-sharedstoragesetmethodoptions-ignoreifpresent">ignoreIfPresent</a><span>, in § 4</span>
   <li><a href="#selecturl-input-url-list">input URL list</a><span>, in § 2.6.1</span>
   <li><a href="#sharedstorageworklet-is-cross-origin-worklet">is cross-origin worklet</a><span>, in § 2</span>
   <li><a href="#dom-sharedstoragerunoperationmethodoptions-keepalive">keepAlive</a><span>, in § 4.1</span>
   <li><a href="#entry-key">key</a><span>, in § 3.2</span>
   <li><a href="#value-struct-last-updated">last updated</a><span>, in § 3.2</span>
   <li><a href="#dom-workletsharedstorage-length">length()</a><span>, in § 4.3.2</span>
   <li>
    maximum length
    <ul>
     <li><a href="#key-maximum-length">dfn for key</a><span>, in § 3.2</span>
     <li><a href="#value-maximum-length">dfn for value</a><span>, in § 3.2</span>
    </ul>
   <li><a href="#navigation-budget-epoch">navigation budget epoch</a><span>, in § 2.6.1</span>
   <li><a href="#navigation-budget-lifetime">navigation budget lifetime</a><span>, in § 2.6.1</span>
   <li><a href="#navigation-entropy-allowance">navigation entropy allowance</a><span>, in § 2.6.1</span>
   <li><a href="#navigation-entropy-ledger">navigation entropy ledger</a><span>, in § 2.6.1</span>
   <li><a href="#obtain-a-boolean-parameter-value">obtain a boolean parameter value</a><span>, in § 7.4</span>
   <li><a href="#obtain-a-shared-storage-bottle-map">obtain a shared storage bottle map</a><span>, in § 3.1</span>
   <li><a href="#obtain-a-shared-storage-shelf">obtain a shared storage shelf</a><span>, in § 3.1</span>
   <li><a href="#obtain-a-string-like-parameter-value">obtain a string-like parameter value</a><span>, in § 7.4</span>
   <li><a href="#sharedstorageworkletglobalscope-operation-map">operation map</a><span>, in § 2.3.1</span>
   <li><a href="#sharedstorageworkletglobalscope-outside-settings">outside settings</a><span>, in § 2.3.1</span>
   <li><a href="#page-load">page load</a><span>, in § 2.6.2</span>
   <li><a href="#workletsharedstorageiterator-pending-entries">pending entries</a><span>, in § 4.3.3</span>
   <li><a href="#pending-shared-storage-budget-debit">pending shared storage budget debit</a><span>, in § 2.6.1</span>
   <li><a href="#purge-expired-bit-debits-from-all-navigation-entropy-ledgers">purge expired bit debits from all navigation entropy ledgers</a><span>, in § 2.6.2</span>
   <li><a href="#shared-storage-database-purge-expired-entries-from-the-database">purge expired entries from the database</a><span>, in § 3.3</span>
   <li><a href="#dom-sharedstorageworkletglobalscope-register">register(name, operationCtor)</a><span>, in § 2.4</span>
   <li><a href="#register-reporting-metadata">register reporting metadata</a><span>, in § 2.5</span>
   <li><a href="#dom-workletsharedstorage-remainingbudget">remainingBudget()</a><span>, in § 4.3.2</span>
   <li><a href="#calling-site-remaining-navigation-budget">remaining navigation budget</a><span>, in § 2.6.1</span>
   <li><a href="#reporting-entropy-allowance">reporting entropy allowance</a><span>, in § 2.6.2</span>
   <li><a href="#dom-sharedstorageurlwithmetadata-reportingmetadata">reportingMetadata</a><span>, in § 2.5</span>
   <li><a href="#dom-sharedstoragerunoperationmethodoptions-resolvetoconfig">resolveToConfig</a><span>, in § 4.1</span>
   <li><a href="#shared-storage-database-retrieve-all-entries-from-the-database">retrieve all entries from the database</a><span>, in § 3.3</span>
   <li><a href="#shared-storage-database-retrieve-an-entry-from-the-database">retrieve an entry from the database</a><span>, in § 3.3</span>
   <li><a href="#callbackdef-runfunctionforsharedstorageselecturloperation">RunFunctionForSharedStorageSelectURLOperation</a><span>, in § 2.3.1</span>
   <li>
    run(name)
    <ul>
     <li><a href="#dom-sharedstorageworklet-run">method for SharedStorageWorklet</a><span>, in § 2.1</span>
     <li><a href="#dom-windowsharedstorage-run">method for WindowSharedStorage</a><span>, in § 4.1.2</span>
    </ul>
   <li>
    run(name, options)
    <ul>
     <li><a href="#dom-sharedstorageworklet-run">method for SharedStorageWorklet</a><span>, in § 2.1</span>
     <li><a href="#dom-windowsharedstorage-run">method for WindowSharedStorage</a><span>, in § 4.1.2</span>
    </ul>
   <li><a href="#http-headerdef-sec-shared-storage-writable">Sec-Shared-Storage-Writable</a><span>, in § 7.3.1</span>
   <li>
    selectURL(name, urls)
    <ul>
     <li><a href="#dom-sharedstorageworklet-selecturl">method for SharedStorageWorklet</a><span>, in § 2.1</span>
     <li><a href="#dom-windowsharedstorage-selecturl">method for WindowSharedStorage</a><span>, in § 4.1.2</span>
    </ul>
   <li>
    selectURL(name, urls, options)
    <ul>
     <li><a href="#dom-sharedstorageworklet-selecturl">method for SharedStorageWorklet</a><span>, in § 2.1</span>
     <li><a href="#dom-windowsharedstorage-selecturl">method for WindowSharedStorage</a><span>, in § 4.1.2</span>
    </ul>
   <li><a href="#windowsharedstorage-set-a-key-value-pair">set a key-value pair</a><span>, in § 4.1.1</span>
   <li><a href="#dom-sharedstorage-set">set(key, value)</a><span>, in § 4</span>
   <li>
    set(key, value, options)
    <ul>
     <li><a href="#dom-sharedstorage-set">method for SharedStorage</a><span>, in § 4</span>
     <li><a href="#dom-windowsharedstorage-set">method for WindowSharedStorage</a><span>, in § 4.1.1</span>
     <li><a href="#dom-workletsharedstorage-set">method for WorkletSharedStorage</a><span>, in § 4.3.1</span>
    </ul>
   <li><a href="#shared-storage">shared storage</a><span>, in § 3.1</span>
   <li><a href="#permissionspolicy-shared-storage">shared-storage</a><span>, in § 8</span>
   <li><a href="#sharedstorage">SharedStorage</a><span>, in § 4</span>
   <li>
    sharedStorage
    <ul>
     <li><a href="#dom-sharedstorageworkletglobalscope-sharedstorage">attribute for SharedStorageWorkletGlobalScope</a><span>, in § 2.3.1</span>
     <li><a href="#dom-window-sharedstorage">attribute for Window</a><span>, in § 4.2</span>
    </ul>
   <li><a href="#shared-storage-bucket">shared storage bucket</a><span>, in § 3.1</span>
   <li><a href="#http-headerdef-shared-storage-cross-origin-worklet-allowed">Shared-Storage-Cross-Origin-Worklet-Allowed</a><span>, in § 2.2.4</span>
   <li><a href="#shared-storage-database">shared storage database</a><span>, in § 3.2</span>
   <li><a href="#shared-storage-database-shared-storage-database-queue">shared storage database queue</a><span>, in § 3.2</span>
   <li>
    sharedStorage getter
    <ul>
     <li><a href="#sharedstorageworkletglobalscope-sharedstorage-getter">dfn for SharedStorageWorkletGlobalScope</a><span>, in § 2.4</span>
     <li><a href="#window-sharedstorage-getter">dfn for Window</a><span>, in § 4.2</span>
    </ul>
   <li><a href="#shared-storage-navigation-budget-charged">shared storage navigation budget charged</a><span>, in § 2.6.1</span>
   <li><a href="#shared-storage-navigation-budget-table">shared storage navigation budget table</a><span>, in § 2.6.1</span>
   <li><a href="#shared-storage-reporting-budget">shared storage reporting budget</a><span>, in § 2.6.2</span>
   <li><a href="#shared-storage-reporting-budget-charged">shared storage reporting budget charged</a><span>, in § 2.6.2</span>
   <li><a href="#typedefdef-sharedstorageresponse">SharedStorageResponse</a><span>, in § 2</span>
   <li><a href="#dictdef-sharedstoragerunoperationmethodoptions">SharedStorageRunOperationMethodOptions</a><span>, in § 4.1</span>
   <li><a href="#permissionspolicy-shared-storage-select-url">shared-storage-select-url</a><span>, in § 8</span>
   <li><a href="#dictdef-sharedstoragesetmethodoptions">SharedStorageSetMethodOptions</a><span>, in § 4</span>
   <li><a href="#shared-storage-shed">shared storage shed</a><span>, in § 3.1</span>
   <li><a href="#dictdef-sharedstorageurlwithmetadata">SharedStorageUrlWithMetadata</a><span>, in § 2.5</span>
   <li><a href="#sharedstorageworklet">SharedStorageWorklet</a><span>, in § 2</span>
   <li><a href="#sharedstorageworkletglobalscope">SharedStorageWorkletGlobalScope</a><span>, in § 2.3.1</span>
   <li><a href="#request-shared-storage-writable">shared storage writable</a><span>, in § 7.1</span>
   <li>
    sharedStorageWritable
    <ul>
     <li><a href="#dom-htmlsharedstoragewritableelementutils-sharedstoragewritable">attribute for HTMLSharedStorageWritableElementUtils</a><span>, in § 6.1</span>
     <li><a href="#dom-requestinit-sharedstoragewritable">dict-member for RequestInit</a><span>, in § 7.1</span>
    </ul>
   <li>
    sharedstoragewritable
    <ul>
     <li><a href="#element-attrdef-iframe-sharedstoragewritable">element-attr for iframe</a><span>, in § 6.1</span>
     <li><a href="#element-attrdef-img-sharedstoragewritable">element-attr for img</a><span>, in § 6.1</span>
    </ul>
   <li><a href="#http-headerdef-shared-storage-write">Shared-Storage-Write</a><span>, in § 7.3.2</span>
   <li><a href="#shared-storage-database-store-an-entry-in-the-database">store an entry in the database</a><span>, in § 3.3</span>
   <li><a href="#bit-debit-timestamp">timestamp</a><span>, in § 2.6.1</span>
   <li><a href="#dom-sharedstorageurlwithmetadata-url">url</a><span>, in § 2.5</span>
   <li><a href="#validate-reporting-metadata">validate reporting metadata</a><span>, in § 2.5</span>
   <li><a href="#value-struct-value">value</a><span>, in § 3.2</span>
   <li><a href="#entry-value-struct">value struct</a><span>, in § 3.2</span>
   <li><a href="#windowsharedstorage">WindowSharedStorage</a><span>, in § 4.1</span>
   <li><a href="#dom-windowsharedstorage-worklet">worklet</a><span>, in § 4.1</span>
   <li><a href="#workletsharedstorage">WorkletSharedStorage</a><span>, in § 4.3</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="ae6f41f1">urn uuid</span>
    </ul>
   <li>
    <a data-link-type="biblio">[ATTESTATION]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="c55932e1">enrolled</span>
    </ul>
   <li>
    <a data-link-type="biblio">[BEACON]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="2efaa6ee">beacon</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-SYNTAX-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="4650cbb8">function</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="85394472">Document</span>
     <li><span class="dfn-paneled" id="5216e1a0">node document</span>
     <li><span class="dfn-paneled" id="c62cd7cf">origin</span>
    </ul>
   <li>
    <a data-link-type="biblio">[ECMA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="3aec4bbc">current realm</span>
     <li><span class="dfn-paneled" id="192e00bf">get</span>
    </ul>
   <li>
    <a data-link-type="biblio">[ENCODING]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="b0fcb8d7">utf-8 decode</span>
     <li><span class="dfn-paneled" id="0303e8e5">utf-8 encode</span>
    </ul>
   <li>
    <a data-link-type="biblio">[Fenced-Frame]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="8edb2f5a">FenceEvent</span>
     <li><span class="dfn-paneled" id="24f2f8da">FencedFrameConfig</span>
     <li><span class="dfn-paneled" id="69ac8948">destination</span>
     <li><span class="dfn-paneled" id="f09e6fca">eventData</span>
     <li><span class="dfn-paneled" id="adcea05f">eventType</span>
     <li><span class="dfn-paneled" id="f8240630">fenced frame</span>
     <li><span class="dfn-paneled" id="b8914171">fenced frame config</span>
     <li><span class="dfn-paneled" id="cf17e487">fenced frame config instance</span>
     <li><span class="dfn-paneled" id="06799577">fenced frame config mapping</span>
     <li><span class="dfn-paneled" id="16ebb1f5">fenced frame reporter</span>
     <li><span class="dfn-paneled" id="e5128568">finalize a pending config</span>
     <li><span class="dfn-paneled" id="6417de26">initiator fenced frame config instance</span>
     <li><span class="dfn-paneled" id="e231e88f">mapped url</span>
     <li><span class="dfn-paneled" id="65de84a0">reportEvent()</span>
     <li><span class="dfn-paneled" id="c5b31ce5">store a pending config</span>
    </ul>
   <li>
    <a data-link-type="biblio">[FETCH]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="0dcd4ad9">RequestInit</span>
     <li><span class="dfn-paneled" id="3f2ca4de">current url</span>
     <li><span class="dfn-paneled" id="ee95ecc7">delete</span>
     <li><span class="dfn-paneled" id="3ae34c95">destination</span>
     <li><span class="dfn-paneled" id="a33db89a">fetch</span>
     <li><span class="dfn-paneled" id="5c66de35">get a structured field value</span>
     <li><span class="dfn-paneled" id="c9e7c11a">header</span>
     <li><span class="dfn-paneled" id="6ee0eab1">header list <small>(for request)</small></span>
     <li><span class="dfn-paneled" id="f7b00a8b">header list <small>(for response)</small></span>
     <li><span class="dfn-paneled" id="2aaa2f42">http fetch</span>
     <li><span class="dfn-paneled" id="2c2acc57">http network or cache fetch</span>
     <li><span class="dfn-paneled" id="eb1b1af3">network error</span>
     <li><span class="dfn-paneled" id="f78d5b5c">origin</span>
     <li><span class="dfn-paneled" id="d83f8790">priority</span>
     <li><span class="dfn-paneled" id="64b62ea0">redirect mode</span>
     <li><span class="dfn-paneled" id="a8b25997">redirect status</span>
     <li><span class="dfn-paneled" id="55213b5b">request</span>
     <li><span class="dfn-paneled" id="162d2b51">request <small>(for Request)</small></span>
     <li><span class="dfn-paneled" id="c07c4a8c">request-constructor</span>
     <li><span class="dfn-paneled" id="ee7bba09">response</span>
     <li><span class="dfn-paneled" id="35b98f13">set a structured field value</span>
     <li><span class="dfn-paneled" id="a1d47575">status</span>
     <li><span class="dfn-paneled" id="dc1cd39b">url</span>
     <li><span class="dfn-paneled" id="1ab127d6">window</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HR-TIME-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="0e9f636b">DOMHighResTimeStamp</span>
     <li><span class="dfn-paneled" id="a09bfce2">current wall time</span>
     <li><span class="dfn-paneled" id="f16ee824">current wall time <small>(for environment settings object)</small></span>
     <li><span class="dfn-paneled" id="4b2c8c72">duration</span>
     <li><span class="dfn-paneled" id="be5dbc8c">unix epoch</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="402ed79d">CEReactions</span>
     <li><span class="dfn-paneled" id="10e25f42">HTMLIFrameElement</span>
     <li><span class="dfn-paneled" id="c5891539">HTMLImageElement</span>
     <li><span class="dfn-paneled" id="5d7209e9">Window</span>
     <li><span class="dfn-paneled" id="2879c404">Worklet</span>
     <li><span class="dfn-paneled" id="0c9b0d3c">WorkletGlobalScope</span>
     <li><span class="dfn-paneled" id="47a5f7a3">WorkletOptions</span>
     <li><span class="dfn-paneled" id="35972864">active document</span>
     <li><span class="dfn-paneled" id="101c721c">active window</span>
     <li><span class="dfn-paneled" id="eec46e27">addModule(moduleURL, options)</span>
     <li><span class="dfn-paneled" id="0c444cb5">added modules list</span>
     <li><span class="dfn-paneled" id="3349d69f">associated document</span>
     <li><span class="dfn-paneled" id="772cb7dd">beginning navigation</span>
     <li><span class="dfn-paneled" id="b0b31697">boolean attributes</span>
     <li><span class="dfn-paneled" id="0d0390b4">browsing context</span>
     <li><span class="dfn-paneled" id="3b2ff63e">browsing context <small>(for Document)</small></span>
     <li><span class="dfn-paneled" id="6d88ab2e">browsing context <small>(for Window)</small></span>
     <li><span class="dfn-paneled" id="762210c0">container</span>
     <li><span class="dfn-paneled" id="68675e70">content attributes</span>
     <li><span class="dfn-paneled" id="e4ffa115">create a worklet global scope</span>
     <li><span class="dfn-paneled" id="faaaa5a1">create navigation params by fetching</span>
     <li><span class="dfn-paneled" id="12b8dfc0">current settings object</span>
     <li><span class="dfn-paneled" id="e10e7eb7">dom manipulation task source</span>
     <li><span class="dfn-paneled" id="7dbefaad">ending navigation</span>
     <li><span class="dfn-paneled" id="102df61f">enqueue the following steps</span>
     <li><span class="dfn-paneled" id="24cf98a1">environment</span>
     <li><span class="dfn-paneled" id="3e12e042">environment settings object</span>
     <li><span class="dfn-paneled" id="3018e13f">fetch a worklet script graph</span>
     <li><span class="dfn-paneled" id="0e3ba9f8">fully active</span>
     <li><span class="dfn-paneled" id="289407ea">get the top-level traversable</span>
     <li><span class="dfn-paneled" id="8a30477b">global object <small>(for environment settings object)</small></span>
     <li><span class="dfn-paneled" id="168f1b6e">global object <small>(for realm)</small></span>
     <li><span class="dfn-paneled" id="6f738b30">global scopes</span>
     <li><span class="dfn-paneled" id="87fcd40c">iframe</span>
     <li><span class="dfn-paneled" id="f0811ff8">img</span>
     <li><span class="dfn-paneled" id="9b3743cd">module map</span>
     <li><span class="dfn-paneled" id="a1005ed9">module script</span>
     <li><span class="dfn-paneled" id="9c19b7fc">navigable</span>
     <li><span class="dfn-paneled" id="2594e562">navigate</span>
     <li><span class="dfn-paneled" id="13dd6cae">node navigable</span>
     <li><span class="dfn-paneled" id="602b1a68">obtain a site</span>
     <li><span class="dfn-paneled" id="f5fd709f">obtaining a worklet agent</span>
     <li><span class="dfn-paneled" id="b01b1359">opaque origin</span>
     <li><span class="dfn-paneled" id="086e3aff">origin</span>
     <li><span class="dfn-paneled" id="43ac8374">origin <small>(for environment settings object)</small></span>
     <li><span class="dfn-paneled" id="1bba3db7">parent</span>
     <li><span class="dfn-paneled" id="48438eb3">queue a global task</span>
     <li><span class="dfn-paneled" id="b75a7d23">realm</span>
     <li><span class="dfn-paneled" id="5ab7b520">reflect</span>
     <li><span class="dfn-paneled" id="5991ccfb">relevant realm</span>
     <li><span class="dfn-paneled" id="9c4c1e66">relevant settings object</span>
     <li><span class="dfn-paneled" id="7393da89">same origin</span>
     <li><span class="dfn-paneled" id="65181da8">secure context</span>
     <li><span class="dfn-paneled" id="1cc25024">set up a worklet environment settings object</span>
     <li><span class="dfn-paneled" id="7deb6835">settings object</span>
     <li><span class="dfn-paneled" id="fb9bb722">site</span>
     <li><span class="dfn-paneled" id="9c9ab424">start a new parallel queue</span>
     <li><span class="dfn-paneled" id="085ddd0a">target browsing context</span>
     <li><span class="dfn-paneled" id="d2f99df9">terminate a worklet global scope</span>
     <li><span class="dfn-paneled" id="30717154">top-level traversable</span>
     <li><span class="dfn-paneled" id="17582406">traversable navigable</span>
     <li><span class="dfn-paneled" id="b402424d">update the image data</span>
     <li><span class="dfn-paneled" id="b79e50d6">user activation</span>
     <li><span class="dfn-paneled" id="93252241">worklet destination type</span>
     <li><span class="dfn-paneled" id="3b8ce5a6">worklet global scope type</span>
     <li><span class="dfn-paneled" id="3e6a4683">worklets</span>
    </ul>
   <li>
    <a data-link-type="biblio">[I18N-GLOSSARY]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="94719b0c">unicode</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="53275e46">append <small>(for list)</small></span>
     <li><span class="dfn-paneled" id="a3b18719">append <small>(for set)</small></span>
     <li><span class="dfn-paneled" id="f0c4369e">ascii</span>
     <li><span class="dfn-paneled" id="2d5a2765">ascii string</span>
     <li><span class="dfn-paneled" id="77b4c09a">assert</span>
     <li><span class="dfn-paneled" id="36858240">boolean</span>
     <li><span class="dfn-paneled" id="bc7b9068">clear</span>
     <li><span class="dfn-paneled" id="027e3e49">clone</span>
     <li><span class="dfn-paneled" id="4a3bf5fb">concatenate</span>
     <li><span class="dfn-paneled" id="ae8def21">contain <small>(for list)</small></span>
     <li><span class="dfn-paneled" id="a326add7">contain <small>(for map)</small></span>
     <li><span class="dfn-paneled" id="f937b7b6">continue</span>
     <li><span class="dfn-paneled" id="a088e610">convert</span>
     <li><span class="dfn-paneled" id="9a9b558b">dequeue</span>
     <li><span class="dfn-paneled" id="03afaf9c">empty <small>(for list)</small></span>
     <li><span class="dfn-paneled" id="cc867b80">empty <small>(for map)</small></span>
     <li><span class="dfn-paneled" id="06a6db54">enqueue</span>
     <li><span class="dfn-paneled" id="8958b003">entry</span>
     <li><span class="dfn-paneled" id="1243a891">exist</span>
     <li><span class="dfn-paneled" id="527b10aa">get</span>
     <li><span class="dfn-paneled" id="d5890b17">getting the values</span>
     <li><span class="dfn-paneled" id="860300d4">implementation-defined</span>
     <li><span class="dfn-paneled" id="5afbefcd">item <small>(for list)</small></span>
     <li><span class="dfn-paneled" id="c88f3887">item <small>(for struct)</small></span>
     <li><span class="dfn-paneled" id="efe8653e">iterate</span>
     <li><span class="dfn-paneled" id="d14a6f26">key</span>
     <li><span class="dfn-paneled" id="31db57e6">keys</span>
     <li><span class="dfn-paneled" id="0fa357c3">length</span>
     <li><span class="dfn-paneled" id="649608b9">list</span>
     <li><span class="dfn-paneled" id="3fca5a9e">map</span>
     <li><span class="dfn-paneled" id="47dfca75">queue</span>
     <li><span class="dfn-paneled" id="99c988d6">remove <small>(for list)</small></span>
     <li><span class="dfn-paneled" id="7d4424b2">remove <small>(for map)</small></span>
     <li><span class="dfn-paneled" id="0e6b2056">set</span>
     <li><span class="dfn-paneled" id="0204d188">size <small>(for list)</small></span>
     <li><span class="dfn-paneled" id="653d0848">size <small>(for map)</small></span>
     <li><span class="dfn-paneled" id="0698d556">string</span>
     <li><span class="dfn-paneled" id="984221ca">struct</span>
     <li><span class="dfn-paneled" id="6d19ac93">user agent</span>
     <li><span class="dfn-paneled" id="12d6b9a8">values</span>
    </ul>
   <li>
    <a data-link-type="biblio">[PERMISSIONS-POLICY-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="47a2271a">is feature enabled in document for origin?</span>
     <li><span class="dfn-paneled" id="cc890cc1">policy-controlled feature</span>
    </ul>
   <li>
    <a data-link-type="biblio">[PRIVATE-AGGREGATION-API]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="672f81c8">private aggregation</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC8941]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="2c680d8a">bare item</span>
     <li><span class="dfn-paneled" id="d56eba29">boolean</span>
     <li><span class="dfn-paneled" id="375247ce">byte sequence</span>
     <li><span class="dfn-paneled" id="77e5cafe">inner list</span>
     <li><span class="dfn-paneled" id="2d1d761a">list</span>
     <li><span class="dfn-paneled" id="4a7ca2e3">parameters</span>
     <li><span class="dfn-paneled" id="cb1e75b1">string</span>
     <li><span class="dfn-paneled" id="e075de1c">structured header</span>
     <li><span class="dfn-paneled" id="04dc11d2">token</span>
    </ul>
   <li>
    <a data-link-type="biblio">[SERVICE-WORKERS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="7d16decb">storage key</span>
    </ul>
   <li>
    <a data-link-type="biblio">[SHARED-STORAGE-EXPLAINER]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="bf8231d0">legitimate use cases</span>
    </ul>
   <li>
    <a data-link-type="biblio">[STORAGE]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="7f8002fa">backing map</span>
     <li><span class="dfn-paneled" id="d7f1116b">bottle map</span>
     <li><span class="dfn-paneled" id="7db4a4b7">bucket map</span>
     <li><span class="dfn-paneled" id="0ad0fd9b">proxy map reference set</span>
     <li><span class="dfn-paneled" id="73fdd654">quota <small>(for storage bottle)</small></span>
     <li><span class="dfn-paneled" id="896f4663">quota <small>(for storage endpoint)</small></span>
     <li><span class="dfn-paneled" id="a5eb2e99">register</span>
     <li><span class="dfn-paneled" id="67130339">storage bottle</span>
     <li><span class="dfn-paneled" id="6148dd37">storage bucket</span>
     <li><span class="dfn-paneled" id="98c6a112">storage endpoint</span>
     <li><span class="dfn-paneled" id="5701f5c0">storage identifier</span>
     <li><span class="dfn-paneled" id="07260e9d">storage model</span>
     <li><span class="dfn-paneled" id="07d4a5a2">storage proxy map</span>
     <li><span class="dfn-paneled" id="660191f0">storage shed</span>
     <li><span class="dfn-paneled" id="daed3f4b">storage shelf</span>
     <li><span class="dfn-paneled" id="2eb97c74">storage type</span>
    </ul>
   <li>
    <a data-link-type="biblio">[STORAGE-PARTITIONING]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="4c2ffaa9">client-side storage partitioning</span>
    </ul>
   <li>
    <a data-link-type="biblio">[URL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="959ad97b">origin</span>
     <li><span class="dfn-paneled" id="dcffbccd">url</span>
     <li><span class="dfn-paneled" id="ca3ca4ae">url parser</span>
     <li><span class="dfn-paneled" id="5442ea33">url serializer</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="8855a9aa">DOMString</span>
     <li><span class="dfn-paneled" id="889e932f">Exposed</span>
     <li><span class="dfn-paneled" id="dcf5fafa">FrozenArray</span>
     <li><span class="dfn-paneled" id="ae46556f">Function</span>
     <li><span class="dfn-paneled" id="7fb6fbc6">Global</span>
     <li><span class="dfn-paneled" id="bdbd19d1">Promise</span>
     <li><span class="dfn-paneled" id="b75bb3bd">SecureContext</span>
     <li><span class="dfn-paneled" id="82ca3efc">TypeError</span>
     <li><span class="dfn-paneled" id="b0d7f3c3">USVString</span>
     <li><span class="dfn-paneled" id="d0b4a948">a promise rejected with</span>
     <li><span class="dfn-paneled" id="cc61f510">an exception was thrown</span>
     <li><span class="dfn-paneled" id="6c6b1005">any</span>
     <li><span class="dfn-paneled" id="3e180d35">associated realm</span>
     <li><span class="dfn-paneled" id="11f367b8">async iterator</span>
     <li><span class="dfn-paneled" id="9a7f3f6f">asynchronous iterator initialization steps</span>
     <li><span class="dfn-paneled" id="5372cca8">boolean</span>
     <li><span class="dfn-paneled" id="1fc2b625">construct</span>
     <li><span class="dfn-paneled" id="bec98d30">dictionary</span>
     <li><span class="dfn-paneled" id="8c800cdf">double</span>
     <li><span class="dfn-paneled" id="e7652812">get the next iteration result</span>
     <li><span class="dfn-paneled" id="1422ec4e">interface</span>
     <li><span class="dfn-paneled" id="d08c79a9">interface mixin</span>
     <li><span class="dfn-paneled" id="10ce5f6f">invoke</span>
     <li><span class="dfn-paneled" id="efd1ec5d">object</span>
     <li><span class="dfn-paneled" id="4bf1cac4">promise</span>
     <li><span class="dfn-paneled" id="cc608da4">promise rejected</span>
     <li><span class="dfn-paneled" id="b262501e">reject</span>
     <li><span class="dfn-paneled" id="3b90bdcd">resolve</span>
     <li><span class="dfn-paneled" id="9cce47fd">sequence</span>
     <li><span class="dfn-paneled" id="4013a022">this</span>
     <li><span class="dfn-paneled" id="5f90bbfb">undefined</span>
     <li><span class="dfn-paneled" id="e97a9688">unsigned long</span>
     <li><span class="dfn-paneled" id="24bd7d25">upon fulfillment</span>
     <li><span class="dfn-paneled" id="f14ed351">upon rejection</span>
     <li><span class="dfn-paneled" id="375981d1">web idl standard</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WIKIPEDIA-ENTROPY]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="7a101e5c">bits of entropy</span>
     <li><span class="dfn-paneled" id="9d801570">entropy bits</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-beacon">[BEACON]
   <dd>Ilya Grigorik; Alois Reitbauer. <a href="https://w3c.github.io/beacon/"><cite>Beacon</cite></a>. URL: <a href="https://w3c.github.io/beacon/">https://w3c.github.io/beacon/</a>
   <dt id="biblio-css-syntax-3">[CSS-SYNTAX-3]
   <dd>Tab Atkins Jr.; Simon Sapin. <a href="https://drafts.csswg.org/css-syntax/"><cite>CSS Syntax Module Level 3</cite></a>. URL: <a href="https://drafts.csswg.org/css-syntax/">https://drafts.csswg.org/css-syntax/</a>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-encoding">[ENCODING]
   <dd>Anne van Kesteren. <a href="https://encoding.spec.whatwg.org/"><cite>Encoding Standard</cite></a>. Living Standard. URL: <a href="https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
   <dt id="biblio-fenced-frame">[Fenced-Frame]
   <dd><a href="https://wicg.github.io/fenced-frame/"><cite>Fenced Frame</cite></a>. Draft Community Group Report. URL: <a href="https://wicg.github.io/fenced-frame/">https://wicg.github.io/fenced-frame/</a>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-hr-time-3">[HR-TIME-3]
   <dd>Yoav Weiss. <a href="https://w3c.github.io/hr-time/"><cite>High Resolution Time</cite></a>. URL: <a href="https://w3c.github.io/hr-time/">https://w3c.github.io/hr-time/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-i18n-glossary">[I18N-GLOSSARY]
   <dd>Richard Ishida; Addison Phillips. <a href="https://w3c.github.io/i18n-glossary/"><cite>Internationalization Glossary</cite></a>. URL: <a href="https://w3c.github.io/i18n-glossary/">https://w3c.github.io/i18n-glossary/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-permissions-policy-1">[PERMISSIONS-POLICY-1]
   <dd>Ian Clelland. <a href="https://w3c.github.io/webappsec-permissions-policy/"><cite>Permissions Policy</cite></a>. URL: <a href="https://w3c.github.io/webappsec-permissions-policy/">https://w3c.github.io/webappsec-permissions-policy/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-rfc8941">[RFC8941]
   <dd>M. Nottingham; P-H. Kamp. <a href="https://httpwg.org/specs/rfc8941.html"><cite>Structured Field Values for HTTP</cite></a>. February 2021. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc8941.html">https://httpwg.org/specs/rfc8941.html</a>
   <dt id="biblio-storage">[STORAGE]
   <dd>Anne van Kesteren. <a href="https://storage.spec.whatwg.org/"><cite>Storage Standard</cite></a>. Living Standard. URL: <a href="https://storage.spec.whatwg.org/">https://storage.spec.whatwg.org/</a>
   <dt id="biblio-url">[URL]
   <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-service-workers">[SERVICE-WORKERS]
   <dd>Jake Archibald; Marijn Kruisselbrink. <a href="https://w3c.github.io/ServiceWorker/"><cite>Service Workers</cite></a>. URL: <a href="https://w3c.github.io/ServiceWorker/">https://w3c.github.io/ServiceWorker/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def"><c- b>typedef</c-> (<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="https://wicg.github.io/fenced-frame/#fencedframeconfig"><c- n>FencedFrameConfig</c-></a>) <a href="#typedefdef-sharedstorageresponse"><code><c- g>SharedStorageResponse</c-></code></a>;

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->)]
<c- b>interface</c-> <a href="#sharedstorageworklet"><code><c- g>SharedStorageWorklet</c-></code></a> : <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/worklets.html#worklet"><c- n>Worklet</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#typedefdef-sharedstorageresponse"><c- n>SharedStorageResponse</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-sharedstorageworklet-selecturl"><c- g>selectURL</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-sharedstorageworklet-selecturl-name-urls-options-name"><code><c- g>name</c-></code></a>,
                               <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-sharedstorageurlwithmetadata"><c- n>SharedStorageUrlWithMetadata</c-></a>> <a href="#dom-sharedstorageworklet-selecturl-name-urls-options-urls"><code><c- g>urls</c-></code></a>,
                               <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sharedstoragerunoperationmethodoptions"><c- n>SharedStorageRunOperationMethodOptions</c-></a> <a href="#dom-sharedstorageworklet-selecturl-name-urls-options-options"><code><c- g>options</c-></code></a> = {});
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-sharedstorageworklet-run"><c- g>run</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-sharedstorageworklet-run-name-options-name"><code><c- g>name</c-></code></a>,
                   <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sharedstoragerunoperationmethodoptions"><c- n>SharedStorageRunOperationMethodOptions</c-></a> <a href="#dom-sharedstorageworklet-run-name-options-options"><code><c- g>options</c-></code></a> = {});
};

<c- b>callback</c-> <a href="#callbackdef-runfunctionforsharedstorageselecturloperation"><code><c- g>RunFunctionForSharedStorageSelectURLOperation</c-></code></a> = <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>>(<a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>> <a href="#dom-runfunctionforsharedstorageselecturloperation-urls"><code><c- g>urls</c-></code></a>, <c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a> <a href="#dom-runfunctionforsharedstorageselecturloperation-data"><code><c- g>data</c-></code></a>);

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>SharedStorageWorklet</c->, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Global"><c- g>Global</c-></a>=<a data-link-type="idl-name" href="#sharedstorageworklet"><c- n>SharedStorageWorklet</c-></a>]
<c- b>interface</c-> <a href="#sharedstorageworkletglobalscope"><code><c- g>SharedStorageWorkletGlobalScope</c-></code></a> : <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/worklets.html#workletglobalscope"><c- n>WorkletGlobalScope</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-sharedstorageworkletglobalscope-register"><c- g>register</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-sharedstorageworkletglobalscope-register-name-operationctor-name"><code><c- g>name</c-></code></a>,
                     <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#Function"><c- n>Function</c-></a> <a href="#dom-sharedstorageworkletglobalscope-register-name-operationctor-operationctor"><code><c- g>operationCtor</c-></code></a>);

  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#workletsharedstorage"><c- n>WorkletSharedStorage</c-></a> <a data-readonly data-type="WorkletSharedStorage" href="#dom-sharedstorageworkletglobalscope-sharedstorage"><code><c- g>sharedStorage</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-sharedstorageurlwithmetadata"><code><c- g>SharedStorageUrlWithMetadata</c-></code></a> {
  <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString " href="#dom-sharedstorageurlwithmetadata-url"><code><c- g>url</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object"><c- b>object</c-></a> <a data-type="object " href="#dom-sharedstorageurlwithmetadata-reportingmetadata"><code><c- g>reportingMetadata</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>SharedStorageWorklet</c->)]
<c- b>interface</c-> <a href="#sharedstorage"><code><c- g>SharedStorage</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a>> <a href="#dom-sharedstorage-set"><code><c- g>set</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-sharedstorage-set-key-value-options-key"><code><c- g>key</c-></code></a>,
                   <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-sharedstorage-set-key-value-options-value"><code><c- g>value</c-></code></a>,
                   <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sharedstoragesetmethodoptions"><c- n>SharedStorageSetMethodOptions</c-></a> <a href="#dom-sharedstorage-set-key-value-options-options"><code><c- g>options</c-></code></a> = {});
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a>> <a href="#dom-sharedstorage-append"><code><c- g>append</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-sharedstorage-append-key-value-key"><code><c- g>key</c-></code></a>,
                      <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-sharedstorage-append-key-value-value"><code><c- g>value</c-></code></a>);
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a>> <a href="#dom-sharedstorage-delete"><code><c- g>delete</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-sharedstorage-delete-key-key"><code><c- g>key</c-></code></a>);
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a>> <a href="#dom-sharedstorage-clear"><code><c- g>clear</c-></code></a>();
};

<c- b>dictionary</c-> <a href="#dictdef-sharedstoragesetmethodoptions"><code><c- g>SharedStorageSetMethodOptions</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-sharedstoragesetmethodoptions-ignoreifpresent"><code><c- g>ignoreIfPresent</c-></code></a> = <c- b>false</c->;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->)]
<c- b>interface</c-> <a href="#windowsharedstorage"><code><c- g>WindowSharedStorage</c-></code></a> : <a data-link-type="idl-name" href="#sharedstorage"><c- n>SharedStorage</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#typedefdef-sharedstorageresponse"><c- n>SharedStorageResponse</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-windowsharedstorage-selecturl"><c- g>selectURL</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-windowsharedstorage-selecturl-name-urls-options-name"><code><c- g>name</c-></code></a>,
                               <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-sharedstorageurlwithmetadata"><c- n>SharedStorageUrlWithMetadata</c-></a>> <a href="#dom-windowsharedstorage-selecturl-name-urls-options-urls"><code><c- g>urls</c-></code></a>,
                               <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sharedstoragerunoperationmethodoptions"><c- n>SharedStorageRunOperationMethodOptions</c-></a> <a href="#dom-windowsharedstorage-selecturl-name-urls-options-options"><code><c- g>options</c-></code></a> = {});
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-windowsharedstorage-run"><c- g>run</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-windowsharedstorage-run-name-options-name"><code><c- g>name</c-></code></a>,
                   <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sharedstoragerunoperationmethodoptions"><c- n>SharedStorageRunOperationMethodOptions</c-></a> <a href="#dom-windowsharedstorage-run-name-options-options"><code><c- g>options</c-></code></a> = {});

  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#sharedstorageworklet"><c- n>SharedStorageWorklet</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-windowsharedstorage-createworklet"><c- g>createWorklet</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a href="#dom-windowsharedstorage-createworklet-moduleurl-options-moduleurl"><code><c- g>moduleURL</c-></code></a>, <c- b>optional</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/worklets.html#workletoptions"><c- n>WorkletOptions</c-></a> <a href="#dom-windowsharedstorage-createworklet-moduleurl-options-options"><code><c- g>options</c-></code></a> = {});

  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#sharedstorageworklet"><c- n>SharedStorageWorklet</c-></a> <a data-readonly data-type="SharedStorageWorklet" href="#dom-windowsharedstorage-worklet"><code><c- g>worklet</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-sharedstoragerunoperationmethodoptions"><code><c- g>SharedStorageRunOperationMethodOptions</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object"><c- b>object</c-></a> <a data-type="object " href="#dom-sharedstoragerunoperationmethodoptions-data"><code><c- g>data</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-sharedstoragerunoperationmethodoptions-resolvetoconfig"><code><c- g>resolveToConfig</c-></code></a> = <c- b>false</c->;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-sharedstoragerunoperationmethodoptions-keepalive"><code><c- g>keepAlive</c-></code></a> = <c- b>false</c->;
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window"><c- g>Window</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#windowsharedstorage"><c- n>WindowSharedStorage</c-></a>? <a data-readonly data-type="WindowSharedStorage?" href="#dom-window-sharedstorage"><code><c- g>sharedStorage</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>SharedStorageWorklet</c->)]
<c- b>interface</c-> <a href="#workletsharedstorage"><code><c- g>WorkletSharedStorage</c-></code></a> : <a data-link-type="idl-name" href="#sharedstorage"><c- n>SharedStorage</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-workletsharedstorage-get"><c- g>get</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-workletsharedstorage-get-key-key"><code><c- g>key</c-></code></a>);
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-workletsharedstorage-length"><c- g>length</c-></a>();
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double"><c- b>double</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-workletsharedstorage-remainingbudget"><c- g>remainingBudget</c-></a>();

  <c- b>async</c-> <c- b>iterable</c->&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>, <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>>;
};

<c- b>interface</c-> <c- b>mixin</c-> <a href="#htmlsharedstoragewritableelementutils"><code><c- g>HTMLSharedStorageWritableElementUtils</c-></code></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions"><c- g>CEReactions</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>] <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-type="boolean" href="#dom-htmlsharedstoragewritableelementutils-sharedstoragewritable"><code><c- g>sharedStorageWritable</c-></code></a>;
};

<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#htmliframeelement"><c- n>HTMLIFrameElement</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="#htmlsharedstoragewritableelementutils"><c- n>HTMLSharedStorageWritableElementUtils</c-></a>;
<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/embedded-content.html#htmlimageelement"><c- n>HTMLImageElement</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="#htmlsharedstoragewritableelementutils"><c- n>HTMLSharedStorageWritableElementUtils</c-></a>;

<c- b>partial</c-> <c- b>dictionary</c-> <a class="idl-code" data-link-type="dictionary" href="https://fetch.spec.whatwg.org/#requestinit"><c- g>RequestInit</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-type="boolean " href="#dom-requestinit-sharedstoragewritable"><code><c- g>sharedStorageWritable</c-></code></a>;
};

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> The "name" and "operationCtor" cannot be missing here given WebIDL. Should just check for default/empty values. <a href="https://github.com/WICG/shared-storage/issues/151">[Issue #151]</a> <a class="issue-return" href="#issue-ec8d9fc9" title="Jump to section">↵</a></div>
   <div class="issue"> <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageurlwithmetadata-reportingmetadata">reportingMetadata</a></code> should be a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-dictionary">dictionary</a>. <a href="https://github.com/WICG/shared-storage/issues/141">[Issue #141]</a> <a class="issue-return" href="#issue-3af1d5c1" title="Jump to section">↵</a></div>
   <div class="issue"> Store <var>reportingUrlMap</var> inside a <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#fencedframetype-fenced-frame-reporter">fenced frame reporter</a> class associated with <var>fencedFrameConfigStruct</var>. Both of these still need to be added to the draft <a data-link-type="biblio" href="#biblio-fenced-frame" title="Fenced Frame">[Fenced-Frame]</a>. <a href="https://github.com/WICG/shared-storage/issues/144">[Issue #144]</a> <a class="issue-return" href="#issue-451ee8b5" title="Jump to section">↵</a></div>
   <div class="issue"> Methods can’t have state attached to them. Many definitions in this section needs improving. <a href="https://github.com/WICG/shared-storage/issues/147">[Issue #147]</a> <a class="issue-return" href="#issue-eaab2bb9" title="Jump to section">↵</a></div>
   <div class="issue"> Move the definition of <a data-link-type="dfn" href="#pending-shared-storage-budget-debit">pending shared storage budget debit</a> to <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#browsing-context-fenced-frame-config-instance">fenced frame config instance</a> in the draft <a data-link-type="biblio" href="#biblio-fenced-frame" title="Fenced Frame">[Fenced-Frame]</a> specification. <a href="https://github.com/WICG/shared-storage/issues/148">[Issue #148]</a> <a class="issue-return" href="#issue-e3244203" title="Jump to section">↵</a></div>
   <div class="issue"> Need to find a better way to specify timing of the navigation budget charging. <a href="https://github.com/WICG/shared-storage/issues/138">[Issue #138]</a> <a class="issue-return" href="#issue-2c9003c1" title="Jump to section">↵</a></div>
   <div class="issue"> The boolean <span>shared storage navigation budget charged</span> have not yet been added to <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#browsing-context-fenced-frame-config-instance">fenced frame config instance</a> in the draft <a data-link-type="biblio" href="#biblio-fenced-frame" title="Fenced Frame">[Fenced-Frame]</a> specification. Some form of them will be added, although their names are subject to bikeshedding. Fix the names when they are added. <a href="https://github.com/WICG/shared-storage/issues/149">[Issue #149]</a> <a class="issue-return" href="#issue-3534ecb9" title="Jump to section">↵</a></div>
   <div class="issue"> Move this to <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#dom-fence-reportevent">reportEvent()</a></code> in <a data-link-type="biblio" href="#biblio-fenced-frame" title="Fenced Frame">[Fenced-Frame]</a>. <a href="https://github.com/WICG/shared-storage/issues/150">[Issue #150]</a> <a class="issue-return" href="#issue-82e0fec0" title="Jump to section">↵</a></div>
   <div class="issue"> The boolean <span>shared storage reporting budget charged</span> have not yet been added to <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#browsing-context-fenced-frame-config-instance">fenced frame config instance</a> in the draft <a data-link-type="biblio" href="#biblio-fenced-frame" title="Fenced Frame">[Fenced-Frame]</a> specification. Some form of them will be added, although their names are subject to bikeshedding. Fix the names when they are added. <a href="https://github.com/WICG/shared-storage/issues/149">[Issue #149]</a> <a class="issue-return" href="#issue-2c90d642" title="Jump to section">↵</a></div>
   <div class="issue"> The <a data-link-type="dfn" href="#determine-whether-a-request-can-currently-use-shared-storage">determine whether a request can currently use shared storage</a> algorithm needs to take into account "opt-in features", as articulated in <a href="https://github.com/w3c/webappsec-permissions-policy/pull/499">https://github.com/w3c/webappsec-permissions-policy/pull/499</a>. <a class="issue-return" href="#issue-9d2a534a" title="Jump to section">↵</a></div>
  </div>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
    const dfnsJson = window.dfnsJson || {};

    function genDfnPanel({dfnID, url, dfnText, refSections, external}) {
        return mk.aside({
            class: "dfn-panel",
            id: `infopanel-for-${dfnID}`,
            "data-for": dfnID,
            "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
            },
            mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
                `Info about the '${dfnText}' ${external?"external":""} reference.`),
            mk.a({href:url}, url),
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({
                                    href: `#${ref.id}`
                                    },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        );
    }

    function genAllDfnPanels() {
        for(const panelData of Object.values(window.dfnpanelData)) {
            const dfnID = panelData.dfnID;
            const dfn = document.getElementById(dfnID);
            if(!dfn) {
                console.log(`Can't find dfn#${dfnID}.`, panelData);
            } else {
                const panel = genDfnPanel(panelData);
                append(document.body, panel);
                insertDfnPopupAction(dfn, panel)
            }
        }
    }

    document.addEventListener("DOMContentLoaded", ()=>{
        genAllDfnPanels();

        // Add popup behavior to all dfns to show the corresponding dfn-panel.
        var dfns = queryAll('.dfn-paneled');
        for(let dfn of dfns) { ; }

        document.body.addEventListener("click", (e) => {
            // If not handled already, just hide all dfn panels.
            hideAllDfnPanels();
        });
    })


    function hideAllDfnPanels() {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>hideDfnPanel(el));
    }

    function showDfnPanel(dfnPanel, dfn) {
        hideAllDfnPanels(); // Only display one at this time.
        dfn.setAttribute("aria-expanded", "true");
        dfnPanel.classList.add("on");
        dfnPanel.style.left = "5px";
        dfnPanel.style.top = "0px";
        const panelRect = dfnPanel.getBoundingClientRect();
        const panelWidth = panelRect.right - panelRect.left;
        if (panelRect.right > document.body.scrollWidth) {
            // Panel's overflowing the screen.
            // Just drop it below the dfn and flip it rightward instead.
            // This still wont' fix things if the screen is *really* wide,
            // but fixing that's a lot harder without 'anchor()'.
            dfnPanel.style.top = "1.5em";
            dfnPanel.style.left = "auto";
            dfnPanel.style.right = "0px";
        }
    }

    function pinDfnPanel(dfnPanel) {
        // Switch it to "activated" state, which pins it.
        dfnPanel.classList.add("activated");
        dfnPanel.style.left = null;
        dfnPanel.style.top = null;
    }

    function hideDfnPanel(dfnPanel, dfn) {
        if(!dfn) {
            dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
        }
        dfn.setAttribute("aria-expanded", "false")
        dfnPanel.classList.remove("on");
        dfnPanel.classList.remove("activated");
    }

    function toggleDfnPanel(dfnPanel, dfn) {
        if(dfnPanel.classList.contains("on")) {
            hideDfnPanel(dfnPanel, dfn);
        } else {
            showDfnPanel(dfnPanel, dfn);
        }
    }

    function insertDfnPopupAction(dfn, dfnPanel) {
        // Find dfn panel
        const panelWrapper = document.createElement('span');
        panelWrapper.appendChild(dfnPanel);
        panelWrapper.style.position = "relative";
        panelWrapper.style.height = "0px";
        dfn.insertAdjacentElement("afterend", panelWrapper);
        dfn.setAttribute('role', 'button');
        dfn.setAttribute('aria-expanded', 'false')
        dfn.tabIndex = 0;
        dfn.classList.add('has-dfn-panel');
        dfn.addEventListener('click', (event) => {
            showDfnPanel(dfnPanel, dfn);
            event.stopPropagation();
        });
        dfn.addEventListener('keypress', (event) => {
            const kc = event.keyCode;
            // 32->Space, 13->Enter
            if(kc == 32 || kc == 13) {
                toggleDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        });

        dfnPanel.addEventListener('click', (event) => {
            if (event.target.nodeName == 'A') {
                pinDfnPanel(dfnPanel);
            }
            event.stopPropagation();
        });

        dfnPanel.addEventListener('keydown', (event) => {
            if(event.keyCode == 27) { // Escape key
                hideDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        })
    }
}
</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
    const dfnsJson = window.dfnsJson || {};

    function genDfnPanel({dfnID, url, dfnText, refSections, external}) {
        return mk.aside({
            class: "dfn-panel",
            id: `infopanel-for-${dfnID}`,
            "data-for": dfnID,
            "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
            },
            mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
                `Info about the '${dfnText}' ${external?"external":""} reference.`),
            mk.a({href:url}, url),
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({
                                    href: `#${ref.id}`
                                    },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        );
    }

    function genAllDfnPanels() {
        for(const panelData of Object.values(window.dfnpanelData)) {
            const dfnID = panelData.dfnID;
            const dfn = document.getElementById(dfnID);
            if(!dfn) {
                console.log(`Can't find dfn#${dfnID}.`, panelData);
            } else {
                const panel = genDfnPanel(panelData);
                append(document.body, panel);
                insertDfnPopupAction(dfn, panel)
            }
        }
    }

    document.addEventListener("DOMContentLoaded", ()=>{
        genAllDfnPanels();

        // Add popup behavior to all dfns to show the corresponding dfn-panel.
        var dfns = queryAll('.dfn-paneled');
        for(let dfn of dfns) { ; }

        document.body.addEventListener("click", (e) => {
            // If not handled already, just hide all dfn panels.
            hideAllDfnPanels();
        });
    })


    function hideAllDfnPanels() {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>hideDfnPanel(el));
    }

    function showDfnPanel(dfnPanel, dfn) {
        hideAllDfnPanels(); // Only display one at this time.
        dfn.setAttribute("aria-expanded", "true");
        dfnPanel.classList.add("on");
        dfnPanel.style.left = "5px";
        dfnPanel.style.top = "0px";
        const panelRect = dfnPanel.getBoundingClientRect();
        const panelWidth = panelRect.right - panelRect.left;
        if (panelRect.right > document.body.scrollWidth) {
            // Panel's overflowing the screen.
            // Just drop it below the dfn and flip it rightward instead.
            // This still wont' fix things if the screen is *really* wide,
            // but fixing that's a lot harder without 'anchor()'.
            dfnPanel.style.top = "1.5em";
            dfnPanel.style.left = "auto";
            dfnPanel.style.right = "0px";
        }
    }

    function pinDfnPanel(dfnPanel) {
        // Switch it to "activated" state, which pins it.
        dfnPanel.classList.add("activated");
        dfnPanel.style.left = null;
        dfnPanel.style.top = null;
    }

    function hideDfnPanel(dfnPanel, dfn) {
        if(!dfn) {
            dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
        }
        dfn.setAttribute("aria-expanded", "false")
        dfnPanel.classList.remove("on");
        dfnPanel.classList.remove("activated");
    }

    function toggleDfnPanel(dfnPanel, dfn) {
        if(dfnPanel.classList.contains("on")) {
            hideDfnPanel(dfnPanel, dfn);
        } else {
            showDfnPanel(dfnPanel, dfn);
        }
    }

    function insertDfnPopupAction(dfn, dfnPanel) {
        // Find dfn panel
        const panelWrapper = document.createElement('span');
        panelWrapper.appendChild(dfnPanel);
        panelWrapper.style.position = "relative";
        panelWrapper.style.height = "0px";
        dfn.insertAdjacentElement("afterend", panelWrapper);
        dfn.setAttribute('role', 'button');
        dfn.setAttribute('aria-expanded', 'false')
        dfn.tabIndex = 0;
        dfn.classList.add('has-dfn-panel');
        dfn.addEventListener('click', (event) => {
            showDfnPanel(dfnPanel, dfn);
            event.stopPropagation();
        });
        dfn.addEventListener('keypress', (event) => {
            const kc = event.keyCode;
            // 32->Space, 13->Enter
            if(kc == 32 || kc == 13) {
                toggleDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        });

        dfnPanel.addEventListener('click', (event) => {
            if (event.target.nodeName == 'A') {
                pinDfnPanel(dfnPanel);
            }
            event.stopPropagation();
        });

        dfnPanel.addEventListener('keydown', (event) => {
            if(event.keyCode == 27) { // Escape key
                hideDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        })
    }
}
</script>
<script>/* Boilerplate: script-dfn-panel-json */
window.dfnpanelData = {};
window.dfnpanelData['ae6f41f1'] = {"dfnID": "ae6f41f1", "url": "https://www.ietf.org/rfc/rfc4122.txt#urn-uuid", "dfnText": "urn uuid", "refSections": [{"refs": [{"id": "ref-for-urn-uuid"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": true};
window.dfnpanelData['c55932e1'] = {"dfnID": "c55932e1", "url": "https://github.com/privacysandbox/attestation#enrolled", "dfnText": "enrolled", "refSections": [{"refs": [{"id": "ref-for-enrolled"}], "title": "2. The SharedStorageWorklet Interface"}], "external": true};
window.dfnpanelData['2efaa6ee'] = {"dfnID": "2efaa6ee", "url": "https://w3c.github.io/beacon/#beacon", "dfnText": "beacon", "refSections": [{"refs": [{"id": "ref-for-beacon"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}], "external": true};
window.dfnpanelData['4650cbb8'] = {"dfnID": "4650cbb8", "url": "https://drafts.csswg.org/css-syntax-3/#function", "dfnText": "function", "refSections": [{"refs": [{"id": "ref-for-function"}], "title": "2.3.1. Monkey Patch for request destination"}], "external": true};
window.dfnpanelData['85394472'] = {"dfnID": "85394472", "url": "https://dom.spec.whatwg.org/#document", "dfnText": "Document", "refSections": [{"refs": [{"id": "ref-for-document"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-document\u2460"}, {"id": "ref-for-document\u2461"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": true};
window.dfnpanelData['5216e1a0'] = {"dfnID": "5216e1a0", "url": "https://dom.spec.whatwg.org/#concept-node-document", "dfnText": "node document", "refSections": [{"refs": [{"id": "ref-for-concept-node-document"}, {"id": "ref-for-concept-node-document\u2460"}, {"id": "ref-for-concept-node-document\u2461"}, {"id": "ref-for-concept-node-document\u2462"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-concept-node-document\u2463"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": true};
window.dfnpanelData['c62cd7cf'] = {"dfnID": "c62cd7cf", "url": "https://dom.spec.whatwg.org/#concept-document-origin", "dfnText": "origin", "refSections": [{"refs": [{"id": "ref-for-concept-document-origin"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-concept-document-origin\u2460"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": true};
window.dfnpanelData['3aec4bbc'] = {"dfnID": "3aec4bbc", "url": "https://tc39.es/ecma262/#current-realm", "dfnText": "current realm", "refSections": [{"refs": [{"id": "ref-for-current-realm"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-current-realm\u2460"}, {"id": "ref-for-current-realm\u2461"}, {"id": "ref-for-current-realm\u2462"}, {"id": "ref-for-current-realm\u2463"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-current-realm\u2464"}, {"id": "ref-for-current-realm\u2465"}, {"id": "ref-for-current-realm\u2466"}, {"id": "ref-for-current-realm\u2467"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-current-realm\u2468"}, {"id": "ref-for-current-realm\u2460\u24ea"}, {"id": "ref-for-current-realm\u2460\u2460"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-current-realm\u2460\u2461"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['192e00bf'] = {"dfnID": "192e00bf", "url": "https://tc39.es/ecma262/#sec-get-o-p", "dfnText": "get", "refSections": [{"refs": [{"id": "ref-for-sec-get-o-p"}], "title": "2.4. SharedStorageWorkletGlobalScope algorithms"}], "external": true};
window.dfnpanelData['b0fcb8d7'] = {"dfnID": "b0fcb8d7", "url": "https://encoding.spec.whatwg.org/#utf-8-decode", "dfnText": "utf-8 decode", "refSections": [{"refs": [{"id": "ref-for-utf-8-decode"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['0303e8e5'] = {"dfnID": "0303e8e5", "url": "https://encoding.spec.whatwg.org/#utf-8-encode", "dfnText": "utf-8 encode", "refSections": [{"refs": [{"id": "ref-for-utf-8-encode"}, {"id": "ref-for-utf-8-encode\u2460"}], "title": "7.3.2. `Shared-Storage-Write` Response Header"}], "external": true};
window.dfnpanelData['8edb2f5a'] = {"dfnID": "8edb2f5a", "url": "https://wicg.github.io/fenced-frame/#dictdef-fenceevent", "dfnText": "FenceEvent", "refSections": [{"refs": [{"id": "ref-for-dictdef-fenceevent"}, {"id": "ref-for-dictdef-fenceevent\u2460"}, {"id": "ref-for-dictdef-fenceevent\u2461"}, {"id": "ref-for-dictdef-fenceevent\u2462"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}], "external": true};
window.dfnpanelData['24f2f8da'] = {"dfnID": "24f2f8da", "url": "https://wicg.github.io/fenced-frame/#fencedframeconfig", "dfnText": "FencedFrameConfig", "refSections": [{"refs": [{"id": "ref-for-fencedframeconfig"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-fencedframeconfig\u2460"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": true};
window.dfnpanelData['69ac8948'] = {"dfnID": "69ac8948", "url": "https://wicg.github.io/fenced-frame/#dom-fenceevent-destination", "dfnText": "destination", "refSections": [{"refs": [{"id": "ref-for-dom-fenceevent-destination"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}, {"refs": [{"id": "ref-for-dom-fenceevent-destination\u2460"}, {"id": "ref-for-dom-fenceevent-destination\u2461"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": true};
window.dfnpanelData['f09e6fca'] = {"dfnID": "f09e6fca", "url": "https://wicg.github.io/fenced-frame/#dom-fenceevent-eventdata", "dfnText": "eventData", "refSections": [{"refs": [{"id": "ref-for-dom-fenceevent-eventdata"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}], "external": true};
window.dfnpanelData['adcea05f'] = {"dfnID": "adcea05f", "url": "https://wicg.github.io/fenced-frame/#dom-fenceevent-eventtype", "dfnText": "eventType", "refSections": [{"refs": [{"id": "ref-for-dom-fenceevent-eventtype"}, {"id": "ref-for-dom-fenceevent-eventtype\u2460"}, {"id": "ref-for-dom-fenceevent-eventtype\u2461"}, {"id": "ref-for-dom-fenceevent-eventtype\u2462"}, {"id": "ref-for-dom-fenceevent-eventtype\u2463"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}, {"refs": [{"id": "ref-for-dom-fenceevent-eventtype\u2464"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": true};
window.dfnpanelData['f8240630'] = {"dfnID": "f8240630", "url": "https://wicg.github.io/fenced-frame/#the-fencedframe-element", "dfnText": "fenced frame", "refSections": [{"refs": [{"id": "ref-for-the-fencedframe-element"}], "title": "1. Introduction"}, {"refs": [{"id": "ref-for-the-fencedframe-element\u2460"}, {"id": "ref-for-the-fencedframe-element\u2461"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}, {"refs": [{"id": "ref-for-the-fencedframe-element\u2462"}, {"id": "ref-for-the-fencedframe-element\u2463"}, {"id": "ref-for-the-fencedframe-element\u2464"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-the-fencedframe-element\u2465"}], "title": "2.6.2. Reporting Entropy Budget"}, {"refs": [{"id": "ref-for-the-fencedframe-element\u2466"}, {"id": "ref-for-the-fencedframe-element\u2467"}, {"id": "ref-for-the-fencedframe-element\u2468"}], "title": "10. Privacy Considerations"}], "external": true};
window.dfnpanelData['b8914171'] = {"dfnID": "b8914171", "url": "https://wicg.github.io/fenced-frame/#fenced-frame-config", "dfnText": "fenced frame config", "refSections": [{"refs": [{"id": "ref-for-fenced-frame-config"}, {"id": "ref-for-fenced-frame-config\u2460"}, {"id": "ref-for-fenced-frame-config\u2461"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-fenced-frame-config\u2462"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}], "external": true};
window.dfnpanelData['cf17e487'] = {"dfnID": "cf17e487", "url": "https://wicg.github.io/fenced-frame/#browsing-context-fenced-frame-config-instance", "dfnText": "fenced frame config instance", "refSections": [{"refs": [{"id": "ref-for-browsing-context-fenced-frame-config-instance"}, {"id": "ref-for-browsing-context-fenced-frame-config-instance\u2460"}, {"id": "ref-for-browsing-context-fenced-frame-config-instance\u2461"}, {"id": "ref-for-browsing-context-fenced-frame-config-instance\u2462"}, {"id": "ref-for-browsing-context-fenced-frame-config-instance\u2463"}, {"id": "ref-for-browsing-context-fenced-frame-config-instance\u2464"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-browsing-context-fenced-frame-config-instance\u2465"}, {"id": "ref-for-browsing-context-fenced-frame-config-instance\u2466"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": true};
window.dfnpanelData['06799577'] = {"dfnID": "06799577", "url": "https://wicg.github.io/fenced-frame/#traversable-navigable-fenced-frame-config-mapping", "dfnText": "fenced frame config mapping", "refSections": [{"refs": [{"id": "ref-for-traversable-navigable-fenced-frame-config-mapping"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}], "external": true};
window.dfnpanelData['16ebb1f5'] = {"dfnID": "16ebb1f5", "url": "https://wicg.github.io/fenced-frame/#fencedframetype-fenced-frame-reporter", "dfnText": "fenced frame reporter", "refSections": [{"refs": [{"id": "ref-for-fencedframetype-fenced-frame-reporter"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}], "external": true};
window.dfnpanelData['e5128568'] = {"dfnID": "e5128568", "url": "https://wicg.github.io/fenced-frame/#fenced-frame-config-mapping-finalize-a-pending-config", "dfnText": "finalize a pending config", "refSections": [{"refs": [{"id": "ref-for-fenced-frame-config-mapping-finalize-a-pending-config"}, {"id": "ref-for-fenced-frame-config-mapping-finalize-a-pending-config\u2460"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}], "external": true};
window.dfnpanelData['6417de26'] = {"dfnID": "6417de26", "url": "https://wicg.github.io/fenced-frame/#source-snapshot-params-initiator-fenced-frame-config-instance", "dfnText": "initiator fenced frame config instance", "refSections": [{"refs": [{"id": "ref-for-source-snapshot-params-initiator-fenced-frame-config-instance"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": true};
window.dfnpanelData['e231e88f'] = {"dfnID": "e231e88f", "url": "https://wicg.github.io/fenced-frame/#fenced-frame-config-mapped-url", "dfnText": "mapped url", "refSections": [{"refs": [{"id": "ref-for-fenced-frame-config-mapped-url"}, {"id": "ref-for-fenced-frame-config-mapped-url\u2460"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}], "external": true};
window.dfnpanelData['65de84a0'] = {"dfnID": "65de84a0", "url": "https://wicg.github.io/fenced-frame/#dom-fence-reportevent", "dfnText": "reportEvent()", "refSections": [{"refs": [{"id": "ref-for-dom-fence-reportevent"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}, {"refs": [{"id": "ref-for-dom-fence-reportevent\u2460"}, {"id": "ref-for-dom-fence-reportevent\u2461"}, {"id": "ref-for-dom-fence-reportevent\u2462"}, {"id": "ref-for-dom-fence-reportevent\u2463"}], "title": "2.6.2. Reporting Entropy Budget"}, {"refs": [{"id": "ref-for-dom-fence-reportevent\u2464"}], "title": "10. Privacy Considerations"}], "external": true};
window.dfnpanelData['c5b31ce5'] = {"dfnID": "c5b31ce5", "url": "https://wicg.github.io/fenced-frame/#fenced-frame-config-mapping-store-a-pending-config", "dfnText": "store a pending config", "refSections": [{"refs": [{"id": "ref-for-fenced-frame-config-mapping-store-a-pending-config"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}], "external": true};
window.dfnpanelData['0dcd4ad9'] = {"dfnID": "0dcd4ad9", "url": "https://fetch.spec.whatwg.org/#requestinit", "dfnText": "RequestInit", "refSections": [{"refs": [{"id": "ref-for-requestinit"}, {"id": "ref-for-requestinit\u2460"}], "title": "7.1. sharedStorageWritable Key"}], "external": true};
window.dfnpanelData['3f2ca4de'] = {"dfnID": "3f2ca4de", "url": "https://fetch.spec.whatwg.org/#concept-request-current-url", "dfnText": "current url", "refSections": [{"refs": [{"id": "ref-for-concept-request-current-url"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-concept-request-current-url\u2460"}, {"id": "ref-for-concept-request-current-url\u2461"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['ee95ecc7'] = {"dfnID": "ee95ecc7", "url": "https://fetch.spec.whatwg.org/#concept-header-list-delete", "dfnText": "delete", "refSections": [{"refs": [{"id": "ref-for-concept-header-list-delete"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['3ae34c95'] = {"dfnID": "3ae34c95", "url": "https://fetch.spec.whatwg.org/#concept-request-destination", "dfnText": "destination", "refSections": [{"refs": [{"id": "ref-for-concept-request-destination"}], "title": "2.2.5. Monkey Patch for HTTP fetch"}, {"refs": [{"id": "ref-for-concept-request-destination\u2460"}, {"id": "ref-for-concept-request-destination\u2461"}], "title": "2.3.1. Monkey Patch for request destination"}], "external": true};
window.dfnpanelData['a33db89a'] = {"dfnID": "a33db89a", "url": "https://fetch.spec.whatwg.org/#concept-fetch", "dfnText": "fetch", "refSections": [{"refs": [{"id": "ref-for-concept-fetch"}], "title": "2.2.3. Monkey Patch for fetch a worklet script graph"}], "external": true};
window.dfnpanelData['5c66de35'] = {"dfnID": "5c66de35", "url": "https://fetch.spec.whatwg.org/#concept-header-list-get-structured-header", "dfnText": "get a structured field value", "refSections": [{"refs": [{"id": "ref-for-concept-header-list-get-structured-header"}], "title": "2.2.5. Monkey Patch for HTTP fetch"}, {"refs": [{"id": "ref-for-concept-header-list-get-structured-header\u2460"}, {"id": "ref-for-concept-header-list-get-structured-header\u2461"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['c9e7c11a'] = {"dfnID": "c9e7c11a", "url": "https://fetch.spec.whatwg.org/#concept-header", "dfnText": "header", "refSections": [{"refs": [{"id": "ref-for-concept-header"}], "title": "5. Triggering Operations Via HTTP Response Header"}, {"refs": [{"id": "ref-for-concept-header\u2460"}, {"id": "ref-for-concept-header\u2461"}], "title": "7.3.1. `Sec-Shared-Storage-Writable` Request Header"}, {"refs": [{"id": "ref-for-concept-header\u2462"}, {"id": "ref-for-concept-header\u2463"}], "title": "7.3.2. `Shared-Storage-Write` Response Header"}], "external": true};
window.dfnpanelData['6ee0eab1'] = {"dfnID": "6ee0eab1", "url": "https://fetch.spec.whatwg.org/#concept-request-header-list", "dfnText": "header list (for request)", "refSections": [{"refs": [{"id": "ref-for-concept-request-header-list"}], "title": "7.2.2. Modification to HTTP network or cache fetch Algorithm"}, {"refs": [{"id": "ref-for-concept-request-header-list\u2460"}, {"id": "ref-for-concept-request-header-list\u2461"}, {"id": "ref-for-concept-request-header-list\u2462"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['f7b00a8b'] = {"dfnID": "f7b00a8b", "url": "https://fetch.spec.whatwg.org/#concept-response-header-list", "dfnText": "header list (for response)", "refSections": [{"refs": [{"id": "ref-for-concept-response-header-list"}], "title": "2.2.5. Monkey Patch for HTTP fetch"}, {"refs": [{"id": "ref-for-concept-response-header-list\u2460"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['2aaa2f42'] = {"dfnID": "2aaa2f42", "url": "https://fetch.spec.whatwg.org/#concept-http-fetch", "dfnText": "http fetch", "refSections": [{"refs": [{"id": "ref-for-concept-http-fetch"}, {"id": "ref-for-concept-http-fetch\u2460"}], "title": "2.2.5. Monkey Patch for HTTP fetch"}, {"refs": [{"id": "ref-for-concept-http-fetch\u2461"}, {"id": "ref-for-concept-http-fetch\u2462"}], "title": "7.2.3. Modification to HTTP fetch Algorithm"}], "external": true};
window.dfnpanelData['2c2acc57'] = {"dfnID": "2c2acc57", "url": "https://fetch.spec.whatwg.org/#concept-http-network-or-cache-fetch", "dfnText": "http network or cache fetch", "refSections": [{"refs": [{"id": "ref-for-concept-http-network-or-cache-fetch"}, {"id": "ref-for-concept-http-network-or-cache-fetch\u2460"}], "title": "7.2.2. Modification to HTTP network or cache fetch Algorithm"}], "external": true};
window.dfnpanelData['eb1b1af3'] = {"dfnID": "eb1b1af3", "url": "https://fetch.spec.whatwg.org/#concept-network-error", "dfnText": "network error", "refSections": [{"refs": [{"id": "ref-for-concept-network-error"}], "title": "2.2.5. Monkey Patch for HTTP fetch"}], "external": true};
window.dfnpanelData['f78d5b5c'] = {"dfnID": "f78d5b5c", "url": "https://fetch.spec.whatwg.org/#concept-request-origin", "dfnText": "origin", "refSections": [{"refs": [{"id": "ref-for-concept-request-origin"}, {"id": "ref-for-concept-request-origin\u2460"}], "title": "2.2.5. Monkey Patch for HTTP fetch"}], "external": true};
window.dfnpanelData['d83f8790'] = {"dfnID": "d83f8790", "url": "https://fetch.spec.whatwg.org/#request-priority", "dfnText": "priority", "refSections": [{"refs": [{"id": "ref-for-request-priority"}], "title": "6.2.1. Modification to Update the image data Algorithm"}], "external": true};
window.dfnpanelData['64b62ea0'] = {"dfnID": "64b62ea0", "url": "https://fetch.spec.whatwg.org/#concept-request-redirect-mode", "dfnText": "redirect mode", "refSections": [{"refs": [{"id": "ref-for-concept-request-redirect-mode"}], "title": "2.2.3. Monkey Patch for fetch a worklet script graph"}], "external": true};
window.dfnpanelData['a8b25997'] = {"dfnID": "a8b25997", "url": "https://fetch.spec.whatwg.org/#redirect-status", "dfnText": "redirect status", "refSections": [{"refs": [{"id": "ref-for-redirect-status"}], "title": "7.2.3. Modification to HTTP fetch Algorithm"}], "external": true};
window.dfnpanelData['55213b5b'] = {"dfnID": "55213b5b", "url": "https://fetch.spec.whatwg.org/#concept-request", "dfnText": "request", "refSections": [{"refs": [{"id": "ref-for-concept-request"}], "title": "7.1. sharedStorageWritable Key"}, {"refs": [{"id": "ref-for-concept-request\u2460"}], "title": "7.2.3. Modification to HTTP fetch Algorithm"}, {"refs": [{"id": "ref-for-concept-request\u2461"}, {"id": "ref-for-concept-request\u2462"}, {"id": "ref-for-concept-request\u2463"}], "title": "7.3.1. `Sec-Shared-Storage-Writable` Request Header"}, {"refs": [{"id": "ref-for-concept-request\u2464"}, {"id": "ref-for-concept-request\u2465"}, {"id": "ref-for-concept-request\u2466"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['162d2b51'] = {"dfnID": "162d2b51", "url": "https://fetch.spec.whatwg.org/#concept-request-request", "dfnText": "request (for Request)", "refSections": [{"refs": [{"id": "ref-for-concept-request-request"}], "title": "6.2.2. Modification to Create navigation params by fetching Algorithm"}, {"refs": [{"id": "ref-for-concept-request-request\u2460"}], "title": "7.2.1. Modification to the Request Constructor Algorithm"}], "external": true};
window.dfnpanelData['c07c4a8c'] = {"dfnID": "c07c4a8c", "url": "https://fetch.spec.whatwg.org/#dom-request", "dfnText": "request-constructor", "refSections": [{"refs": [{"id": "ref-for-dom-request"}, {"id": "ref-for-dom-request\u2460"}], "title": "7.2.1. Modification to the Request Constructor Algorithm"}], "external": true};
window.dfnpanelData['ee7bba09'] = {"dfnID": "ee7bba09", "url": "https://fetch.spec.whatwg.org/#concept-response", "dfnText": "response", "refSections": [{"refs": [{"id": "ref-for-concept-response"}], "title": "5. Triggering Operations Via HTTP Response Header"}, {"refs": [{"id": "ref-for-concept-response\u2460"}], "title": "7.2.3. Modification to HTTP fetch Algorithm"}, {"refs": [{"id": "ref-for-concept-response\u2461"}], "title": "7.3.1. `Sec-Shared-Storage-Writable` Request Header"}, {"refs": [{"id": "ref-for-concept-response\u2462"}, {"id": "ref-for-concept-response\u2463"}], "title": "7.3.2. `Shared-Storage-Write` Response Header"}, {"refs": [{"id": "ref-for-concept-response\u2464"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['35b98f13'] = {"dfnID": "35b98f13", "url": "https://fetch.spec.whatwg.org/#concept-header-list-set-structured-header", "dfnText": "set a structured field value", "refSections": [{"refs": [{"id": "ref-for-concept-header-list-set-structured-header"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['a1d47575'] = {"dfnID": "a1d47575", "url": "https://fetch.spec.whatwg.org/#concept-response-status", "dfnText": "status", "refSections": [{"refs": [{"id": "ref-for-concept-response-status"}], "title": "7.2.3. Modification to HTTP fetch Algorithm"}], "external": true};
window.dfnpanelData['dc1cd39b'] = {"dfnID": "dc1cd39b", "url": "https://fetch.spec.whatwg.org/#concept-request-url", "dfnText": "url", "refSections": [{"refs": [{"id": "ref-for-concept-request-url"}], "title": "2.2.3. Monkey Patch for fetch a worklet script graph"}, {"refs": [{"id": "ref-for-concept-request-url\u2460"}], "title": "2.2.5. Monkey Patch for HTTP fetch"}], "external": true};
window.dfnpanelData['1ab127d6'] = {"dfnID": "1ab127d6", "url": "https://fetch.spec.whatwg.org/#concept-request-window", "dfnText": "window", "refSections": [{"refs": [{"id": "ref-for-concept-request-window"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-concept-request-window\u2460"}, {"id": "ref-for-concept-request-window\u2461"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['0e9f636b'] = {"dfnID": "0e9f636b", "url": "https://w3c.github.io/hr-time/#dom-domhighrestimestamp", "dfnText": "DOMHighResTimeStamp", "refSections": [{"refs": [{"id": "ref-for-dom-domhighrestimestamp"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-dom-domhighrestimestamp\u2460"}], "title": "3.2. The Shared Storage Database"}], "external": true};
window.dfnpanelData['a09bfce2'] = {"dfnID": "a09bfce2", "url": "https://w3c.github.io/hr-time/#dfn-current-wall-time", "dfnText": "current wall time", "refSections": [{"refs": [{"id": "ref-for-dfn-current-wall-time"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": true};
window.dfnpanelData['f16ee824'] = {"dfnID": "f16ee824", "url": "https://w3c.github.io/hr-time/#dfn-eso-current-wall-time", "dfnText": "current wall time (for environment settings object)", "refSections": [{"refs": [{"id": "ref-for-dfn-eso-current-wall-time"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-dfn-eso-current-wall-time\u2460"}, {"id": "ref-for-dfn-eso-current-wall-time\u2461"}], "title": "3.3. The Database Algorithms"}], "external": true};
window.dfnpanelData['4b2c8c72'] = {"dfnID": "4b2c8c72", "url": "https://w3c.github.io/hr-time/#dfn-duration", "dfnText": "duration", "refSections": [{"refs": [{"id": "ref-for-dfn-duration"}, {"id": "ref-for-dfn-duration\u2460"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-dfn-duration\u2461"}], "title": "3.2. The Shared Storage Database"}], "external": true};
window.dfnpanelData['be5dbc8c'] = {"dfnID": "be5dbc8c", "url": "https://w3c.github.io/hr-time/#dfn-unix-epoch", "dfnText": "unix epoch", "refSections": [{"refs": [{"id": "ref-for-dfn-unix-epoch"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-dfn-unix-epoch\u2460"}], "title": "3.2. The Shared Storage Database"}], "external": true};
window.dfnpanelData['402ed79d'] = {"dfnID": "402ed79d", "url": "https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions", "dfnText": "CEReactions", "refSections": [{"refs": [{"id": "ref-for-cereactions"}], "title": "6.1. sharedStorageWritable & sharedstoragewritable Attributes"}], "external": true};
window.dfnpanelData['10e25f42'] = {"dfnID": "10e25f42", "url": "https://html.spec.whatwg.org/multipage/iframe-embed-object.html#htmliframeelement", "dfnText": "HTMLIFrameElement", "refSections": [{"refs": [{"id": "ref-for-htmliframeelement"}, {"id": "ref-for-htmliframeelement\u2460"}], "title": "6.1. sharedStorageWritable & sharedstoragewritable Attributes"}], "external": true};
window.dfnpanelData['c5891539'] = {"dfnID": "c5891539", "url": "https://html.spec.whatwg.org/multipage/embedded-content.html#htmlimageelement", "dfnText": "HTMLImageElement", "refSections": [{"refs": [{"id": "ref-for-htmlimageelement"}, {"id": "ref-for-htmlimageelement\u2460"}], "title": "6.1. sharedStorageWritable & sharedstoragewritable Attributes"}], "external": true};
window.dfnpanelData['5d7209e9'] = {"dfnID": "5d7209e9", "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#window", "dfnText": "Window", "refSections": [{"refs": [{"id": "ref-for-window"}, {"id": "ref-for-window\u2460"}, {"id": "ref-for-window\u2461"}, {"id": "ref-for-window\u2462"}, {"id": "ref-for-window\u2463"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-window\u2464"}, {"id": "ref-for-window\u2465"}, {"id": "ref-for-window\u2466"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-window\u2467"}, {"id": "ref-for-window\u2468"}], "title": "2.2.5. Monkey Patch for HTTP fetch"}, {"refs": [{"id": "ref-for-window\u2460\u24ea"}, {"id": "ref-for-window\u2460\u2460"}, {"id": "ref-for-window\u2460\u2461"}, {"id": "ref-for-window\u2460\u2462"}], "title": "4. The SharedStorage Interface"}, {"refs": [{"id": "ref-for-window\u2460\u2463"}, {"id": "ref-for-window\u2460\u2464"}, {"id": "ref-for-window\u2460\u2465"}, {"id": "ref-for-window\u2460\u2466"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-window\u2460\u2467"}, {"id": "ref-for-window\u2460\u2468"}, {"id": "ref-for-window\u2461\u24ea"}, {"id": "ref-for-window\u2461\u2460"}], "title": "4.2. Extension to the Window interface"}, {"refs": [{"id": "ref-for-window\u2461\u2461"}], "title": "5. Triggering Operations Via HTTP Response Header"}, {"refs": [{"id": "ref-for-window\u2461\u2462"}, {"id": "ref-for-window\u2461\u2463"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['2879c404'] = {"dfnID": "2879c404", "url": "https://html.spec.whatwg.org/multipage/worklets.html#worklet", "dfnText": "Worklet", "refSections": [{"refs": [{"id": "ref-for-worklet"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-worklet\u2460"}], "title": "2.2.1. Monkey Patch for set up a worklet environment settings object"}, {"refs": [{"id": "ref-for-worklet\u2461"}], "title": "2.2.6. Monkey Patch for addModule()"}], "external": true};
window.dfnpanelData['0c9b0d3c'] = {"dfnID": "0c9b0d3c", "url": "https://html.spec.whatwg.org/multipage/worklets.html#workletglobalscope", "dfnText": "WorkletGlobalScope", "refSections": [{"refs": [{"id": "ref-for-workletglobalscope"}], "title": "2.3.1. Monkey Patch for request destination"}], "external": true};
window.dfnpanelData['47a5f7a3'] = {"dfnID": "47a5f7a3", "url": "https://html.spec.whatwg.org/multipage/worklets.html#workletoptions", "dfnText": "WorkletOptions", "refSections": [{"refs": [{"id": "ref-for-workletoptions"}], "title": "4.1. The WindowSharedStorage interface"}], "external": true};
window.dfnpanelData['35972864'] = {"dfnID": "35972864", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#nav-document", "dfnText": "active document", "refSections": [{"refs": [{"id": "ref-for-nav-document"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-nav-document\u2460"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": true};
window.dfnpanelData['101c721c'] = {"dfnID": "101c721c", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#nav-window", "dfnText": "active window", "refSections": [{"refs": [{"id": "ref-for-nav-window"}, {"id": "ref-for-nav-window\u2460"}, {"id": "ref-for-nav-window\u2461"}, {"id": "ref-for-nav-window\u2462"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-nav-window\u2463"}, {"id": "ref-for-nav-window\u2464"}, {"id": "ref-for-nav-window\u2465"}, {"id": "ref-for-nav-window\u2466"}, {"id": "ref-for-nav-window\u2467"}, {"id": "ref-for-nav-window\u2468"}, {"id": "ref-for-nav-window\u2460\u24ea"}, {"id": "ref-for-nav-window\u2460\u2460"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-nav-window\u2460\u2461"}, {"id": "ref-for-nav-window\u2460\u2462"}, {"id": "ref-for-nav-window\u2460\u2463"}, {"id": "ref-for-nav-window\u2460\u2464"}, {"id": "ref-for-nav-window\u2460\u2465"}, {"id": "ref-for-nav-window\u2460\u2466"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-nav-window\u2460\u2467"}, {"id": "ref-for-nav-window\u2460\u2468"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['eec46e27'] = {"dfnID": "eec46e27", "url": "https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule", "dfnText": "addModule(moduleURL, options)", "refSections": [{"refs": [{"id": "ref-for-dom-worklet-addmodule"}, {"id": "ref-for-dom-worklet-addmodule\u2460"}, {"id": "ref-for-dom-worklet-addmodule\u2461"}, {"id": "ref-for-dom-worklet-addmodule\u2462"}, {"id": "ref-for-dom-worklet-addmodule\u2463"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-dom-worklet-addmodule\u2464"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-dom-worklet-addmodule\u2465"}, {"id": "ref-for-dom-worklet-addmodule\u2466"}, {"id": "ref-for-dom-worklet-addmodule\u2467"}], "title": "2.2.6. Monkey Patch for addModule()"}, {"refs": [{"id": "ref-for-dom-worklet-addmodule\u2468"}], "title": "4. The SharedStorage Interface"}, {"refs": [{"id": "ref-for-dom-worklet-addmodule\u2460\u24ea"}], "title": "4.1.3. Create a new worklet via WindowSharedStorage"}], "external": true};
window.dfnpanelData['0c444cb5'] = {"dfnID": "0c444cb5", "url": "https://html.spec.whatwg.org/multipage/worklets.html#concept-worklet-added-modules-list", "dfnText": "added modules list", "refSections": [{"refs": [{"id": "ref-for-concept-worklet-added-modules-list"}], "title": "2.2.1. Monkey Patch for set up a worklet environment settings object"}], "external": true};
window.dfnpanelData['3349d69f'] = {"dfnID": "3349d69f", "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window", "dfnText": "associated document", "refSections": [{"refs": [{"id": "ref-for-concept-document-window"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-concept-document-window\u2460"}, {"id": "ref-for-concept-document-window\u2461"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-concept-document-window\u2462"}, {"id": "ref-for-concept-document-window\u2463"}, {"id": "ref-for-concept-document-window\u2464"}, {"id": "ref-for-concept-document-window\u2465"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-concept-document-window\u2466"}, {"id": "ref-for-concept-document-window\u2467"}, {"id": "ref-for-concept-document-window\u2468"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-concept-document-window\u2460\u24ea"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['772cb7dd'] = {"dfnID": "772cb7dd", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#beginning-navigation", "dfnText": "beginning navigation", "refSections": [{"refs": [{"id": "ref-for-beginning-navigation"}, {"id": "ref-for-beginning-navigation\u2460"}, {"id": "ref-for-beginning-navigation\u2461"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": true};
window.dfnpanelData['b0b31697'] = {"dfnID": "b0b31697", "url": "https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#boolean-attributes", "dfnText": "boolean attributes", "refSections": [{"refs": [{"id": "ref-for-boolean-attributes"}], "title": "6.1. sharedStorageWritable & sharedstoragewritable Attributes"}], "external": true};
window.dfnpanelData['0d0390b4'] = {"dfnID": "0d0390b4", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#browsing-context", "dfnText": "browsing context", "refSections": [{"refs": [{"id": "ref-for-browsing-context"}, {"id": "ref-for-browsing-context\u2460"}], "title": "3.2. The Shared Storage Database"}], "external": true};
window.dfnpanelData['3b2ff63e'] = {"dfnID": "3b2ff63e", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#concept-document-bc", "dfnText": "browsing context (for Document)", "refSections": [{"refs": [{"id": "ref-for-concept-document-bc"}, {"id": "ref-for-concept-document-bc\u2460"}, {"id": "ref-for-concept-document-bc\u2461"}, {"id": "ref-for-concept-document-bc\u2462"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-concept-document-bc\u2463"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": true};
window.dfnpanelData['6d88ab2e'] = {"dfnID": "6d88ab2e", "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#window-bc", "dfnText": "browsing context (for Window)", "refSections": [{"refs": [{"id": "ref-for-window-bc"}, {"id": "ref-for-window-bc\u2460"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-window-bc\u2461"}, {"id": "ref-for-window-bc\u2462"}, {"id": "ref-for-window-bc\u2463"}, {"id": "ref-for-window-bc\u2464"}], "title": "4.1.1. Window Setter/Deleter Methods"}], "external": true};
window.dfnpanelData['762210c0'] = {"dfnID": "762210c0", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#nav-container", "dfnText": "container", "refSections": [{"refs": [{"id": "ref-for-nav-container"}], "title": "6.2.2. Modification to Create navigation params by fetching Algorithm"}], "external": true};
window.dfnpanelData['68675e70'] = {"dfnID": "68675e70", "url": "https://html.spec.whatwg.org/multipage/dom.html#concept-element-attributes", "dfnText": "content attributes", "refSections": [{"refs": [{"id": "ref-for-concept-element-attributes"}], "title": "6.1. sharedStorageWritable & sharedstoragewritable Attributes"}, {"refs": [{"id": "ref-for-concept-element-attributes\u2460"}], "title": "6.2.2. Modification to Create navigation params by fetching Algorithm"}], "external": true};
window.dfnpanelData['e4ffa115'] = {"dfnID": "e4ffa115", "url": "https://html.spec.whatwg.org/multipage/worklets.html#create-a-worklet-global-scope", "dfnText": "create a worklet global scope", "refSections": [{"refs": [{"id": "ref-for-create-a-worklet-global-scope"}, {"id": "ref-for-create-a-worklet-global-scope\u2460"}], "title": "2.2.2. Monkey Patch for create a worklet global scope"}], "external": true};
window.dfnpanelData['faaaa5a1'] = {"dfnID": "faaaa5a1", "url": "https://html.spec.whatwg.org/multipage/browsing-the-web.html#create-navigation-params-by-fetchin", "dfnText": "create navigation params by fetching", "refSections": [{"refs": [{"id": "ref-for-create-navigation-params-by-fetchin"}, {"id": "ref-for-create-navigation-params-by-fetchin\u2460"}], "title": "6.2.2. Modification to Create navigation params by fetching Algorithm"}], "external": true};
window.dfnpanelData['12b8dfc0'] = {"dfnID": "12b8dfc0", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object", "dfnText": "current settings object", "refSections": [{"refs": [{"id": "ref-for-current-settings-object"}, {"id": "ref-for-current-settings-object\u2460"}, {"id": "ref-for-current-settings-object\u2461"}], "title": "2. The SharedStorageWorklet Interface"}], "external": true};
window.dfnpanelData['e10e7eb7'] = {"dfnID": "e10e7eb7", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source", "dfnText": "dom manipulation task source", "refSections": [{"refs": [{"id": "ref-for-dom-manipulation-task-source"}, {"id": "ref-for-dom-manipulation-task-source\u2460"}, {"id": "ref-for-dom-manipulation-task-source\u2461"}, {"id": "ref-for-dom-manipulation-task-source\u2462"}, {"id": "ref-for-dom-manipulation-task-source\u2463"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-dom-manipulation-task-source\u2464"}, {"id": "ref-for-dom-manipulation-task-source\u2465"}, {"id": "ref-for-dom-manipulation-task-source\u2466"}, {"id": "ref-for-dom-manipulation-task-source\u2467"}, {"id": "ref-for-dom-manipulation-task-source\u2468"}, {"id": "ref-for-dom-manipulation-task-source\u2460\u24ea"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-dom-manipulation-task-source\u2460\u2460"}, {"id": "ref-for-dom-manipulation-task-source\u2460\u2461"}, {"id": "ref-for-dom-manipulation-task-source\u2460\u2462"}, {"id": "ref-for-dom-manipulation-task-source\u2460\u2463"}, {"id": "ref-for-dom-manipulation-task-source\u2460\u2464"}, {"id": "ref-for-dom-manipulation-task-source\u2460\u2465"}, {"id": "ref-for-dom-manipulation-task-source\u2460\u2466"}, {"id": "ref-for-dom-manipulation-task-source\u2460\u2467"}, {"id": "ref-for-dom-manipulation-task-source\u2460\u2468"}, {"id": "ref-for-dom-manipulation-task-source\u2461\u24ea"}, {"id": "ref-for-dom-manipulation-task-source\u2461\u2460"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-dom-manipulation-task-source\u2461\u2461"}, {"id": "ref-for-dom-manipulation-task-source\u2461\u2462"}, {"id": "ref-for-dom-manipulation-task-source\u2461\u2463"}, {"id": "ref-for-dom-manipulation-task-source\u2461\u2464"}, {"id": "ref-for-dom-manipulation-task-source\u2461\u2465"}, {"id": "ref-for-dom-manipulation-task-source\u2461\u2466"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-dom-manipulation-task-source\u2461\u2467"}, {"id": "ref-for-dom-manipulation-task-source\u2461\u2468"}, {"id": "ref-for-dom-manipulation-task-source\u2462\u24ea"}, {"id": "ref-for-dom-manipulation-task-source\u2462\u2460"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['7dbefaad'] = {"dfnID": "7dbefaad", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#ending-navigation", "dfnText": "ending navigation", "refSections": [{"refs": [{"id": "ref-for-ending-navigation"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": true};
window.dfnpanelData['102df61f'] = {"dfnID": "102df61f", "url": "https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps", "dfnText": "enqueue the following steps", "refSections": [{"refs": [{"id": "ref-for-enqueue-the-following-steps"}, {"id": "ref-for-enqueue-the-following-steps\u2460"}, {"id": "ref-for-enqueue-the-following-steps\u2461"}, {"id": "ref-for-enqueue-the-following-steps\u2462"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-enqueue-the-following-steps\u2463"}, {"id": "ref-for-enqueue-the-following-steps\u2464"}, {"id": "ref-for-enqueue-the-following-steps\u2465"}, {"id": "ref-for-enqueue-the-following-steps\u2466"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-enqueue-the-following-steps\u2467"}, {"id": "ref-for-enqueue-the-following-steps\u2468"}, {"id": "ref-for-enqueue-the-following-steps\u2460\u24ea"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-enqueue-the-following-steps\u2460\u2460"}, {"id": "ref-for-enqueue-the-following-steps\u2460\u2461"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['24cf98a1'] = {"dfnID": "24cf98a1", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#environment", "dfnText": "environment", "refSections": [{"refs": [{"id": "ref-for-environment"}], "title": "4. The SharedStorage Interface"}], "external": true};
window.dfnpanelData['3e12e042'] = {"dfnID": "3e12e042", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object", "dfnText": "environment settings object", "refSections": [{"refs": [{"id": "ref-for-environment-settings-object"}, {"id": "ref-for-environment-settings-object\u2460"}, {"id": "ref-for-environment-settings-object\u2461"}, {"id": "ref-for-environment-settings-object\u2462"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-environment-settings-object\u2463"}], "title": "2.2.1. Monkey Patch for set up a worklet environment settings object"}, {"refs": [{"id": "ref-for-environment-settings-object\u2464"}], "title": "2.3.1. Monkey Patch for request destination"}, {"refs": [{"id": "ref-for-environment-settings-object\u2465"}, {"id": "ref-for-environment-settings-object\u2466"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-environment-settings-object\u2467"}, {"id": "ref-for-environment-settings-object\u2468"}], "title": "3.1. Monkey Patch for the Storage Model"}, {"refs": [{"id": "ref-for-environment-settings-object\u2460\u24ea"}, {"id": "ref-for-environment-settings-object\u2460\u2460"}, {"id": "ref-for-environment-settings-object\u2460\u2461"}, {"id": "ref-for-environment-settings-object\u2460\u2462"}], "title": "3.3. The Database Algorithms"}, {"refs": [{"id": "ref-for-environment-settings-object\u2460\u2463"}, {"id": "ref-for-environment-settings-object\u2460\u2464"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['3018e13f'] = {"dfnID": "3018e13f", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-worklet-script-graph", "dfnText": "fetch a worklet script graph", "refSections": [{"refs": [{"id": "ref-for-fetch-a-worklet-script-graph"}, {"id": "ref-for-fetch-a-worklet-script-graph\u2460"}], "title": "2.2.3. Monkey Patch for fetch a worklet script graph"}], "external": true};
window.dfnpanelData['0e3ba9f8'] = {"dfnID": "0e3ba9f8", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#fully-active", "dfnText": "fully active", "refSections": [{"refs": [{"id": "ref-for-fully-active"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-fully-active\u2460"}], "title": "4.2. Extension to the Window interface"}, {"refs": [{"id": "ref-for-fully-active\u2461"}, {"id": "ref-for-fully-active\u2462"}, {"id": "ref-for-fully-active\u2463"}, {"id": "ref-for-fully-active\u2464"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-fully-active\u2465"}, {"id": "ref-for-fully-active\u2466"}, {"id": "ref-for-fully-active\u2467"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-fully-active\u2468"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['289407ea'] = {"dfnID": "289407ea", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#nav-top", "dfnText": "get the top-level traversable", "refSections": [{"refs": [{"id": "ref-for-nav-top\u2460\u24ea"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": true};
window.dfnpanelData['8a30477b'] = {"dfnID": "8a30477b", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global", "dfnText": "global object (for environment settings object)", "refSections": [{"refs": [{"id": "ref-for-concept-settings-object-global"}], "title": "2.2.3. Monkey Patch for fetch a worklet script graph"}], "external": true};
window.dfnpanelData['168f1b6e'] = {"dfnID": "168f1b6e", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global", "dfnText": "global object (for realm)", "refSections": [{"refs": [{"id": "ref-for-concept-realm-global"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-concept-realm-global\u2460"}], "title": "2.2.1. Monkey Patch for set up a worklet environment settings object"}, {"refs": [{"id": "ref-for-concept-realm-global\u2461"}, {"id": "ref-for-concept-realm-global\u2462"}, {"id": "ref-for-concept-realm-global\u2463"}, {"id": "ref-for-concept-realm-global\u2464"}, {"id": "ref-for-concept-realm-global\u2465"}, {"id": "ref-for-concept-realm-global\u2466"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-concept-realm-global\u2467"}, {"id": "ref-for-concept-realm-global\u2468"}, {"id": "ref-for-concept-realm-global\u2460\u24ea"}, {"id": "ref-for-concept-realm-global\u2460\u2460"}, {"id": "ref-for-concept-realm-global\u2460\u2461"}, {"id": "ref-for-concept-realm-global\u2460\u2462"}, {"id": "ref-for-concept-realm-global\u2460\u2463"}, {"id": "ref-for-concept-realm-global\u2460\u2464"}, {"id": "ref-for-concept-realm-global\u2460\u2465"}, {"id": "ref-for-concept-realm-global\u2460\u2466"}, {"id": "ref-for-concept-realm-global\u2460\u2467"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-concept-realm-global\u2460\u2468"}, {"id": "ref-for-concept-realm-global\u2461\u24ea"}, {"id": "ref-for-concept-realm-global\u2461\u2460"}, {"id": "ref-for-concept-realm-global\u2461\u2461"}, {"id": "ref-for-concept-realm-global\u2461\u2462"}, {"id": "ref-for-concept-realm-global\u2461\u2463"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-concept-realm-global\u2461\u2464"}, {"id": "ref-for-concept-realm-global\u2461\u2465"}, {"id": "ref-for-concept-realm-global\u2461\u2466"}, {"id": "ref-for-concept-realm-global\u2461\u2467"}], "title": "4.3.3. Iteration"}, {"refs": [{"id": "ref-for-concept-realm-global\u2461\u2468"}, {"id": "ref-for-concept-realm-global\u2462\u24ea"}, {"id": "ref-for-concept-realm-global\u2462\u2460"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['6f738b30'] = {"dfnID": "6f738b30", "url": "https://html.spec.whatwg.org/multipage/worklets.html#concept-worklet-global-scopes", "dfnText": "global scopes", "refSections": [{"refs": [{"id": "ref-for-concept-worklet-global-scopes"}, {"id": "ref-for-concept-worklet-global-scopes\u2460"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-concept-worklet-global-scopes\u2461"}, {"id": "ref-for-concept-worklet-global-scopes\u2462"}, {"id": "ref-for-concept-worklet-global-scopes\u2463"}, {"id": "ref-for-concept-worklet-global-scopes\u2464"}, {"id": "ref-for-concept-worklet-global-scopes\u2465"}, {"id": "ref-for-concept-worklet-global-scopes\u2466"}, {"id": "ref-for-concept-worklet-global-scopes\u2467"}, {"id": "ref-for-concept-worklet-global-scopes\u2468"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}], "external": true};
window.dfnpanelData['87fcd40c'] = {"dfnID": "87fcd40c", "url": "https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element", "dfnText": "iframe", "refSections": [{"refs": [{"id": "ref-for-the-iframe-element"}], "title": "6.1. sharedStorageWritable & sharedstoragewritable Attributes"}, {"refs": [{"id": "ref-for-the-iframe-element\u2460"}], "title": "6.2.2. Modification to Create navigation params by fetching Algorithm"}], "external": true};
window.dfnpanelData['f0811ff8'] = {"dfnID": "f0811ff8", "url": "https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element", "dfnText": "img", "refSections": [{"refs": [{"id": "ref-for-the-img-element"}], "title": "6.1. sharedStorageWritable & sharedstoragewritable Attributes"}], "external": true};
window.dfnpanelData['9b3743cd'] = {"dfnID": "9b3743cd", "url": "https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-module-map", "dfnText": "module map", "refSections": [{"refs": [{"id": "ref-for-concept-workerglobalscope-module-map"}, {"id": "ref-for-concept-workerglobalscope-module-map\u2460"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}], "external": true};
window.dfnpanelData['a1005ed9'] = {"dfnID": "a1005ed9", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#module-script", "dfnText": "module script", "refSections": [{"refs": [{"id": "ref-for-module-script"}, {"id": "ref-for-module-script\u2460"}, {"id": "ref-for-module-script\u2461"}], "title": "2. The SharedStorageWorklet Interface"}], "external": true};
window.dfnpanelData['9c19b7fc'] = {"dfnID": "9c19b7fc", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#navigable", "dfnText": "navigable", "refSections": [{"refs": [{"id": "ref-for-navigable"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": true};
window.dfnpanelData['2594e562'] = {"dfnID": "2594e562", "url": "https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate", "dfnText": "navigate", "refSections": [{"refs": [{"id": "ref-for-navigate"}, {"id": "ref-for-navigate\u2460"}, {"id": "ref-for-navigate\u2461"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-navigate\u2462"}], "title": "10. Privacy Considerations"}], "external": true};
window.dfnpanelData['13dd6cae'] = {"dfnID": "13dd6cae", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#node-navigable", "dfnText": "node navigable", "refSections": [{"refs": [{"id": "ref-for-node-navigable"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-node-navigable\u2460"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-node-navigable\u2461"}, {"id": "ref-for-node-navigable\u2462"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": true};
window.dfnpanelData['602b1a68'] = {"dfnID": "602b1a68", "url": "https://html.spec.whatwg.org/multipage/browsers.html#obtain-a-site", "dfnText": "obtain a site", "refSections": [{"refs": [{"id": "ref-for-obtain-a-site"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-obtain-a-site\u2460"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-obtain-a-site\u2461"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-obtain-a-site\u2462"}], "title": "4.3.2. Getter Methods"}], "external": true};
window.dfnpanelData['f5fd709f'] = {"dfnID": "f5fd709f", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#obtain-a-worklet-agent", "dfnText": "obtaining a worklet agent", "refSections": [{"refs": [{"id": "ref-for-obtain-a-worklet-agent"}, {"id": "ref-for-obtain-a-worklet-agent\u2460"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}], "external": true};
window.dfnpanelData['b01b1359'] = {"dfnID": "b01b1359", "url": "https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque", "dfnText": "opaque origin", "refSections": [{"refs": [{"id": "ref-for-concept-origin-opaque"}, {"id": "ref-for-concept-origin-opaque\u2460"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-concept-origin-opaque\u2461"}, {"id": "ref-for-concept-origin-opaque\u2462"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-concept-origin-opaque\u2463"}], "title": "4.3.2. Getter Methods"}], "external": true};
window.dfnpanelData['086e3aff'] = {"dfnID": "086e3aff", "url": "https://html.spec.whatwg.org/multipage/browsers.html#concept-origin", "dfnText": "origin", "refSections": [{"refs": [{"id": "ref-for-concept-origin"}, {"id": "ref-for-concept-origin\u2460"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-concept-origin\u2461"}, {"id": "ref-for-concept-origin\u2462"}, {"id": "ref-for-concept-origin\u2463"}, {"id": "ref-for-concept-origin\u2464"}], "title": "3.1. Monkey Patch for the Storage Model"}, {"refs": [{"id": "ref-for-concept-origin\u2465"}, {"id": "ref-for-concept-origin\u2466"}, {"id": "ref-for-concept-origin\u2467"}, {"id": "ref-for-concept-origin\u2468"}, {"id": "ref-for-concept-origin\u2460\u24ea"}, {"id": "ref-for-concept-origin\u2460\u2460"}, {"id": "ref-for-concept-origin\u2460\u2461"}, {"id": "ref-for-concept-origin\u2460\u2462"}], "title": "7.3.2. `Shared-Storage-Write` Response Header"}], "external": true};
window.dfnpanelData['43ac8374'] = {"dfnID": "43ac8374", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin", "dfnText": "origin (for environment settings object)", "refSections": [{"refs": [{"id": "ref-for-concept-settings-object-origin"}, {"id": "ref-for-concept-settings-object-origin\u2460"}, {"id": "ref-for-concept-settings-object-origin\u2461"}, {"id": "ref-for-concept-settings-object-origin\u2462"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-concept-settings-object-origin\u2463"}, {"id": "ref-for-concept-settings-object-origin\u2464"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-concept-settings-object-origin\u2465"}, {"id": "ref-for-concept-settings-object-origin\u2466"}], "title": "2.2.1. Monkey Patch for set up a worklet environment settings object"}, {"refs": [{"id": "ref-for-concept-settings-object-origin\u2467"}, {"id": "ref-for-concept-settings-object-origin\u2468"}], "title": "2.2.3. Monkey Patch for fetch a worklet script graph"}, {"refs": [{"id": "ref-for-concept-settings-object-origin\u2460\u24ea"}], "title": "2.2.5. Monkey Patch for HTTP fetch"}, {"refs": [{"id": "ref-for-concept-settings-object-origin\u2460\u2460"}, {"id": "ref-for-concept-settings-object-origin\u2460\u2461"}, {"id": "ref-for-concept-settings-object-origin\u2460\u2462"}, {"id": "ref-for-concept-settings-object-origin\u2460\u2463"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-concept-settings-object-origin\u2460\u2464"}, {"id": "ref-for-concept-settings-object-origin\u2460\u2465"}, {"id": "ref-for-concept-settings-object-origin\u2460\u2466"}, {"id": "ref-for-concept-settings-object-origin\u2460\u2467"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-concept-settings-object-origin\u2460\u2468"}, {"id": "ref-for-concept-settings-object-origin\u2461\u24ea"}, {"id": "ref-for-concept-settings-object-origin\u2461\u2460"}, {"id": "ref-for-concept-settings-object-origin\u2461\u2461"}, {"id": "ref-for-concept-settings-object-origin\u2461\u2462"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-concept-settings-object-origin\u2461\u2463"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['1bba3db7'] = {"dfnID": "1bba3db7", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#nav-parent", "dfnText": "parent", "refSections": [{"refs": [{"id": "ref-for-nav-parent"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-nav-parent\u2460"}, {"id": "ref-for-nav-parent\u2461"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": true};
window.dfnpanelData['48438eb3'] = {"dfnID": "48438eb3", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task", "dfnText": "queue a global task", "refSections": [{"refs": [{"id": "ref-for-queue-a-global-task"}, {"id": "ref-for-queue-a-global-task\u2460"}, {"id": "ref-for-queue-a-global-task\u2461"}, {"id": "ref-for-queue-a-global-task\u2462"}, {"id": "ref-for-queue-a-global-task\u2463"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-queue-a-global-task\u2464"}, {"id": "ref-for-queue-a-global-task\u2465"}, {"id": "ref-for-queue-a-global-task\u2466"}, {"id": "ref-for-queue-a-global-task\u2467"}, {"id": "ref-for-queue-a-global-task\u2468"}, {"id": "ref-for-queue-a-global-task\u2460\u24ea"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-queue-a-global-task\u2460\u2460"}, {"id": "ref-for-queue-a-global-task\u2460\u2461"}, {"id": "ref-for-queue-a-global-task\u2460\u2462"}, {"id": "ref-for-queue-a-global-task\u2460\u2463"}, {"id": "ref-for-queue-a-global-task\u2460\u2464"}, {"id": "ref-for-queue-a-global-task\u2460\u2465"}, {"id": "ref-for-queue-a-global-task\u2460\u2466"}, {"id": "ref-for-queue-a-global-task\u2460\u2467"}, {"id": "ref-for-queue-a-global-task\u2460\u2468"}, {"id": "ref-for-queue-a-global-task\u2461\u24ea"}, {"id": "ref-for-queue-a-global-task\u2461\u2460"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-queue-a-global-task\u2461\u2461"}, {"id": "ref-for-queue-a-global-task\u2461\u2462"}, {"id": "ref-for-queue-a-global-task\u2461\u2463"}, {"id": "ref-for-queue-a-global-task\u2461\u2464"}, {"id": "ref-for-queue-a-global-task\u2461\u2465"}, {"id": "ref-for-queue-a-global-task\u2461\u2466"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-queue-a-global-task\u2461\u2467"}, {"id": "ref-for-queue-a-global-task\u2461\u2468"}, {"id": "ref-for-queue-a-global-task\u2462\u24ea"}, {"id": "ref-for-queue-a-global-task\u2462\u2460"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['b75a7d23'] = {"dfnID": "b75a7d23", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-global-object-realm", "dfnText": "realm", "refSections": [{"refs": [{"id": "ref-for-concept-global-object-realm"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-concept-global-object-realm\u2460"}, {"id": "ref-for-concept-global-object-realm\u2461"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-concept-global-object-realm\u2462"}], "title": "2.2.5. Monkey Patch for HTTP fetch"}], "external": true};
window.dfnpanelData['5ab7b520'] = {"dfnID": "5ab7b520", "url": "https://html.spec.whatwg.org/multipage/common-dom-interfaces.html#reflect", "dfnText": "reflect", "refSections": [{"refs": [{"id": "ref-for-reflect"}], "title": "6.1. sharedStorageWritable & sharedstoragewritable Attributes"}], "external": true};
window.dfnpanelData['5991ccfb'] = {"dfnID": "5991ccfb", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm", "dfnText": "relevant realm", "refSections": [{"refs": [{"id": "ref-for-concept-relevant-realm"}, {"id": "ref-for-concept-relevant-realm\u2460"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}], "external": true};
window.dfnpanelData['9c4c1e66'] = {"dfnID": "9c4c1e66", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object", "dfnText": "relevant settings object", "refSections": [{"refs": [{"id": "ref-for-relevant-settings-object"}, {"id": "ref-for-relevant-settings-object\u2460"}, {"id": "ref-for-relevant-settings-object\u2461"}, {"id": "ref-for-relevant-settings-object\u2462"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-relevant-settings-object\u2463"}], "title": "2.3.1. Monkey Patch for request destination"}, {"refs": [{"id": "ref-for-relevant-settings-object\u2464"}, {"id": "ref-for-relevant-settings-object\u2465"}, {"id": "ref-for-relevant-settings-object\u2466"}, {"id": "ref-for-relevant-settings-object\u2467"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-relevant-settings-object\u2468"}, {"id": "ref-for-relevant-settings-object\u2460\u24ea"}, {"id": "ref-for-relevant-settings-object\u2460\u2460"}, {"id": "ref-for-relevant-settings-object\u2460\u2461"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-relevant-settings-object\u2460\u2462"}, {"id": "ref-for-relevant-settings-object\u2460\u2463"}, {"id": "ref-for-relevant-settings-object\u2460\u2464"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-relevant-settings-object\u2460\u2465"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['7393da89'] = {"dfnID": "7393da89", "url": "https://html.spec.whatwg.org/multipage/browsers.html#same-origin", "dfnText": "same origin", "refSections": [{"refs": [{"id": "ref-for-same-origin"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-same-origin\u2460"}, {"id": "ref-for-same-origin\u2461"}], "title": "2.2.5. Monkey Patch for HTTP fetch"}], "external": true};
window.dfnpanelData['65181da8'] = {"dfnID": "65181da8", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#secure-context", "dfnText": "secure context", "refSections": [{"refs": [{"id": "ref-for-secure-context"}], "title": "2. The SharedStorageWorklet Interface"}], "external": true};
window.dfnpanelData['1cc25024'] = {"dfnID": "1cc25024", "url": "https://html.spec.whatwg.org/multipage/worklets.html#set-up-a-worklet-environment-settings-object", "dfnText": "set up a worklet environment settings object", "refSections": [{"refs": [{"id": "ref-for-set-up-a-worklet-environment-settings-object"}, {"id": "ref-for-set-up-a-worklet-environment-settings-object\u2460"}], "title": "2.2.1. Monkey Patch for set up a worklet environment settings object"}, {"refs": [{"id": "ref-for-set-up-a-worklet-environment-settings-object\u2461"}], "title": "2.2.2. Monkey Patch for create a worklet global scope"}], "external": true};
window.dfnpanelData['7deb6835'] = {"dfnID": "7deb6835", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object", "dfnText": "settings object", "refSections": [{"refs": [{"id": "ref-for-concept-realm-settings-object"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-concept-realm-settings-object\u2460"}, {"id": "ref-for-concept-realm-settings-object\u2461"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-concept-realm-settings-object\u2462"}, {"id": "ref-for-concept-realm-settings-object\u2463"}], "title": "2.2.3. Monkey Patch for fetch a worklet script graph"}, {"refs": [{"id": "ref-for-concept-realm-settings-object\u2464"}], "title": "2.2.5. Monkey Patch for HTTP fetch"}, {"refs": [{"id": "ref-for-concept-realm-settings-object\u2465"}, {"id": "ref-for-concept-realm-settings-object\u2466"}, {"id": "ref-for-concept-realm-settings-object\u2467"}, {"id": "ref-for-concept-realm-settings-object\u2468"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-concept-realm-settings-object\u2460\u24ea"}, {"id": "ref-for-concept-realm-settings-object\u2460\u2460"}, {"id": "ref-for-concept-realm-settings-object\u2460\u2461"}, {"id": "ref-for-concept-realm-settings-object\u2460\u2462"}, {"id": "ref-for-concept-realm-settings-object\u2460\u2463"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-concept-realm-settings-object\u2460\u2464"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['fb9bb722'] = {"dfnID": "fb9bb722", "url": "https://html.spec.whatwg.org/multipage/browsers.html#site", "dfnText": "site", "refSections": [{"refs": [{"id": "ref-for-site"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": true};
window.dfnpanelData['9c9ab424'] = {"dfnID": "9c9ab424", "url": "https://html.spec.whatwg.org/multipage/infrastructure.html#starting-a-new-parallel-queue", "dfnText": "start a new parallel queue", "refSections": [{"refs": [{"id": "ref-for-starting-a-new-parallel-queue"}], "title": "3.2. The Shared Storage Database"}], "external": true};
window.dfnpanelData['085ddd0a'] = {"dfnID": "085ddd0a", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context", "dfnText": "target browsing context", "refSections": [{"refs": [{"id": "ref-for-concept-environment-target-browsing-context"}, {"id": "ref-for-concept-environment-target-browsing-context\u2460"}, {"id": "ref-for-concept-environment-target-browsing-context\u2461"}, {"id": "ref-for-concept-environment-target-browsing-context\u2462"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-concept-environment-target-browsing-context\u2463"}, {"id": "ref-for-concept-environment-target-browsing-context\u2464"}, {"id": "ref-for-concept-environment-target-browsing-context\u2465"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-concept-environment-target-browsing-context\u2466"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['d2f99df9'] = {"dfnID": "d2f99df9", "url": "https://html.spec.whatwg.org/multipage/worklets.html#terminate-a-worklet-global-scope", "dfnText": "terminate a worklet global scope", "refSections": [{"refs": [{"id": "ref-for-terminate-a-worklet-global-scope"}, {"id": "ref-for-terminate-a-worklet-global-scope\u2460"}, {"id": "ref-for-terminate-a-worklet-global-scope\u2461"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}], "external": true};
window.dfnpanelData['30717154'] = {"dfnID": "30717154", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#nav-top", "dfnText": "top-level traversable", "refSections": [{"refs": [{"id": "ref-for-nav-top"}, {"id": "ref-for-nav-top\u2460"}], "title": "1. Introduction"}, {"refs": [{"id": "ref-for-nav-top\u2461"}, {"id": "ref-for-nav-top\u2462"}, {"id": "ref-for-nav-top\u2463"}, {"id": "ref-for-nav-top\u2464"}, {"id": "ref-for-nav-top\u2465"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-nav-top\u2466"}, {"id": "ref-for-nav-top\u2467"}, {"id": "ref-for-nav-top\u2468"}], "title": "2.6.2. Reporting Entropy Budget"}, {"refs": [{"id": "ref-for-nav-top\u2460\u2460"}], "title": "10. Privacy Considerations"}], "external": true};
window.dfnpanelData['17582406'] = {"dfnID": "17582406", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#nav-traversable", "dfnText": "traversable navigable", "refSections": [{"refs": [{"id": "ref-for-nav-traversable"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}], "external": true};
window.dfnpanelData['b402424d'] = {"dfnID": "b402424d", "url": "https://html.spec.whatwg.org/multipage/images.html#update-the-image-data", "dfnText": "update the image data", "refSections": [{"refs": [{"id": "ref-for-update-the-image-data"}, {"id": "ref-for-update-the-image-data\u2460"}], "title": "6.2.1. Modification to Update the image data Algorithm"}], "external": true};
window.dfnpanelData['b79e50d6'] = {"dfnID": "b79e50d6", "url": "https://html.spec.whatwg.org/multipage/interaction.html#tracking-user-activation", "dfnText": "user activation", "refSections": [{"refs": [{"id": "ref-for-tracking-user-activation"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": true};
window.dfnpanelData['93252241'] = {"dfnID": "93252241", "url": "https://html.spec.whatwg.org/multipage/worklets.html#worklet-destination-type", "dfnText": "worklet destination type", "refSections": [{"refs": [{"id": "ref-for-worklet-destination-type"}], "title": "2.3. The SharedStorageWorkletGlobalScope"}], "external": true};
window.dfnpanelData['3b8ce5a6'] = {"dfnID": "3b8ce5a6", "url": "https://html.spec.whatwg.org/multipage/worklets.html#worklet-global-scope-type", "dfnText": "worklet global scope type", "refSections": [{"refs": [{"id": "ref-for-worklet-global-scope-type"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-worklet-global-scope-type\u2460"}], "title": "2.3. The SharedStorageWorkletGlobalScope"}], "external": true};
window.dfnpanelData['3e6a4683'] = {"dfnID": "3e6a4683", "url": "https://html.spec.whatwg.org/multipage/worklets.html#worklets", "dfnText": "worklets", "refSections": [{"refs": [{"id": "ref-for-worklets"}, {"id": "ref-for-worklets\u2460"}], "title": "2.2. Monkey Patch for Worklets"}], "external": true};
window.dfnpanelData['94719b0c'] = {"dfnID": "94719b0c", "url": "https://w3c.github.io/i18n-glossary/#dfn-unicode", "dfnText": "unicode", "refSections": [{"refs": [{"id": "ref-for-dfn-unicode"}], "title": "7.3.2. `Shared-Storage-Write` Response Header"}], "external": true};
window.dfnpanelData['53275e46'] = {"dfnID": "53275e46", "url": "https://infra.spec.whatwg.org/#list-append", "dfnText": "append (for list)", "refSections": [{"refs": [{"id": "ref-for-list-append"}, {"id": "ref-for-list-append\u2460"}, {"id": "ref-for-list-append\u2461"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-list-append\u2462"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-list-append\u2463"}, {"id": "ref-for-list-append\u2464"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-list-append\u2465"}, {"id": "ref-for-list-append\u2466"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}], "external": true};
window.dfnpanelData['a3b18719'] = {"dfnID": "a3b18719", "url": "https://infra.spec.whatwg.org/#set-append", "dfnText": "append (for set)", "refSections": [{"refs": [{"id": "ref-for-set-append"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": true};
window.dfnpanelData['f0c4369e'] = {"dfnID": "f0c4369e", "url": "https://infra.spec.whatwg.org#ascii-code-point", "dfnText": "ascii", "refSections": [{"refs": [{"id": "ref-for-ascii-code-point"}], "title": "7.3.2. `Shared-Storage-Write` Response Header"}], "external": true};
window.dfnpanelData['2d5a2765'] = {"dfnID": "2d5a2765", "url": "https://infra.spec.whatwg.org/#ascii-string", "dfnText": "ascii string", "refSections": [{"refs": [{"id": "ref-for-ascii-string"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['77b4c09a'] = {"dfnID": "77b4c09a", "url": "https://infra.spec.whatwg.org/#assert", "dfnText": "assert", "refSections": [{"refs": [{"id": "ref-for-assert"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-assert\u2460"}, {"id": "ref-for-assert\u2461"}, {"id": "ref-for-assert\u2462"}, {"id": "ref-for-assert\u2463"}, {"id": "ref-for-assert\u2464"}, {"id": "ref-for-assert\u2465"}, {"id": "ref-for-assert\u2466"}, {"id": "ref-for-assert\u2467"}, {"id": "ref-for-assert\u2468"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-assert\u2460\u24ea"}], "title": "2.2.1. Monkey Patch for set up a worklet environment settings object"}, {"refs": [{"id": "ref-for-assert\u2460\u2460"}], "title": "2.2.5. Monkey Patch for HTTP fetch"}, {"refs": [{"id": "ref-for-assert\u2460\u2461"}], "title": "2.2.6. Monkey Patch for addModule()"}, {"refs": [{"id": "ref-for-assert\u2460\u2462"}, {"id": "ref-for-assert\u2460\u2463"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}, {"refs": [{"id": "ref-for-assert\u2460\u2464"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-assert\u2460\u2465"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-assert\u2460\u2466"}, {"id": "ref-for-assert\u2460\u2467"}, {"id": "ref-for-assert\u2460\u2468"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['36858240'] = {"dfnID": "36858240", "url": "https://infra.spec.whatwg.org/#boolean", "dfnText": "boolean", "refSections": [{"refs": [{"id": "ref-for-boolean"}], "title": "2.3.1. Monkey Patch for request destination"}, {"refs": [{"id": "ref-for-boolean\u2460"}], "title": "7.1. sharedStorageWritable Key"}], "external": true};
window.dfnpanelData['bc7b9068'] = {"dfnID": "bc7b9068", "url": "https://infra.spec.whatwg.org/#map-clear", "dfnText": "clear", "refSections": [{"refs": [{"id": "ref-for-map-clear"}], "title": "3.3. The Database Algorithms"}], "external": true};
window.dfnpanelData['027e3e49'] = {"dfnID": "027e3e49", "url": "https://infra.spec.whatwg.org/#list-clone", "dfnText": "clone", "refSections": [{"refs": [{"id": "ref-for-list-clone"}], "title": "2.2.1. Monkey Patch for set up a worklet environment settings object"}], "external": true};
window.dfnpanelData['4a3bf5fb'] = {"dfnID": "4a3bf5fb", "url": "https://infra.spec.whatwg.org/#string-concatenate", "dfnText": "concatenate", "refSections": [{"refs": [{"id": "ref-for-string-concatenate"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-string-concatenate\u2460"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}], "external": true};
window.dfnpanelData['ae8def21'] = {"dfnID": "ae8def21", "url": "https://infra.spec.whatwg.org/#list-contain", "dfnText": "contain (for list)", "refSections": [{"refs": [{"id": "ref-for-list-contain"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}, {"refs": [{"id": "ref-for-list-contain\u2460"}, {"id": "ref-for-list-contain\u2461"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": true};
window.dfnpanelData['a326add7'] = {"dfnID": "a326add7", "url": "https://infra.spec.whatwg.org/#map-exists", "dfnText": "contain (for map)", "refSections": [{"refs": [{"id": "ref-for-map-exists"}, {"id": "ref-for-map-exists\u2460"}, {"id": "ref-for-map-exists\u2461"}, {"id": "ref-for-map-exists\u2462"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-map-exists\u2463"}], "title": "2.4. SharedStorageWorkletGlobalScope algorithms"}, {"refs": [{"id": "ref-for-map-exists\u2464"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-map-exists\u2465"}], "title": "3.3. The Database Algorithms"}, {"refs": [{"id": "ref-for-map-exists\u2466"}], "title": "7.2.1. Modification to the Request Constructor Algorithm"}, {"refs": [{"id": "ref-for-map-exists\u2467"}, {"id": "ref-for-map-exists\u2468"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['f937b7b6'] = {"dfnID": "f937b7b6", "url": "https://infra.spec.whatwg.org/#iteration-continue", "dfnText": "continue", "refSections": [{"refs": [{"id": "ref-for-iteration-continue"}, {"id": "ref-for-iteration-continue\u2460"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-iteration-continue\u2461"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": true};
window.dfnpanelData['a088e610'] = {"dfnID": "a088e610", "url": "https://infra.spec.whatwg.org/#javascript-string-convert", "dfnText": "convert", "refSections": [{"refs": [{"id": "ref-for-javascript-string-convert"}], "title": "2.4. SharedStorageWorkletGlobalScope algorithms"}], "external": true};
window.dfnpanelData['9a9b558b'] = {"dfnID": "9a9b558b", "url": "https://infra.spec.whatwg.org/#queue-dequeue", "dfnText": "dequeue", "refSections": [{"refs": [{"id": "ref-for-queue-dequeue"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['03afaf9c'] = {"dfnID": "03afaf9c", "url": "https://infra.spec.whatwg.org/#list-empty", "dfnText": "empty (for list)", "refSections": [{"refs": [{"id": "ref-for-list-empty"}, {"id": "ref-for-list-empty\u2460"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-list-empty\u2461"}, {"id": "ref-for-list-empty\u2462"}], "title": "4.3.3. Iteration"}, {"refs": [{"id": "ref-for-list-empty\u2463"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['cc867b80'] = {"dfnID": "cc867b80", "url": "https://infra.spec.whatwg.org#map-is-empty", "dfnText": "empty (for map)", "refSections": [{"refs": [{"id": "ref-for-map-is-empty"}, {"id": "ref-for-map-is-empty\u2460"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-map-is-empty\u2461"}, {"id": "ref-for-map-is-empty\u2462"}, {"id": "ref-for-map-is-empty\u2463"}, {"id": "ref-for-map-is-empty\u2464"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}], "external": true};
window.dfnpanelData['06a6db54'] = {"dfnID": "06a6db54", "url": "https://infra.spec.whatwg.org/#queue-enqueue", "dfnText": "enqueue", "refSections": [{"refs": [{"id": "ref-for-queue-enqueue"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['8958b003'] = {"dfnID": "8958b003", "url": "https://infra.spec.whatwg.org/#map-entry", "dfnText": "entry", "refSections": [{"refs": [{"id": "ref-for-map-entry"}], "title": "2.4. SharedStorageWorkletGlobalScope algorithms"}], "external": true};
window.dfnpanelData['1243a891'] = {"dfnID": "1243a891", "url": "https://infra.spec.whatwg.org/#map-exists", "dfnText": "exist", "refSections": [{"refs": [{"id": "ref-for-map-exists"}, {"id": "ref-for-map-exists\u2460"}, {"id": "ref-for-map-exists\u2461"}, {"id": "ref-for-map-exists\u2462"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-map-exists\u2463"}], "title": "2.4. SharedStorageWorkletGlobalScope algorithms"}, {"refs": [{"id": "ref-for-map-exists\u2464"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-map-exists\u2465"}], "title": "3.3. The Database Algorithms"}, {"refs": [{"id": "ref-for-map-exists\u2466"}], "title": "7.2.1. Modification to the Request Constructor Algorithm"}, {"refs": [{"id": "ref-for-map-exists\u2467"}, {"id": "ref-for-map-exists\u2468"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['527b10aa'] = {"dfnID": "527b10aa", "url": "https://infra.spec.whatwg.org/#map-get", "dfnText": "get", "refSections": [{"refs": [{"id": "ref-for-map-get"}, {"id": "ref-for-map-get\u2460"}], "title": "3.3. The Database Algorithms"}], "external": true};
window.dfnpanelData['d5890b17'] = {"dfnID": "d5890b17", "url": "https://infra.spec.whatwg.org/#map-getting-the-values", "dfnText": "getting the values", "refSections": [{"refs": [{"id": "ref-for-map-getting-the-values"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}, {"refs": [{"id": "ref-for-map-getting-the-values\u2460"}], "title": "3.3. The Database Algorithms"}], "external": true};
window.dfnpanelData['860300d4'] = {"dfnID": "860300d4", "url": "https://infra.spec.whatwg.org/#implementation-defined", "dfnText": "implementation-defined", "refSections": [{"refs": [{"id": "ref-for-implementation-defined"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-implementation-defined\u2460"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": true};
window.dfnpanelData['5afbefcd'] = {"dfnID": "5afbefcd", "url": "https://infra.spec.whatwg.org/#list-item", "dfnText": "item (for list)", "refSections": [{"refs": [{"id": "ref-for-list-item"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": true};
window.dfnpanelData['c88f3887'] = {"dfnID": "c88f3887", "url": "https://infra.spec.whatwg.org/#struct-item", "dfnText": "item (for struct)", "refSections": [{"refs": [{"id": "ref-for-struct-item"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": true};
window.dfnpanelData['efe8653e'] = {"dfnID": "efe8653e", "url": "https://infra.spec.whatwg.org/#map-iterate", "dfnText": "iterate", "refSections": [{"refs": [{"id": "ref-for-map-iterate"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-map-iterate\u2460"}, {"id": "ref-for-map-iterate\u2461"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}, {"refs": [{"id": "ref-for-map-iterate\u2462"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-map-iterate\u2463"}, {"id": "ref-for-map-iterate\u2464"}], "title": "2.6.2. Reporting Entropy Budget"}, {"refs": [{"id": "ref-for-map-iterate\u2465"}], "title": "3.3. The Database Algorithms"}, {"refs": [{"id": "ref-for-map-iterate\u2466"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['d14a6f26'] = {"dfnID": "d14a6f26", "url": "https://infra.spec.whatwg.org/#map-key", "dfnText": "key", "refSections": [{"refs": [{"id": "ref-for-map-key"}], "title": "2.4. SharedStorageWorkletGlobalScope algorithms"}], "external": true};
window.dfnpanelData['31db57e6'] = {"dfnID": "31db57e6", "url": "https://infra.spec.whatwg.org/#map-getting-the-keys", "dfnText": "keys", "refSections": [{"refs": [{"id": "ref-for-map-getting-the-keys"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}], "external": true};
window.dfnpanelData['0fa357c3'] = {"dfnID": "0fa357c3", "url": "https://infra.spec.whatwg.org/#string-length", "dfnText": "length", "refSections": [{"refs": [{"id": "ref-for-string-length"}, {"id": "ref-for-string-length\u2460"}, {"id": "ref-for-string-length\u2461"}, {"id": "ref-for-string-length\u2462"}, {"id": "ref-for-string-length\u2463"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-string-length\u2464"}, {"id": "ref-for-string-length\u2465"}, {"id": "ref-for-string-length\u2466"}, {"id": "ref-for-string-length\u2467"}, {"id": "ref-for-string-length\u2468"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-string-length\u2460\u24ea"}], "title": "4.3.2. Getter Methods"}], "external": true};
window.dfnpanelData['649608b9'] = {"dfnID": "649608b9", "url": "https://infra.spec.whatwg.org/#list", "dfnText": "list", "refSections": [{"refs": [{"id": "ref-for-list"}, {"id": "ref-for-list\u2460"}, {"id": "ref-for-list\u2461"}, {"id": "ref-for-list\u2462"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-list\u2463"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-list\u2464"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-list\u2465"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}], "external": true};
window.dfnpanelData['3fca5a9e'] = {"dfnID": "3fca5a9e", "url": "https://infra.spec.whatwg.org/#ordered-map", "dfnText": "map", "refSections": [{"refs": [{"id": "ref-for-ordered-map"}], "title": "2.3.1. Monkey Patch for request destination"}, {"refs": [{"id": "ref-for-ordered-map\u2460"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}, {"refs": [{"id": "ref-for-ordered-map\u2461"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-ordered-map\u2462"}, {"id": "ref-for-ordered-map\u2463"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": true};
window.dfnpanelData['47dfca75'] = {"dfnID": "47dfca75", "url": "https://infra.spec.whatwg.org/#queue", "dfnText": "queue", "refSections": [{"refs": [{"id": "ref-for-queue"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['99c988d6'] = {"dfnID": "99c988d6", "url": "https://infra.spec.whatwg.org/#list-remove", "dfnText": "remove (for list)", "refSections": [{"refs": [{"id": "ref-for-list-remove"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": true};
window.dfnpanelData['7d4424b2'] = {"dfnID": "7d4424b2", "url": "https://infra.spec.whatwg.org/#map-remove", "dfnText": "remove (for map)", "refSections": [{"refs": [{"id": "ref-for-map-remove"}, {"id": "ref-for-map-remove\u2460"}], "title": "3.3. The Database Algorithms"}], "external": true};
window.dfnpanelData['0e6b2056'] = {"dfnID": "0e6b2056", "url": "https://infra.spec.whatwg.org/#map-set", "dfnText": "set", "refSections": [{"refs": [{"id": "ref-for-map-set"}], "title": "2.4. SharedStorageWorkletGlobalScope algorithms"}, {"refs": [{"id": "ref-for-map-set\u2460"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}, {"refs": [{"id": "ref-for-map-set\u2461"}], "title": "3.3. The Database Algorithms"}, {"refs": [{"id": "ref-for-map-set\u2462"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['0204d188'] = {"dfnID": "0204d188", "url": "https://infra.spec.whatwg.org/#list-size", "dfnText": "size (for list)", "refSections": [{"refs": [{"id": "ref-for-list-size"}, {"id": "ref-for-list-size\u2460"}, {"id": "ref-for-list-size\u2461"}, {"id": "ref-for-list-size\u2462"}, {"id": "ref-for-list-size\u2463"}, {"id": "ref-for-list-size\u2464"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-list-size\u2465"}], "title": "2.2.1. Monkey Patch for set up a worklet environment settings object"}, {"refs": [{"id": "ref-for-list-size\u2466"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": true};
window.dfnpanelData['653d0848'] = {"dfnID": "653d0848", "url": "https://infra.spec.whatwg.org/#map-size", "dfnText": "size (for map)", "refSections": [{"refs": [{"id": "ref-for-map-size"}], "title": "3.1. Monkey Patch for the Storage Model"}, {"refs": [{"id": "ref-for-map-size\u2460"}], "title": "3.3. The Database Algorithms"}], "external": true};
window.dfnpanelData['0698d556'] = {"dfnID": "0698d556", "url": "https://infra.spec.whatwg.org/#string", "dfnText": "string", "refSections": [{"refs": [{"id": "ref-for-string"}], "title": "2.3.1. Monkey Patch for request destination"}, {"refs": [{"id": "ref-for-string\u2460"}, {"id": "ref-for-string\u2461"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}, {"refs": [{"id": "ref-for-string\u2462"}, {"id": "ref-for-string\u2463"}], "title": "3.2. The Shared Storage Database"}, {"refs": [{"id": "ref-for-string\u2464"}, {"id": "ref-for-string\u2465"}, {"id": "ref-for-string\u2466"}, {"id": "ref-for-string\u2467"}, {"id": "ref-for-string\u2468"}], "title": "4.1.1. Window Setter/Deleter Methods"}], "external": true};
window.dfnpanelData['984221ca'] = {"dfnID": "984221ca", "url": "https://infra.spec.whatwg.org/#struct", "dfnText": "struct", "refSections": [{"refs": [{"id": "ref-for-struct"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-struct\u2460"}], "title": "3.2. The Shared Storage Database"}], "external": true};
window.dfnpanelData['6d19ac93'] = {"dfnID": "6d19ac93", "url": "https://infra.spec.whatwg.org/#user-agent", "dfnText": "user agent", "refSections": [{"refs": [{"id": "ref-for-user-agent"}], "title": "2.6. Entropy Budgets"}, {"refs": [{"id": "ref-for-user-agent\u2460"}, {"id": "ref-for-user-agent\u2461"}, {"id": "ref-for-user-agent\u2462"}, {"id": "ref-for-user-agent\u2463"}, {"id": "ref-for-user-agent\u2464"}, {"id": "ref-for-user-agent\u2465"}, {"id": "ref-for-user-agent\u2466"}, {"id": "ref-for-user-agent\u2467"}, {"id": "ref-for-user-agent\u2468"}, {"id": "ref-for-user-agent\u2460\u24ea"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-user-agent\u2460\u2460"}, {"id": "ref-for-user-agent\u2460\u2461"}, {"id": "ref-for-user-agent\u2460\u2462"}, {"id": "ref-for-user-agent\u2460\u2463"}, {"id": "ref-for-user-agent\u2460\u2464"}], "title": "2.6.2. Reporting Entropy Budget"}, {"refs": [{"id": "ref-for-user-agent\u2460\u2465"}, {"id": "ref-for-user-agent\u2460\u2466"}, {"id": "ref-for-user-agent\u2460\u2467"}], "title": "3.1. Monkey Patch for the Storage Model"}, {"refs": [{"id": "ref-for-user-agent\u2460\u2468"}, {"id": "ref-for-user-agent\u2461\u24ea"}, {"id": "ref-for-user-agent\u2461\u2460"}, {"id": "ref-for-user-agent\u2461\u2461"}], "title": "3.2. The Shared Storage Database"}, {"refs": [{"id": "ref-for-user-agent\u2461\u2462"}], "title": "3.3. The Database Algorithms"}], "external": true};
window.dfnpanelData['12d6b9a8'] = {"dfnID": "12d6b9a8", "url": "https://infra.spec.whatwg.org/#map-getting-the-values", "dfnText": "values", "refSections": [{"refs": [{"id": "ref-for-map-getting-the-values"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}, {"refs": [{"id": "ref-for-map-getting-the-values\u2460"}], "title": "3.3. The Database Algorithms"}], "external": true};
window.dfnpanelData['47a2271a'] = {"dfnID": "47a2271a", "url": "https://www.w3.org/TR/permissions-policy/#algo-is-feature-enabled", "dfnText": "is feature enabled in document for origin?", "refSections": [{"refs": [{"id": "ref-for-algo-is-feature-enabled"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-algo-is-feature-enabled\u2460"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}], "external": true};
window.dfnpanelData['cc890cc1'] = {"dfnID": "cc890cc1", "url": "https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature", "dfnText": "policy-controlled feature", "refSections": [{"refs": [{"id": "ref-for-policy-controlled-feature"}, {"id": "ref-for-policy-controlled-feature\u2460"}], "title": "8. Permissions Policy Integration"}], "external": true};
window.dfnpanelData['672f81c8'] = {"dfnID": "672f81c8", "url": "https://github.com/patcg-individual-drafts/private-aggregation-api/blob/main/README.md#private-aggregation", "dfnText": "private aggregation", "refSections": [{"refs": [{"id": "ref-for-private-aggregation"}], "title": "1. Introduction"}, {"refs": [{"id": "ref-for-private-aggregation\u2460"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-private-aggregation\u2461"}], "title": "10. Privacy Considerations"}], "external": true};
window.dfnpanelData['2c680d8a'] = {"dfnID": "2c680d8a", "url": "https://httpwg.org/specs/rfc8941.html#item", "dfnText": "bare item", "refSections": [{"refs": [{"id": "ref-for-item"}, {"id": "ref-for-item\u2460"}, {"id": "ref-for-item\u2461"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['d56eba29'] = {"dfnID": "d56eba29", "url": "https://httpwg.org/specs/rfc8941.html#boolean", "dfnText": "boolean", "refSections": [{"refs": [{"id": "ref-for-boolean\u2461"}], "title": "7.3.1. `Sec-Shared-Storage-Writable` Request Header"}, {"refs": [{"id": "ref-for-boolean\u2462"}], "title": "7.3.2. `Shared-Storage-Write` Response Header"}, {"refs": [{"id": "ref-for-boolean\u2463"}, {"id": "ref-for-boolean\u2464"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['375247ce'] = {"dfnID": "375247ce", "url": "https://httpwg.org/specs/rfc8941.html#binary", "dfnText": "byte sequence", "refSections": [{"refs": [{"id": "ref-for-binary"}, {"id": "ref-for-binary\u2460"}, {"id": "ref-for-binary\u2461"}, {"id": "ref-for-binary\u2462"}, {"id": "ref-for-binary\u2463"}, {"id": "ref-for-binary\u2464"}, {"id": "ref-for-binary\u2465"}, {"id": "ref-for-binary\u2466"}, {"id": "ref-for-binary\u2467"}], "title": "7.3.2. `Shared-Storage-Write` Response Header"}, {"refs": [{"id": "ref-for-binary\u2468"}, {"id": "ref-for-binary\u2460\u24ea"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['77e5cafe'] = {"dfnID": "77e5cafe", "url": "https://httpwg.org/specs/rfc8941.html#inner-list", "dfnText": "inner list", "refSections": [{"refs": [{"id": "ref-for-inner-list"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['2d1d761a'] = {"dfnID": "2d1d761a", "url": "https://httpwg.org/specs/rfc8941.html#list", "dfnText": "list", "refSections": [{"refs": [{"id": "ref-for-list\u2466"}], "title": "7.3.2. `Shared-Storage-Write` Response Header"}], "external": true};
window.dfnpanelData['4a7ca2e3'] = {"dfnID": "4a7ca2e3", "url": "https://httpwg.org/specs/rfc8941.html#param", "dfnText": "parameters", "refSections": [{"refs": [{"id": "ref-for-param"}, {"id": "ref-for-param\u2460"}, {"id": "ref-for-param\u2461"}, {"id": "ref-for-param\u2462"}, {"id": "ref-for-param\u2463"}, {"id": "ref-for-param\u2464"}, {"id": "ref-for-param\u2465"}, {"id": "ref-for-param\u2466"}, {"id": "ref-for-param\u2467"}, {"id": "ref-for-param\u2468"}, {"id": "ref-for-param\u2460\u24ea"}, {"id": "ref-for-param\u2460\u2460"}, {"id": "ref-for-param\u2460\u2461"}, {"id": "ref-for-param\u2460\u2462"}, {"id": "ref-for-param\u2460\u2463"}], "title": "7.3.2. `Shared-Storage-Write` Response Header"}, {"refs": [{"id": "ref-for-param\u2460\u2464"}, {"id": "ref-for-param\u2460\u2465"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['cb1e75b1'] = {"dfnID": "cb1e75b1", "url": "https://httpwg.org/specs/rfc8941.html#string", "dfnText": "string", "refSections": [{"refs": [{"id": "ref-for-string\u2460\u24ea"}, {"id": "ref-for-string\u2460\u2460"}, {"id": "ref-for-string\u2460\u2461"}, {"id": "ref-for-string\u2460\u2462"}, {"id": "ref-for-string\u2460\u2463"}, {"id": "ref-for-string\u2460\u2464"}], "title": "7.3.2. `Shared-Storage-Write` Response Header"}, {"refs": [{"id": "ref-for-string\u2460\u2465"}, {"id": "ref-for-string\u2460\u2466"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['e075de1c'] = {"dfnID": "e075de1c", "url": "https://httpwg.org/specs/rfc8941.html#specify", "dfnText": "structured header", "refSections": [{"refs": [{"id": "ref-for-specify"}], "title": "7.3.1. `Sec-Shared-Storage-Writable` Request Header"}, {"refs": [{"id": "ref-for-specify\u2460"}], "title": "7.3.2. `Shared-Storage-Write` Response Header"}], "external": true};
window.dfnpanelData['04dc11d2'] = {"dfnID": "04dc11d2", "url": "https://httpwg.org/specs/rfc8941.html#token", "dfnText": "token", "refSections": [{"refs": [{"id": "ref-for-token"}, {"id": "ref-for-token\u2460"}, {"id": "ref-for-token\u2461"}, {"id": "ref-for-token\u2462"}, {"id": "ref-for-token\u2463"}, {"id": "ref-for-token\u2464"}], "title": "7.3.2. `Shared-Storage-Write` Response Header"}, {"refs": [{"id": "ref-for-token\u2465"}, {"id": "ref-for-token\u2466"}, {"id": "ref-for-token\u2467"}, {"id": "ref-for-token\u2468"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['7d16decb'] = {"dfnID": "7d16decb", "url": "https://w3c.github.io/ServiceWorker/#service-worker-registration-storage-key", "dfnText": "storage key", "refSections": [{"refs": [{"id": "ref-for-service-worker-registration-storage-key"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": true};
window.dfnpanelData['bf8231d0'] = {"dfnID": "bf8231d0", "url": "https://github.com/WICG/shared-storage#example-scenarios", "dfnText": "legitimate use cases", "refSections": [{"refs": [{"id": "ref-for-example-scenarios"}], "title": "1. Introduction"}], "external": true};
window.dfnpanelData['7f8002fa'] = {"dfnID": "7f8002fa", "url": "https://storage.spec.whatwg.org/#storage-proxy-map-backing-map", "dfnText": "backing map", "refSections": [{"refs": [{"id": "ref-for-storage-proxy-map-backing-map"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": true};
window.dfnpanelData['d7f1116b'] = {"dfnID": "d7f1116b", "url": "https://storage.spec.whatwg.org/#bottle-map", "dfnText": "bottle map", "refSections": [{"refs": [{"id": "ref-for-bottle-map"}, {"id": "ref-for-bottle-map\u2460"}, {"id": "ref-for-bottle-map\u2461"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": true};
window.dfnpanelData['7db4a4b7'] = {"dfnID": "7db4a4b7", "url": "https://storage.spec.whatwg.org/#bucket-map", "dfnText": "bucket map", "refSections": [{"refs": [{"id": "ref-for-bucket-map"}, {"id": "ref-for-bucket-map\u2460"}, {"id": "ref-for-bucket-map\u2461"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": true};
window.dfnpanelData['0ad0fd9b'] = {"dfnID": "0ad0fd9b", "url": "https://storage.spec.whatwg.org/#storage-bottle-proxy-map-reference-set", "dfnText": "proxy map reference set", "refSections": [{"refs": [{"id": "ref-for-storage-bottle-proxy-map-reference-set"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": true};
window.dfnpanelData['73fdd654'] = {"dfnID": "73fdd654", "url": "https://storage.spec.whatwg.org/#storage-bottle-quota", "dfnText": "quota (for storage bottle)", "refSections": [{"refs": [{"id": "ref-for-storage-bottle-quota"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": true};
window.dfnpanelData['896f4663'] = {"dfnID": "896f4663", "url": "https://storage.spec.whatwg.org/#storage-endpoint-quota", "dfnText": "quota (for storage endpoint)", "refSections": [{"refs": [{"id": "ref-for-storage-endpoint-quota"}, {"id": "ref-for-storage-endpoint-quota\u2460"}, {"id": "ref-for-storage-endpoint-quota\u2461"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": true};
window.dfnpanelData['a5eb2e99'] = {"dfnID": "a5eb2e99", "url": "https://storage.spec.whatwg.org/#registered-storage-endpoints", "dfnText": "register", "refSections": [{"refs": [{"id": "ref-for-registered-storage-endpoints"}], "title": "3. Shared Storage\u2019s Backend"}, {"refs": [{"id": "ref-for-registered-storage-endpoints\u2460"}, {"id": "ref-for-registered-storage-endpoints\u2461"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": true};
window.dfnpanelData['67130339'] = {"dfnID": "67130339", "url": "https://storage.spec.whatwg.org/#storage-bottle", "dfnText": "storage bottle", "refSections": [{"refs": [{"id": "ref-for-storage-bottle"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": true};
window.dfnpanelData['6148dd37'] = {"dfnID": "6148dd37", "url": "https://storage.spec.whatwg.org/#storage-bucket", "dfnText": "storage bucket", "refSections": [{"refs": [{"id": "ref-for-storage-bucket"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": true};
window.dfnpanelData['98c6a112'] = {"dfnID": "98c6a112", "url": "https://storage.spec.whatwg.org/#storage-endpoint", "dfnText": "storage endpoint", "refSections": [{"refs": [{"id": "ref-for-storage-endpoint"}], "title": "3. Shared Storage\u2019s Backend"}, {"refs": [{"id": "ref-for-storage-endpoint\u2460"}, {"id": "ref-for-storage-endpoint\u2461"}, {"id": "ref-for-storage-endpoint\u2462"}, {"id": "ref-for-storage-endpoint\u2463"}, {"id": "ref-for-storage-endpoint\u2464"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": true};
window.dfnpanelData['5701f5c0'] = {"dfnID": "5701f5c0", "url": "https://storage.spec.whatwg.org/#storage-identifier", "dfnText": "storage identifier", "refSections": [{"refs": [{"id": "ref-for-storage-identifier"}, {"id": "ref-for-storage-identifier\u2460"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": true};
window.dfnpanelData['07260e9d'] = {"dfnID": "07260e9d", "url": "https://storage.spec.whatwg.org/#model", "dfnText": "storage model", "refSections": [{"refs": [{"id": "ref-for-model"}], "title": "3. Shared Storage\u2019s Backend"}, {"refs": [{"id": "ref-for-model\u2460"}, {"id": "ref-for-model\u2461"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": true};
window.dfnpanelData['07d4a5a2'] = {"dfnID": "07d4a5a2", "url": "https://storage.spec.whatwg.org/#storage-proxy-map", "dfnText": "storage proxy map", "refSections": [{"refs": [{"id": "ref-for-storage-proxy-map"}], "title": "3.1. Monkey Patch for the Storage Model"}, {"refs": [{"id": "ref-for-storage-proxy-map\u2460"}, {"id": "ref-for-storage-proxy-map\u2461"}, {"id": "ref-for-storage-proxy-map\u2462"}, {"id": "ref-for-storage-proxy-map\u2463"}, {"id": "ref-for-storage-proxy-map\u2464"}, {"id": "ref-for-storage-proxy-map\u2465"}, {"id": "ref-for-storage-proxy-map\u2466"}, {"id": "ref-for-storage-proxy-map\u2467"}, {"id": "ref-for-storage-proxy-map\u2468"}, {"id": "ref-for-storage-proxy-map\u2460\u24ea"}, {"id": "ref-for-storage-proxy-map\u2460\u2460"}, {"id": "ref-for-storage-proxy-map\u2460\u2461"}, {"id": "ref-for-storage-proxy-map\u2460\u2462"}], "title": "3.3. The Database Algorithms"}], "external": true};
window.dfnpanelData['660191f0'] = {"dfnID": "660191f0", "url": "https://storage.spec.whatwg.org/#storage-shed", "dfnText": "storage shed", "refSections": [{"refs": [{"id": "ref-for-storage-shed"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": true};
window.dfnpanelData['daed3f4b'] = {"dfnID": "daed3f4b", "url": "https://storage.spec.whatwg.org/#storage-shelf", "dfnText": "storage shelf", "refSections": [{"refs": [{"id": "ref-for-storage-shelf"}, {"id": "ref-for-storage-shelf\u2460"}, {"id": "ref-for-storage-shelf\u2461"}, {"id": "ref-for-storage-shelf\u2462"}, {"id": "ref-for-storage-shelf\u2463"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": true};
window.dfnpanelData['2eb97c74'] = {"dfnID": "2eb97c74", "url": "https://storage.spec.whatwg.org/#storage-type", "dfnText": "storage type", "refSections": [{"refs": [{"id": "ref-for-storage-type"}, {"id": "ref-for-storage-type\u2460"}, {"id": "ref-for-storage-type\u2461"}, {"id": "ref-for-storage-type\u2462"}, {"id": "ref-for-storage-type\u2463"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": true};
window.dfnpanelData['4c2ffaa9'] = {"dfnID": "4c2ffaa9", "url": "https://privacycg.github.io/storage-partitioning/#client-side-storage-partitioning", "dfnText": "client-side storage partitioning", "refSections": [{"refs": [{"id": "ref-for-client-side-storage-partitioning"}], "title": "1. Introduction"}, {"refs": [{"id": "ref-for-client-side-storage-partitioning\u2460"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": true};
window.dfnpanelData['959ad97b'] = {"dfnID": "959ad97b", "url": "https://url.spec.whatwg.org/#concept-url-origin", "dfnText": "origin", "refSections": [{"refs": [{"id": "ref-for-concept-url-origin"}, {"id": "ref-for-concept-url-origin\u2460"}, {"id": "ref-for-concept-url-origin\u2461"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-concept-url-origin\u2462"}], "title": "2.2.1. Monkey Patch for set up a worklet environment settings object"}, {"refs": [{"id": "ref-for-concept-url-origin\u2463"}], "title": "2.2.3. Monkey Patch for fetch a worklet script graph"}, {"refs": [{"id": "ref-for-concept-url-origin\u2464"}], "title": "2.2.4. The `Shared-Storage-Cross-Origin-Worklet-Allowed` HTTP response header"}, {"refs": [{"id": "ref-for-concept-url-origin\u2465"}, {"id": "ref-for-concept-url-origin\u2466"}], "title": "2.2.5. Monkey Patch for HTTP fetch"}, {"refs": [{"id": "ref-for-concept-url-origin\u2467"}, {"id": "ref-for-concept-url-origin\u2468"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": true};
window.dfnpanelData['dcffbccd'] = {"dfnID": "dcffbccd", "url": "https://url.spec.whatwg.org/#concept-url", "dfnText": "url", "refSections": [{"refs": [{"id": "ref-for-concept-url"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-concept-url\u2460"}], "title": "2.2.4. The `Shared-Storage-Cross-Origin-Worklet-Allowed` HTTP response header"}, {"refs": [{"id": "ref-for-concept-url\u2461"}], "title": "2.2.5. Monkey Patch for HTTP fetch"}, {"refs": [{"id": "ref-for-concept-url\u2462"}, {"id": "ref-for-concept-url\u2463"}, {"id": "ref-for-concept-url\u2464"}, {"id": "ref-for-concept-url\u2465"}, {"id": "ref-for-concept-url\u2466"}, {"id": "ref-for-concept-url\u2467"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}, {"refs": [{"id": "ref-for-concept-url\u2468"}, {"id": "ref-for-concept-url\u2460\u24ea"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-concept-url\u2460\u2460"}], "title": "2.6.2. Reporting Entropy Budget"}, {"refs": [{"id": "ref-for-concept-url\u2460\u2461"}, {"id": "ref-for-concept-url\u2460\u2462"}, {"id": "ref-for-concept-url\u2460\u2463"}], "title": "10. Privacy Considerations"}], "external": true};
window.dfnpanelData['ca3ca4ae'] = {"dfnID": "ca3ca4ae", "url": "https://url.spec.whatwg.org/#concept-url-parser", "dfnText": "url parser", "refSections": [{"refs": [{"id": "ref-for-concept-url-parser"}, {"id": "ref-for-concept-url-parser\u2460"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}], "external": true};
window.dfnpanelData['5442ea33'] = {"dfnID": "5442ea33", "url": "https://url.spec.whatwg.org/#concept-url-serializer", "dfnText": "url serializer", "refSections": [{"refs": [{"id": "ref-for-concept-url-serializer"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}], "external": true};
window.dfnpanelData['8855a9aa'] = {"dfnID": "8855a9aa", "url": "https://webidl.spec.whatwg.org/#idl-DOMString", "dfnText": "DOMString", "refSections": [{"refs": [{"id": "ref-for-idl-DOMString"}, {"id": "ref-for-idl-DOMString\u2460"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-idl-DOMString\u2461"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-idl-DOMString\u2462"}], "title": "2.3.1. Monkey Patch for request destination"}, {"refs": [{"id": "ref-for-idl-DOMString\u2463"}, {"id": "ref-for-idl-DOMString\u2464"}, {"id": "ref-for-idl-DOMString\u2465"}, {"id": "ref-for-idl-DOMString\u2466"}, {"id": "ref-for-idl-DOMString\u2467"}], "title": "4. The SharedStorage Interface"}, {"refs": [{"id": "ref-for-idl-DOMString\u2468"}, {"id": "ref-for-idl-DOMString\u2460\u24ea"}], "title": "4.1. The WindowSharedStorage interface"}, {"refs": [{"id": "ref-for-idl-DOMString\u2460\u2460"}, {"id": "ref-for-idl-DOMString\u2460\u2461"}, {"id": "ref-for-idl-DOMString\u2460\u2462"}, {"id": "ref-for-idl-DOMString\u2460\u2463"}], "title": "4.3. The WorkletSharedStorage interface"}], "external": true};
window.dfnpanelData['889e932f'] = {"dfnID": "889e932f", "url": "https://webidl.spec.whatwg.org/#Exposed", "dfnText": "Exposed", "refSections": [{"refs": [{"id": "ref-for-Exposed"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-Exposed\u2460"}], "title": "2.3.1. Monkey Patch for request destination"}, {"refs": [{"id": "ref-for-Exposed\u2461"}], "title": "4. The SharedStorage Interface"}, {"refs": [{"id": "ref-for-Exposed\u2462"}], "title": "4.1. The WindowSharedStorage interface"}, {"refs": [{"id": "ref-for-Exposed\u2463"}], "title": "4.3. The WorkletSharedStorage interface"}], "external": true};
window.dfnpanelData['dcf5fafa'] = {"dfnID": "dcf5fafa", "url": "https://webidl.spec.whatwg.org/#idl-frozen-array", "dfnText": "FrozenArray", "refSections": [{"refs": [{"id": "ref-for-idl-frozen-array"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-idl-frozen-array\u2460"}], "title": "4.1. The WindowSharedStorage interface"}], "external": true};
window.dfnpanelData['ae46556f'] = {"dfnID": "ae46556f", "url": "https://webidl.spec.whatwg.org/#Function", "dfnText": "Function", "refSections": [{"refs": [{"id": "ref-for-Function"}], "title": "2.3.1. Monkey Patch for request destination"}], "external": true};
window.dfnpanelData['7fb6fbc6'] = {"dfnID": "7fb6fbc6", "url": "https://webidl.spec.whatwg.org/#Global", "dfnText": "Global", "refSections": [{"refs": [{"id": "ref-for-Global"}], "title": "2.3.1. Monkey Patch for request destination"}], "external": true};
window.dfnpanelData['bdbd19d1'] = {"dfnID": "bdbd19d1", "url": "https://webidl.spec.whatwg.org/#idl-promise", "dfnText": "Promise", "refSections": [{"refs": [{"id": "ref-for-idl-promise"}, {"id": "ref-for-idl-promise\u2460"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-idl-promise\u2464"}], "title": "2.3.1. Monkey Patch for request destination"}, {"refs": [{"id": "ref-for-idl-promise\u2465"}, {"id": "ref-for-idl-promise\u2466"}, {"id": "ref-for-idl-promise\u2467"}, {"id": "ref-for-idl-promise\u2468"}], "title": "4. The SharedStorage Interface"}, {"refs": [{"id": "ref-for-idl-promise\u2460\u24ea"}, {"id": "ref-for-idl-promise\u2460\u2460"}, {"id": "ref-for-idl-promise\u2460\u2461"}], "title": "4.1. The WindowSharedStorage interface"}, {"refs": [{"id": "ref-for-idl-promise\u2460\u2467"}, {"id": "ref-for-idl-promise\u2460\u2468"}, {"id": "ref-for-idl-promise\u2461\u24ea"}], "title": "4.3. The WorkletSharedStorage interface"}], "external": true};
window.dfnpanelData['b75bb3bd'] = {"dfnID": "b75bb3bd", "url": "https://webidl.spec.whatwg.org/#SecureContext", "dfnText": "SecureContext", "refSections": [{"refs": [{"id": "ref-for-SecureContext"}], "title": "4.2. Extension to the Window interface"}, {"refs": [{"id": "ref-for-SecureContext\u2460"}], "title": "6.1. sharedStorageWritable & sharedstoragewritable Attributes"}], "external": true};
window.dfnpanelData['82ca3efc'] = {"dfnID": "82ca3efc", "url": "https://webidl.spec.whatwg.org/#exceptiondef-typeerror", "dfnText": "TypeError", "refSections": [{"refs": [{"id": "ref-for-exceptiondef-typeerror"}, {"id": "ref-for-exceptiondef-typeerror\u2460"}, {"id": "ref-for-exceptiondef-typeerror\u2461"}, {"id": "ref-for-exceptiondef-typeerror\u2462"}, {"id": "ref-for-exceptiondef-typeerror\u2463"}, {"id": "ref-for-exceptiondef-typeerror\u2464"}, {"id": "ref-for-exceptiondef-typeerror\u2465"}, {"id": "ref-for-exceptiondef-typeerror\u2466"}, {"id": "ref-for-exceptiondef-typeerror\u2467"}, {"id": "ref-for-exceptiondef-typeerror\u2468"}, {"id": "ref-for-exceptiondef-typeerror\u2460\u24ea"}, {"id": "ref-for-exceptiondef-typeerror\u2460\u2460"}, {"id": "ref-for-exceptiondef-typeerror\u2460\u2461"}, {"id": "ref-for-exceptiondef-typeerror\u2460\u2462"}, {"id": "ref-for-exceptiondef-typeerror\u2460\u2463"}, {"id": "ref-for-exceptiondef-typeerror\u2460\u2464"}, {"id": "ref-for-exceptiondef-typeerror\u2460\u2465"}, {"id": "ref-for-exceptiondef-typeerror\u2460\u2466"}, {"id": "ref-for-exceptiondef-typeerror\u2460\u2467"}, {"id": "ref-for-exceptiondef-typeerror\u2460\u2468"}, {"id": "ref-for-exceptiondef-typeerror\u2461\u24ea"}, {"id": "ref-for-exceptiondef-typeerror\u2461\u2460"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-exceptiondef-typeerror\u2461\u2461"}, {"id": "ref-for-exceptiondef-typeerror\u2461\u2462"}], "title": "2.2.6. Monkey Patch for addModule()"}, {"refs": [{"id": "ref-for-exceptiondef-typeerror\u2461\u2463"}, {"id": "ref-for-exceptiondef-typeerror\u2461\u2464"}, {"id": "ref-for-exceptiondef-typeerror\u2461\u2465"}, {"id": "ref-for-exceptiondef-typeerror\u2461\u2466"}], "title": "2.4. SharedStorageWorkletGlobalScope algorithms"}, {"refs": [{"id": "ref-for-exceptiondef-typeerror\u2461\u2467"}, {"id": "ref-for-exceptiondef-typeerror\u2461\u2468"}, {"id": "ref-for-exceptiondef-typeerror\u2462\u24ea"}, {"id": "ref-for-exceptiondef-typeerror\u2462\u2460"}, {"id": "ref-for-exceptiondef-typeerror\u2462\u2461"}, {"id": "ref-for-exceptiondef-typeerror\u2462\u2462"}, {"id": "ref-for-exceptiondef-typeerror\u2462\u2463"}, {"id": "ref-for-exceptiondef-typeerror\u2462\u2464"}, {"id": "ref-for-exceptiondef-typeerror\u2462\u2465"}, {"id": "ref-for-exceptiondef-typeerror\u2462\u2466"}, {"id": "ref-for-exceptiondef-typeerror\u2462\u2467"}, {"id": "ref-for-exceptiondef-typeerror\u2462\u2468"}, {"id": "ref-for-exceptiondef-typeerror\u2463\u24ea"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-exceptiondef-typeerror\u2463\u2460"}], "title": "4.1.3. Create a new worklet via WindowSharedStorage"}, {"refs": [{"id": "ref-for-exceptiondef-typeerror\u2463\u2461"}, {"id": "ref-for-exceptiondef-typeerror\u2463\u2462"}, {"id": "ref-for-exceptiondef-typeerror\u2463\u2463"}, {"id": "ref-for-exceptiondef-typeerror\u2463\u2464"}, {"id": "ref-for-exceptiondef-typeerror\u2463\u2465"}, {"id": "ref-for-exceptiondef-typeerror\u2463\u2466"}, {"id": "ref-for-exceptiondef-typeerror\u2463\u2467"}, {"id": "ref-for-exceptiondef-typeerror\u2463\u2468"}, {"id": "ref-for-exceptiondef-typeerror\u2464\u24ea"}, {"id": "ref-for-exceptiondef-typeerror\u2464\u2460"}, {"id": "ref-for-exceptiondef-typeerror\u2464\u2461"}, {"id": "ref-for-exceptiondef-typeerror\u2464\u2462"}, {"id": "ref-for-exceptiondef-typeerror\u2464\u2463"}, {"id": "ref-for-exceptiondef-typeerror\u2464\u2464"}, {"id": "ref-for-exceptiondef-typeerror\u2464\u2465"}, {"id": "ref-for-exceptiondef-typeerror\u2464\u2466"}, {"id": "ref-for-exceptiondef-typeerror\u2464\u2467"}, {"id": "ref-for-exceptiondef-typeerror\u2464\u2468"}, {"id": "ref-for-exceptiondef-typeerror\u2465\u24ea"}, {"id": "ref-for-exceptiondef-typeerror\u2465\u2460"}, {"id": "ref-for-exceptiondef-typeerror\u2465\u2461"}, {"id": "ref-for-exceptiondef-typeerror\u2465\u2462"}, {"id": "ref-for-exceptiondef-typeerror\u2465\u2463"}, {"id": "ref-for-exceptiondef-typeerror\u2465\u2464"}, {"id": "ref-for-exceptiondef-typeerror\u2465\u2465"}, {"id": "ref-for-exceptiondef-typeerror\u2465\u2466"}, {"id": "ref-for-exceptiondef-typeerror\u2465\u2467"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-exceptiondef-typeerror\u2465\u2468"}, {"id": "ref-for-exceptiondef-typeerror\u2466\u24ea"}, {"id": "ref-for-exceptiondef-typeerror\u2466\u2460"}, {"id": "ref-for-exceptiondef-typeerror\u2466\u2461"}, {"id": "ref-for-exceptiondef-typeerror\u2466\u2462"}, {"id": "ref-for-exceptiondef-typeerror\u2466\u2463"}, {"id": "ref-for-exceptiondef-typeerror\u2466\u2464"}, {"id": "ref-for-exceptiondef-typeerror\u2466\u2465"}, {"id": "ref-for-exceptiondef-typeerror\u2466\u2466"}, {"id": "ref-for-exceptiondef-typeerror\u2466\u2467"}, {"id": "ref-for-exceptiondef-typeerror\u2466\u2468"}, {"id": "ref-for-exceptiondef-typeerror\u2467\u24ea"}, {"id": "ref-for-exceptiondef-typeerror\u2467\u2460"}, {"id": "ref-for-exceptiondef-typeerror\u2467\u2461"}, {"id": "ref-for-exceptiondef-typeerror\u2467\u2462"}, {"id": "ref-for-exceptiondef-typeerror\u2467\u2463"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-exceptiondef-typeerror\u2467\u2464"}, {"id": "ref-for-exceptiondef-typeerror\u2467\u2465"}, {"id": "ref-for-exceptiondef-typeerror\u2467\u2466"}, {"id": "ref-for-exceptiondef-typeerror\u2467\u2467"}, {"id": "ref-for-exceptiondef-typeerror\u2467\u2468"}, {"id": "ref-for-exceptiondef-typeerror\u2468\u24ea"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['b0d7f3c3'] = {"dfnID": "b0d7f3c3", "url": "https://webidl.spec.whatwg.org/#idl-USVString", "dfnText": "USVString", "refSections": [{"refs": [{"id": "ref-for-idl-USVString"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-idl-USVString\u2460"}], "title": "2.3.1. Monkey Patch for request destination"}, {"refs": [{"id": "ref-for-idl-USVString\u2461"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}, {"refs": [{"id": "ref-for-idl-USVString\u2462"}], "title": "4.1. The WindowSharedStorage interface"}], "external": true};
window.dfnpanelData['d0b4a948'] = {"dfnID": "d0b4a948", "url": "https://webidl.spec.whatwg.org/#a-promise-rejected-with", "dfnText": "a promise rejected with", "refSections": [{"refs": [{"id": "ref-for-a-promise-rejected-with\u2460\u2465"}, {"id": "ref-for-a-promise-rejected-with\u2460\u2466"}], "title": "2.2.6. Monkey Patch for addModule()"}], "external": true};
window.dfnpanelData['cc61f510'] = {"dfnID": "cc61f510", "url": "https://webidl.spec.whatwg.org/#an-exception-was-thrown", "dfnText": "an exception was thrown", "refSections": [{"refs": [{"id": "ref-for-an-exception-was-thrown"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-an-exception-was-thrown\u2460"}, {"id": "ref-for-an-exception-was-thrown\u2461"}, {"id": "ref-for-an-exception-was-thrown\u2462"}, {"id": "ref-for-an-exception-was-thrown\u2463"}, {"id": "ref-for-an-exception-was-thrown\u2464"}, {"id": "ref-for-an-exception-was-thrown\u2465"}, {"id": "ref-for-an-exception-was-thrown\u2466"}, {"id": "ref-for-an-exception-was-thrown\u2467"}], "title": "3.3. The Database Algorithms"}], "external": true};
window.dfnpanelData['6c6b1005'] = {"dfnID": "6c6b1005", "url": "https://webidl.spec.whatwg.org/#idl-any", "dfnText": "any", "refSections": [{"refs": [{"id": "ref-for-idl-any"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-idl-any\u2460"}], "title": "2.3.1. Monkey Patch for request destination"}, {"refs": [{"id": "ref-for-idl-any\u2461"}, {"id": "ref-for-idl-any\u2462"}, {"id": "ref-for-idl-any\u2463"}, {"id": "ref-for-idl-any\u2464"}], "title": "4. The SharedStorage Interface"}, {"refs": [{"id": "ref-for-idl-any\u2465"}], "title": "4.1. The WindowSharedStorage interface"}], "external": true};
window.dfnpanelData['3e180d35'] = {"dfnID": "3e180d35", "url": "https://webidl.spec.whatwg.org/#dfn-associated-realm", "dfnText": "associated realm", "refSections": [{"refs": [{"id": "ref-for-dfn-associated-realm"}, {"id": "ref-for-dfn-associated-realm\u2460"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}], "external": true};
window.dfnpanelData['11f367b8'] = {"dfnID": "11f367b8", "url": "https://webidl.spec.whatwg.org#idl-async-iterable", "dfnText": "async iterator", "refSections": [{"refs": [{"id": "ref-for-idl-async-iterable"}, {"id": "ref-for-idl-async-iterable\u2460"}, {"id": "ref-for-idl-async-iterable\u2461"}, {"id": "ref-for-idl-async-iterable\u2462"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['9a7f3f6f'] = {"dfnID": "9a7f3f6f", "url": "https://webidl.spec.whatwg.org/#asynchronous-iterator-initialization-steps", "dfnText": "asynchronous iterator initialization steps", "refSections": [{"refs": [{"id": "ref-for-asynchronous-iterator-initialization-steps"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['5372cca8'] = {"dfnID": "5372cca8", "url": "https://webidl.spec.whatwg.org/#idl-boolean", "dfnText": "boolean", "refSections": [{"refs": [{"id": "ref-for-idl-boolean"}], "title": "4. The SharedStorage Interface"}, {"refs": [{"id": "ref-for-idl-boolean\u2460"}, {"id": "ref-for-idl-boolean\u2461"}], "title": "4.1. The WindowSharedStorage interface"}, {"refs": [{"id": "ref-for-idl-boolean\u2462"}], "title": "4.3.3. Iteration"}, {"refs": [{"id": "ref-for-idl-boolean\u2463"}], "title": "6.1. sharedStorageWritable & sharedstoragewritable Attributes"}, {"refs": [{"id": "ref-for-idl-boolean\u2464"}], "title": "7.1. sharedStorageWritable Key"}], "external": true};
window.dfnpanelData['1fc2b625'] = {"dfnID": "1fc2b625", "url": "https://webidl.spec.whatwg.org/#construct-a-callback-function", "dfnText": "construct", "refSections": [{"refs": [{"id": "ref-for-construct-a-callback-function"}], "title": "2.4. SharedStorageWorkletGlobalScope algorithms"}], "external": true};
window.dfnpanelData['bec98d30'] = {"dfnID": "bec98d30", "url": "https://webidl.spec.whatwg.org/#dfn-dictionary", "dfnText": "dictionary", "refSections": [{"refs": [{"id": "ref-for-dfn-dictionary"}, {"id": "ref-for-dfn-dictionary\u2460"}, {"id": "ref-for-dfn-dictionary\u2461"}, {"id": "ref-for-dfn-dictionary\u2462"}, {"id": "ref-for-dfn-dictionary\u2463"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}], "external": true};
window.dfnpanelData['8c800cdf'] = {"dfnID": "8c800cdf", "url": "https://webidl.spec.whatwg.org/#idl-double", "dfnText": "double", "refSections": [{"refs": [{"id": "ref-for-idl-double"}], "title": "2.6.2. Reporting Entropy Budget"}, {"refs": [{"id": "ref-for-idl-double\u2460"}], "title": "4.3. The WorkletSharedStorage interface"}], "external": true};
window.dfnpanelData['e7652812'] = {"dfnID": "e7652812", "url": "https://webidl.spec.whatwg.org/#dfn-get-the-next-iteration-result", "dfnText": "get the next iteration result", "refSections": [{"refs": [{"id": "ref-for-dfn-get-the-next-iteration-result"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['1422ec4e'] = {"dfnID": "1422ec4e", "url": "https://webidl.spec.whatwg.org/#dfn-interface", "dfnText": "interface", "refSections": [{"refs": [{"id": "ref-for-dfn-interface"}], "title": "6.1. sharedStorageWritable & sharedstoragewritable Attributes"}], "external": true};
window.dfnpanelData['d08c79a9'] = {"dfnID": "d08c79a9", "url": "https://webidl.spec.whatwg.org/#interface-mixin", "dfnText": "interface mixin", "refSections": [{"refs": [{"id": "ref-for-interface-mixin"}], "title": "6.1. sharedStorageWritable & sharedstoragewritable Attributes"}], "external": true};
window.dfnpanelData['10ce5f6f'] = {"dfnID": "10ce5f6f", "url": "https://webidl.spec.whatwg.org/#invoke-a-callback-function", "dfnText": "invoke", "refSections": [{"refs": [{"id": "ref-for-invoke-a-callback-function"}, {"id": "ref-for-invoke-a-callback-function\u2460"}, {"id": "ref-for-invoke-a-callback-function\u2461"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}], "external": true};
window.dfnpanelData['efd1ec5d'] = {"dfnID": "efd1ec5d", "url": "https://webidl.spec.whatwg.org/#idl-object", "dfnText": "object", "refSections": [{"refs": [{"id": "ref-for-idl-object"}, {"id": "ref-for-idl-object\u2460"}, {"id": "ref-for-idl-object\u2461"}, {"id": "ref-for-idl-object\u2462"}, {"id": "ref-for-idl-object\u2463"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}, {"refs": [{"id": "ref-for-idl-object\u2464"}], "title": "4.1. The WindowSharedStorage interface"}], "external": true};
window.dfnpanelData['4bf1cac4'] = {"dfnID": "4bf1cac4", "url": "https://webidl.spec.whatwg.org#idl-promise", "dfnText": "promise", "refSections": [{"refs": [{"id": "ref-for-idl-promise\u2461"}, {"id": "ref-for-idl-promise\u2462"}, {"id": "ref-for-idl-promise\u2463"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-idl-promise\u2460\u2462"}, {"id": "ref-for-idl-promise\u2460\u2463"}, {"id": "ref-for-idl-promise\u2460\u2464"}, {"id": "ref-for-idl-promise\u2460\u2465"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-idl-promise\u2460\u2466"}], "title": "4.1.3. Create a new worklet via WindowSharedStorage"}, {"refs": [{"id": "ref-for-idl-promise\u2461\u2460"}, {"id": "ref-for-idl-promise\u2461\u2461"}, {"id": "ref-for-idl-promise\u2461\u2462"}, {"id": "ref-for-idl-promise\u2461\u2463"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-idl-promise\u2461\u2464"}, {"id": "ref-for-idl-promise\u2461\u2465"}, {"id": "ref-for-idl-promise\u2461\u2466"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-idl-promise\u2461\u2467"}, {"id": "ref-for-idl-promise\u2461\u2468"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['cc608da4'] = {"dfnID": "cc608da4", "url": "https://webidl.spec.whatwg.org#a-promise-rejected-with", "dfnText": "promise rejected", "refSections": [{"refs": [{"id": "ref-for-a-promise-rejected-with"}, {"id": "ref-for-a-promise-rejected-with\u2460"}, {"id": "ref-for-a-promise-rejected-with\u2461"}, {"id": "ref-for-a-promise-rejected-with\u2462"}, {"id": "ref-for-a-promise-rejected-with\u2463"}, {"id": "ref-for-a-promise-rejected-with\u2464"}, {"id": "ref-for-a-promise-rejected-with\u2465"}, {"id": "ref-for-a-promise-rejected-with\u2466"}, {"id": "ref-for-a-promise-rejected-with\u2467"}, {"id": "ref-for-a-promise-rejected-with\u2468"}, {"id": "ref-for-a-promise-rejected-with\u2460\u24ea"}, {"id": "ref-for-a-promise-rejected-with\u2460\u2460"}, {"id": "ref-for-a-promise-rejected-with\u2460\u2461"}, {"id": "ref-for-a-promise-rejected-with\u2460\u2462"}, {"id": "ref-for-a-promise-rejected-with\u2460\u2463"}, {"id": "ref-for-a-promise-rejected-with\u2460\u2464"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-a-promise-rejected-with\u2460\u2467"}, {"id": "ref-for-a-promise-rejected-with\u2460\u2468"}, {"id": "ref-for-a-promise-rejected-with\u2461\u24ea"}, {"id": "ref-for-a-promise-rejected-with\u2461\u2460"}, {"id": "ref-for-a-promise-rejected-with\u2461\u2461"}, {"id": "ref-for-a-promise-rejected-with\u2461\u2462"}, {"id": "ref-for-a-promise-rejected-with\u2461\u2463"}, {"id": "ref-for-a-promise-rejected-with\u2461\u2464"}, {"id": "ref-for-a-promise-rejected-with\u2461\u2465"}, {"id": "ref-for-a-promise-rejected-with\u2461\u2466"}, {"id": "ref-for-a-promise-rejected-with\u2461\u2467"}, {"id": "ref-for-a-promise-rejected-with\u2461\u2468"}, {"id": "ref-for-a-promise-rejected-with\u2462\u24ea"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-a-promise-rejected-with\u2462\u2460"}, {"id": "ref-for-a-promise-rejected-with\u2462\u2461"}, {"id": "ref-for-a-promise-rejected-with\u2462\u2462"}, {"id": "ref-for-a-promise-rejected-with\u2462\u2463"}, {"id": "ref-for-a-promise-rejected-with\u2462\u2464"}, {"id": "ref-for-a-promise-rejected-with\u2462\u2465"}, {"id": "ref-for-a-promise-rejected-with\u2462\u2466"}, {"id": "ref-for-a-promise-rejected-with\u2462\u2467"}, {"id": "ref-for-a-promise-rejected-with\u2462\u2468"}, {"id": "ref-for-a-promise-rejected-with\u2463\u24ea"}, {"id": "ref-for-a-promise-rejected-with\u2463\u2460"}, {"id": "ref-for-a-promise-rejected-with\u2463\u2461"}, {"id": "ref-for-a-promise-rejected-with\u2463\u2462"}, {"id": "ref-for-a-promise-rejected-with\u2463\u2463"}, {"id": "ref-for-a-promise-rejected-with\u2463\u2464"}, {"id": "ref-for-a-promise-rejected-with\u2463\u2465"}, {"id": "ref-for-a-promise-rejected-with\u2463\u2466"}, {"id": "ref-for-a-promise-rejected-with\u2463\u2467"}, {"id": "ref-for-a-promise-rejected-with\u2463\u2468"}, {"id": "ref-for-a-promise-rejected-with\u2464\u24ea"}, {"id": "ref-for-a-promise-rejected-with\u2464\u2460"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-a-promise-rejected-with\u2464\u2461"}, {"id": "ref-for-a-promise-rejected-with\u2464\u2462"}, {"id": "ref-for-a-promise-rejected-with\u2464\u2463"}, {"id": "ref-for-a-promise-rejected-with\u2464\u2464"}, {"id": "ref-for-a-promise-rejected-with\u2464\u2465"}, {"id": "ref-for-a-promise-rejected-with\u2464\u2466"}, {"id": "ref-for-a-promise-rejected-with\u2464\u2467"}, {"id": "ref-for-a-promise-rejected-with\u2464\u2468"}, {"id": "ref-for-a-promise-rejected-with\u2465\u24ea"}, {"id": "ref-for-a-promise-rejected-with\u2465\u2460"}, {"id": "ref-for-a-promise-rejected-with\u2465\u2461"}, {"id": "ref-for-a-promise-rejected-with\u2465\u2462"}, {"id": "ref-for-a-promise-rejected-with\u2465\u2463"}, {"id": "ref-for-a-promise-rejected-with\u2465\u2464"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-a-promise-rejected-with\u2465\u2465"}, {"id": "ref-for-a-promise-rejected-with\u2465\u2466"}, {"id": "ref-for-a-promise-rejected-with\u2465\u2467"}, {"id": "ref-for-a-promise-rejected-with\u2465\u2468"}, {"id": "ref-for-a-promise-rejected-with\u2466\u24ea"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['b262501e'] = {"dfnID": "b262501e", "url": "https://webidl.spec.whatwg.org/#reject", "dfnText": "reject", "refSections": [{"refs": [{"id": "ref-for-reject"}, {"id": "ref-for-reject\u2460"}, {"id": "ref-for-reject\u2461"}, {"id": "ref-for-reject\u2462"}, {"id": "ref-for-reject\u2463"}, {"id": "ref-for-reject\u2464"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-reject\u2465"}], "title": "4.1.3. Create a new worklet via WindowSharedStorage"}, {"refs": [{"id": "ref-for-reject\u2466"}, {"id": "ref-for-reject\u2467"}, {"id": "ref-for-reject\u2468"}, {"id": "ref-for-reject\u2460\u24ea"}, {"id": "ref-for-reject\u2460\u2460"}, {"id": "ref-for-reject\u2460\u2461"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-reject\u2460\u2462"}, {"id": "ref-for-reject\u2460\u2463"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-reject\u2460\u2464"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['3b90bdcd'] = {"dfnID": "3b90bdcd", "url": "https://webidl.spec.whatwg.org/#resolve", "dfnText": "resolve", "refSections": [{"refs": [{"id": "ref-for-resolve"}, {"id": "ref-for-resolve\u2460"}, {"id": "ref-for-resolve\u2461"}, {"id": "ref-for-resolve\u2462"}, {"id": "ref-for-resolve\u2463"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-resolve\u2464"}, {"id": "ref-for-resolve\u2465"}], "title": "2.2.6. Monkey Patch for addModule()"}, {"refs": [{"id": "ref-for-resolve\u2466"}, {"id": "ref-for-resolve\u2467"}, {"id": "ref-for-resolve\u2468"}, {"id": "ref-for-resolve\u2460\u24ea"}, {"id": "ref-for-resolve\u2460\u2460"}, {"id": "ref-for-resolve\u2460\u2461"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-resolve\u2460\u2462"}], "title": "4.1.3. Create a new worklet via WindowSharedStorage"}, {"refs": [{"id": "ref-for-resolve\u2460\u2463"}, {"id": "ref-for-resolve\u2460\u2464"}, {"id": "ref-for-resolve\u2460\u2465"}, {"id": "ref-for-resolve\u2460\u2466"}, {"id": "ref-for-resolve\u2460\u2467"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-resolve\u2460\u2468"}, {"id": "ref-for-resolve\u2461\u24ea"}, {"id": "ref-for-resolve\u2461\u2460"}, {"id": "ref-for-resolve\u2461\u2461"}, {"id": "ref-for-resolve\u2461\u2462"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-resolve\u2461\u2463"}, {"id": "ref-for-resolve\u2461\u2464"}, {"id": "ref-for-resolve\u2461\u2465"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['9cce47fd'] = {"dfnID": "9cce47fd", "url": "https://webidl.spec.whatwg.org/#idl-sequence", "dfnText": "sequence", "refSections": [{"refs": [{"id": "ref-for-idl-sequence"}], "title": "2.3.1. Monkey Patch for request destination"}], "external": true};
window.dfnpanelData['4013a022'] = {"dfnID": "4013a022", "url": "https://webidl.spec.whatwg.org/#this", "dfnText": "this", "refSections": [{"refs": [{"id": "ref-for-this"}, {"id": "ref-for-this\u2460"}, {"id": "ref-for-this\u2461"}, {"id": "ref-for-this\u2462"}, {"id": "ref-for-this\u2463"}, {"id": "ref-for-this\u2464"}, {"id": "ref-for-this\u2465"}, {"id": "ref-for-this\u2466"}, {"id": "ref-for-this\u2467"}, {"id": "ref-for-this\u2468"}, {"id": "ref-for-this\u2460\u24ea"}, {"id": "ref-for-this\u2460\u2460"}, {"id": "ref-for-this\u2460\u2461"}, {"id": "ref-for-this\u2460\u2462"}, {"id": "ref-for-this\u2460\u2463"}, {"id": "ref-for-this\u2460\u2464"}, {"id": "ref-for-this\u2460\u2465"}, {"id": "ref-for-this\u2460\u2466"}, {"id": "ref-for-this\u2460\u2467"}, {"id": "ref-for-this\u2460\u2468"}, {"id": "ref-for-this\u2461\u24ea"}, {"id": "ref-for-this\u2461\u2460"}, {"id": "ref-for-this\u2461\u2461"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-this\u2461\u2462"}, {"id": "ref-for-this\u2461\u2463"}], "title": "2.4. SharedStorageWorkletGlobalScope algorithms"}, {"refs": [{"id": "ref-for-this\u2461\u2464"}, {"id": "ref-for-this\u2461\u2465"}], "title": "4.1.2. Run Operation Methods on WindowSharedStorage"}, {"refs": [{"id": "ref-for-this\u2461\u2466"}, {"id": "ref-for-this\u2461\u2467"}], "title": "4.2. Extension to the Window interface"}], "external": true};
window.dfnpanelData['5f90bbfb'] = {"dfnID": "5f90bbfb", "url": "https://webidl.spec.whatwg.org/#idl-undefined", "dfnText": "undefined", "refSections": [{"refs": [{"id": "ref-for-idl-undefined"}], "title": "2.3.1. Monkey Patch for request destination"}], "external": true};
window.dfnpanelData['e97a9688'] = {"dfnID": "e97a9688", "url": "https://webidl.spec.whatwg.org/#idl-unsigned-long", "dfnText": "unsigned long", "refSections": [{"refs": [{"id": "ref-for-idl-unsigned-long"}], "title": "2.3.1. Monkey Patch for request destination"}, {"refs": [{"id": "ref-for-idl-unsigned-long\u2460"}], "title": "4.3. The WorkletSharedStorage interface"}], "external": true};
window.dfnpanelData['24bd7d25'] = {"dfnID": "24bd7d25", "url": "https://webidl.spec.whatwg.org/#upon-fulfillment", "dfnText": "upon fulfillment", "refSections": [{"refs": [{"id": "ref-for-upon-fulfillment"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-upon-fulfillment\u2460"}], "title": "4.1.3. Create a new worklet via WindowSharedStorage"}, {"refs": [{"id": "ref-for-upon-fulfillment\u2461"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['f14ed351'] = {"dfnID": "f14ed351", "url": "https://webidl.spec.whatwg.org/#upon-rejection", "dfnText": "upon rejection", "refSections": [{"refs": [{"id": "ref-for-upon-rejection"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-upon-rejection\u2460"}], "title": "4.1.3. Create a new worklet via WindowSharedStorage"}, {"refs": [{"id": "ref-for-upon-rejection\u2461"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['375981d1'] = {"dfnID": "375981d1", "url": "https://webidl.spec.whatwg.org#introduction", "dfnText": "web idl standard", "refSections": [{"refs": [{"id": "ref-for-introduction"}], "title": "4.3.3. Iteration"}], "external": true};
window.dfnpanelData['7a101e5c'] = {"dfnID": "7a101e5c", "url": "https://en.wikipedia.org/wiki/Entropy_(information_theory)#bits-of-entropy", "dfnText": "bits of entropy", "refSections": [{"refs": [{"id": "ref-for-bits-of-entropy"}], "title": "2.6. Entropy Budgets"}], "external": true};
window.dfnpanelData['9d801570'] = {"dfnID": "9d801570", "url": "https://en.wikipedia.org/wiki/Entropy_(information_theory)#entropy-bits", "dfnText": "entropy bits", "refSections": [{"refs": [{"id": "ref-for-entropy-bits"}, {"id": "ref-for-entropy-bits\u2460"}, {"id": "ref-for-entropy-bits\u2461"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-entropy-bits\u2462"}, {"id": "ref-for-entropy-bits\u2463"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": true};
window.dfnpanelData['typedefdef-sharedstorageresponse'] = {"dfnID": "typedefdef-sharedstorageresponse", "url": "#typedefdef-sharedstorageresponse", "dfnText": "SharedStorageResponse", "refSections": [{"refs": [{"id": "ref-for-typedefdef-sharedstorageresponse"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-typedefdef-sharedstorageresponse\u2460"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}, {"refs": [{"id": "ref-for-typedefdef-sharedstorageresponse\u2461"}, {"id": "ref-for-typedefdef-sharedstorageresponse\u2462"}, {"id": "ref-for-typedefdef-sharedstorageresponse\u2463"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-typedefdef-sharedstorageresponse\u2464"}], "title": "4.1. The WindowSharedStorage interface"}], "external": false};
window.dfnpanelData['sharedstorageworklet'] = {"dfnID": "sharedstorageworklet", "url": "#sharedstorageworklet", "dfnText": "SharedStorageWorklet", "refSections": [{"refs": [{"id": "ref-for-sharedstorageworklet"}, {"id": "ref-for-sharedstorageworklet\u2460"}, {"id": "ref-for-sharedstorageworklet\u2461"}, {"id": "ref-for-sharedstorageworklet\u2462"}, {"id": "ref-for-sharedstorageworklet\u2463"}, {"id": "ref-for-sharedstorageworklet\u2464"}, {"id": "ref-for-sharedstorageworklet\u2465"}, {"id": "ref-for-sharedstorageworklet\u2466"}, {"id": "ref-for-sharedstorageworklet\u2467"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-sharedstorageworklet\u2468"}, {"id": "ref-for-sharedstorageworklet\u2460\u24ea"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-sharedstorageworklet\u2460\u2460"}], "title": "2.2.6. Monkey Patch for addModule()"}, {"refs": [{"id": "ref-for-sharedstorageworklet\u2460\u2461"}, {"id": "ref-for-sharedstorageworklet\u2460\u2462"}], "title": "2.3. The SharedStorageWorkletGlobalScope"}, {"refs": [{"id": "ref-for-sharedstorageworklet\u2460\u2463"}, {"id": "ref-for-sharedstorageworklet\u2460\u2464"}], "title": "2.3.1. Monkey Patch for request destination"}, {"refs": [{"id": "ref-for-sharedstorageworklet\u2460\u2465"}, {"id": "ref-for-sharedstorageworklet\u2460\u2466"}, {"id": "ref-for-sharedstorageworklet\u2460\u2467"}, {"id": "ref-for-sharedstorageworklet\u2460\u2468"}], "title": "4. The SharedStorage Interface"}, {"refs": [{"id": "ref-for-sharedstorageworklet\u2461\u24ea"}, {"id": "ref-for-sharedstorageworklet\u2461\u2460"}], "title": "4.1. The WindowSharedStorage interface"}, {"refs": [{"id": "ref-for-sharedstorageworklet\u2461\u2461"}], "title": "4.1.3. Create a new worklet via WindowSharedStorage"}, {"refs": [{"id": "ref-for-sharedstorageworklet\u2461\u2462"}, {"id": "ref-for-sharedstorageworklet\u2461\u2463"}], "title": "10. Privacy Considerations"}], "external": false};
window.dfnpanelData['sharedstorageworklet-addmodule-initiated'] = {"dfnID": "sharedstorageworklet-addmodule-initiated", "url": "#sharedstorageworklet-addmodule-initiated", "dfnText": "addModule initiated", "refSections": [{"refs": [{"id": "ref-for-sharedstorageworklet-addmodule-initiated"}, {"id": "ref-for-sharedstorageworklet-addmodule-initiated\u2460"}, {"id": "ref-for-sharedstorageworklet-addmodule-initiated\u2461"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-sharedstorageworklet-addmodule-initiated\u2462"}, {"id": "ref-for-sharedstorageworklet-addmodule-initiated\u2463"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}], "external": false};
window.dfnpanelData['sharedstorageworklet-cross-origin-worklet-allowed'] = {"dfnID": "sharedstorageworklet-cross-origin-worklet-allowed", "url": "#sharedstorageworklet-cross-origin-worklet-allowed", "dfnText": "cross-origin worklet allowed", "refSections": [{"refs": [{"id": "ref-for-sharedstorageworklet-cross-origin-worklet-allowed"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-sharedstorageworklet-cross-origin-worklet-allowed\u2460"}], "title": "4.1.3. Create a new worklet via WindowSharedStorage"}], "external": false};
window.dfnpanelData['sharedstorageworklet-is-cross-origin-worklet'] = {"dfnID": "sharedstorageworklet-is-cross-origin-worklet", "url": "#sharedstorageworklet-is-cross-origin-worklet", "dfnText": "is cross-origin worklet", "refSections": [{"refs": [{"id": "ref-for-sharedstorageworklet-is-cross-origin-worklet"}, {"id": "ref-for-sharedstorageworklet-is-cross-origin-worklet\u2460"}, {"id": "ref-for-sharedstorageworklet-is-cross-origin-worklet\u2461"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-sharedstorageworklet-is-cross-origin-worklet\u2462"}, {"id": "ref-for-sharedstorageworklet-is-cross-origin-worklet\u2463"}, {"id": "ref-for-sharedstorageworklet-is-cross-origin-worklet\u2464"}, {"id": "ref-for-sharedstorageworklet-is-cross-origin-worklet\u2465"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-sharedstorageworklet-is-cross-origin-worklet\u2466"}], "title": "2.2.6. Monkey Patch for addModule()"}], "external": false};
window.dfnpanelData['check-if-user-preference-setting-allows-access-to-shared-storage'] = {"dfnID": "check-if-user-preference-setting-allows-access-to-shared-storage", "url": "#check-if-user-preference-setting-allows-access-to-shared-storage", "dfnText": "check if user preference setting allows access to shared storage", "refSections": [{"refs": [{"id": "ref-for-check-if-user-preference-setting-allows-access-to-shared-storage"}, {"id": "ref-for-check-if-user-preference-setting-allows-access-to-shared-storage\u2460"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-check-if-user-preference-setting-allows-access-to-shared-storage\u2461"}, {"id": "ref-for-check-if-user-preference-setting-allows-access-to-shared-storage\u2462"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-check-if-user-preference-setting-allows-access-to-shared-storage\u2463"}], "title": "3.1. Monkey Patch for the Storage Model"}, {"refs": [{"id": "ref-for-check-if-user-preference-setting-allows-access-to-shared-storage\u2464"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-check-if-user-preference-setting-allows-access-to-shared-storage\u2465"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": false};
window.dfnpanelData['determine-whether-shared-storage-is-allowed-by-context'] = {"dfnID": "determine-whether-shared-storage-is-allowed-by-context", "url": "#determine-whether-shared-storage-is-allowed-by-context", "dfnText": "determine whether shared storage is allowed by context", "refSections": [{"refs": [{"id": "ref-for-determine-whether-shared-storage-is-allowed-by-context"}, {"id": "ref-for-determine-whether-shared-storage-is-allowed-by-context\u2460"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-determine-whether-shared-storage-is-allowed-by-context\u2461"}, {"id": "ref-for-determine-whether-shared-storage-is-allowed-by-context\u2462"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-determine-whether-shared-storage-is-allowed-by-context\u2463"}], "title": "3.1. Monkey Patch for the Storage Model"}, {"refs": [{"id": "ref-for-determine-whether-shared-storage-is-allowed-by-context\u2464"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-determine-whether-shared-storage-is-allowed-by-context\u2465"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": false};
window.dfnpanelData['check-if-addmodule-is-allowed-and-update-state'] = {"dfnID": "check-if-addmodule-is-allowed-and-update-state", "url": "#check-if-addmodule-is-allowed-and-update-state", "dfnText": "check if addModule is allowed and update state", "refSections": [{"refs": [{"id": "ref-for-check-if-addmodule-is-allowed-and-update-state"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-check-if-addmodule-is-allowed-and-update-state\u2460"}], "title": "2.2.6. Monkey Patch for addModule()"}], "external": false};
window.dfnpanelData['get-the-select-url-result-index'] = {"dfnID": "get-the-select-url-result-index", "url": "#get-the-select-url-result-index", "dfnText": "get the select-url result index", "refSections": [{"refs": [{"id": "ref-for-get-the-select-url-result-index"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}], "external": false};
window.dfnpanelData['dom-sharedstorageworklet-selecturl'] = {"dfnID": "dom-sharedstorageworklet-selecturl", "url": "#dom-sharedstorageworklet-selecturl", "dfnText": "selectURL(name, urls, options)", "refSections": [{"refs": [{"id": "ref-for-dom-sharedstorageworklet-selecturl"}, {"id": "ref-for-dom-sharedstorageworklet-selecturl\u2460"}, {"id": "ref-for-dom-sharedstorageworklet-selecturl\u2461"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-dom-sharedstorageworklet-selecturl\u2462"}, {"id": "ref-for-dom-sharedstorageworklet-selecturl\u2463"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-dom-sharedstorageworklet-selecturl\u2464"}], "title": "2.2.5. Monkey Patch for HTTP fetch"}, {"refs": [{"id": "ref-for-dom-sharedstorageworklet-selecturl\u2465"}], "title": "2.2.6. Monkey Patch for addModule()"}, {"refs": [{"id": "ref-for-dom-sharedstorageworklet-selecturl\u2466"}, {"id": "ref-for-dom-sharedstorageworklet-selecturl\u2467"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}, {"refs": [{"id": "ref-for-dom-sharedstorageworklet-selecturl\u2468"}], "title": "2.6. Entropy Budgets"}, {"refs": [{"id": "ref-for-dom-sharedstorageworklet-selecturl\u2460\u24ea"}, {"id": "ref-for-dom-sharedstorageworklet-selecturl\u2460\u2460"}, {"id": "ref-for-dom-sharedstorageworklet-selecturl\u2460\u2461"}, {"id": "ref-for-dom-sharedstorageworklet-selecturl\u2460\u2462"}, {"id": "ref-for-dom-sharedstorageworklet-selecturl\u2460\u2463"}, {"id": "ref-for-dom-sharedstorageworklet-selecturl\u2460\u2464"}, {"id": "ref-for-dom-sharedstorageworklet-selecturl\u2460\u2465"}, {"id": "ref-for-dom-sharedstorageworklet-selecturl\u2460\u2466"}, {"id": "ref-for-dom-sharedstorageworklet-selecturl\u2460\u2467"}, {"id": "ref-for-dom-sharedstorageworklet-selecturl\u2460\u2468"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-dom-sharedstorageworklet-selecturl\u2461\u24ea"}], "title": "2.6.2. Reporting Entropy Budget"}, {"refs": [{"id": "ref-for-dom-sharedstorageworklet-selecturl\u2461\u2460"}], "title": "4. The SharedStorage Interface"}, {"refs": [{"id": "ref-for-dom-sharedstorageworklet-selecturl\u2461\u2461"}], "title": "4.1.2. Run Operation Methods on WindowSharedStorage"}, {"refs": [{"id": "ref-for-dom-sharedstorageworklet-selecturl\u2461\u2462"}], "title": "8. Permissions Policy Integration"}], "external": false};
window.dfnpanelData['dom-sharedstorageworklet-run'] = {"dfnID": "dom-sharedstorageworklet-run", "url": "#dom-sharedstorageworklet-run", "dfnText": "run(name, options)", "refSections": [{"refs": [{"id": "ref-for-dom-sharedstorageworklet-run"}, {"id": "ref-for-dom-sharedstorageworklet-run\u2460"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-dom-sharedstorageworklet-run\u2461"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-dom-sharedstorageworklet-run\u2462"}], "title": "2.2.5. Monkey Patch for HTTP fetch"}, {"refs": [{"id": "ref-for-dom-sharedstorageworklet-run\u2463"}], "title": "2.2.6. Monkey Patch for addModule()"}, {"refs": [{"id": "ref-for-dom-sharedstorageworklet-run\u2464"}], "title": "4. The SharedStorage Interface"}, {"refs": [{"id": "ref-for-dom-sharedstorageworklet-run\u2465"}], "title": "4.1.2. Run Operation Methods on WindowSharedStorage"}], "external": false};
window.dfnpanelData['http-headerdef-shared-storage-cross-origin-worklet-allowed'] = {"dfnID": "http-headerdef-shared-storage-cross-origin-worklet-allowed", "url": "#http-headerdef-shared-storage-cross-origin-worklet-allowed", "dfnText": "Shared-Storage-Cross-Origin-Worklet-Allowed", "refSections": [{"refs": [{"id": "ref-for-http-headerdef-shared-storage-cross-origin-worklet-allowed"}, {"id": "ref-for-http-headerdef-shared-storage-cross-origin-worklet-allowed\u2460"}], "title": "2.2.4. The `Shared-Storage-Cross-Origin-Worklet-Allowed` HTTP response header"}, {"refs": [{"id": "ref-for-http-headerdef-shared-storage-cross-origin-worklet-allowed\u2461"}, {"id": "ref-for-http-headerdef-shared-storage-cross-origin-worklet-allowed\u2462"}], "title": "2.2.5. Monkey Patch for HTTP fetch"}], "external": false};
window.dfnpanelData['callbackdef-runfunctionforsharedstorageselecturloperation'] = {"dfnID": "callbackdef-runfunctionforsharedstorageselecturloperation", "url": "#callbackdef-runfunctionforsharedstorageselecturloperation", "dfnText": "RunFunctionForSharedStorageSelectURLOperation", "refSections": [{"refs": [{"id": "ref-for-callbackdef-runfunctionforsharedstorageselecturloperation"}], "title": "2.4. SharedStorageWorkletGlobalScope algorithms"}], "external": false};
window.dfnpanelData['sharedstorageworkletglobalscope'] = {"dfnID": "sharedstorageworkletglobalscope", "url": "#sharedstorageworkletglobalscope", "dfnText": "SharedStorageWorkletGlobalScope", "refSections": [{"refs": [{"id": "ref-for-sharedstorageworkletglobalscope"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2460"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2461"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-sharedstorageworkletglobalscope\u2462"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2463"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2464"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-sharedstorageworkletglobalscope\u2465"}], "title": "2.2.1. Monkey Patch for set up a worklet environment settings object"}, {"refs": [{"id": "ref-for-sharedstorageworkletglobalscope\u2466"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2467"}], "title": "2.2.3. Monkey Patch for fetch a worklet script graph"}, {"refs": [{"id": "ref-for-sharedstorageworkletglobalscope\u2468"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2460\u24ea"}], "title": "2.3. The SharedStorageWorkletGlobalScope"}, {"refs": [{"id": "ref-for-sharedstorageworkletglobalscope\u2460\u2460"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2460\u2461"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2460\u2462"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2460\u2463"}], "title": "2.3.1. Monkey Patch for request destination"}, {"refs": [{"id": "ref-for-sharedstorageworkletglobalscope\u2460\u2464"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2460\u2465"}], "title": "2.4. SharedStorageWorkletGlobalScope algorithms"}, {"refs": [{"id": "ref-for-sharedstorageworkletglobalscope\u2460\u2466"}], "title": "4. The SharedStorage Interface"}, {"refs": [{"id": "ref-for-sharedstorageworkletglobalscope\u2460\u2467"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2460\u2468"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2461\u24ea"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2461\u2460"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2461\u2461"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2461\u2462"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2461\u2463"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2461\u2464"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-sharedstorageworkletglobalscope\u2461\u2465"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2461\u2466"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2461\u2467"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2461\u2468"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2462\u24ea"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2462\u2460"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-sharedstorageworkletglobalscope\u2462\u2461"}, {"id": "ref-for-sharedstorageworkletglobalscope\u2462\u2462"}], "title": "4.3.3. Iteration"}, {"refs": [{"id": "ref-for-sharedstorageworkletglobalscope\u2462\u2463"}], "title": "5. Triggering Operations Via HTTP Response Header"}], "external": false};
window.dfnpanelData['dom-sharedstorageworkletglobalscope-sharedstorage'] = {"dfnID": "dom-sharedstorageworkletglobalscope-sharedstorage", "url": "#dom-sharedstorageworkletglobalscope-sharedstorage", "dfnText": "sharedStorage", "refSections": [{"refs": [{"id": "ref-for-dom-sharedstorageworkletglobalscope-sharedstorage"}, {"id": "ref-for-dom-sharedstorageworkletglobalscope-sharedstorage\u2460"}], "title": "2.4. SharedStorageWorkletGlobalScope algorithms"}], "external": false};
window.dfnpanelData['sharedstorageworkletglobalscope-outside-settings'] = {"dfnID": "sharedstorageworkletglobalscope-outside-settings", "url": "#sharedstorageworkletglobalscope-outside-settings", "dfnText": "outside settings", "refSections": [{"refs": [{"id": "ref-for-sharedstorageworkletglobalscope-outside-settings"}, {"id": "ref-for-sharedstorageworkletglobalscope-outside-settings\u2460"}, {"id": "ref-for-sharedstorageworkletglobalscope-outside-settings\u2461"}, {"id": "ref-for-sharedstorageworkletglobalscope-outside-settings\u2462"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-sharedstorageworkletglobalscope-outside-settings\u2463"}, {"id": "ref-for-sharedstorageworkletglobalscope-outside-settings\u2464"}, {"id": "ref-for-sharedstorageworkletglobalscope-outside-settings\u2465"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-sharedstorageworkletglobalscope-outside-settings\u2466"}], "title": "4.3.3. Iteration"}], "external": false};
window.dfnpanelData['sharedstorageworkletglobalscope-addmodule-success'] = {"dfnID": "sharedstorageworkletglobalscope-addmodule-success", "url": "#sharedstorageworkletglobalscope-addmodule-success", "dfnText": "addModule success", "refSections": [{"refs": [{"id": "ref-for-sharedstorageworkletglobalscope-addmodule-success"}, {"id": "ref-for-sharedstorageworkletglobalscope-addmodule-success\u2460"}], "title": "2.2.6. Monkey Patch for addModule()"}, {"refs": [{"id": "ref-for-sharedstorageworkletglobalscope-addmodule-success\u2461"}, {"id": "ref-for-sharedstorageworkletglobalscope-addmodule-success\u2462"}], "title": "2.4. SharedStorageWorkletGlobalScope algorithms"}], "external": false};
window.dfnpanelData['sharedstorageworkletglobalscope-operation-map'] = {"dfnID": "sharedstorageworkletglobalscope-operation-map", "url": "#sharedstorageworkletglobalscope-operation-map", "dfnText": "operation map", "refSections": [{"refs": [{"id": "ref-for-sharedstorageworkletglobalscope-operation-map"}, {"id": "ref-for-sharedstorageworkletglobalscope-operation-map\u2460"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-sharedstorageworkletglobalscope-operation-map\u2461"}], "title": "2.4. SharedStorageWorkletGlobalScope algorithms"}], "external": false};
window.dfnpanelData['dom-sharedstorageworkletglobalscope-register'] = {"dfnID": "dom-sharedstorageworkletglobalscope-register", "url": "#dom-sharedstorageworkletglobalscope-register", "dfnText": "register(name, operationCtor)", "refSections": [{"refs": [{"id": "ref-for-dom-sharedstorageworkletglobalscope-register"}, {"id": "ref-for-dom-sharedstorageworkletglobalscope-register\u2460"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-dom-sharedstorageworkletglobalscope-register\u2461"}], "title": "2.3.1. Monkey Patch for request destination"}], "external": false};
window.dfnpanelData['sharedstorageworkletglobalscope-sharedstorage-getter'] = {"dfnID": "sharedstorageworkletglobalscope-sharedstorage-getter", "url": "#sharedstorageworkletglobalscope-sharedstorage-getter", "dfnText": "sharedStorage getter", "refSections": [{"refs": [{"id": "ref-for-sharedstorageworkletglobalscope-sharedstorage-getter"}], "title": "2.3.1. Monkey Patch for request destination"}], "external": false};
window.dfnpanelData['sharedstorageworkletglobalscope-check-whether-addmodule-is-finished'] = {"dfnID": "sharedstorageworkletglobalscope-check-whether-addmodule-is-finished", "url": "#sharedstorageworkletglobalscope-check-whether-addmodule-is-finished", "dfnText": "check whether addModule is finished", "refSections": [{"refs": [{"id": "ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished"}, {"id": "ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished\u2460"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished\u2461"}, {"id": "ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished\u2462"}, {"id": "ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished\u2463"}, {"id": "ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished\u2464"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished\u2465"}, {"id": "ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished\u2466"}, {"id": "ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished\u2467"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-sharedstorageworkletglobalscope-check-whether-addmodule-is-finished\u2468"}], "title": "4.3.3. Iteration"}], "external": false};
window.dfnpanelData['dictdef-sharedstorageurlwithmetadata'] = {"dfnID": "dictdef-sharedstorageurlwithmetadata", "url": "#dictdef-sharedstorageurlwithmetadata", "dfnText": "SharedStorageUrlWithMetadata", "refSections": [{"refs": [{"id": "ref-for-dictdef-sharedstorageurlwithmetadata"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-dictdef-sharedstorageurlwithmetadata\u2460"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-dictdef-sharedstorageurlwithmetadata\u2461"}, {"id": "ref-for-dictdef-sharedstorageurlwithmetadata\u2462"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}, {"refs": [{"id": "ref-for-dictdef-sharedstorageurlwithmetadata\u2463"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-dictdef-sharedstorageurlwithmetadata\u2464"}], "title": "4.1. The WindowSharedStorage interface"}], "external": false};
window.dfnpanelData['dom-sharedstorageurlwithmetadata-url'] = {"dfnID": "dom-sharedstorageurlwithmetadata-url", "url": "#dom-sharedstorageurlwithmetadata-url", "dfnText": "url", "refSections": [{"refs": [{"id": "ref-for-dom-sharedstorageurlwithmetadata-url"}, {"id": "ref-for-dom-sharedstorageurlwithmetadata-url\u2460"}, {"id": "ref-for-dom-sharedstorageurlwithmetadata-url\u2461"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": false};
window.dfnpanelData['dom-sharedstorageurlwithmetadata-reportingmetadata'] = {"dfnID": "dom-sharedstorageurlwithmetadata-reportingmetadata", "url": "#dom-sharedstorageurlwithmetadata-reportingmetadata", "dfnText": "reportingMetadata", "refSections": [{"refs": [{"id": "ref-for-dom-sharedstorageurlwithmetadata-reportingmetadata"}, {"id": "ref-for-dom-sharedstorageurlwithmetadata-reportingmetadata\u2460"}, {"id": "ref-for-dom-sharedstorageurlwithmetadata-reportingmetadata\u2461"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}], "external": false};
window.dfnpanelData['validate-reporting-metadata'] = {"dfnID": "validate-reporting-metadata", "url": "#validate-reporting-metadata", "dfnText": "validate reporting metadata", "refSections": [{"refs": [{"id": "ref-for-validate-reporting-metadata"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}], "external": false};
window.dfnpanelData['get-the-canonical-url-string-if-valid'] = {"dfnID": "get-the-canonical-url-string-if-valid", "url": "#get-the-canonical-url-string-if-valid", "dfnText": "get the canonical URL string if valid", "refSections": [{"refs": [{"id": "ref-for-get-the-canonical-url-string-if-valid"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-get-the-canonical-url-string-if-valid\u2460"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}], "external": false};
window.dfnpanelData['register-reporting-metadata'] = {"dfnID": "register-reporting-metadata", "url": "#register-reporting-metadata", "dfnText": "register reporting metadata", "refSections": [{"refs": [{"id": "ref-for-register-reporting-metadata"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-register-reporting-metadata\u2460"}, {"id": "ref-for-register-reporting-metadata\u2461"}], "title": "2.5. SharedStorageUrlWithMetadata and Reporting"}], "external": false};
window.dfnpanelData['calling-site'] = {"dfnID": "calling-site", "url": "#calling-site", "dfnText": "calling site", "refSections": [{"refs": [{"id": "ref-for-calling-site"}, {"id": "ref-for-calling-site\u2460"}, {"id": "ref-for-calling-site\u2461"}, {"id": "ref-for-calling-site\u2462"}, {"id": "ref-for-calling-site\u2463"}, {"id": "ref-for-calling-site\u2464"}, {"id": "ref-for-calling-site\u2465"}, {"id": "ref-for-calling-site\u2466"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": false};
window.dfnpanelData['navigation-entropy-allowance'] = {"dfnID": "navigation-entropy-allowance", "url": "#navigation-entropy-allowance", "dfnText": "navigation entropy allowance", "refSections": [{"refs": [{"id": "ref-for-navigation-entropy-allowance"}, {"id": "ref-for-navigation-entropy-allowance\u2460"}, {"id": "ref-for-navigation-entropy-allowance\u2461"}, {"id": "ref-for-navigation-entropy-allowance\u2462"}, {"id": "ref-for-navigation-entropy-allowance\u2463"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": false};
window.dfnpanelData['navigation-budget-lifetime'] = {"dfnID": "navigation-budget-lifetime", "url": "#navigation-budget-lifetime", "dfnText": "navigation budget lifetime", "refSections": [{"refs": [{"id": "ref-for-navigation-budget-lifetime"}, {"id": "ref-for-navigation-budget-lifetime\u2460"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": false};
window.dfnpanelData['navigation-budget-epoch'] = {"dfnID": "navigation-budget-epoch", "url": "#navigation-budget-epoch", "dfnText": "navigation budget epoch", "refSections": [{"refs": [{"id": "ref-for-navigation-budget-epoch"}, {"id": "ref-for-navigation-budget-epoch\u2460"}, {"id": "ref-for-navigation-budget-epoch\u2461"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": false};
window.dfnpanelData['shared-storage-navigation-budget-table'] = {"dfnID": "shared-storage-navigation-budget-table", "url": "#shared-storage-navigation-budget-table", "dfnText": "shared storage navigation budget table", "refSections": [{"refs": [{"id": "ref-for-shared-storage-navigation-budget-table"}, {"id": "ref-for-shared-storage-navigation-budget-table\u2460"}, {"id": "ref-for-shared-storage-navigation-budget-table\u2461"}, {"id": "ref-for-shared-storage-navigation-budget-table\u2462"}, {"id": "ref-for-shared-storage-navigation-budget-table\u2463"}, {"id": "ref-for-shared-storage-navigation-budget-table\u2464"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-shared-storage-navigation-budget-table\u2465"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": false};
window.dfnpanelData['navigation-entropy-ledger'] = {"dfnID": "navigation-entropy-ledger", "url": "#navigation-entropy-ledger", "dfnText": "navigation entropy ledger", "refSections": [{"refs": [{"id": "ref-for-navigation-entropy-ledger"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": false};
window.dfnpanelData['bit-debit'] = {"dfnID": "bit-debit", "url": "#bit-debit", "dfnText": "bit debit", "refSections": [{"refs": [{"id": "ref-for-bit-debit"}, {"id": "ref-for-bit-debit\u2460"}, {"id": "ref-for-bit-debit\u2461"}, {"id": "ref-for-bit-debit\u2462"}, {"id": "ref-for-bit-debit\u2463"}, {"id": "ref-for-bit-debit\u2464"}, {"id": "ref-for-bit-debit\u2465"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-bit-debit\u2466"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": false};
window.dfnpanelData['bit-debit-bits'] = {"dfnID": "bit-debit-bits", "url": "#bit-debit-bits", "dfnText": "bits", "refSections": [{"refs": [{"id": "ref-for-bit-debit-bits"}, {"id": "ref-for-bit-debit-bits\u2460"}, {"id": "ref-for-bit-debit-bits\u2461"}, {"id": "ref-for-bit-debit-bits\u2462"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": false};
window.dfnpanelData['bit-debit-timestamp'] = {"dfnID": "bit-debit-timestamp", "url": "#bit-debit-timestamp", "dfnText": "timestamp", "refSections": [{"refs": [{"id": "ref-for-bit-debit-timestamp"}, {"id": "ref-for-bit-debit-timestamp\u2460"}, {"id": "ref-for-bit-debit-timestamp\u2461"}, {"id": "ref-for-bit-debit-timestamp\u2462"}, {"id": "ref-for-bit-debit-timestamp\u2463"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": false};
window.dfnpanelData['bit-debit-expired'] = {"dfnID": "bit-debit-expired", "url": "#bit-debit-expired", "dfnText": "expired", "refSections": [{"refs": [{"id": "ref-for-bit-debit-expired"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": false};
window.dfnpanelData['calling-site-remaining-navigation-budget'] = {"dfnID": "calling-site-remaining-navigation-budget", "url": "#calling-site-remaining-navigation-budget", "dfnText": "remaining navigation budget", "refSections": [{"refs": [{"id": "ref-for-calling-site-remaining-navigation-budget"}], "title": "2.2.5. Monkey Patch for HTTP fetch"}, {"refs": [{"id": "ref-for-calling-site-remaining-navigation-budget\u2460"}, {"id": "ref-for-calling-site-remaining-navigation-budget\u2461"}, {"id": "ref-for-calling-site-remaining-navigation-budget\u2462"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": false};
window.dfnpanelData['selecturl-input-url-list'] = {"dfnID": "selecturl-input-url-list", "url": "#selecturl-input-url-list", "dfnText": "input URL list", "refSections": [{"refs": [{"id": "ref-for-selecturl-input-url-list"}, {"id": "ref-for-selecturl-input-url-list\u2460"}, {"id": "ref-for-selecturl-input-url-list\u2461"}, {"id": "ref-for-selecturl-input-url-list\u2462"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": false};
window.dfnpanelData['default-index'] = {"dfnID": "default-index", "url": "#default-index", "dfnText": "default index", "refSections": [{"refs": [{"id": "ref-for-default-index"}, {"id": "ref-for-default-index\u2460"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-default-index\u2461"}, {"id": "ref-for-default-index\u2462"}, {"id": "ref-for-default-index\u2463"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": false};
window.dfnpanelData['determine-remaining-navigation-budget'] = {"dfnID": "determine-remaining-navigation-budget", "url": "#determine-remaining-navigation-budget", "dfnText": "determine remaining navigation budget", "refSections": [{"refs": [{"id": "ref-for-determine-remaining-navigation-budget"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-determine-remaining-navigation-budget\u2460"}], "title": "4.3.2. Getter Methods"}], "external": false};
window.dfnpanelData['check-whether-a-bit-debit-is-expired'] = {"dfnID": "check-whether-a-bit-debit-is-expired", "url": "#check-whether-a-bit-debit-is-expired", "dfnText": "check whether a bit debit is expired", "refSections": [{"refs": [{"id": "ref-for-check-whether-a-bit-debit-is-expired"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-check-whether-a-bit-debit-is-expired\u2460"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": false};
window.dfnpanelData['pending-shared-storage-budget-debit'] = {"dfnID": "pending-shared-storage-budget-debit", "url": "#pending-shared-storage-budget-debit", "dfnText": "pending shared storage budget debit", "refSections": [{"refs": [{"id": "ref-for-pending-shared-storage-budget-debit"}, {"id": "ref-for-pending-shared-storage-budget-debit\u2460"}], "title": "2.6.1. Navigation Entropy Budget"}, {"refs": [{"id": "ref-for-pending-shared-storage-budget-debit\u2461"}, {"id": "ref-for-pending-shared-storage-budget-debit\u2462"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": false};
window.dfnpanelData['shared-storage-navigation-budget-charged'] = {"dfnID": "shared-storage-navigation-budget-charged", "url": "#shared-storage-navigation-budget-charged", "dfnText": "shared storage navigation budget charged", "refSections": [{"refs": [{"id": "ref-for-shared-storage-navigation-budget-charged"}, {"id": "ref-for-shared-storage-navigation-budget-charged\u2460"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": false};
window.dfnpanelData['charge-shared-storage-navigation-budget'] = {"dfnID": "charge-shared-storage-navigation-budget", "url": "#charge-shared-storage-navigation-budget", "dfnText": "charge shared storage navigation budget", "refSections": [{"refs": [{"id": "ref-for-charge-shared-storage-navigation-budget"}, {"id": "ref-for-charge-shared-storage-navigation-budget\u2460"}], "title": "2.6.1. Navigation Entropy Budget"}], "external": false};
window.dfnpanelData['page-load'] = {"dfnID": "page-load", "url": "#page-load", "dfnText": "page load", "refSections": [{"refs": [{"id": "ref-for-page-load"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": false};
window.dfnpanelData['reporting-entropy-allowance'] = {"dfnID": "reporting-entropy-allowance", "url": "#reporting-entropy-allowance", "dfnText": "reporting entropy allowance", "refSections": [{"refs": [{"id": "ref-for-reporting-entropy-allowance"}, {"id": "ref-for-reporting-entropy-allowance\u2460"}, {"id": "ref-for-reporting-entropy-allowance\u2461"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": false};
window.dfnpanelData['shared-storage-reporting-budget'] = {"dfnID": "shared-storage-reporting-budget", "url": "#shared-storage-reporting-budget", "dfnText": "shared storage reporting budget", "refSections": [{"refs": [{"id": "ref-for-shared-storage-reporting-budget"}, {"id": "ref-for-shared-storage-reporting-budget\u2460"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": false};
window.dfnpanelData['determine-reporting-budget-to-charge'] = {"dfnID": "determine-reporting-budget-to-charge", "url": "#determine-reporting-budget-to-charge", "dfnText": "determine reporting budget to charge", "refSections": [{"refs": [{"id": "ref-for-determine-reporting-budget-to-charge"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": false};
window.dfnpanelData['shared-storage-reporting-budget-charged'] = {"dfnID": "shared-storage-reporting-budget-charged", "url": "#shared-storage-reporting-budget-charged", "dfnText": "shared storage reporting budget charged", "refSections": [{"refs": [{"id": "ref-for-shared-storage-reporting-budget-charged"}, {"id": "ref-for-shared-storage-reporting-budget-charged\u2460"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": false};
window.dfnpanelData['charge-shared-storage-reporting-budget'] = {"dfnID": "charge-shared-storage-reporting-budget", "url": "#charge-shared-storage-reporting-budget", "dfnText": "charge shared storage reporting budget", "refSections": [{"refs": [{"id": "ref-for-charge-shared-storage-reporting-budget"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": false};
window.dfnpanelData['purge-expired-bit-debits-from-all-navigation-entropy-ledgers'] = {"dfnID": "purge-expired-bit-debits-from-all-navigation-entropy-ledgers", "url": "#purge-expired-bit-debits-from-all-navigation-entropy-ledgers", "dfnText": "purge expired bit debits from all navigation entropy ledgers", "refSections": [{"refs": [{"id": "ref-for-purge-expired-bit-debits-from-all-navigation-entropy-ledgers"}], "title": "2.6.2. Reporting Entropy Budget"}], "external": false};
window.dfnpanelData['shared-storage-shed'] = {"dfnID": "shared-storage-shed", "url": "#shared-storage-shed", "dfnText": "shared storage shed", "refSections": [{"refs": [{"id": "ref-for-shared-storage-shed"}, {"id": "ref-for-shared-storage-shed\u2460"}, {"id": "ref-for-shared-storage-shed\u2461"}, {"id": "ref-for-shared-storage-shed\u2462"}, {"id": "ref-for-shared-storage-shed\u2463"}, {"id": "ref-for-shared-storage-shed\u2464"}, {"id": "ref-for-shared-storage-shed\u2465"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": false};
window.dfnpanelData['shared-storage'] = {"dfnID": "shared-storage", "url": "#shared-storage", "dfnText": "shared storage", "refSections": [{"refs": [{"id": "ref-for-shared-storage"}, {"id": "ref-for-shared-storage\u2460"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-shared-storage\u2461"}], "title": "3.1. Monkey Patch for the Storage Model"}, {"refs": [{"id": "ref-for-shared-storage\u2462"}], "title": "4.2. Extension to the Window interface"}, {"refs": [{"id": "ref-for-shared-storage\u2463"}], "title": "7.3.1. `Sec-Shared-Storage-Writable` Request Header"}], "external": false};
window.dfnpanelData['obtain-a-shared-storage-shelf'] = {"dfnID": "obtain-a-shared-storage-shelf", "url": "#obtain-a-shared-storage-shelf", "dfnText": "obtain a shared storage shelf", "refSections": [{"refs": [{"id": "ref-for-obtain-a-shared-storage-shelf"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": false};
window.dfnpanelData['create-a-shared-storage-shelf'] = {"dfnID": "create-a-shared-storage-shelf", "url": "#create-a-shared-storage-shelf", "dfnText": "create a shared storage shelf", "refSections": [{"refs": [{"id": "ref-for-create-a-shared-storage-shelf"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": false};
window.dfnpanelData['shared-storage-bucket'] = {"dfnID": "shared-storage-bucket", "url": "#shared-storage-bucket", "dfnText": "shared storage bucket", "refSections": [{"refs": [{"id": "ref-for-shared-storage-bucket"}, {"id": "ref-for-shared-storage-bucket\u2460"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": false};
window.dfnpanelData['create-a-shared-storage-bucket'] = {"dfnID": "create-a-shared-storage-bucket", "url": "#create-a-shared-storage-bucket", "dfnText": "create a shared storage bucket", "refSections": [{"refs": [{"id": "ref-for-create-a-shared-storage-bucket"}], "title": "3.1. Monkey Patch for the Storage Model"}], "external": false};
window.dfnpanelData['obtain-a-shared-storage-bottle-map'] = {"dfnID": "obtain-a-shared-storage-bottle-map", "url": "#obtain-a-shared-storage-bottle-map", "dfnText": "obtain a shared storage bottle map", "refSections": [{"refs": [{"id": "ref-for-obtain-a-shared-storage-bottle-map"}, {"id": "ref-for-obtain-a-shared-storage-bottle-map\u2460"}, {"id": "ref-for-obtain-a-shared-storage-bottle-map\u2461"}, {"id": "ref-for-obtain-a-shared-storage-bottle-map\u2462"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-obtain-a-shared-storage-bottle-map\u2463"}, {"id": "ref-for-obtain-a-shared-storage-bottle-map\u2464"}, {"id": "ref-for-obtain-a-shared-storage-bottle-map\u2465"}, {"id": "ref-for-obtain-a-shared-storage-bottle-map\u2466"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-obtain-a-shared-storage-bottle-map\u2467"}, {"id": "ref-for-obtain-a-shared-storage-bottle-map\u2468"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-obtain-a-shared-storage-bottle-map\u2460\u24ea"}], "title": "4.3.3. Iteration"}], "external": false};
window.dfnpanelData['shared-storage-database'] = {"dfnID": "shared-storage-database", "url": "#shared-storage-database", "dfnText": "shared storage database", "refSections": [{"refs": [{"id": "ref-for-shared-storage-database"}, {"id": "ref-for-shared-storage-database\u2460"}, {"id": "ref-for-shared-storage-database\u2461"}, {"id": "ref-for-shared-storage-database\u2462"}, {"id": "ref-for-shared-storage-database\u2463"}], "title": "3.2. The Shared Storage Database"}, {"refs": [{"id": "ref-for-shared-storage-database\u2464"}], "title": "3.3. The Database Algorithms"}, {"refs": [{"id": "ref-for-shared-storage-database\u2465"}, {"id": "ref-for-shared-storage-database\u2466"}], "title": "4. The SharedStorage Interface"}, {"refs": [{"id": "ref-for-shared-storage-database\u2467"}, {"id": "ref-for-shared-storage-database\u2468"}, {"id": "ref-for-shared-storage-database\u2460\u24ea"}, {"id": "ref-for-shared-storage-database\u2460\u2460"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-shared-storage-database\u2460\u2461"}, {"id": "ref-for-shared-storage-database\u2460\u2462"}, {"id": "ref-for-shared-storage-database\u2460\u2463"}, {"id": "ref-for-shared-storage-database\u2460\u2464"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-shared-storage-database\u2460\u2465"}, {"id": "ref-for-shared-storage-database\u2460\u2466"}, {"id": "ref-for-shared-storage-database\u2460\u2467"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-shared-storage-database\u2460\u2468"}], "title": "4.3.3. Iteration"}, {"refs": [{"id": "ref-for-shared-storage-database\u2461\u24ea"}, {"id": "ref-for-shared-storage-database\u2461\u2460"}, {"id": "ref-for-shared-storage-database\u2461\u2461"}, {"id": "ref-for-shared-storage-database\u2461\u2462"}, {"id": "ref-for-shared-storage-database\u2461\u2463"}, {"id": "ref-for-shared-storage-database\u2461\u2464"}, {"id": "ref-for-shared-storage-database\u2461\u2465"}, {"id": "ref-for-shared-storage-database\u2461\u2466"}], "title": "7.3.2. `Shared-Storage-Write` Response Header"}], "external": false};
window.dfnpanelData['shared-storage-database-shared-storage-database-queue'] = {"dfnID": "shared-storage-database-shared-storage-database-queue", "url": "#shared-storage-database-shared-storage-database-queue", "dfnText": "shared storage database queue", "refSections": [{"refs": [{"id": "ref-for-shared-storage-database-shared-storage-database-queue"}], "title": "3.2. The Shared Storage Database"}, {"refs": [{"id": "ref-for-shared-storage-database-shared-storage-database-queue\u2460"}, {"id": "ref-for-shared-storage-database-shared-storage-database-queue\u2461"}, {"id": "ref-for-shared-storage-database-shared-storage-database-queue\u2462"}, {"id": "ref-for-shared-storage-database-shared-storage-database-queue\u2463"}, {"id": "ref-for-shared-storage-database-shared-storage-database-queue\u2464"}, {"id": "ref-for-shared-storage-database-shared-storage-database-queue\u2465"}, {"id": "ref-for-shared-storage-database-shared-storage-database-queue\u2466"}], "title": "3.3. The Database Algorithms"}, {"refs": [{"id": "ref-for-shared-storage-database-shared-storage-database-queue\u2467"}, {"id": "ref-for-shared-storage-database-shared-storage-database-queue\u2468"}, {"id": "ref-for-shared-storage-database-shared-storage-database-queue\u2460\u24ea"}, {"id": "ref-for-shared-storage-database-shared-storage-database-queue\u2460\u2460"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-shared-storage-database-shared-storage-database-queue\u2460\u2461"}, {"id": "ref-for-shared-storage-database-shared-storage-database-queue\u2460\u2462"}, {"id": "ref-for-shared-storage-database-shared-storage-database-queue\u2460\u2463"}, {"id": "ref-for-shared-storage-database-shared-storage-database-queue\u2460\u2464"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-shared-storage-database-shared-storage-database-queue\u2460\u2465"}, {"id": "ref-for-shared-storage-database-shared-storage-database-queue\u2460\u2466"}, {"id": "ref-for-shared-storage-database-shared-storage-database-queue\u2460\u2467"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-shared-storage-database-shared-storage-database-queue\u2460\u2468"}], "title": "4.3.3. Iteration"}], "external": false};
window.dfnpanelData['shared-storage-database-entry'] = {"dfnID": "shared-storage-database-entry", "url": "#shared-storage-database-entry", "dfnText": "entry", "refSections": [{"refs": [{"id": "ref-for-shared-storage-database-entry"}, {"id": "ref-for-shared-storage-database-entry\u2460"}, {"id": "ref-for-shared-storage-database-entry\u2461"}, {"id": "ref-for-shared-storage-database-entry\u2462"}, {"id": "ref-for-shared-storage-database-entry\u2463"}], "title": "3.2. The Shared Storage Database"}, {"refs": [{"id": "ref-for-shared-storage-database-entry\u2464"}, {"id": "ref-for-shared-storage-database-entry\u2465"}], "title": "4.3.3. Iteration"}, {"refs": [{"id": "ref-for-shared-storage-database-entry\u2466"}, {"id": "ref-for-shared-storage-database-entry\u2467"}, {"id": "ref-for-shared-storage-database-entry\u2468"}, {"id": "ref-for-shared-storage-database-entry\u2460\u24ea"}, {"id": "ref-for-shared-storage-database-entry\u2460\u2460"}, {"id": "ref-for-shared-storage-database-entry\u2460\u2461"}, {"id": "ref-for-shared-storage-database-entry\u2460\u2462"}, {"id": "ref-for-shared-storage-database-entry\u2460\u2463"}, {"id": "ref-for-shared-storage-database-entry\u2460\u2464"}], "title": "7.3.2. `Shared-Storage-Write` Response Header"}], "external": false};
window.dfnpanelData['entry-key'] = {"dfnID": "entry-key", "url": "#entry-key", "dfnText": "key", "refSections": [{"refs": [{"id": "ref-for-entry-key"}, {"id": "ref-for-entry-key\u2460"}, {"id": "ref-for-entry-key\u2461"}, {"id": "ref-for-entry-key\u2462"}], "title": "3.2. The Shared Storage Database"}, {"refs": [{"id": "ref-for-entry-key\u2463"}, {"id": "ref-for-entry-key\u2464"}, {"id": "ref-for-entry-key\u2465"}, {"id": "ref-for-entry-key\u2466"}], "title": "3.3. The Database Algorithms"}, {"refs": [{"id": "ref-for-entry-key\u2467"}, {"id": "ref-for-entry-key\u2468"}, {"id": "ref-for-entry-key\u2460\u24ea"}, {"id": "ref-for-entry-key\u2460\u2460"}], "title": "7.3.2. `Shared-Storage-Write` Response Header"}], "external": false};
window.dfnpanelData['key-maximum-length'] = {"dfnID": "key-maximum-length", "url": "#key-maximum-length", "dfnText": "maximum length", "refSections": [{"refs": [{"id": "ref-for-key-maximum-length"}, {"id": "ref-for-key-maximum-length\u2460"}, {"id": "ref-for-key-maximum-length\u2461"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-key-maximum-length\u2462"}, {"id": "ref-for-key-maximum-length\u2463"}, {"id": "ref-for-key-maximum-length\u2464"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-key-maximum-length\u2465"}], "title": "4.3.2. Getter Methods"}], "external": false};
window.dfnpanelData['entry-value-struct'] = {"dfnID": "entry-value-struct", "url": "#entry-value-struct", "dfnText": "value struct", "refSections": [{"refs": [{"id": "ref-for-entry-value-struct"}], "title": "3.2. The Shared Storage Database"}, {"refs": [{"id": "ref-for-entry-value-struct\u2460"}, {"id": "ref-for-entry-value-struct\u2461"}], "title": "3.3. The Database Algorithms"}, {"refs": [{"id": "ref-for-entry-value-struct\u2462"}, {"id": "ref-for-entry-value-struct\u2463"}, {"id": "ref-for-entry-value-struct\u2464"}], "title": "7.3.2. `Shared-Storage-Write` Response Header"}], "external": false};
window.dfnpanelData['value-struct-value'] = {"dfnID": "value-struct-value", "url": "#value-struct-value", "dfnText": "value", "refSections": [{"refs": [{"id": "ref-for-value-struct-value"}], "title": "3.2. The Shared Storage Database"}, {"refs": [{"id": "ref-for-value-struct-value\u2460"}, {"id": "ref-for-value-struct-value\u2461"}, {"id": "ref-for-value-struct-value\u2462"}], "title": "3.3. The Database Algorithms"}, {"refs": [{"id": "ref-for-value-struct-value\u2463"}, {"id": "ref-for-value-struct-value\u2464"}, {"id": "ref-for-value-struct-value\u2465"}], "title": "7.3.2. `Shared-Storage-Write` Response Header"}], "external": false};
window.dfnpanelData['value-struct-last-updated'] = {"dfnID": "value-struct-last-updated", "url": "#value-struct-last-updated", "dfnText": "last updated", "refSections": [{"refs": [{"id": "ref-for-value-struct-last-updated"}, {"id": "ref-for-value-struct-last-updated\u2460"}], "title": "3.3. The Database Algorithms"}], "external": false};
window.dfnpanelData['value-maximum-length'] = {"dfnID": "value-maximum-length", "url": "#value-maximum-length", "dfnText": "maximum length", "refSections": [{"refs": [{"id": "ref-for-value-maximum-length"}, {"id": "ref-for-value-maximum-length\u2460"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-value-maximum-length\u2461"}, {"id": "ref-for-value-maximum-length\u2462"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}], "external": false};
window.dfnpanelData['default-entry-lifetime'] = {"dfnID": "default-entry-lifetime", "url": "#default-entry-lifetime", "dfnText": "default entry lifetime", "refSections": [{"refs": [{"id": "ref-for-default-entry-lifetime"}], "title": "3.2. The Shared Storage Database"}, {"refs": [{"id": "ref-for-default-entry-lifetime\u2460"}], "title": "3.3. The Database Algorithms"}], "external": false};
window.dfnpanelData['shared-storage-database-store-an-entry-in-the-database'] = {"dfnID": "shared-storage-database-store-an-entry-in-the-database", "url": "#shared-storage-database-store-an-entry-in-the-database", "dfnText": "store an entry in the database", "refSections": [{"refs": [{"id": "ref-for-shared-storage-database-store-an-entry-in-the-database"}, {"id": "ref-for-shared-storage-database-store-an-entry-in-the-database\u2460"}], "title": "3.2. The Shared Storage Database"}, {"refs": [{"id": "ref-for-shared-storage-database-store-an-entry-in-the-database\u2461"}, {"id": "ref-for-shared-storage-database-store-an-entry-in-the-database\u2462"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-shared-storage-database-store-an-entry-in-the-database\u2463"}, {"id": "ref-for-shared-storage-database-store-an-entry-in-the-database\u2464"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}], "external": false};
window.dfnpanelData['shared-storage-database-retrieve-an-entry-from-the-database'] = {"dfnID": "shared-storage-database-retrieve-an-entry-from-the-database", "url": "#shared-storage-database-retrieve-an-entry-from-the-database", "dfnText": "retrieve an entry from the database", "refSections": [{"refs": [{"id": "ref-for-shared-storage-database-retrieve-an-entry-from-the-database"}], "title": "3.2. The Shared Storage Database"}, {"refs": [{"id": "ref-for-shared-storage-database-retrieve-an-entry-from-the-database\u2460"}, {"id": "ref-for-shared-storage-database-retrieve-an-entry-from-the-database\u2461"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-shared-storage-database-retrieve-an-entry-from-the-database\u2462"}, {"id": "ref-for-shared-storage-database-retrieve-an-entry-from-the-database\u2463"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-shared-storage-database-retrieve-an-entry-from-the-database\u2464"}], "title": "4.3.2. Getter Methods"}], "external": false};
window.dfnpanelData['shared-storage-database-delete-an-entry-from-the-database'] = {"dfnID": "shared-storage-database-delete-an-entry-from-the-database", "url": "#shared-storage-database-delete-an-entry-from-the-database", "dfnText": "delete an entry from the database", "refSections": [{"refs": [{"id": "ref-for-shared-storage-database-delete-an-entry-from-the-database"}], "title": "3.2. The Shared Storage Database"}, {"refs": [{"id": "ref-for-shared-storage-database-delete-an-entry-from-the-database\u2460"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-shared-storage-database-delete-an-entry-from-the-database\u2461"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}], "external": false};
window.dfnpanelData['shared-storage-database-clear-all-entries-in-the-database'] = {"dfnID": "shared-storage-database-clear-all-entries-in-the-database", "url": "#shared-storage-database-clear-all-entries-in-the-database", "dfnText": "clear all entries in the database", "refSections": [{"refs": [{"id": "ref-for-shared-storage-database-clear-all-entries-in-the-database"}], "title": "3.2. The Shared Storage Database"}, {"refs": [{"id": "ref-for-shared-storage-database-clear-all-entries-in-the-database\u2460"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-shared-storage-database-clear-all-entries-in-the-database\u2461"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}], "external": false};
window.dfnpanelData['shared-storage-database-retrieve-all-entries-from-the-database'] = {"dfnID": "shared-storage-database-retrieve-all-entries-from-the-database", "url": "#shared-storage-database-retrieve-all-entries-from-the-database", "dfnText": "retrieve all entries from the database", "refSections": [{"refs": [{"id": "ref-for-shared-storage-database-retrieve-all-entries-from-the-database"}], "title": "4.3.3. Iteration"}], "external": false};
window.dfnpanelData['shared-storage-database-count-entries-in-the-database'] = {"dfnID": "shared-storage-database-count-entries-in-the-database", "url": "#shared-storage-database-count-entries-in-the-database", "dfnText": "count entries in the database", "refSections": [{"refs": [{"id": "ref-for-shared-storage-database-count-entries-in-the-database"}], "title": "4.3.2. Getter Methods"}], "external": false};
window.dfnpanelData['shared-storage-database-purge-expired-entries-from-the-database'] = {"dfnID": "shared-storage-database-purge-expired-entries-from-the-database", "url": "#shared-storage-database-purge-expired-entries-from-the-database", "dfnText": "purge expired entries from the database", "refSections": [{"refs": [{"id": "ref-for-shared-storage-database-purge-expired-entries-from-the-database"}, {"id": "ref-for-shared-storage-database-purge-expired-entries-from-the-database\u2460"}], "title": "3.2. The Shared Storage Database"}], "external": false};
window.dfnpanelData['shared-storage-database-determine-whether-an-entry-is-expired'] = {"dfnID": "shared-storage-database-determine-whether-an-entry-is-expired", "url": "#shared-storage-database-determine-whether-an-entry-is-expired", "dfnText": "determine whether an entry is expired", "refSections": [{"refs": [{"id": "ref-for-shared-storage-database-determine-whether-an-entry-is-expired"}, {"id": "ref-for-shared-storage-database-determine-whether-an-entry-is-expired\u2460"}], "title": "3.3. The Database Algorithms"}], "external": false};
window.dfnpanelData['sharedstorage'] = {"dfnID": "sharedstorage", "url": "#sharedstorage", "dfnText": "SharedStorage", "refSections": [{"refs": [{"id": "ref-for-sharedstorage"}, {"id": "ref-for-sharedstorage\u2460"}, {"id": "ref-for-sharedstorage\u2461"}], "title": "4. The SharedStorage Interface"}, {"refs": [{"id": "ref-for-sharedstorage\u2462"}], "title": "4.1. The WindowSharedStorage interface"}, {"refs": [{"id": "ref-for-sharedstorage\u2463"}], "title": "4.3. The WorkletSharedStorage interface"}], "external": false};
window.dfnpanelData['dictdef-sharedstoragesetmethodoptions'] = {"dfnID": "dictdef-sharedstoragesetmethodoptions", "url": "#dictdef-sharedstoragesetmethodoptions", "dfnText": "SharedStorageSetMethodOptions", "refSections": [{"refs": [{"id": "ref-for-dictdef-sharedstoragesetmethodoptions"}], "title": "4. The SharedStorage Interface"}, {"refs": [{"id": "ref-for-dictdef-sharedstoragesetmethodoptions\u2460"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-dictdef-sharedstoragesetmethodoptions\u2461"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": false};
window.dfnpanelData['windowsharedstorage'] = {"dfnID": "windowsharedstorage", "url": "#windowsharedstorage", "dfnText": "WindowSharedStorage", "refSections": [{"refs": [{"id": "ref-for-windowsharedstorage"}, {"id": "ref-for-windowsharedstorage\u2460"}], "title": "4. The SharedStorage Interface"}, {"refs": [{"id": "ref-for-windowsharedstorage\u2461"}, {"id": "ref-for-windowsharedstorage\u2462"}], "title": "4.1. The WindowSharedStorage interface"}, {"refs": [{"id": "ref-for-windowsharedstorage\u2463"}, {"id": "ref-for-windowsharedstorage\u2464"}, {"id": "ref-for-windowsharedstorage\u2465"}, {"id": "ref-for-windowsharedstorage\u2466"}, {"id": "ref-for-windowsharedstorage\u2467"}, {"id": "ref-for-windowsharedstorage\u2468"}, {"id": "ref-for-windowsharedstorage\u2460\u24ea"}, {"id": "ref-for-windowsharedstorage\u2460\u2460"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-windowsharedstorage\u2460\u2461"}], "title": "4.1.2. Run Operation Methods on WindowSharedStorage"}, {"refs": [{"id": "ref-for-windowsharedstorage\u2460\u2462"}], "title": "4.1.3. Create a new worklet via WindowSharedStorage"}, {"refs": [{"id": "ref-for-windowsharedstorage\u2460\u2463"}, {"id": "ref-for-windowsharedstorage\u2460\u2464"}], "title": "4.2. Extension to the Window interface"}], "external": false};
window.dfnpanelData['dom-windowsharedstorage-worklet'] = {"dfnID": "dom-windowsharedstorage-worklet", "url": "#dom-windowsharedstorage-worklet", "dfnText": "worklet", "refSections": [{"refs": [{"id": "ref-for-dom-windowsharedstorage-worklet"}], "title": "4. The SharedStorage Interface"}, {"refs": [{"id": "ref-for-dom-windowsharedstorage-worklet\u2460"}, {"id": "ref-for-dom-windowsharedstorage-worklet\u2461"}], "title": "4.1.2. Run Operation Methods on WindowSharedStorage"}], "external": false};
window.dfnpanelData['dictdef-sharedstoragerunoperationmethodoptions'] = {"dfnID": "dictdef-sharedstoragerunoperationmethodoptions", "url": "#dictdef-sharedstoragerunoperationmethodoptions", "dfnText": "SharedStorageRunOperationMethodOptions", "refSections": [{"refs": [{"id": "ref-for-dictdef-sharedstoragerunoperationmethodoptions"}, {"id": "ref-for-dictdef-sharedstoragerunoperationmethodoptions\u2460"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-dictdef-sharedstoragerunoperationmethodoptions\u2461"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-dictdef-sharedstoragerunoperationmethodoptions\u2462"}, {"id": "ref-for-dictdef-sharedstoragerunoperationmethodoptions\u2463"}], "title": "4.1. The WindowSharedStorage interface"}], "external": false};
window.dfnpanelData['dom-windowsharedstorage-set'] = {"dfnID": "dom-windowsharedstorage-set", "url": "#dom-windowsharedstorage-set", "dfnText": "set(key, value, options)", "refSections": [{"refs": [{"id": "ref-for-dom-windowsharedstorage-set"}], "title": "5. Triggering Operations Via HTTP Response Header"}], "external": false};
window.dfnpanelData['dom-windowsharedstorage-append'] = {"dfnID": "dom-windowsharedstorage-append", "url": "#dom-windowsharedstorage-append", "dfnText": "append(key, value)", "refSections": [{"refs": [{"id": "ref-for-dom-windowsharedstorage-append"}], "title": "5. Triggering Operations Via HTTP Response Header"}], "external": false};
window.dfnpanelData['dom-windowsharedstorage-delete'] = {"dfnID": "dom-windowsharedstorage-delete", "url": "#dom-windowsharedstorage-delete", "dfnText": "delete(key)", "refSections": [{"refs": [{"id": "ref-for-dom-windowsharedstorage-delete"}], "title": "5. Triggering Operations Via HTTP Response Header"}], "external": false};
window.dfnpanelData['dom-windowsharedstorage-clear'] = {"dfnID": "dom-windowsharedstorage-clear", "url": "#dom-windowsharedstorage-clear", "dfnText": "clear()", "refSections": [{"refs": [{"id": "ref-for-dom-windowsharedstorage-clear"}], "title": "5. Triggering Operations Via HTTP Response Header"}], "external": false};
window.dfnpanelData['windowsharedstorage-set-a-key-value-pair'] = {"dfnID": "windowsharedstorage-set-a-key-value-pair", "url": "#windowsharedstorage-set-a-key-value-pair", "dfnText": "set a key-value pair", "refSections": [{"refs": [{"id": "ref-for-windowsharedstorage-set-a-key-value-pair"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-windowsharedstorage-set-a-key-value-pair\u2460"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": false};
window.dfnpanelData['windowsharedstorage-append-a-key-value-pair'] = {"dfnID": "windowsharedstorage-append-a-key-value-pair", "url": "#windowsharedstorage-append-a-key-value-pair", "dfnText": "append a key-value pair", "refSections": [{"refs": [{"id": "ref-for-windowsharedstorage-append-a-key-value-pair"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-windowsharedstorage-append-a-key-value-pair\u2460"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": false};
window.dfnpanelData['windowsharedstorage-delete-a-key'] = {"dfnID": "windowsharedstorage-delete-a-key", "url": "#windowsharedstorage-delete-a-key", "dfnText": "delete a key", "refSections": [{"refs": [{"id": "ref-for-windowsharedstorage-delete-a-key"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-windowsharedstorage-delete-a-key\u2460"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": false};
window.dfnpanelData['windowsharedstorage-clear-all-keys'] = {"dfnID": "windowsharedstorage-clear-all-keys", "url": "#windowsharedstorage-clear-all-keys", "dfnText": "clear all keys", "refSections": [{"refs": [{"id": "ref-for-windowsharedstorage-clear-all-keys"}], "title": "4.1.1. Window Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-windowsharedstorage-clear-all-keys\u2460"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": false};
window.dfnpanelData['dom-windowsharedstorage-selecturl'] = {"dfnID": "dom-windowsharedstorage-selecturl", "url": "#dom-windowsharedstorage-selecturl", "dfnText": "selectURL(name, urls, options)", "refSections": [{"refs": [{"id": "ref-for-dom-windowsharedstorage-selecturl"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-dom-windowsharedstorage-selecturl\u2460"}], "title": "4.1. The WindowSharedStorage interface"}], "external": false};
window.dfnpanelData['dom-windowsharedstorage-run'] = {"dfnID": "dom-windowsharedstorage-run", "url": "#dom-windowsharedstorage-run", "dfnText": "run(name, options)", "refSections": [{"refs": [{"id": "ref-for-dom-windowsharedstorage-run"}], "title": "4.1. The WindowSharedStorage interface"}], "external": false};
window.dfnpanelData['dom-windowsharedstorage-createworklet'] = {"dfnID": "dom-windowsharedstorage-createworklet", "url": "#dom-windowsharedstorage-createworklet", "dfnText": "createWorklet(moduleURL, options)", "refSections": [{"refs": [{"id": "ref-for-dom-windowsharedstorage-createworklet"}, {"id": "ref-for-dom-windowsharedstorage-createworklet\u2460"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-dom-windowsharedstorage-createworklet\u2461"}], "title": "4.1. The WindowSharedStorage interface"}], "external": false};
window.dfnpanelData['dom-window-sharedstorage'] = {"dfnID": "dom-window-sharedstorage", "url": "#dom-window-sharedstorage", "dfnText": "sharedStorage", "refSections": [{"refs": [{"id": "ref-for-dom-window-sharedstorage"}, {"id": "ref-for-dom-window-sharedstorage\u2460"}, {"id": "ref-for-dom-window-sharedstorage\u2461"}], "title": "4.2. Extension to the Window interface"}, {"refs": [{"id": "ref-for-dom-window-sharedstorage\u2462"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": false};
window.dfnpanelData['window-sharedstorage-getter'] = {"dfnID": "window-sharedstorage-getter", "url": "#window-sharedstorage-getter", "dfnText": "sharedStorage getter", "refSections": [{"refs": [{"id": "ref-for-window-sharedstorage-getter"}], "title": "4.2. Extension to the Window interface"}], "external": false};
window.dfnpanelData['workletsharedstorage'] = {"dfnID": "workletsharedstorage", "url": "#workletsharedstorage", "dfnText": "WorkletSharedStorage", "refSections": [{"refs": [{"id": "ref-for-workletsharedstorage"}, {"id": "ref-for-workletsharedstorage\u2460"}], "title": "2.3.1. Monkey Patch for request destination"}, {"refs": [{"id": "ref-for-workletsharedstorage\u2461"}, {"id": "ref-for-workletsharedstorage\u2462"}], "title": "4. The SharedStorage Interface"}, {"refs": [{"id": "ref-for-workletsharedstorage\u2463"}, {"id": "ref-for-workletsharedstorage\u2464"}], "title": "4.3. The WorkletSharedStorage interface"}, {"refs": [{"id": "ref-for-workletsharedstorage\u2465"}, {"id": "ref-for-workletsharedstorage\u2466"}, {"id": "ref-for-workletsharedstorage\u2467"}, {"id": "ref-for-workletsharedstorage\u2468"}, {"id": "ref-for-workletsharedstorage\u2460\u24ea"}, {"id": "ref-for-workletsharedstorage\u2460\u2460"}, {"id": "ref-for-workletsharedstorage\u2460\u2461"}, {"id": "ref-for-workletsharedstorage\u2460\u2462"}], "title": "4.3.1. Worklet Setter/Deleter Methods"}, {"refs": [{"id": "ref-for-workletsharedstorage\u2460\u2463"}, {"id": "ref-for-workletsharedstorage\u2460\u2464"}, {"id": "ref-for-workletsharedstorage\u2460\u2465"}, {"id": "ref-for-workletsharedstorage\u2460\u2466"}, {"id": "ref-for-workletsharedstorage\u2460\u2467"}, {"id": "ref-for-workletsharedstorage\u2460\u2468"}], "title": "4.3.2. Getter Methods"}, {"refs": [{"id": "ref-for-workletsharedstorage\u2461\u24ea"}, {"id": "ref-for-workletsharedstorage\u2461\u2460"}, {"id": "ref-for-workletsharedstorage\u2461\u2461"}, {"id": "ref-for-workletsharedstorage\u2461\u2462"}, {"id": "ref-for-workletsharedstorage\u2461\u2463"}, {"id": "ref-for-workletsharedstorage\u2461\u2464"}], "title": "4.3.3. Iteration"}], "external": false};
window.dfnpanelData['dom-workletsharedstorage-get'] = {"dfnID": "dom-workletsharedstorage-get", "url": "#dom-workletsharedstorage-get", "dfnText": "get(key)", "refSections": [{"refs": [{"id": "ref-for-dom-workletsharedstorage-get"}], "title": "4.3. The WorkletSharedStorage interface"}], "external": false};
window.dfnpanelData['dom-workletsharedstorage-length'] = {"dfnID": "dom-workletsharedstorage-length", "url": "#dom-workletsharedstorage-length", "dfnText": "length()", "refSections": [{"refs": [{"id": "ref-for-dom-workletsharedstorage-length"}], "title": "4.3. The WorkletSharedStorage interface"}], "external": false};
window.dfnpanelData['dom-workletsharedstorage-remainingbudget'] = {"dfnID": "dom-workletsharedstorage-remainingbudget", "url": "#dom-workletsharedstorage-remainingbudget", "dfnText": "remainingBudget()", "refSections": [{"refs": [{"id": "ref-for-dom-workletsharedstorage-remainingbudget"}], "title": "4.3. The WorkletSharedStorage interface"}], "external": false};
window.dfnpanelData['workletsharedstorageiterator-pending-entries'] = {"dfnID": "workletsharedstorageiterator-pending-entries", "url": "#workletsharedstorageiterator-pending-entries", "dfnText": "pending entries", "refSections": [{"refs": [{"id": "ref-for-workletsharedstorageiterator-pending-entries"}, {"id": "ref-for-workletsharedstorageiterator-pending-entries\u2460"}, {"id": "ref-for-workletsharedstorageiterator-pending-entries\u2461"}], "title": "4.3.3. Iteration"}], "external": false};
window.dfnpanelData['workletsharedstorageiterator-error'] = {"dfnID": "workletsharedstorageiterator-error", "url": "#workletsharedstorageiterator-error", "dfnText": "error", "refSections": [{"refs": [{"id": "ref-for-workletsharedstorageiterator-error"}, {"id": "ref-for-workletsharedstorageiterator-error\u2460"}], "title": "4.3.3. Iteration"}], "external": false};
window.dfnpanelData['workletsharedstorageiterator-asynchronous-iterator-initialization-steps'] = {"dfnID": "workletsharedstorageiterator-asynchronous-iterator-initialization-steps", "url": "#workletsharedstorageiterator-asynchronous-iterator-initialization-steps", "dfnText": "asynchronous iterator initialization steps", "refSections": [{"refs": [{"id": "ref-for-workletsharedstorageiterator-asynchronous-iterator-initialization-steps"}], "title": "4.3.3. Iteration"}], "external": false};
window.dfnpanelData['workletsharedstorageiterator-get-the-next-iteration-result'] = {"dfnID": "workletsharedstorageiterator-get-the-next-iteration-result", "url": "#workletsharedstorageiterator-get-the-next-iteration-result", "dfnText": "get the next iteration result", "refSections": [{"refs": [{"id": "ref-for-workletsharedstorageiterator-get-the-next-iteration-result"}], "title": "4.3.3. Iteration"}], "external": false};
window.dfnpanelData['htmlsharedstoragewritableelementutils'] = {"dfnID": "htmlsharedstoragewritableelementutils", "url": "#htmlsharedstoragewritableelementutils", "dfnText": "HTMLSharedStorageWritableElementUtils", "refSections": [{"refs": [{"id": "ref-for-htmlsharedstoragewritableelementutils"}, {"id": "ref-for-htmlsharedstoragewritableelementutils\u2460"}], "title": "6.1. sharedStorageWritable & sharedstoragewritable Attributes"}], "external": false};
window.dfnpanelData['dom-htmlsharedstoragewritableelementutils-sharedstoragewritable'] = {"dfnID": "dom-htmlsharedstoragewritableelementutils-sharedstoragewritable", "url": "#dom-htmlsharedstoragewritableelementutils-sharedstoragewritable", "dfnText": "sharedStorageWritable", "refSections": [{"refs": [{"id": "ref-for-dom-htmlsharedstoragewritableelementutils-sharedstoragewritable"}, {"id": "ref-for-dom-htmlsharedstoragewritableelementutils-sharedstoragewritable\u2460"}], "title": "6.1. sharedStorageWritable & sharedstoragewritable Attributes"}], "external": false};
window.dfnpanelData['element-attrdef-iframe-sharedstoragewritable'] = {"dfnID": "element-attrdef-iframe-sharedstoragewritable", "url": "#element-attrdef-iframe-sharedstoragewritable", "dfnText": "sharedstoragewritable", "refSections": [{"refs": [{"id": "ref-for-element-attrdef-iframe-sharedstoragewritable"}], "title": "6.1. sharedStorageWritable & sharedstoragewritable Attributes"}, {"refs": [{"id": "ref-for-element-attrdef-iframe-sharedstoragewritable\u2460"}], "title": "6.2.2. Modification to Create navigation params by fetching Algorithm"}], "external": false};
window.dfnpanelData['element-attrdef-img-sharedstoragewritable'] = {"dfnID": "element-attrdef-img-sharedstoragewritable", "url": "#element-attrdef-img-sharedstoragewritable", "dfnText": "sharedstoragewritable", "refSections": [{"refs": [{"id": "ref-for-element-attrdef-img-sharedstoragewritable"}], "title": "6.2.1. Modification to Update the image data Algorithm"}], "external": false};
window.dfnpanelData['request-shared-storage-writable'] = {"dfnID": "request-shared-storage-writable", "url": "#request-shared-storage-writable", "dfnText": "shared storage writable", "refSections": [{"refs": [{"id": "ref-for-request-shared-storage-writable"}], "title": "6.2.1. Modification to Update the image data Algorithm"}, {"refs": [{"id": "ref-for-request-shared-storage-writable\u2460"}], "title": "6.2.2. Modification to Create navigation params by fetching Algorithm"}, {"refs": [{"id": "ref-for-request-shared-storage-writable\u2461"}], "title": "7.2.1. Modification to the Request Constructor Algorithm"}, {"refs": [{"id": "ref-for-request-shared-storage-writable\u2462"}, {"id": "ref-for-request-shared-storage-writable\u2463"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": false};
window.dfnpanelData['dom-requestinit-sharedstoragewritable'] = {"dfnID": "dom-requestinit-sharedstoragewritable", "url": "#dom-requestinit-sharedstoragewritable", "dfnText": "sharedStorageWritable", "refSections": [{"refs": [{"id": "ref-for-dom-requestinit-sharedstoragewritable"}, {"id": "ref-for-dom-requestinit-sharedstoragewritable\u2460"}], "title": "7.1. sharedStorageWritable Key"}, {"refs": [{"id": "ref-for-dom-requestinit-sharedstoragewritable\u2461"}], "title": "7.2.1. Modification to the Request Constructor Algorithm"}], "external": false};
window.dfnpanelData['http-headerdef-sec-shared-storage-writable'] = {"dfnID": "http-headerdef-sec-shared-storage-writable", "url": "#http-headerdef-sec-shared-storage-writable", "dfnText": "Sec-Shared-Storage-Writable", "refSections": [{"refs": [{"id": "ref-for-http-headerdef-sec-shared-storage-writable"}, {"id": "ref-for-http-headerdef-sec-shared-storage-writable\u2460"}, {"id": "ref-for-http-headerdef-sec-shared-storage-writable\u2461"}], "title": "7.3.1. `Sec-Shared-Storage-Writable` Request Header"}, {"refs": [{"id": "ref-for-http-headerdef-sec-shared-storage-writable\u2462"}, {"id": "ref-for-http-headerdef-sec-shared-storage-writable\u2463"}, {"id": "ref-for-http-headerdef-sec-shared-storage-writable\u2464"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": false};
window.dfnpanelData['http-headerdef-shared-storage-write'] = {"dfnID": "http-headerdef-shared-storage-write", "url": "#http-headerdef-shared-storage-write", "dfnText": "Shared-Storage-Write", "refSections": [{"refs": [{"id": "ref-for-http-headerdef-shared-storage-write"}, {"id": "ref-for-http-headerdef-shared-storage-write\u2460"}], "title": "7.3.2. `Shared-Storage-Write` Response Header"}, {"refs": [{"id": "ref-for-http-headerdef-shared-storage-write\u2461"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": false};
window.dfnpanelData['determine-whether-a-request-can-currently-use-shared-storage'] = {"dfnID": "determine-whether-a-request-can-currently-use-shared-storage", "url": "#determine-whether-a-request-can-currently-use-shared-storage", "dfnText": "determine whether a request can currently use shared storage", "refSections": [{"refs": [{"id": "ref-for-determine-whether-a-request-can-currently-use-shared-storage"}, {"id": "ref-for-determine-whether-a-request-can-currently-use-shared-storage\u2460"}, {"id": "ref-for-determine-whether-a-request-can-currently-use-shared-storage\u2461"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": false};
window.dfnpanelData['append-or-modify-a-sec-shared-storage-writable-request-header'] = {"dfnID": "append-or-modify-a-sec-shared-storage-writable-request-header", "url": "#append-or-modify-a-sec-shared-storage-writable-request-header", "dfnText": "append or modify a Sec-Shared-Storage-Writable request header", "refSections": [{"refs": [{"id": "ref-for-append-or-modify-a-sec-shared-storage-writable-request-header"}], "title": "7.2.2. Modification to HTTP network or cache fetch Algorithm"}], "external": false};
window.dfnpanelData['handle-a-shared-storage-write-response'] = {"dfnID": "handle-a-shared-storage-write-response", "url": "#handle-a-shared-storage-write-response", "dfnText": "handle a Shared-Storage-Write response", "refSections": [{"refs": [{"id": "ref-for-handle-a-shared-storage-write-response"}], "title": "7.2.3. Modification to HTTP fetch Algorithm"}], "external": false};
window.dfnpanelData['check-if-string-like'] = {"dfnID": "check-if-string-like", "url": "#check-if-string-like", "dfnText": "check if string-like", "refSections": [{"refs": [{"id": "ref-for-check-if-string-like"}, {"id": "ref-for-check-if-string-like\u2460"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": false};
window.dfnpanelData['get-the-string-value'] = {"dfnID": "get-the-string-value", "url": "#get-the-string-value", "dfnText": "get the string value", "refSections": [{"refs": [{"id": "ref-for-get-the-string-value"}, {"id": "ref-for-get-the-string-value\u2460"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": false};
window.dfnpanelData['obtain-a-string-like-parameter-value'] = {"dfnID": "obtain-a-string-like-parameter-value", "url": "#obtain-a-string-like-parameter-value", "dfnText": "obtain a string-like parameter value", "refSections": [{"refs": [{"id": "ref-for-obtain-a-string-like-parameter-value"}, {"id": "ref-for-obtain-a-string-like-parameter-value\u2460"}, {"id": "ref-for-obtain-a-string-like-parameter-value\u2461"}, {"id": "ref-for-obtain-a-string-like-parameter-value\u2462"}, {"id": "ref-for-obtain-a-string-like-parameter-value\u2463"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": false};
window.dfnpanelData['obtain-a-boolean-parameter-value'] = {"dfnID": "obtain-a-boolean-parameter-value", "url": "#obtain-a-boolean-parameter-value", "dfnText": "obtain a boolean parameter value", "refSections": [{"refs": [{"id": "ref-for-obtain-a-boolean-parameter-value"}], "title": "7.4. Shared Storage Fetch-Related Algorithms"}], "external": false};
window.dfnpanelData['permissionspolicy-shared-storage'] = {"dfnID": "permissionspolicy-shared-storage", "url": "#permissionspolicy-shared-storage", "dfnText": "shared-storage", "refSections": [{"refs": [{"id": "ref-for-permissionspolicy-shared-storage"}], "title": "2. The SharedStorageWorklet Interface"}, {"refs": [{"id": "ref-for-permissionspolicy-shared-storage\u2460"}], "title": "8. Permissions Policy Integration"}], "external": false};
window.dfnpanelData['permissionspolicy-shared-storage-select-url'] = {"dfnID": "permissionspolicy-shared-storage-select-url", "url": "#permissionspolicy-shared-storage-select-url", "dfnText": "shared-storage-select-url", "refSections": [{"refs": [{"id": "ref-for-permissionspolicy-shared-storage-select-url"}], "title": "2.1. Run Operation Methods on SharedStorageWorklet"}, {"refs": [{"id": "ref-for-permissionspolicy-shared-storage-select-url\u2460"}], "title": "8. Permissions Policy Integration"}], "external": false};
</script>
<script>/* Boilerplate: script-dom-helper */
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}
</script>
<script>/* Boilerplate: script-var-click-highlighting */
/*
Color-choosing design:

Colors are ordered by goodness.
Each color has a usage count (initially zero).
Each variable has a last-used color.

* If the var has a last-used color, and that color's usage is 0,
    return that color.
* Otherwise, return the lowest-indexed color with the lowest usage.
    Increment the color's usage and set it as the last-used color
    for that var.
* On unclicking, decrement usage of the color.
*/
"use strict";
{
    document.addEventListener("click", e=>{
        if(e.target.nodeName == "VAR") {
            highlightSameAlgoVars(e.target);
        }
    });
    const indexCounts = new Map();
    const indexNames = new Map();
    function highlightSameAlgoVars(v) {
        // Find the algorithm container.
        let algoContainer = null;
        let searchEl = v;
        while(algoContainer == null && searchEl != document.body) {
            searchEl = searchEl.parentNode;
            if(searchEl.hasAttribute("data-algorithm")) {
                algoContainer = searchEl;
            }
        }

        // Not highlighting document-global vars,
        // too likely to be unrelated.
        if(algoContainer == null) return;

        const algoName = algoContainer.getAttribute("data-algorithm");
        const varName = getVarName(v);
        const addClass = !v.classList.contains("selected");
        let highlightClass = null;
        if(addClass) {
            const index = chooseHighlightIndex(algoName, varName);
            indexCounts.get(algoName)[index] += 1;
            indexNames.set(algoName+"///"+varName, index);
            highlightClass = nameFromIndex(index);
        } else {
            const index = previousHighlightIndex(algoName, varName);
            indexCounts.get(algoName)[index] -= 1;
            highlightClass = nameFromIndex(index);
        }

        // Find all same-name vars, and toggle their class appropriately.
        for(const el of algoContainer.querySelectorAll("var")) {
            if(getVarName(el) == varName) {
                el.classList.toggle("selected", addClass);
                el.classList.toggle(highlightClass, addClass);
            }
        }
    }
    function getVarName(el) {
        return el.textContent.replace(/(\s|\xa0)+/, " ").trim();
    }
    function chooseHighlightIndex(algoName, varName) {
        let indexes = null;
        if(indexCounts.has(algoName)) {
            indexes = indexCounts.get(algoName);
        } else {
            // 7 classes right now
            indexes = [0,0,0,0,0,0,0];
            indexCounts.set(algoName, indexes);
        }

        // If the element was recently unclicked,
        // *and* that color is still unclaimed,
        // give it back the same color.
        const lastIndex = previousHighlightIndex(algoName, varName);
        if(indexes[lastIndex] === 0) return lastIndex;

        // Find the earliest index with the lowest count.
        const minCount = Math.min.apply(null, indexes);
        let index = null;
        for(var i = 0; i < indexes.length; i++) {
            if(indexes[i] == minCount) {
                return i;
            }
        }
    }
    function previousHighlightIndex(algoName, varName) {
        return indexNames.get(algoName+"///"+varName);
    }
    function nameFromIndex(index) {
        return "selected" + index;
    }
}
</script>