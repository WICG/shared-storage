<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Shared Storage API</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <link href="https://www.w3.org/StyleSheets/TR/2021/cg-draft" rel="stylesheet">
  <meta content="Bikeshed version 74068a90b, updated Wed Mar 22 17:34:51 2023 -0700" name="generator">
  <link href="https://github.com/WICG/shared-storage" rel="canonical">
  <meta content="8e15d8463ce4749ebf274394d1d5f0f037c1e096" name="document-revision">
<style>
/* adapted from .XXX at https://resources.whatwg.org/standard.css */
.todo {
  color: #D50606;
  background: white;
  border: solid #D50606;
}

span.todo {
  padding-top: 0;
  padding-bottom: 0;
}

.todo::before { content: 'TODO: '; }

span.todo::before {
  left: 0;
  top: -0.25em;
}
</style>
<style>/* style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}
</style>
<style>/* style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}
</style>
<style>/* style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    min-width: min-content;
    max-width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* style-syntax-highlighting */

            pre.idl.highlight {
                background: var(--borderedblock-bg, var(--def-bg));
            }
            
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-var-click-highlighting */

    var { cursor: pointer; }
    var.selected0 { background-color: #F4D200; box-shadow: 0 0 0 2px #F4D200; }
    var.selected1 { background-color: #FF87A2; box-shadow: 0 0 0 2px #FF87A2; }
    var.selected2 { background-color: #96E885; box-shadow: 0 0 0 2px #96E885; }
    var.selected3 { background-color: #3EEED2; box-shadow: 0 0 0 2px #3EEED2; }
    var.selected4 { background-color: #EACFB6; box-shadow: 0 0 0 2px #EACFB6; }
    var.selected5 { background-color: #82DDFF; box-shadow: 0 0 0 2px #82DDFF; }
    var.selected6 { background-color: #FFBCF2; box-shadow: 0 0 0 2px #FFBCF2; }
    </style>
<style>/* style-darkmode */

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}

@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Shared Storage API</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#CG-DRAFT">Draft Community Group Report</a>, <time class="dt-updated" datetime="2023-03-23">23 March 2023</time></p>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://github.com/WICG/shared-storage">https://github.com/WICG/shared-storage</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/WICG/shared-storage/issues/">GitHub</a>
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:cammie@chromium.org">Camillia Smith Barnes</a> (<a class="p-org org" href="https://google.com">Google</a>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2023 the Contributors to the Shared Storage API Specification, published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>.
A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>Shared Storage is a storage API that is intentionally not partitioned by top-frame site (though still partitioned by context origin of course!). To limit cross-site reidentification of users, data in Shared Storage may only be read in a restricted environment that has carefully constructed output gates.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This specification was published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a>.
  It is not a W3C Standard nor is it on the W3C Standards Track.

  Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply.

  Learn more about <a href="http://www.w3.org/community/">W3C Community and Business Groups</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li>
     <a href="#worklet"><span class="secno">2</span> <span class="content">The <code class="idl"><span>SharedStorageWorklet</span></code> Interface</span></a>
     <ol class="toc">
      <li><a href="#worklet-monkey-patch"><span class="secno">2.1</span> <span class="content">Monkey Patch for <span>Worklets</span></span></a>
      <li><a href="#global-scope"><span class="secno">2.2</span> <span class="content">The <code class="idl"><span>SharedStorageWorkletGlobalScope</span></code></span></a>
      <li><a href="#register-worklet"><span class="secno">2.3</span> <span class="content">Registering a Worklet</span></a>
     </ol>
    <li>
     <a href="#backend"><span class="secno">3</span> <span class="content">Shared Storage’s Backend</span></a>
     <ol class="toc">
      <li><a href="#storage-monkey-patch"><span class="secno">3.1</span> <span class="content">Monkey Patch for the <span>Storage Model</span></span></a>
      <li><a href="#database"><span class="secno">3.2</span> <span class="content">The <span>Shared Storage Database</span></span></a>
      <li><a href="#database-algorithms"><span class="secno">3.3</span> <span class="content">The <span>Database</span> Algorithms</span></a>
     </ol>
    <li>
     <a href="#shared-storage-interface"><span class="secno">4</span> <span class="content">The <code class="idl"><span>SharedStorage</span></code> Interface</span></a>
     <ol class="toc">
      <li>
       <a href="#window"><span class="secno">4.1</span> <span class="content">The <code class="idl"><span>WindowSharedStorage</span></code> interface</span></a>
       <ol class="toc">
        <li><a href="#window-setter"><span class="secno">4.1.1</span> <span class="content">Window Setter/Deleter Methods</span></a>
        <li><a href="#reporting"><span class="secno">4.1.2</span> <span class="content"><code class="idl"><span>SharedStorageUrlWithMetadata</span></code> and Reporting</span></a>
        <li>
         <a href="#budgets"><span class="secno">4.1.3</span> <span class="content">Entropy Budgets</span></a>
         <ol class="toc">
          <li><a href="#nav-budget"><span class="secno">4.1.3.1</span> <span class="content">Navigation Entropy Budget</span></a>
          <li><a href="#report-budget"><span class="secno">4.1.3.2</span> <span class="content">Reporting Entropy Budget</span></a>
         </ol>
        <li><a href="#run-op"><span class="secno">4.1.4</span> <span class="content">Run Operation Methods</span></a>
       </ol>
      <li>
       <a href="#worklet-shared-storage"><span class="secno">4.2</span> <span class="content">The <code class="idl"><span>WorkletSharedStorage</span></code> interface</span></a>
       <ol class="toc">
        <li><a href="#worklet-setter"><span class="secno">4.2.1</span> <span class="content">Worklet Setter/Deleter Methods</span></a>
        <li><a href="#getter"><span class="secno">4.2.2</span> <span class="content">Getter Methods</span></a>
        <li><a href="#iteration"><span class="secno">4.2.3</span> <span class="content">Iteration</span></a>
       </ol>
     </ol>
    <li><a href="#privacy"><span class="secno">5</span> <span class="content">Privacy Considerations</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
    <em>This section is not normative.</em> 
   <p>In order to prevent cross-site user tracking, browsers are partitioning all forms of storage by <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#top-level-traversable" id="ref-for-top-level-traversable">top-frame</a> site; see <a data-link-type="dfn" href="https://privacycg.github.io/storage-partitioning/#client-side-storage-partitioning" id="ref-for-client-side-storage-partitioning">Client-Side Storage Partitioning</a>. But, there are many <a data-link-type="dfn" href="https://github.com/WICG/shared-storage#example-scenarios" id="ref-for-example-scenarios">legitimate use cases</a> currently relying on unpartitioned storage.</p>
   <p>This document introduces a new storage API that is intentionally not partitioned by <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#top-level-traversable" id="ref-for-top-level-traversable①">top-frame</a> site (though still partitioned by context origin), in order to serve a number of the use cases needing unpartitioned storage. To limit cross-site reidentification of users, data in Shared Storage may only be read in a restricted environment, such as in a <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element">fenced frame</a> or via the <a data-link-type="dfn" href="https://github.com/patcg-individual-drafts/private-aggregation-api/blob/main/README.md#private-aggregation" id="ref-for-private-aggregation">private aggregation service</a>. Over time, there may be additional ouput gates included in the standard.</p>
   <div class="example" id="example-0f0ca66a">
    <a class="self-link" href="#example-0f0ca66a"></a> <code>a.example</code> randomly assigns users to groups in a way that is consistent cross-site. 
    <p>Inside an <code>a.example</code> iframe:</p>
<pre class="lang-js highlight"><c- a>function</c-> generateSeed<c- p>()</c-> <c- p>{</c-> … <c- p>}</c->
<c- k>await</c-> window<c- p>.</c->sharedStorage<c- p>.</c->worklet<c- p>.</c->addModule<c- p>(</c-><c- t>'experiment.js'</c-><c- p>);</c->

<c- c1>// Only write a cross-site seed to a.example’s storage if there isn’t one yet.</c->
window<c- p>.</c->sharedStorage<c- p>.</c->set<c- p>(</c-><c- t>'seed'</c-><c- p>,</c-> generateSeed<c- p>(),</c-> <c- p>{</c-> ignoreIfPresent<c- o>:</c-> <c- kc>true</c-> <c- p>});</c->

<c- a>let</c-> fencedFrameConfig <c- o>=</c-> <c- k>await</c-> window<c- p>.</c->sharedStorage<c- p>.</c->selectURL<c- p>(</c->
  <c- t>'select-url-for-experiment'</c-><c- p>,</c->
  <c- p>[</c->
    <c- p>{</c->url<c- o>:</c-> <c- u>"blob:https://a.example/123…"</c-><c- p>,</c-> reportingMetadata<c- o>:</c-> <c- p>{</c-><c- u>"click"</c-><c- o>:</c-> <c- u>"https://report.example/1..."</c-><c- p>}},</c->
    <c- p>{</c->url<c- o>:</c-> <c- u>"blob:https://b.example/abc…"</c-><c- p>,</c-> reportingMetadata<c- o>:</c-> <c- p>{</c-><c- u>"click"</c-><c- o>:</c-> <c- u>"https://report.example/a..."</c-><c- p>}},</c->
    <c- p>{</c->url<c- o>:</c-> <c- u>"blob:https://c.example/789…"</c-><c- p>}</c->
  <c- p>],</c->
  <c- p>{</c-> data<c- o>:</c-> <c- p>{</c-> name<c- o>:</c-> <c- t>'experimentA'</c-> <c- p>}</c-> <c- p>}</c->
<c- p>);</c->

<c- c1>// Assumes that the fenced frame 'my-fenced-frame' has already been attached.</c->
document<c- p>.</c->getElementById<c- p>(</c-><c- t>'my-fenced-frame'</c-><c- p>).</c->config <c- o>=</c-> fencedFrameConfig<c- p>;</c-></pre>
    <p>inside the <code>experiment.js</code> worklet script:</p>
<pre class="lang-js highlight"><c- a>class</c-> SelectURLOperation <c- p>{</c->
  hash<c- p>(</c->experimentName<c- p>,</c-> seed<c- p>)</c-> <c- p>{</c-> … <c- p>}</c->

  <c- k>async</c-> run<c- p>(</c->data<c- p>,</c-> urls<c- p>)</c-> <c- p>{</c->
    <c- a>const</c-> seed <c- o>=</c-> <c- k>await</c-> <c- k>this</c-><c- p>.</c->sharedStorage<c- p>.</c->get<c- p>(</c-><c- t>'seed'</c-><c- p>);</c->
    <c- k>return</c-> hash<c- p>(</c->data<c- p>.</c->name<c- p>,</c-> seed<c- p>)</c-> <c- o>%</c-> urls<c- p>.</c->length<c- p>;</c->
  <c- p>}</c->
<c- p>}</c->
register<c- p>(</c-><c- t>'select-url-for-experiment'</c-><c- p>,</c-> SelectURLOperation<c- p>);</c-></pre>
   </div>
   <h2 class="heading settled" data-level="2" id="worklet"><span class="secno">2. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet">SharedStorageWorklet</a></code> Interface</span><a class="self-link" href="#worklet"></a></h2>
    The <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet①">SharedStorageWorklet</a></code> object allows developers to supply <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#module-script" id="ref-for-module-script">module scripts</a> to process <a data-link-type="dfn" href="#shared-storage" id="ref-for-shared-storage">Shared Storage</a> data and then output the result through one or more of the output gates. Currently there are two output gates, the <a data-link-type="dfn" href="https://github.com/patcg-individual-drafts/private-aggregation-api/blob/main/README.md#private-aggregation" id="ref-for-private-aggregation①">private aggregation</a> output gate and the <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-selecturl" id="ref-for-dom-windowsharedstorage-selecturl">URL-selection</a></code> output gate. 
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="sharedstorageworklet"><code><c- g>SharedStorageWorklet</c-></code></dfn> : <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/worklets.html#worklet" id="ref-for-worklet"><c- n>Worklet</c-></a> {
};</pre>
   <p>Each <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet②">SharedStorageWorklet</a></code> has an associated boolean <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="module-added">module added</dfn>, initialized to false.</p>
   <p>Because adding multiple <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#module-script" id="ref-for-module-script①">module scripts</a> via <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule">addModule()</a></code> for the same <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet③">SharedStorageWorklet</a></code> would give the caller the ability to store data from <a data-link-type="dfn" href="#shared-storage" id="ref-for-shared-storage①">Shared Storage</a> in global variables defined in the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#module-script" id="ref-for-module-script②">module scripts</a> and then exfiltrate the data through later call(s) to <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule①">addModule()</a></code>, each <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet④">SharedStorageWorklet</a></code> can only call <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule②">addModule()</a></code> once. The <a data-link-type="dfn" href="#module-added" id="ref-for-module-added">module added</a> boolean makes it possible to enforce this restriction.</p>
   <p>When <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule③">addModule()</a></code> for a <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet⑤">SharedStorageWorklet</a></code>, it will run <a data-link-type="dfn" href="#check-and-update-module-added-status" id="ref-for-check-and-update-module-added-status">check and update module added status</a>, and if the result is true, abort the remaining steps in the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule④">addModule()</a></code> call, as detailed in the <a href="#worklet-monkey-patch">§ 2.1 Monkey Patch for Worklets</a>.</p>
   <div class="algorithm" data-algorithm="check and update module added status">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="check-and-update-module-added-status">check and update module added status</dfn> for a <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet⑥">SharedStorageWorklet</a></code> <var>worklet</var>, run the following steps: 
    <ol>
     <li data-md>
      <p>If <var>worklet</var>’s <a data-link-type="dfn" href="#module-added" id="ref-for-module-added①">module added</a> is true, return true.</p>
     <li data-md>
      <p>Otherwise, set <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#worklet" id="ref-for-worklet①">Worklet</a></code>'s <a data-link-type="dfn" href="#module-added" id="ref-for-module-added②">module added</a> to true.</p>
     <li data-md>
      <p>Return false.</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="2.1" id="worklet-monkey-patch"><span class="secno">2.1. </span><span class="content">Monkey Patch for <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#worklets" id="ref-for-worklets">Worklets</a></span><a class="self-link" href="#worklet-monkey-patch"></a></h3>
   <p>This specification will make some modifications to the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#worklets" id="ref-for-worklets①">Worklet</a> standard to accommodate the needs of Shared Storage.</p>
   <p>In particular, the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule⑤">addModule()</a></code> method steps for <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#worklet" id="ref-for-worklet②">Worklet</a></code> will need to be prepended with the following step:</p>
   <ol start="0">
    <li data-md>
     <p>If <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#worklet" id="ref-for-worklet③">Worklet</a></code> has an associated boolean <a data-link-type="dfn" href="#module-added" id="ref-for-module-added③">module added</a>, and the result of running <a data-link-type="dfn" href="#check-and-update-module-added-status" id="ref-for-check-and-update-module-added-status①">check and update module added status</a> on <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#worklet" id="ref-for-worklet④">Worklet</a></code> is true, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror">TypeError</a></code>.</p>
   </ol>
   <p><span class="todo">Add additional monkey patch pieces for out-of-process worklets.</span></p>
   <h3 class="heading settled" data-level="2.2" id="global-scope"><span class="secno">2.2. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope">SharedStorageWorkletGlobalScope</a></code></span><a class="self-link" href="#global-scope"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet⑦">SharedStorageWorklet</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#worklet-global-scope-type" id="ref-for-worklet-global-scope-type">worklet global scope type</a> is <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①">SharedStorageWorkletGlobalScope</a></code>.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①"><c- g>Exposed</c-></a>=<c- n>SharedStorageWorklet</c->, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Global" id="ref-for-Global"><c- g>Global</c-></a>=<a data-link-type="idl-name" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet⑧"><c- n>SharedStorageWorklet</c-></a>]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="sharedstorageworkletglobalscope"><code><c- g>SharedStorageWorkletGlobalScope</c-></code></dfn> : <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/worklets.html#workletglobalscope" id="ref-for-workletglobalscope"><c- n>WorkletGlobalScope</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-sharedstorageworkletglobalscope-register" id="ref-for-dom-sharedstorageworkletglobalscope-register"><c- g>register</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorageWorkletGlobalScope/register(name, operationCtor)" data-dfn-type="argument" data-export id="dom-sharedstorageworkletglobalscope-register-name-operationctor-name"><code><c- g>name</c-></code><a class="self-link" href="#dom-sharedstorageworkletglobalscope-register-name-operationctor-name"></a></dfn>,
                     <a data-link-type="idl-name" href="#callbackdef-sharedstorageoperationconstructor" id="ref-for-callbackdef-sharedstorageoperationconstructor"><c- n>SharedStorageOperationConstructor</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorageWorkletGlobalScope/register(name, operationCtor)" data-dfn-type="argument" data-export id="dom-sharedstorageworkletglobalscope-register-name-operationctor-operationctor"><code><c- g>operationCtor</c-></code><a class="self-link" href="#dom-sharedstorageworkletglobalscope-register-name-operationctor-operationctor"></a></dfn>);
};

<c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-sharedstorageoperationconstructor"><code><c- g>SharedStorageOperationConstructor</c-></code></dfn> =
  <a data-link-type="idl-name" href="#sharedstorageoperation" id="ref-for-sharedstorageoperation"><c- n>SharedStorageOperation</c-></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sharedstoragerunoperationmethodoptions" id="ref-for-dictdef-sharedstoragerunoperationmethodoptions"><c- n>SharedStorageRunOperationMethodOptions</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorageOperationConstructor" data-dfn-type="argument" data-export id="dom-sharedstorageoperationconstructor-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-sharedstorageoperationconstructor-options"></a></dfn>);

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed②"><c- g>Exposed</c-></a>=<c- n>SharedStorageWorklet</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="sharedstorageoperation"><code><c- g>SharedStorageOperation</c-></code></dfn> {
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-sharedstoragerunoperationmethodoptions"><code><c- g>SharedStorageRunOperationMethodOptions</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object"><c- b>object</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorageRunOperationMethodOptions" data-dfn-type="dict-member" data-export data-type="object " id="dom-sharedstoragerunoperationmethodoptions-data"><code><c- g>data</c-></code><a class="self-link" href="#dom-sharedstoragerunoperationmethodoptions-data"></a></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean"><c- b>boolean</c-></a> <dfn class="idl-code" data-default="false" data-dfn-for="SharedStorageRunOperationMethodOptions" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-sharedstoragerunoperationmethodoptions-resolvetoconfig"><code><c- g>resolveToConfig</c-></code><a class="self-link" href="#dom-sharedstoragerunoperationmethodoptions-resolvetoconfig"></a></dfn> = <c- b>false</c->;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean①"><c- b>boolean</c-></a> <dfn class="idl-code" data-default="false" data-dfn-for="SharedStorageRunOperationMethodOptions" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-sharedstoragerunoperationmethodoptions-keepalive"><code><c- g>keepAlive</c-></code><a class="self-link" href="#dom-sharedstoragerunoperationmethodoptions-keepalive"></a></dfn> = <c- b>false</c->;
};</pre>
   <p>Each <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope②">SharedStorageWorkletGlobalScope</a></code> has an associated <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object">environment settings object</a> <dfn class="dfn-paneled" data-dfn-for="SharedStorageWorkletGlobalScope" data-dfn-type="dfn" data-noexport id="sharedstorageworkletglobalscope-outside-settings">outside settings</dfn>, which is the associated <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet⑨">SharedStorageWorklet</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object">relevant settings object</a>.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope③">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#module-map" id="ref-for-module-map">module map</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#module-script" id="ref-for-module-script③">module scripts</a> should each define and <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-identity/#dom-rtcidentityproviderregistrar-register" id="ref-for-dom-rtcidentityproviderregistrar-register">register</a></code> one or more <code class="idl"><a data-link-type="idl" href="#sharedstorageoperation" id="ref-for-sharedstorageoperation①">SharedStorageOperation</a></code>s.</p>
   <p>Each <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope④">SharedStorageWorkletGlobalScope</a></code> also has an associated <dfn class="dfn-paneled" data-dfn-for="SharedStorageWorkletGlobalScope" data-dfn-type="dfn" data-noexport id="sharedstorageworkletglobalscope-operation-map">operation map</dfn>, which is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org#ordered-map" id="ref-for-ordered-map">map</a>, initially empty, of <a data-link-type="dfn" href="https://infra.spec.whatwg.org#string" id="ref-for-string">strings</a> (denoting operation names) to <a data-link-type="dfn" href="https://tc39.es/ecma262/#function-object" id="ref-for-function-object">functions</a>.</p>
   <p>Currently each <code class="idl"><a data-link-type="idl" href="#sharedstorageoperation" id="ref-for-sharedstorageoperation②">SharedStorageOperation</a></code> registered via <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageworkletglobalscope-register" id="ref-for-dom-sharedstorageworkletglobalscope-register①">register()</a></code> must be one of the following two types:</p>
   <ul>
    <li data-md>
     <p><code class="idl"><a data-link-type="idl" href="#sharedstoragerunoperation" id="ref-for-sharedstoragerunoperation">SharedStorageRunOperation</a></code></p>
    <li data-md>
     <p><code class="idl"><a data-link-type="idl" href="#sharedstorageselecturloperation" id="ref-for-sharedstorageselecturloperation">SharedStorageSelectURLOperation</a></code></p>
   </ul>
   <p>The <code class="idl"><a data-link-type="idl" href="#sharedstoragerunoperation" id="ref-for-sharedstoragerunoperation①">SharedStorageRunOperation</a></code> is designed to work with output gates that do not need a return value, like the <a data-link-type="dfn" href="https://github.com/patcg-individual-drafts/private-aggregation-api/blob/main/README.md#private-aggregation" id="ref-for-private-aggregation②">private aggregation</a> service. A <code class="idl"><a data-link-type="idl" href="#sharedstoragerunoperation" id="ref-for-sharedstoragerunoperation②">SharedStorageRunOperation</a></code> performs an async operation and returns a promise that resolves to undefined.</p>
   <p>A <code class="idl"><a data-link-type="idl" href="#sharedstorageselecturloperation" id="ref-for-sharedstorageselecturloperation①">SharedStorageSelectURLOperation</a></code> is an <code class="idl"><a data-link-type="idl" href="#sharedstorageoperation" id="ref-for-sharedstorageoperation③">SharedStorageOperation</a></code> that takes in a <a data-link-type="dfn" href="https://infra.spec.whatwg.org#list" id="ref-for-list">list</a> of <code class="idl"><a data-link-type="idl" href="#dictdef-sharedstorageurlwithmetadata" id="ref-for-dictdef-sharedstorageurlwithmetadata">SharedStorageUrlWithMetadata</a></code>s (i.e. <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#dfn-dictionary" id="ref-for-dfn-dictionary">dictionaries</a> containing <a data-link-type="dfn" href="https://infra.spec.whatwg.org#string" id="ref-for-string①">strings</a> representing <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url">URL</a></code>s each wrapped with optional metadata), performs an async operation, and then returns a promise to a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-long" id="ref-for-idl-long">long</a></code> integer index specifying which of these <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url①">URL</a></code>s should be selected.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed③"><c- g>Exposed</c-></a>=<c- n>SharedStorageWorklet</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="sharedstoragerunoperation"><code><c- g>SharedStorageRunOperation</c-></code></dfn> : <a data-link-type="idl-name" href="#sharedstorageoperation" id="ref-for-sharedstorageoperation④"><c- n>SharedStorageOperation</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined①"><c- b>undefined</c-></a>> <dfn class="idl-code" data-dfn-for="SharedStorageRunOperation" data-dfn-type="method" data-export data-lt="run(data)" id="dom-sharedstoragerunoperation-run"><code><c- g>run</c-></code><a class="self-link" href="#dom-sharedstoragerunoperation-run"></a></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object①"><c- b>object</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorageRunOperation/run(data)" data-dfn-type="argument" data-export id="dom-sharedstoragerunoperation-run-data-data"><code><c- g>data</c-></code><a class="self-link" href="#dom-sharedstoragerunoperation-run-data-data"></a></dfn>);
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed④"><c- g>Exposed</c-></a>=<c- n>SharedStorageWorklet</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="sharedstorageselecturloperation"><code><c- g>SharedStorageSelectURLOperation</c-></code></dfn> : <a data-link-type="idl-name" href="#sharedstorageoperation" id="ref-for-sharedstorageoperation⑤"><c- n>SharedStorageOperation</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long" id="ref-for-idl-long①"><c- b>long</c-></a>> <dfn class="idl-code" data-dfn-for="SharedStorageSelectURLOperation" data-dfn-type="method" data-export data-lt="run(data, urls)" id="dom-sharedstorageselecturloperation-run"><code><c- g>run</c-></code><a class="self-link" href="#dom-sharedstorageselecturloperation-run"></a></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object②"><c- b>object</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorageSelectURLOperation/run(data, urls)" data-dfn-type="argument" data-export id="dom-sharedstorageselecturloperation-run-data-urls-data"><code><c- g>data</c-></code><a class="self-link" href="#dom-sharedstorageselecturloperation-run-data-urls-data"></a></dfn>,
                    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array" id="ref-for-idl-frozen-array"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-sharedstorageurlwithmetadata" id="ref-for-dictdef-sharedstorageurlwithmetadata①"><c- n>SharedStorageUrlWithMetadata</c-></a>> <dfn class="idl-code" data-dfn-for="SharedStorageSelectURLOperation/run(data, urls)" data-dfn-type="argument" data-export id="dom-sharedstorageselecturloperation-run-data-urls-urls"><code><c- g>urls</c-></code><a class="self-link" href="#dom-sharedstorageselecturloperation-run-data-urls-urls"></a></dfn>);
};</pre>
   <h3 class="heading settled" data-level="2.3" id="register-worklet"><span class="secno">2.3. </span><span class="content">Registering a Worklet</span><a class="self-link" href="#register-worklet"></a></h3>
   <div class="algorithm" data-algorithm="register(name, operationCtor)" data-algorithm-for="SharedStorageWorkletGlobalScope">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="SharedStorageWorkletGlobalScope" data-dfn-type="method" data-export id="dom-sharedstorageworkletglobalscope-register"><code>register(<var>name</var>, <var>operationCtor</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>If <var>name</var> is missing or empty, throw a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>operationMap</var> be this <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope⑤">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-operation-map" id="ref-for-sharedstorageworkletglobalscope-operation-map">operation map</a>.</p>
     <li data-md>
      <p>If <var>operationMap</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-exists" id="ref-for-map-exists">contains</a> an <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-entry" id="ref-for-map-entry">entry</a> with <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-key" id="ref-for-map-key">key</a> <var>name</var>, throw a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>operationCtor</var> is missing, throw a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③">TypeError</a></code>.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-isconstructor" id="ref-for-sec-isconstructor">IsConstructor()</a> with <var>operationCtor</var> is false, throw a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror④">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>prototype</var> be the result of running <var>operationCtor</var>’s <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-ordinary-object-internal-methods-and-internal-slots-getprototypeof" id="ref-for-sec-ordinary-object-internal-methods-and-internal-slots-getprototypeof">[[GetPrototypeOf]]()</a> method.</p>
     <li data-md>
      <p>If <var>prototype</var> is not an <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-object-type" id="ref-for-sec-object-type">object</a>, throw a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑤">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>run</var> be the result of running <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-getmethod" id="ref-for-sec-getmethod">GetMethod()</a> with <var>prototype</var> and "<code>run</code>".</p>
     <li data-md>
      <p>If <var>run</var> is undefined, throw a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑥">TypeError</a></code>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-set" id="ref-for-map-set">Set</a> the value of <var>operationMap</var>[<var>name</var>] to <var>run</var>.</p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="3" id="backend"><span class="secno">3. </span><span class="content">Shared Storage’s Backend</span><a class="self-link" href="#backend"></a></h2>
    The Shared Storage API will integrate into the <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#model" id="ref-for-model">Storage API</a> as below, via <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#registered-storage-endpoints" id="ref-for-registered-storage-endpoints">registering</a> a new <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-endpoint" id="ref-for-storage-endpoint">storage endpoint</a>. 
   <h3 class="heading settled" data-level="3.1" id="storage-monkey-patch"><span class="secno">3.1. </span><span class="content">Monkey Patch for the <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#model" id="ref-for-model①">Storage Model</a></span><a class="self-link" href="#storage-monkey-patch"></a></h3>
   <p>This standard will add a new <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-type" id="ref-for-storage-type">storage type</a> "<code>shared</code>" to the <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#model" id="ref-for-model②">Storage Model</a>.</p>
   <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent">user agent</a> holds a <a data-link-type="dfn" href="#shared-storage-shed" id="ref-for-shared-storage-shed">shared storage shed</a> for <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-endpoint" id="ref-for-storage-endpoint①">storage endpoints</a> of <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-type" id="ref-for-storage-type①">type</a> "<code>shared</code>".</p>
   <p>This standard will also <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#registered-storage-endpoints" id="ref-for-registered-storage-endpoints①">register</a> a <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-endpoint" id="ref-for-storage-endpoint②">storage endpoint</a> of <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-type" id="ref-for-storage-type②">type</a> "<code>shared</code>" with <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-identifier" id="ref-for-storage-identifier">storage identifier</a> "<code>sharedStorage</code>" and <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-endpoint-quota" id="ref-for-storage-endpoint-quota">quota</a> <code>5</code><sup><code>4</code></sup> <code>*</code> <code>2</code><sup><code>16</code></sup> bytes (i.e. 39.0625 mebibytes).</p>
   <p><span class="todo">This <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-endpoint-quota" id="ref-for-storage-endpoint-quota①">quota</a> is calculated from the current implementation. Consider bringing the current implementation in line with the spec for <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-endpoint" id="ref-for-storage-endpoint③">storage endpoints</a> "<code>localStorage</code>" and "<code>sessionStorage</code>", i.e. <code>5 * 2</code><sup><code>20</code></sup> bytes. For example, decreasing the per-origin entry limit from 10,000 to 1,280 would achieve this.</span></p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="shared-storage-shed">shared storage shed</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org#ordered-map" id="ref-for-ordered-map①">map</a> of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin">origins</a> to <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-shelf" id="ref-for-storage-shelf">storage shelves</a>. It is initially empty.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Unlike <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-shed" id="ref-for-storage-shed">storage sheds</a>, whose keys are <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-key" id="ref-for-storage-key">storage keys</a>, <a data-link-type="dfn" href="#shared-storage-shed" id="ref-for-shared-storage-shed①">shared storage sheds</a> use <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin①">origins</a> as keys directly. <a data-link-type="dfn" href="#shared-storage" id="ref-for-shared-storage②">Shared storage</a> will be intentionally excluded from <a data-link-type="dfn" href="https://privacycg.github.io/storage-partitioning/#client-side-storage-partitioning" id="ref-for-client-side-storage-partitioning①">client-side storage partitioning</a>.</p>
   <p>For each <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-shelf" id="ref-for-storage-shelf①">storage shelf</a> in a <a data-link-type="dfn" href="#shared-storage-shed" id="ref-for-shared-storage-shed②">shared storage shed</a>, the <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-shelf" id="ref-for-storage-shelf②">storage shelf</a>'s <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#bucket-map" id="ref-for-bucket-map">bucket map</a> currently has only a single key of "<code>default</code>".</p>
   <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent①">user agent</a>'s <a data-link-type="dfn" href="#shared-storage-shed" id="ref-for-shared-storage-shed③">shared storage shed</a> holds all <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="shared-storage">shared storage</dfn> data.</p>
   <div class="algorithm" data-algorithm="obtain a shared storage shelf">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-a-shared-storage-shelf">obtain a shared storage shelf</dfn>, given a <a data-link-type="dfn" href="#shared-storage-shed" id="ref-for-shared-storage-shed④">shared storage shed</a> <var>shed</var> and an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object①">environment settings object</a> <var>environment</var>, run these steps: 
    <ol>
     <li data-md>
      <p>Let <var>origin</var> be <var>environment</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org#concept-url-origin" id="ref-for-concept-url-origin">origin</a>.</p>
     <li data-md>
      <p>If <var>origin</var> is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-opaque-origin" id="ref-for-concept-opaque-origin">opaque origin</a>, then return failure.</p>
     <li data-md>
      <p>If the user has disabled <a data-link-type="dfn" href="#shared-storage" id="ref-for-shared-storage③">shared storage</a>, then return failure.</p>
     <li data-md>
      <p>If <var>shed</var>[origin] does not exist, then set <var>shed</var>[origin] to the result of running <a data-link-type="dfn" href="#create-a-shared-storage-shelf" id="ref-for-create-a-shared-storage-shelf">create a shared storage shelf</a> with <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-type" id="ref-for-storage-type③">type</a> "<code>shared</code>".</p>
     <li data-md>
      <p>Return <var>shed</var>[<var>origin</var>].</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="create a shared storage shelf">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="create-a-shared-storage-shelf">create a shared storage shelf</dfn>, run these steps: 
    <ol>
     <li data-md>
      <p>Let <var>shelf</var> be a new <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-shelf" id="ref-for-storage-shelf③">storage shelf</a>.</p>
     <li data-md>
      <p>Set <var>shelf</var>’s <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#bucket-map" id="ref-for-bucket-map①">bucket map</a>["<code>default</code>"] to the result of running <a data-link-type="dfn" href="#create-a-shared-storage-bucket" id="ref-for-create-a-shared-storage-bucket">create a shared storage bucket</a>.</p>
     <li data-md>
      <p>Return <var>shelf</var>.</p>
    </ol>
   </div>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="shared-storage-bucket">shared storage bucket</dfn> is a <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-bucket" id="ref-for-storage-bucket">storage bucket</a> in one of a <a data-link-type="dfn" href="#shared-storage-shed" id="ref-for-shared-storage-shed⑤">shared storage shed</a>'s <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-shelf" id="ref-for-storage-shelf④">shelves</a>.</p>
   <div class="algorithm" data-algorithm="create a shared storage bucket">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="create-a-shared-storage-bucket">create a shared storage bucket</dfn>, run these steps: 
    <ol>
     <li data-md>
      <p>Let <var>endpoint</var> be the <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-endpoint" id="ref-for-storage-endpoint④">storage endpoint</a> with <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-identifier" id="ref-for-storage-identifier①">storage identifier</a> "<code>sharedStorage</code>".</p>
     <li data-md>
      <p>Let <var>bucket</var> be a new <a data-link-type="dfn" href="#shared-storage-bucket" id="ref-for-shared-storage-bucket">shared storage bucket</a>.</p>
     <li data-md>
      <p>Set <var>bucket</var>’s <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#bottle-map" id="ref-for-bottle-map">bottle map</a>["<code>sharedStorage</code>"] to a new <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-bottle" id="ref-for-storage-bottle">storage bottle</a> whose <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-bottle-quota" id="ref-for-storage-bottle-quota">quota</a> is <var>endpoint</var>’s <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-endpoint-quota" id="ref-for-storage-endpoint-quota②">quota</a>.</p>
     <li data-md>
      <p>Return <var>bucket</var>.</p>
    </ol>
   </div>
   <p class="note" role="note"><span class="marker">Note:</span> Currently, a <a data-link-type="dfn" href="#shared-storage-bucket" id="ref-for-shared-storage-bucket①">shared storage bucket</a>'s <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#bottle-map" id="ref-for-bottle-map①">bottle map</a> has <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-size" id="ref-for-map-size">size</a> <code>1</code>, since there is only one <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-endpoint" id="ref-for-storage-endpoint⑤">storage endpoint</a> <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#registered-storage-endpoints" id="ref-for-registered-storage-endpoints②">registered</a> with <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-type" id="ref-for-storage-type④">type</a> "<code>shared</code>".</p>
   <div class="algorithm" data-algorithm="obtain a shared storage bottle map">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-a-shared-storage-bottle-map">obtain a shared storage bottle map</dfn>, given an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object②">environment settings object</a> <var>environment</var>, run these steps: 
    <ol>
     <li data-md>
      <p>Let <var>shed</var> be the <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent②">user agent</a>'s <a data-link-type="dfn" href="#shared-storage-shed" id="ref-for-shared-storage-shed⑥">shared storage shed</a>.</p>
     <li data-md>
      <p>Let <var>shelf</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-shelf" id="ref-for-obtain-a-shared-storage-shelf">obtain a shared storage shelf</a> with <var>shed</var> and <var>environment</var>.</p>
     <li data-md>
      <p>If <var>shelf</var> is failure, then return failure.</p>
     <li data-md>
      <p>Let <var>bucket</var> be <var>shelf</var>’s <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#bucket-map" id="ref-for-bucket-map②">bucket map</a>["<code>default</code>"].</p>
     <li data-md>
      <p>Let <var>bottle</var> be <var>bucket</var>’s <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#bottle-map" id="ref-for-bottle-map②">bottle map</a>["<code>sharedStorage</code>"].</p>
     <li data-md>
      <p>Let <var>proxyMap</var> be a new <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-proxy-map" id="ref-for-storage-proxy-map">storage proxy map</a> whose <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-proxy-map-backing-map" id="ref-for-storage-proxy-map-backing-map">backing map</a> is <var>bottle</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org#ordered-map" id="ref-for-ordered-map②">map</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org#set-append" id="ref-for-set-append">Append</a> <var>proxyMap</var> to <var>bottle</var>’s <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-bottle-proxy-map-reference-set" id="ref-for-storage-bottle-proxy-map-reference-set">proxy map reference set</a>.</p>
     <li data-md>
      <p>Return <var>proxyMap</var>.</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="3.2" id="database"><span class="secno">3.2. </span><span class="content">The <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database">Shared Storage Database</a></span><a class="self-link" href="#database"></a></h3>
   <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#browsing-context" id="ref-for-browsing-context">browsing context</a> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="shared-storage-database">shared storage database</dfn>, which provides methods to <a data-link-type="dfn" href="#shared-storage-database-store-an-entry-in-the-database" id="ref-for-shared-storage-database-store-an-entry-in-the-database">store</a>, <a data-link-type="dfn" href="#shared-storage-database-retrieve-an-entry-from-the-database" id="ref-for-shared-storage-database-retrieve-an-entry-from-the-database">retrieve</a>, <a data-link-type="dfn" href="#shared-storage-database-delete-an-entry-from-the-database" id="ref-for-shared-storage-database-delete-an-entry-from-the-database">delete</a>, <a data-link-type="dfn" href="#shared-storage-database-clear-all-entries-in-the-database" id="ref-for-shared-storage-database-clear-all-entries-in-the-database">clear</a>, and <a data-link-type="dfn" href="#shared-storage-database-purge-expired-entries-from-the-database" id="ref-for-shared-storage-database-purge-expired-entries-from-the-database">purge expired</a> data, and additional methods as below. The data in the <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database①">database</a> take the form of <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry">entries</a>.</p>
   <p>Each <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database②">shared storage database</a> has a <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-shared-storage-database-queue">shared storage database queue</dfn>, which is the result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#starting-a-new-parallel-queue" id="ref-for-starting-a-new-parallel-queue">starting a new parallel queue</a>, on which the each of the <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database③">shared storage database</a>'s methods run when calls to them are initiated from that <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#browsing-context" id="ref-for-browsing-context①">browsing context</a>.</p>
   <p>Each <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-entry">entry</dfn> consists of a <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key">key</a> and a <a data-link-type="dfn" href="#entry-value-struct" id="ref-for-entry-value-struct">value struct</a>.</p>
   <p>An <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry①">entry</a>'s <dfn class="dfn-paneled" data-dfn-for="entry" data-dfn-type="dfn" data-noexport id="entry-key">key</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org#string" id="ref-for-string②">string</a>.</p>
   <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent③">User agents</a> may specify the <dfn class="dfn-paneled" data-dfn-for="key" data-dfn-type="dfn" data-noexport id="key-maximum-length">maximum length</dfn> of a <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key①">key</a>.</p>
   <p>Since <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key②">keys</a> are used to organize and efficiently retrieve <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry②">entries</a>, <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key③">keys</a> must appear at most once in any given <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database④">shared storage database</a>.</p>
   <p>An <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry③">entry</a>'s <dfn class="dfn-paneled" data-dfn-for="entry" data-dfn-type="dfn" data-noexport id="entry-value-struct">value struct</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org#struct" id="ref-for-struct">struct</a> composed of <a data-link-type="dfn" href="https://infra.spec.whatwg.org#string" id="ref-for-string③">string</a> <dfn class="dfn-paneled" data-dfn-for="value struct" data-dfn-type="dfn" data-noexport id="value-struct-value">value</dfn> and <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/hr-time/#dom-domhighrestimestamp" id="ref-for-dom-domhighrestimestamp">DOMHighResTimeStamp</a></code> <dfn class="dfn-paneled" data-dfn-for="value struct" data-dfn-type="dfn" data-noexport id="value-struct-last-updated">last updated</dfn> (from the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unix-epoch" id="ref-for-dfn-unix-epoch">Unix Epoch</a>).</p>
   <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent④">User agents</a> may specify the <dfn class="dfn-paneled" data-dfn-for="value" data-dfn-type="dfn" data-noexport id="value-maximum-length">maximum length</dfn> of a <a data-link-type="dfn" href="#value-struct-value" id="ref-for-value-struct-value">value</a>.</p>
   <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent⑤">User agents</a> may specify a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="default-entry-lifetime">default entry lifetime</dfn>, the default <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration" id="ref-for-dfn-duration">duration</a> between when an <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry④">entry</a> is <a data-link-type="dfn" href="#shared-storage-database-store-an-entry-in-the-database" id="ref-for-shared-storage-database-store-an-entry-in-the-database①">stored</a> and when it expires. If the <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent⑥">user agent</a> specifies a <a data-link-type="dfn" href="#default-entry-lifetime" id="ref-for-default-entry-lifetime">default entry lifetime</a>, then it should have a timer periodically <a data-link-type="dfn" href="#shared-storage-database-purge-expired-entries-from-the-database" id="ref-for-shared-storage-database-purge-expired-entries-from-the-database①">purge expired entries from the database</a>.</p>
   <h3 class="heading settled" data-level="3.3" id="database-algorithms"><span class="secno">3.3. </span><span class="content">The <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database⑤">Database</a> Algorithms</span><a class="self-link" href="#database-algorithms"></a></h3>
   <div class="algorithm" data-algorithm="store an entry in the database" data-algorithm-for="shared storage database">
     To <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-store-an-entry-in-the-database">store an entry in the database</dfn>, given a <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue">shared storage database queue</a> <var>queue</var>, an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object③">environment settings object</a> <var>environment</var>, a <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key④">key</a> <var>key</var>, and a <a data-link-type="dfn" href="#value-struct-value" id="ref-for-value-struct-value①">value</a> <var>value</var>, run the following steps on <var>queue</var>: 
    <ol>
     <li data-md>
      <p>Let <var>databaseMap</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-bottle-map" id="ref-for-obtain-a-shared-storage-bottle-map">obtain a shared storage bottle map</a> for <var>environment</var>.</p>
     <li data-md>
      <p>If <var>databaseMap</var> is failure, then return false.</p>
     <li data-md>
      <p>Let <var>valueStruct</var> be a new <a data-link-type="dfn" href="#entry-value-struct" id="ref-for-entry-value-struct①">value struct</a>.</p>
     <li data-md>
      <p>Set <var>valueStruct</var>’s <a data-link-type="dfn" href="#value-struct-value" id="ref-for-value-struct-value②">value</a> to <var>value</var>.</p>
     <li data-md>
      <p>Let <var>currentTime</var> be the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-current-wall-time" id="ref-for-dfn-current-wall-time">current wall time</a>.</p>
     <li data-md>
      <p>Set <var>valueStruct</var>’s <a data-link-type="dfn" href="#value-struct-last-updated" id="ref-for-value-struct-last-updated">last updated</a> to <var>currentTime</var>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-set" id="ref-for-map-set①">Set</a> <var>databaseMap</var>[<var>key</var>] to <var>valueStruct</var>.</p>
     <li data-md>
      <p>Return true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="retrieve an entry from the database" data-algorithm-for="shared storage database">
     To <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-retrieve-an-entry-from-the-database">retrieve an entry from the database</dfn>, given a <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①">shared storage database queue</a> <var>queue</var>, an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object④">environment settings object</a> <var>environment</var>, and a <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key⑤">key</a> <var>key</var>, run the following steps on <var>queue</var>: 
    <ol>
     <li data-md>
      <p>Let <var>databaseMap</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-bottle-map" id="ref-for-obtain-a-shared-storage-bottle-map①">obtain a shared storage bottle map</a> for <var>environment</var>.</p>
     <li data-md>
      <p>If <var>databaseMap</var> is failure, then return false.</p>
     <li data-md>
      <p>If <var>databaseMap</var> does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-exists" id="ref-for-map-exists①">contain</a> <var>key</var>, return undefined.</p>
     <li data-md>
      <p>Let <var>valueStruct</var> be the result of running <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-get" id="ref-for-map-get">Get</a> on <var>databaseMap</var> with <var>key</var>.</p>
     <li data-md>
      <p>If the result of running <a data-link-type="dfn" href="#shared-storage-database-determine-whether-an-entry-is-expired" id="ref-for-shared-storage-database-determine-whether-an-entry-is-expired">determine whether an entry is expired</a> with <var>valueStruct</var> is true, return undefined.</p>
     <li data-md>
      <p>Return <var>valueStruct</var>’s <a data-link-type="dfn" href="#value-struct-value" id="ref-for-value-struct-value③">value</a>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="delete an entry from the database" data-algorithm-for="shared storage database">
     To <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-delete-an-entry-from-the-database">delete an entry from the database</dfn>, given a <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue②">shared storage database queue</a> <var>queue</var>, an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object⑤">environment settings object</a> <var>environment</var>, and a <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key⑥">key</a> <var>key</var>, run the following steps on <var>queue</var>: 
    <ol>
     <li data-md>
      <p>Let <var>databaseMap</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-bottle-map" id="ref-for-obtain-a-shared-storage-bottle-map②">obtain a shared storage bottle map</a> for <var>environment</var>.</p>
     <li data-md>
      <p>If <var>databaseMap</var> is failure, then return false.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-remove" id="ref-for-map-remove">Remove</a> <var>databaseMap</var>[<var>key</var>].</p>
     <li data-md>
      <p>Return true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="clear all entries in the database" data-algorithm-for="shared storage database">
     To <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-clear-all-entries-in-the-database">clear all entries in the database</dfn>, given a <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue③">shared storage database queue</a> <var>queue</var> and an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object⑥">environment settings object</a> <var>environment</var>, run the following steps on <var>queue</var>: 
    <ol>
     <li data-md>
      <p>Let <var>databaseMap</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-bottle-map" id="ref-for-obtain-a-shared-storage-bottle-map③">obtain a shared storage bottle map</a> for <var>environment</var>.</p>
     <li data-md>
      <p>If <var>databaseMap</var> is failure, then return false.</p>
     <li data-md>
      <p>Run <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-clear" id="ref-for-map-clear">Clear</a> on <var>databaseMap</var>.</p>
     <li data-md>
      <p>Return true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="retrieve all entries from the database" data-algorithm-for="shared storage database">
     To <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-retrieve-all-entries-from-the-database">retrieve all entries from the database</dfn>, given a <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue④">shared storage database queue</a> <var>queue</var> and an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object⑦">environment settings object</a> <var>environment</var>, run the following steps on <var>queue</var>: 
    <ol>
     <li data-md>
      <p>Let <var>databaseMap</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-bottle-map" id="ref-for-obtain-a-shared-storage-bottle-map④">obtain a shared storage bottle map</a> for <var>environment</var>.</p>
     <li data-md>
      <p>If <var>databaseMap</var> is failure, then return undefined.</p>
     <li data-md>
      <p>Return the result of running <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-getting-the-values" id="ref-for-map-getting-the-values">getting the values</a> on <var>databaseMap</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="count entries in the database" data-algorithm-for="shared storage database">
     To <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-count-entries-in-the-database">count entries in the database</dfn>, given a <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue⑤">shared storage database queue</a> <var>queue</var> and an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object⑧">environment settings object</a> <var>environment</var>, run the following steps on <var>queue</var>: 
    <ol>
     <li data-md>
      <p>Let <var>databaseMap</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-bottle-map" id="ref-for-obtain-a-shared-storage-bottle-map⑤">obtain a shared storage bottle map</a> for <var>environment</var>.</p>
     <li data-md>
      <p>If <var>databaseMap</var> is failure, then return undefined.</p>
     <li data-md>
      <p>Return <var>databaseMap</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-size" id="ref-for-map-size①">size</a>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="purge expired entries from the database" data-algorithm-for="shared storage database">
     To <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-purge-expired-entries-from-the-database">purge expired entries from the database</dfn>, given a <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue⑥">shared storage database queue</a> <var>queue</var> and an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object⑨">environment settings object</a> <var>environment</var>, run the following steps on <var>queue</var>: 
    <ol>
     <li data-md>
      <p>Let <var>databaseMap</var> be the result of running <a data-link-type="dfn" href="#obtain-a-shared-storage-bottle-map" id="ref-for-obtain-a-shared-storage-bottle-map⑥">obtain a shared storage bottle map</a> for <var>environment</var>.</p>
     <li data-md>
      <p>If <var>databaseMap</var> is failure, then return false.</p>
     <li data-md>
      <p>For each <a data-link-type="dfn" href="#entry-key" id="ref-for-entry-key⑦">key</a> <var>key</var> in <var>databaseMap</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>valueStruct</var> be the result of running <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-get" id="ref-for-map-get①">Get</a> on <var>databaseMap</var> with <var>key</var>.</p>
       <li data-md>
        <p>If the result of running <a data-link-type="dfn" href="#shared-storage-database-determine-whether-an-entry-is-expired" id="ref-for-shared-storage-database-determine-whether-an-entry-is-expired①">determine whether an entry is expired</a> with <var>valueStruct</var> is true, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-remove" id="ref-for-map-remove①">Remove</a> <var>databaseMap</var>[<var>key</var>].</p>
      </ol>
     <li data-md>
      <p>Return true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="determine whether an entry is expired" data-algorithm-for="shared storage database">
    <p>To <dfn class="dfn-paneled" data-dfn-for="shared storage database" data-dfn-type="dfn" data-noexport id="shared-storage-database-determine-whether-an-entry-is-expired">determine whether an entry is expired</dfn>, given a <a data-link-type="dfn" href="#entry-value-struct" id="ref-for-entry-value-struct②">value struct</a> <var>valueStruct</var>, run the following steps:</p>
    <ol>
     <li data-md>
      <p>Let <var>lastUpdated</var> be <var>valueStruct</var>’s <a data-link-type="dfn" href="#value-struct-last-updated" id="ref-for-value-struct-last-updated①">last updated</a>.</p>
     <li data-md>
      <p>Let <var>lifetime</var> be <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent⑦">user agent</a>'s <a data-link-type="dfn" href="#default-entry-lifetime" id="ref-for-default-entry-lifetime①">default entry lifetime</a>.</p>
     <li data-md>
      <p>Let <var>expiration</var> be the sum of <var>lastUpdated</var> and <var>lifetime</var>.</p>
     <li data-md>
      <p>Let <var>currentTime</var> be the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-current-wall-time" id="ref-for-dfn-current-wall-time①">current wall time</a>.</p>
     <li data-md>
      <p>If <var>expiration</var> is less than or equal to <var>currentTime</var>, return true.</p>
     <li data-md>
      <p>Otherwise, return false.</p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="4" id="shared-storage-interface"><span class="secno">4. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#sharedstorage" id="ref-for-sharedstorage">SharedStorage</a></code> Interface</span><a class="self-link" href="#shared-storage-interface"></a></h2>
    The <code class="idl"><a data-link-type="idl" href="#sharedstorage" id="ref-for-sharedstorage①">SharedStorage</a></code> interface is the base for derived interfaces <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage">WindowSharedStorage</a></code> and <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage">WorkletSharedStorage</a></code>, which are exposed to the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window">Window</a></code> and the <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet①⓪">SharedStorageWorklet</a></code>, respectively. 
   <p>Methods that allow the setting and/or deleting of data are exposed to both the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window①">Window</a></code> and the <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet①①">SharedStorageWorklet</a></code> and hence are declared in the base <code class="idl"><a data-link-type="idl" href="#sharedstorage" id="ref-for-sharedstorage②">SharedStorage</a></code> interface, although their implementations may vary depending on their <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment" id="ref-for-environment">environment</a>. This makes it possible to modify the data in Shared Storage from multiple contexts.</p>
   <p>Meanwhile, methods for running <code class="idl"><a data-link-type="idl" href="#sharedstorageoperation" id="ref-for-sharedstorageoperation⑥">SharedStorageOperation</a></code>s, along with the <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-worklet" id="ref-for-dom-windowsharedstorage-worklet">worklet</a></code> attribute which is used to call <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule⑥">addModule()</a></code>, are declared in <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage①">WindowSharedStorage</a></code> and exposed to the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window②">Window</a></code> only, as these are the means by which the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window③">Window</a></code> interacts with the <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet①②">SharedStorageWorklet</a></code>.</p>
   <p>On the other hand, methods for getting data from the <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database⑥">shared storage database</a> are declared in <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage①">WorkletSharedStorage</a></code> and exposed to the <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet①③">SharedStorageWorklet</a></code> only, in order to carefully control the flow of data read from the <a data-link-type="dfn" href="#shared-storage-database" id="ref-for-shared-storage-database⑦">database</a>.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed⑤"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>SharedStorageWorklet</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="sharedstorage"><code><c- g>SharedStorage</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise②"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any"><c- b>any</c-></a>> <dfn class="idl-code" data-dfn-for="SharedStorage" data-dfn-type="method" data-export data-lt="set(key, value, options)|set(key, value)" id="dom-sharedstorage-set"><code><c- g>set</c-></code><a class="self-link" href="#dom-sharedstorage-set"></a></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorage/set(key, value, options), SharedStorage/set(key, value)" data-dfn-type="argument" data-export id="dom-sharedstorage-set-key-value-options-key"><code><c- g>key</c-></code><a class="self-link" href="#dom-sharedstorage-set-key-value-options-key"></a></dfn>,
                   <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorage/set(key, value, options), SharedStorage/set(key, value)" data-dfn-type="argument" data-export id="dom-sharedstorage-set-key-value-options-value"><code><c- g>value</c-></code><a class="self-link" href="#dom-sharedstorage-set-key-value-options-value"></a></dfn>,
                   <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sharedstoragesetmethodoptions" id="ref-for-dictdef-sharedstoragesetmethodoptions"><c- n>SharedStorageSetMethodOptions</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorage/set(key, value, options), SharedStorage/set(key, value)" data-dfn-type="argument" data-export id="dom-sharedstorage-set-key-value-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-sharedstorage-set-key-value-options-options"></a></dfn> = {});
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise③"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any①"><c- b>any</c-></a>> <dfn class="idl-code" data-dfn-for="SharedStorage" data-dfn-type="method" data-export data-lt="append(key, value)" id="dom-sharedstorage-append"><code><c- g>append</c-></code><a class="self-link" href="#dom-sharedstorage-append"></a></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString③"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorage/append(key, value)" data-dfn-type="argument" data-export id="dom-sharedstorage-append-key-value-key"><code><c- g>key</c-></code><a class="self-link" href="#dom-sharedstorage-append-key-value-key"></a></dfn>,
                      <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString④"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorage/append(key, value)" data-dfn-type="argument" data-export id="dom-sharedstorage-append-key-value-value"><code><c- g>value</c-></code><a class="self-link" href="#dom-sharedstorage-append-key-value-value"></a></dfn>);
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise④"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any②"><c- b>any</c-></a>> <dfn class="idl-code" data-dfn-for="SharedStorage" data-dfn-type="method" data-export data-lt="delete(key)" id="dom-sharedstorage-delete"><code><c- g>delete</c-></code><a class="self-link" href="#dom-sharedstorage-delete"></a></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑤"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="SharedStorage/delete(key)" data-dfn-type="argument" data-export id="dom-sharedstorage-delete-key-key"><code><c- g>key</c-></code><a class="self-link" href="#dom-sharedstorage-delete-key-key"></a></dfn>);
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise⑤"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any③"><c- b>any</c-></a>> <dfn class="idl-code" data-dfn-for="SharedStorage" data-dfn-type="method" data-export data-lt="clear()" id="dom-sharedstorage-clear"><code><c- g>clear</c-></code><a class="self-link" href="#dom-sharedstorage-clear"></a></dfn>();
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-sharedstoragesetmethodoptions"><code><c- g>SharedStorageSetMethodOptions</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean②"><c- b>boolean</c-></a> <dfn class="idl-code" data-default="false" data-dfn-for="SharedStorageSetMethodOptions" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-sharedstoragesetmethodoptions-ignoreifpresent"><code><c- g>ignoreIfPresent</c-></code><a class="self-link" href="#dom-sharedstoragesetmethodoptions-ignoreifpresent"></a></dfn> = <c- b>false</c->;
};</pre>
   <h3 class="heading settled" data-level="4.1" id="window"><span class="secno">4.1. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage②">WindowSharedStorage</a></code> interface</span><a class="self-link" href="#window"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage③">WindowSharedStorage</a></code> interface is as follows.</p>
<pre class="idl highlight def"><c- b>typedef</c-> (<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString"><c- b>USVString</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="https://wicg.github.io/fenced-frame/#fencedframeconfig" id="ref-for-fencedframeconfig"><c- n>FencedFrameConfig</c-></a>) <dfn class="dfn-paneled idl-code" data-dfn-type="typedef" data-export id="typedefdef-sharedstorageresponse"><code><c- g>SharedStorageResponse</c-></code></dfn>;

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed⑥"><c- g>Exposed</c-></a>=(<c- n>Window</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="windowsharedstorage"><code><c- g>WindowSharedStorage</c-></code></dfn> : <a data-link-type="idl-name" href="#sharedstorage" id="ref-for-sharedstorage③"><c- n>SharedStorage</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise⑥"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any④"><c- b>any</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-windowsharedstorage-run" id="ref-for-dom-windowsharedstorage-run"><c- g>run</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑥"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="WindowSharedStorage/run(name, options), WindowSharedStorage/run(name)" data-dfn-type="argument" data-export id="dom-windowsharedstorage-run-name-options-name"><code><c- g>name</c-></code><a class="self-link" href="#dom-windowsharedstorage-run-name-options-name"></a></dfn>,
                   <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sharedstoragerunoperationmethodoptions" id="ref-for-dictdef-sharedstoragerunoperationmethodoptions①"><c- n>SharedStorageRunOperationMethodOptions</c-></a> <dfn class="idl-code" data-dfn-for="WindowSharedStorage/run(name, options), WindowSharedStorage/run(name)" data-dfn-type="argument" data-export id="dom-windowsharedstorage-run-name-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-windowsharedstorage-run-name-options-options"></a></dfn> = {});
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise⑦"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#typedefdef-sharedstorageresponse" id="ref-for-typedefdef-sharedstorageresponse"><c- n>SharedStorageResponse</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-windowsharedstorage-selecturl" id="ref-for-dom-windowsharedstorage-selecturl①"><c- g>selectURL</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑦"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="WindowSharedStorage/selectURL(name, urls, options), WindowSharedStorage/selectURL(name, urls)" data-dfn-type="argument" data-export id="dom-windowsharedstorage-selecturl-name-urls-options-name"><code><c- g>name</c-></code><a class="self-link" href="#dom-windowsharedstorage-selecturl-name-urls-options-name"></a></dfn>,
                               <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array" id="ref-for-idl-frozen-array①"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-sharedstorageurlwithmetadata" id="ref-for-dictdef-sharedstorageurlwithmetadata②"><c- n>SharedStorageUrlWithMetadata</c-></a>> <dfn class="idl-code" data-dfn-for="WindowSharedStorage/selectURL(name, urls, options), WindowSharedStorage/selectURL(name, urls)" data-dfn-type="argument" data-export id="dom-windowsharedstorage-selecturl-name-urls-options-urls"><code><c- g>urls</c-></code><a class="self-link" href="#dom-windowsharedstorage-selecturl-name-urls-options-urls"></a></dfn>,
                               <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sharedstoragerunoperationmethodoptions" id="ref-for-dictdef-sharedstoragerunoperationmethodoptions②"><c- n>SharedStorageRunOperationMethodOptions</c-></a> <dfn class="idl-code" data-dfn-for="WindowSharedStorage/selectURL(name, urls, options), WindowSharedStorage/selectURL(name, urls)" data-dfn-type="argument" data-export id="dom-windowsharedstorage-selecturl-name-urls-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-windowsharedstorage-selecturl-name-urls-options-options"></a></dfn> = {});

  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet①④"><c- n>SharedStorageWorklet</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="WindowSharedStorage" data-dfn-type="attribute" data-export data-readonly data-type="SharedStorageWorklet" id="dom-windowsharedstorage-worklet"><code><c- g>worklet</c-></code></dfn>;
};</pre>
   <h4 class="heading settled" data-level="4.1.1" id="window-setter"><span class="secno">4.1.1. </span><span class="content">Window Setter/Deleter Methods</span><a class="self-link" href="#window-setter"></a></h4>
   <div class="algorithm" data-algorithm="set(key, value, options)" data-algorithm-for="WindowSharedStorage">
     The <dfn class="idl-code" data-dfn-for="WindowSharedStorage" data-dfn-type="method" data-export id="dom-windowsharedstorage-set"><code>set(<var>key</var>, <var>value</var>, <var>options</var>)</code><a class="self-link" href="#dom-windowsharedstorage-set"></a></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise⑧">promise</a>.</p>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage④">WindowSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window④">Window</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#window-bc" id="ref-for-window-bc">browsing context</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://tc39.es/ecma262/#assert" id="ref-for-assert">Assert</a> that <var>context</var> is not null.</p>
     <li data-md>
      <p>If <var>key</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length">length</a> exceeds the <a data-link-type="dfn" href="#key-maximum-length" id="ref-for-key-maximum-length">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑦">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>value</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length①">length</a> exceeds the <a data-link-type="dfn" href="#value-maximum-length" id="ref-for-value-maximum-length">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑧">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#active-window" id="ref-for-active-window">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object①">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue⑦">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>If <var>options</var>["<code>ignoreIfPresent</code>"] is true and the result of running <a data-link-type="dfn" href="#shared-storage-database-retrieve-an-entry-from-the-database" id="ref-for-shared-storage-database-retrieve-an-entry-from-the-database①">retrieve an entry from the database</a> with <var>queue</var>, <var>environment</var>, and <var>key</var> is not undefined, return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-resolved-with" id="ref-for-a-promise-resolved-with">promise resolved</a> with undefined.</p>
       <li data-md>
        <p>Run <a data-link-type="dfn" href="#shared-storage-database-store-an-entry-in-the-database" id="ref-for-shared-storage-database-store-an-entry-in-the-database②">store an entry in the database</a> with <var>queue</var>, <var>environment</var>, <var>key</var>, and <var>value</var>.</p>
       <li data-md>
        <p>Resolve <var>promise</var> with undefined.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="append(key, value)" data-algorithm-for="WindowSharedStorage">
     The <dfn class="idl-code" data-dfn-for="WindowSharedStorage" data-dfn-type="method" data-export id="dom-windowsharedstorage-append"><code>append(<var>key</var>, <var>value</var>)</code><a class="self-link" href="#dom-windowsharedstorage-append"></a></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise⑨">promise</a>.</p>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage⑤">WindowSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window⑤">Window</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#window-bc" id="ref-for-window-bc①">browsing context</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://tc39.es/ecma262/#assert" id="ref-for-assert①">Assert</a> that <var>context</var> is not null.</p>
     <li data-md>
      <p>If <var>key</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length②">length</a> exceeds the <a data-link-type="dfn" href="#key-maximum-length" id="ref-for-key-maximum-length①">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with③">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror⑨">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>value</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length③">length</a> exceeds the <a data-link-type="dfn" href="#value-maximum-length" id="ref-for-value-maximum-length①">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with④">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①⓪">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#active-window" id="ref-for-active-window①">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object②">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue⑧">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps①">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>currentValue</var> be the result of running <a data-link-type="dfn" href="#shared-storage-database-retrieve-an-entry-from-the-database" id="ref-for-shared-storage-database-retrieve-an-entry-from-the-database②">retrieve an entry from the database</a> with <var>queue</var>, <var>environment</var>, and <var>key</var>.</p>
       <li data-md>
        <p>If <var>currentValue</var> is false, return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-resolved-with" id="ref-for-a-promise-resolved-with①">promise resolved</a> with undefined.</p>
       <li data-md>
        <p>If <var>currentValue</var> is not undefined:</p>
        <ol>
         <li data-md>
          <p>Let <var>list</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org#list" id="ref-for-list①">list</a>.</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org#list-append" id="ref-for-list-append">Append</a> <var>currentValue</var> to <var>list</var>.</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org#list-append" id="ref-for-list-append①">Append</a> <var>value</var> to <var>list</var>.</p>
         <li data-md>
          <p>Set <var>value</var> to the result of running <a data-link-type="dfn" href="https://infra.spec.whatwg.org#string-concatenate" id="ref-for-string-concatenate">concatenate</a> on <var>list</var>.</p>
        </ol>
       <li data-md>
        <p>Run <a data-link-type="dfn" href="#shared-storage-database-store-an-entry-in-the-database" id="ref-for-shared-storage-database-store-an-entry-in-the-database③">store an entry in the database</a> with <var>queue</var>, <var>environment</var>, <var>key</var>, and <var>value</var>.</p>
       <li data-md>
        <p>Resolve <var>promise</var> with undefined.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="delete(key)" data-algorithm-for="WindowSharedStorage">
     The <dfn class="idl-code" data-dfn-for="WindowSharedStorage" data-dfn-type="method" data-export id="dom-windowsharedstorage-delete"><code>delete(<var>key</var>)</code><a class="self-link" href="#dom-windowsharedstorage-delete"></a></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise①⓪">promise</a>.</p>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage⑥">WindowSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window⑥">Window</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#window-bc" id="ref-for-window-bc②">browsing context</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://tc39.es/ecma262/#assert" id="ref-for-assert②">Assert</a> that <var>context</var> is not null.</p>
     <li data-md>
      <p>If <var>key</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length④">length</a> exceeds the <a data-link-type="dfn" href="#key-maximum-length" id="ref-for-key-maximum-length②">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑤">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①①">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#active-window" id="ref-for-active-window②">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object③">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue⑨">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps②">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>Run <a data-link-type="dfn" href="#shared-storage-database-delete-an-entry-from-the-database" id="ref-for-shared-storage-database-delete-an-entry-from-the-database①">delete an entry from the database</a> with <var>queue</var>, <var>environment</var>, and <var>key</var>.</p>
       <li data-md>
        <p>Resolve <var>promise</var> with undefined.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="clear()" data-algorithm-for="WindowSharedStorage">
     The <dfn class="idl-code" data-dfn-for="WindowSharedStorage" data-dfn-type="method" data-export id="dom-windowsharedstorage-clear"><code>clear()</code><a class="self-link" href="#dom-windowsharedstorage-clear"></a></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise①①">promise</a>.</p>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage⑦">WindowSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window⑦">Window</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#window-bc" id="ref-for-window-bc③">browsing context</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://tc39.es/ecma262/#assert" id="ref-for-assert③">Assert</a> that <var>context</var> is not null.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#active-window" id="ref-for-active-window③">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object④">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①⓪">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps③">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>Run <a data-link-type="dfn" href="#shared-storage-database-clear-all-entries-in-the-database" id="ref-for-shared-storage-database-clear-all-entries-in-the-database①">clear all entries in the database</a> with <var>queue</var> and <var>environment</var>.</p>
       <li data-md>
        <p>Resolve <var>promise</var> with undefined.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="4.1.2" id="reporting"><span class="secno">4.1.2. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#dictdef-sharedstorageurlwithmetadata" id="ref-for-dictdef-sharedstorageurlwithmetadata③">SharedStorageUrlWithMetadata</a></code> and Reporting</span><a class="self-link" href="#reporting"></a></h4>
   <p>A <code class="idl"><a data-link-type="idl" href="#dictdef-sharedstorageurlwithmetadata" id="ref-for-dictdef-sharedstorageurlwithmetadata④">SharedStorageUrlWithMetadata</a></code> <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object③">object</a></code> is a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#dfn-dictionary" id="ref-for-dfn-dictionary①">dictionary</a> containing a <a data-link-type="dfn" href="https://infra.spec.whatwg.org#string" id="ref-for-string④">string</a> representing a <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url②">URL</a></code> and, optionally, a <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageurlwithmetadata-reportingmetadata" id="ref-for-dom-sharedstorageurlwithmetadata-reportingmetadata">reportingMetadata</a></code> <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object④">object</a></code>.</p>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-sharedstorageurlwithmetadata"><code><c- g>SharedStorageUrlWithMetadata</c-></code></dfn> {
  <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString①"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="SharedStorageUrlWithMetadata" data-dfn-type="dict-member" data-export data-type="USVString " id="dom-sharedstorageurlwithmetadata-url"><code><c- g>url</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object⑤"><c- b>object</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="SharedStorageUrlWithMetadata" data-dfn-type="dict-member" data-export data-type="object " id="dom-sharedstorageurlwithmetadata-reportingmetadata"><code><c- g>reportingMetadata</c-></code></dfn>;
};</pre>
   <p>If a <code class="idl"><a data-link-type="idl" href="#dictdef-sharedstorageurlwithmetadata" id="ref-for-dictdef-sharedstorageurlwithmetadata⑤">SharedStorageUrlWithMetadata</a></code> <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object⑥">object</a></code> contains a non-<a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-is-empty" id="ref-for-map-is-empty">empty</a> <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageurlwithmetadata-reportingmetadata" id="ref-for-dom-sharedstorageurlwithmetadata-reportingmetadata①">reportingMetadata</a></code> <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object⑦">object</a></code> in the form of a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#dfn-dictionary" id="ref-for-dfn-dictionary②">dictionary</a> whose <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-key" id="ref-for-map-key①">keys</a> are <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-eventtype" id="ref-for-dom-fenceevent-eventtype">eventTypes</a> and whose <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-value" id="ref-for-map-value">values</a> are <a data-link-type="dfn" href="https://infra.spec.whatwg.org#string" id="ref-for-string⑤">strings</a> that parse to valid <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url">URLs</a>, then these <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-eventtype" id="ref-for-dom-fenceevent-eventtype①">eventType</a>-<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①">URL</a> pairs will be <a data-link-type="dfn" href="#register-reporting-metadata" id="ref-for-register-reporting-metadata">registered</a> for later access within any <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element①">fenced frame</a> that loads the <code class="idl"><a data-link-type="idl" href="#typedefdef-sharedstorageresponse" id="ref-for-typedefdef-sharedstorageresponse①">SharedStorageResponse</a></code> resulting from this <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-selecturl" id="ref-for-dom-windowsharedstorage-selecturl②">selectURL()</a></code> call.</p>
   <p>Inside a <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element②">fenced frame</a> with <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-eventtype" id="ref-for-dom-fenceevent-eventtype②">eventType</a>-<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url②">URL</a> pairs that have been <a data-link-type="dfn" href="#register-reporting-metadata" id="ref-for-register-reporting-metadata①">registered</a> through <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-selecturl" id="ref-for-dom-windowsharedstorage-selecturl③">selectURL()</a></code> with <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageurlwithmetadata-reportingmetadata" id="ref-for-dom-sharedstorageurlwithmetadata-reportingmetadata②">reportingMetadata</a></code> <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object⑧">object</a></code>s, if <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#dom-fence-reportevent" id="ref-for-dom-fence-reportevent">fence.reportEvent()</a> is called on a <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#dictdef-fenceevent" id="ref-for-dictdef-fenceevent">FenceEvent</a> with a <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-destination" id="ref-for-dom-fenceevent-destination">destination</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain">containing</a> "<code>shared-storage-select-url</code>" and that <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#dictdef-fenceevent" id="ref-for-dictdef-fenceevent①">FenceEvent</a>'s corresponding <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-eventtype" id="ref-for-dom-fenceevent-eventtype③">eventType</a> is triggered, then the <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#dictdef-fenceevent" id="ref-for-dictdef-fenceevent②">FenceEvent</a>'s <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-eventdata" id="ref-for-dom-fenceevent-eventdata">eventData</a> will be sent as a <a data-link-type="dfn" href="https://w3c.github.io/beacon/#beacon" id="ref-for-beacon">beacon</a> to the registered <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url③">URL</a> for that <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-eventtype" id="ref-for-dom-fenceevent-eventtype④">eventType</a>.</p>
   <div class="algorithm" data-algorithm="validate reporting metadata">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="validate-reporting-metadata">validate reporting metadata</dfn>, given an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object⑨">object</a></code> <var>reportingMetadata</var>, run the following steps: 
    <ol>
     <li data-md>
      <p>If <var>reportingMetadata</var> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-is-empty" id="ref-for-map-is-empty①">empty</a>, return true.</p>
     <li data-md>
      <p>If <var>reportingMetadata</var> is not a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#dfn-dictionary" id="ref-for-dfn-dictionary③">dictionary</a>, return false.</p>
     <li data-md>
      <p>For each <var>eventType</var> -> <var>urlString</var> of <var>reportingMetadata</var>, if the result of running <a data-link-type="dfn" href="#get-the-canonical-url-string-if-valid" id="ref-for-get-the-canonical-url-string-if-valid">get the canonical URL string if valid</a> with <var>urlString</var> is undefined, return false.</p>
     <li data-md>
      <p>Return true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="get the canonical URL string if valid">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="get-the-canonical-url-string-if-valid">get the canonical URL string if valid</dfn>, given a <a data-link-type="dfn" href="https://infra.spec.whatwg.org#string" id="ref-for-string⑥">string</a> <var>urlString</var>, run the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>url</var> be the result of running a <a data-link-type="dfn" href="https://url.spec.whatwg.org#concept-url-parser" id="ref-for-concept-url-parser">URL parser</a> on <var>urlString</var>.</p>
     <li data-md>
      <p>If <var>url</var> is not a valid <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url③">URL</a></code>, return undefined.</p>
     <li data-md>
      <p>Otherwise, return the result of running a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer">URL serializer</a> on <var>url</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="register reporting metadata">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="register-reporting-metadata">register reporting metadata</dfn>, given an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object①⓪">object</a></code> <var>reportingMetadata</var> and a "fenced frame config struct" <var>fencedFrameConfigStruct</var>, run the following steps: 
    <ol>
     <li data-md>
      <p>If <var>reportingMetadata</var> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-is-empty" id="ref-for-map-is-empty②">empty</a>, return.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://tc39.es/ecma262/#assert" id="ref-for-assert④">Assert</a> that <var>reportingMetadata</var> is a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#dfn-dictionary" id="ref-for-dfn-dictionary④">dictionary</a>.</p>
     <li data-md>
      <p>Let <var>reportingUrlMap</var> be an <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-is-empty" id="ref-for-map-is-empty③">empty</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org#ordered-map" id="ref-for-ordered-map③">map</a>.</p>
     <li data-md>
      <p>For each <var>eventType</var> -> <var>urlString</var> of <var>reportingMetadata</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>url</var> be the result of running a <a data-link-type="dfn" href="https://url.spec.whatwg.org#concept-url-parser" id="ref-for-concept-url-parser①">URL parser</a> on <var>urlString</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://tc39.es/ecma262/#assert" id="ref-for-assert⑤">Assert</a> that <var>url</var> is a valid <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url④">URL</a></code>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-set" id="ref-for-map-set②">Set</a> <var>reportingUrlMap</var>[<var>eventType</var>] to <var>url</var>.</p>
      </ol>
     <li data-md>
      <p><span class="todo">Store <var>reportingUrlMap</var> inside a "fenced frame reporter" class associated with <var>fencedFrameConfigStruct</var>. Both of these still need to be added to the draft <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element③">Fenced Frame specification</a>.</span></p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="4.1.3" id="budgets"><span class="secno">4.1.3. </span><span class="content">Entropy Budgets</span><a class="self-link" href="#budgets"></a></h4>
   <p>Because <a data-link-type="dfn" href="https://en.wikipedia.org/wiki/Entropy_(information_theory)#bits-of-entropy" id="ref-for-bits-of-entropy">bits of entropy</a> can leak via <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-selecturl" id="ref-for-dom-windowsharedstorage-selecturl④">selectURL()</a></code>, the <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent⑧">user agent</a> will need to maintain budgets to limit these leaks.</p>
   <h5 class="heading settled" data-level="4.1.3.1" id="nav-budget"><span class="secno">4.1.3.1. </span><span class="content">Navigation Entropy Budget</span><a class="self-link" href="#nav-budget"></a></h5>
   <p>If a user activates a <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element④">fenced frame</a> whose <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#fencedframeconfig" id="ref-for-fencedframeconfig①">FencedFrameConfig</a></code> was generated by <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-selecturl" id="ref-for-dom-windowsharedstorage-selecturl⑤">selectURL()</a></code> and thereby initiates a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#top-level-traversable" id="ref-for-top-level-traversable②">top-frame</a> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigate">navigation</a>, this will reveal to the landing page that its <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url④">URL</a> was selected, which is a leak in <a data-link-type="dfn" href="https://en.wikipedia.org/wiki/Entropy_(information_theory)#entropy-bits" id="ref-for-entropy-bits">entropy bits</a> of up to logarithm base 2 of the number of input <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑤">URLs</a> for the call to <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-selecturl" id="ref-for-dom-windowsharedstorage-selecturl⑥">selectURL()</a></code>. To mitigate this, a <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent⑨">user agent</a> will set a per-<a data-link-type="dfn" href="#calling-origin" id="ref-for-calling-origin">calling origin</a> <a data-link-type="dfn" href="#navigation-entropy-allowance" id="ref-for-navigation-entropy-allowance">navigation entropy allowance</a>.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="calling-origin">calling origin</dfn> for <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-selecturl" id="ref-for-dom-windowsharedstorage-selecturl⑦">selectURL()</a></code> is the <a data-link-type="dfn" href="https://url.spec.whatwg.org#concept-url-origin" id="ref-for-concept-url-origin①">origin</a> of an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment" id="ref-for-environment①">environment</a> that makes a <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-selecturl" id="ref-for-dom-windowsharedstorage-selecturl⑧">selectURL()</a></code> call.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="navigation-entropy-allowance">navigation entropy allowance</dfn> is a maximum allowance of <a data-link-type="dfn" href="https://en.wikipedia.org/wiki/Entropy_(information_theory)#entropy-bits" id="ref-for-entropy-bits①">entropy bits</a> that are permitted to leak via <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element⑤">fenced frames</a> initiating <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#top-level-traversable" id="ref-for-top-level-traversable③">top-frame</a> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigate①">navigations</a> during a given <a data-link-type="dfn" href="#navigation-budget-epoch" id="ref-for-navigation-budget-epoch">navigation budget epoch</a> for a given calling <a data-link-type="dfn" href="#calling-origin" id="ref-for-calling-origin①">calling origin</a>. This <a data-link-type="dfn" href="#navigation-entropy-allowance" id="ref-for-navigation-entropy-allowance①">allowance</a> is defined by the <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent①⓪">user agent</a> and is <a data-link-type="dfn" href="#calling-origin" id="ref-for-calling-origin②">calling origin</a>-agnostic.</p>
   <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent①①">user agent</a> will define a fixed predetermined <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration" id="ref-for-dfn-duration①">duration</a> <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="navigation-budget-lifetime">navigation budget lifetime</dfn>.</p>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="navigation-budget-epoch">navigation budget epoch</dfn> is any interval of time whose <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration" id="ref-for-dfn-duration②">duration</a> is the <a data-link-type="dfn" href="#navigation-budget-lifetime" id="ref-for-navigation-budget-lifetime">navigation budget lifetime</a>.</p>
   <p>To keep track of how this <a data-link-type="dfn" href="#navigation-entropy-allowance" id="ref-for-navigation-entropy-allowance②">navigation entropy allowance</a> is used, the <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent①②">user agent</a> uses a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="shared-storage-navigation-budget-table">shared storage navigation budget table</dfn>, which is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org#ordered-map" id="ref-for-ordered-map④">map</a> of <a data-link-type="dfn" href="#calling-origin" id="ref-for-calling-origin③">calling origins</a> to <a data-link-type="dfn" href="#navigation-entropy-ledger" id="ref-for-navigation-entropy-ledger">navigation entropy ledgers</a>.</p>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="navigation-entropy-ledger">navigation entropy ledger</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org#list" id="ref-for-list②">list</a> of <a data-link-type="dfn" href="#bit-debit" id="ref-for-bit-debit">bit debits</a>.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="bit-debit">bit debit</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org#struct" id="ref-for-struct①">struct</a> containing a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-double" id="ref-for-idl-double">double</a></code> <dfn class="dfn-paneled" data-dfn-for="bit debit" data-dfn-type="dfn" data-noexport id="bit-debit-bits">bits</dfn>, indicating a value in <a data-link-type="dfn" href="https://en.wikipedia.org/wiki/Entropy_(information_theory)#entropy-bits" id="ref-for-entropy-bits②">entropy bits</a>, along with a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/hr-time/#dom-domhighrestimestamp" id="ref-for-dom-domhighrestimestamp①">DOMHighResTimeStamp</a></code> <dfn class="dfn-paneled" data-dfn-for="bit debit" data-dfn-type="dfn" data-noexport id="bit-debit-timestamp">timestamp</dfn> (from the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unix-epoch" id="ref-for-dfn-unix-epoch①">Unix Epoch</a>).</p>
   <p><a data-link-type="dfn" href="#bit-debit" id="ref-for-bit-debit①">Bit debits</a> whose <a data-link-type="dfn" href="#bit-debit-timestamp" id="ref-for-bit-debit-timestamp">timestamps</a> precede the start of the current <a data-link-type="dfn" href="#navigation-budget-epoch" id="ref-for-navigation-budget-epoch①">navigation budget epoch</a> are said to be <dfn class="dfn-paneled" data-dfn-for="bit debit" data-dfn-type="dfn" data-noexport id="bit-debit-expired">expired</dfn>.</p>
   <p>When a leak occurs, its value in <a data-link-type="dfn" href="https://en.wikipedia.org/wiki/Entropy_(information_theory)#entropy-bits" id="ref-for-entropy-bits③">entropy bits</a> is calculated and stored for that <a data-link-type="dfn" href="#calling-origin" id="ref-for-calling-origin④">calling origin</a>, along with the current time as a <a data-link-type="dfn" href="#bit-debit-timestamp" id="ref-for-bit-debit-timestamp①">timestamp</a>, together as a <a data-link-type="dfn" href="#bit-debit" id="ref-for-bit-debit②">bit debit</a> in the <a data-link-type="dfn" href="#shared-storage-navigation-budget-table" id="ref-for-shared-storage-navigation-budget-table">shared storage navigation budget table</a>.</p>
   <p>A <a data-link-type="dfn" href="#calling-origin" id="ref-for-calling-origin⑤">calling origin</a>'s <dfn class="dfn-paneled" data-dfn-for="calling origin" data-dfn-type="dfn" data-noexport id="calling-origin-remaining-navigation-budget">remaining navigation budget</dfn> is the <a data-link-type="dfn" href="#navigation-entropy-allowance" id="ref-for-navigation-entropy-allowance③">navigation entropy allowance</a> minus any <a data-link-type="dfn" href="#bit-debit" id="ref-for-bit-debit③">bit debits</a> whose <a data-link-type="dfn" href="#bit-debit-timestamp" id="ref-for-bit-debit-timestamp②">timestamps</a> are within the current <a data-link-type="dfn" href="#navigation-budget-epoch" id="ref-for-navigation-budget-epoch②">navigation budget epoch</a>.</p>
   <p><code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-selecturl" id="ref-for-dom-windowsharedstorage-selecturl⑨">selectURL()</a></code>'s argument "<code>urls</code>" is its <dfn class="dfn-paneled" data-dfn-for="selectURL" data-dfn-type="dfn" data-noexport id="selecturl-input-url-list">input URL list</dfn>.</p>
   <p>When an <a data-link-type="dfn" href="#calling-origin" id="ref-for-calling-origin⑥">calling origin</a> has insufficient <a data-link-type="dfn" href="#calling-origin-remaining-navigation-budget" id="ref-for-calling-origin-remaining-navigation-budget">remaining navigation budget</a>, <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-selecturl" id="ref-for-dom-windowsharedstorage-selecturl①⓪">selectURL()</a></code> will return a <code class="idl"><a data-link-type="idl" href="#typedefdef-sharedstorageresponse" id="ref-for-typedefdef-sharedstorageresponse②">SharedStorageResponse</a></code> (i.e. either a <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#fencedframeconfig" id="ref-for-fencedframeconfig②">FencedFrameConfig</a></code> or an opaque <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑥">URL</a>) for the <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageurlwithmetadata-url" id="ref-for-dom-sharedstorageurlwithmetadata-url">url</a></code> in the <code class="idl"><a data-link-type="idl" href="#dictdef-sharedstorageurlwithmetadata" id="ref-for-dictdef-sharedstorageurlwithmetadata⑥">SharedStorageUrlWithMetadata</a></code> at the <a data-link-type="dfn" href="#default-index" id="ref-for-default-index">default index</a> in its <a data-link-type="dfn" href="#selecturl-input-url-list" id="ref-for-selecturl-input-url-list">input URL list</a>.</p>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="default-index">default index</dfn> for a call to <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-selecturl" id="ref-for-dom-windowsharedstorage-selecturl①①">selectURL()</a></code> is implementation-defined in such a way that it is independent from the result of the associated <code class="idl"><a data-link-type="idl" href="#sharedstorageselecturloperation" id="ref-for-sharedstorageselecturloperation②">SharedStorageSelectURLOperation</a></code>'s "<code>run</code>" method.</p>
   <div class="example" id="example-ce30be1e">
    <a class="self-link" href="#example-ce30be1e"></a> The <a data-link-type="dfn" href="#default-index" id="ref-for-default-index①">default index</a> could be defined to be 0. 
    <p>In this case, whenever the <code class="idl"><a data-link-type="idl" href="#sharedstorageselecturloperation" id="ref-for-sharedstorageselecturloperation③">SharedStorageSelectURLOperation</a></code>'s "<code>run</code>" method encounters an error, or whenever there is insufficient <a data-link-type="dfn" href="#calling-origin-remaining-navigation-budget" id="ref-for-calling-origin-remaining-navigation-budget①">remaining navigation budget</a>, the "<code>run</code>" method would return 0, and hence <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-selecturl" id="ref-for-dom-windowsharedstorage-selecturl①②">selectURL()</a></code> would return a <code class="idl"><a data-link-type="idl" href="#typedefdef-sharedstorageresponse" id="ref-for-typedefdef-sharedstorageresponse③">SharedStorageResponse</a></code> for the first <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageurlwithmetadata-url" id="ref-for-dom-sharedstorageurlwithmetadata-url①">url</a></code> in its <a data-link-type="dfn" href="#selecturl-input-url-list" id="ref-for-selecturl-input-url-list①">input URL list</a>.</p>
   </div>
   <div class="example" id="example-fba23a56">
    <a class="self-link" href="#example-fba23a56"></a> The <a data-link-type="dfn" href="#default-index" id="ref-for-default-index②">default index</a> could be defined to be <a data-link-type="dfn" href="#selecturl-input-url-list" id="ref-for-selecturl-input-url-list②">input URL list</a>'s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size">size</a> minus 1. 
    <p>In this case, whenever the <code class="idl"><a data-link-type="idl" href="#sharedstorageselecturloperation" id="ref-for-sharedstorageselecturloperation④">SharedStorageSelectURLOperation</a></code>'s "<code>run</code>" method encounters an error, or whenever there is insufficient <a data-link-type="dfn" href="#calling-origin-remaining-navigation-budget" id="ref-for-calling-origin-remaining-navigation-budget②">remaining navigation budget</a>, <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-selecturl" id="ref-for-dom-windowsharedstorage-selecturl①③">selectURL()</a></code> would return a <code class="idl"><a data-link-type="idl" href="#typedefdef-sharedstorageresponse" id="ref-for-typedefdef-sharedstorageresponse④">SharedStorageResponse</a></code> for the last <code class="idl"><a data-link-type="idl" href="#dom-sharedstorageurlwithmetadata-url" id="ref-for-dom-sharedstorageurlwithmetadata-url②">url</a></code> in its <a data-link-type="dfn" href="#selecturl-input-url-list" id="ref-for-selecturl-input-url-list③">input URL list</a>.</p>
   </div>
   <div class="algorithm" data-algorithm="determine remaining navigation budget">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="determine-remaining-navigation-budget">determine remaining navigation budget</dfn>, given a calling <a data-link-type="dfn" href="#calling-origin" id="ref-for-calling-origin⑦">calling origin</a> <var>origin</var>, run the following steps: 
    <ol>
     <li data-md>
      <p>If <var>origin</var> is <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-opaque-origin" id="ref-for-concept-opaque-origin①">opaque</a>, return undefined.</p>
     <li data-md>
      <p>Let <var>maxBits</var> be the <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent①③">user agent</a>'s <a data-link-type="dfn" href="#navigation-entropy-allowance" id="ref-for-navigation-entropy-allowance④">navigation entropy allowance</a>.</p>
     <li data-md>
      <p>If the <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent①④">user agent</a>'s <a data-link-type="dfn" href="#shared-storage-navigation-budget-table" id="ref-for-shared-storage-navigation-budget-table①">shared storage navigation budget table</a> does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-exists" id="ref-for-map-exists②">contain</a> <var>origin</var>, then return <var>maxBits</var>.</p>
     <li data-md>
      <p>Otherwise, let <var>ledger</var> be <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent①⑤">user agent</a>'s <a data-link-type="dfn" href="#shared-storage-navigation-budget-table" id="ref-for-shared-storage-navigation-budget-table②">shared storage navigation budget table</a>[<var>origin</var>].</p>
     <li data-md>
      <p>Let <var>debitSum</var> be 0.</p>
     <li data-md>
      <p>For each <a data-link-type="dfn" href="https://infra.spec.whatwg.org#list-item" id="ref-for-list-item">item</a> <var>bitDebit</var> in <var>ledger</var>, do the following steps:</p>
      <ol>
       <li data-md>
        <p>Let <var>debit</var> be <var>bitDebit</var>’s <a data-link-type="dfn" href="#bit-debit-bits" id="ref-for-bit-debit-bits">bits</a>.</p>
       <li data-md>
        <p>If the result of running <a data-link-type="dfn" href="#check-whether-a-bit-debit-is-expired" id="ref-for-check-whether-a-bit-debit-is-expired">check whether a bit debit is expired</a> with <var>bitDebit</var> is false, then increment <var>debitSum</var> by <var>debit</var>.</p>
      </ol>
     <li data-md>
      <p>Return <var>maxBits</var> minus <var>debitSum</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="check whether a bit debit is expired">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="check-whether-a-bit-debit-is-expired">check whether a bit debit is expired</dfn>, given a <a data-link-type="dfn" href="#bit-debit" id="ref-for-bit-debit④">bit debit</a> <var>bitDebit</var>, run the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>epochLength</var> be the <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent①⑥">user agent</a>'s <a data-link-type="dfn" href="#navigation-budget-lifetime" id="ref-for-navigation-budget-lifetime①">navigation budget lifetime</a>.</p>
     <li data-md>
      <p>Let <var>currentTime</var> be the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-current-wall-time" id="ref-for-dfn-current-wall-time②">current wall time</a>.</p>
     <li data-md>
      <p>Let <var>threshold</var> be <var>currentTime</var> minus <var>epochLength</var>.</p>
     <li data-md>
      <p>If <var>bitDebit</var>’s <a data-link-type="dfn" href="#bit-debit-timestamp" id="ref-for-bit-debit-timestamp③">timestamp</a> is less than <var>threshold</var>, return true.</p>
     <li data-md>
      <p>Otherwise, return false.</p>
    </ol>
   </div>
   <p>A <a data-link-type="dfn" href="#bit-debit" id="ref-for-bit-debit⑤">bit debit</a> will need to be <a data-link-type="dfn" href="#charge-shared-storage-navigation-budget" id="ref-for-charge-shared-storage-navigation-budget">charged</a> to the <a data-link-type="dfn" href="#shared-storage-navigation-budget-table" id="ref-for-shared-storage-navigation-budget-table③">shared storage navigation budget table</a> for each <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#top-level-traversable" id="ref-for-top-level-traversable④">top-frame</a> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigate②">navigation</a> initiated by a <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element⑥">fenced frame</a> whose <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#fencedframeconfig" id="ref-for-fencedframeconfig③">FencedFrameConfig</a></code> was generated via <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-selecturl" id="ref-for-dom-windowsharedstorage-selecturl①④">selectURL()</a></code>, as this can leak cross-site data. Since the <a data-link-type="dfn" href="#bit-debit-bits" id="ref-for-bit-debit-bits①">bits</a> to charge is calculated during the call to <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-selecturl" id="ref-for-dom-windowsharedstorage-selecturl①⑤">selectURL()</a></code> but only actually recorded in the <a data-link-type="dfn" href="#shared-storage-navigation-budget-table" id="ref-for-shared-storage-navigation-budget-table④">shared storage navigation budget table</a> if and when the resulting fenced frame initiates a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#top-level-traversable" id="ref-for-top-level-traversable⑤">top-frame</a> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#beginning-navigation" id="ref-for-beginning-navigation">navigation</a>, the <a data-link-type="dfn" href="#bit-debit-bits" id="ref-for-bit-debit-bits②">bits</a> must be stored as a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="pending-shared-storage-budget-debit">pending shared storage budget debit</dfn> in the corresponding <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#fencedframeconfig" id="ref-for-fencedframeconfig④">FencedFrameConfig</a></code> until this time.</p>
   <p>Between <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#beginning-navigation" id="ref-for-beginning-navigation①">beginning navigation</a> and <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#ending-navigation" id="ref-for-ending-navigation">ending navigation</a>, a <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent①⑦">user agent</a> will perform the <a data-link-type="dfn" href="#charge-shared-storage-navigation-budget" id="ref-for-charge-shared-storage-navigation-budget①">charge shared storage navigation budget</a> algorithm.</p>
   <p class="issue" id="issue-7ff511a8"><a class="self-link" href="#issue-7ff511a8"></a> The "fenced frame config struct" and its boolean <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="has-navigated">has navigated</dfn> have not yet been added to the draft <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element⑦">Fenced Frame</a> specification. Some form of them will be added, although their names are subject to bikeshedding. <span class="todo">Fix the names when they are added.</span></p>
   <div class="algorithm" data-algorithm="charge shared storage navigation budget">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="charge-shared-storage-navigation-budget">charge shared storage navigation budget</dfn> during a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#beginning-navigation" id="ref-for-beginning-navigation②">navigation</a> with <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#navigable" id="ref-for-navigable">navigable</a> <var>navigable</var> and <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document">Document</a></code> <var>sourceDocument</var>, run the following steps: 
    <ol>
     <li data-md>
      <p>If <var>navigable</var> is not a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-traversable" id="ref-for-nav-traversable">traversable navigable</a>, return.</p>
     <li data-md>
      <p>Let <var>node</var> be <var>sourceDocument</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#node-navigable" id="ref-for-node-navigable">node navigable</a>.</p>
     <li data-md>
      <p>While <var>node</var> is not null:</p>
      <ol>
       <li data-md>
        <p>If <var>node</var> has a "fenced frame config struct":</p>
        <ol>
         <li data-md>
          <p>Let <var>origin</var> be <var>node</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#active-document" id="ref-for-active-document">active document</a>'s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document-origin" id="ref-for-concept-document-origin">origin</a>.</p>
         <li data-md>
          <p>Let <var>pendingBits</var> be <var>node</var>’s "fenced frame config struct"'s <a data-link-type="dfn" href="#pending-shared-storage-budget-debit" id="ref-for-pending-shared-storage-budget-debit">pending shared storage budget debit</a>.</p>
         <li data-md>
          <p>If <var>pendingBits</var> is greater than 0 and if "fenced frame config struct"'s <a data-link-type="dfn" href="#has-navigated" id="ref-for-has-navigated">has navigated</a> is false, run the following steps:</p>
          <ol>
           <li data-md>
            <p>Let <var>ledger</var> be <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent①⑧">user agent</a>'s <a data-link-type="dfn" href="#shared-storage-navigation-budget-table" id="ref-for-shared-storage-navigation-budget-table⑤">shared storage navigation budget table</a>[<var>origin</var>].</p>
           <li data-md>
            <p>Let <var>bitDebit</var> be a new <a data-link-type="dfn" href="#bit-debit" id="ref-for-bit-debit⑥">bit debit</a>.</p>
           <li data-md>
            <p>Set <var>bitDebit</var>’s <a data-link-type="dfn" href="#bit-debit-bits" id="ref-for-bit-debit-bits③">bits</a> to <var>pendingBits</var>.</p>
           <li data-md>
            <p>Let <var>currentTime</var> be the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-current-wall-time" id="ref-for-dfn-current-wall-time③">current wall time</a>.</p>
           <li data-md>
            <p>Set <var>bitDebit</var>’s <a data-link-type="dfn" href="#bit-debit-timestamp" id="ref-for-bit-debit-timestamp④">timestamp</a> to <var>currentTime</var>.</p>
           <li data-md>
            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org#list-append" id="ref-for-list-append②">Append</a> <var>bitDebit</var> to <var>ledger</var>.</p>
           <li data-md>
            <p>Set <var>node</var>’s "fenced frame config struct"'s <a data-link-type="dfn" href="#has-navigated" id="ref-for-has-navigated①">has navigated</a> to true.</p>
          </ol>
        </ol>
       <li data-md>
        <p>Set <var>node</var> to <var>node</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#nav-parent" id="ref-for-nav-parent">parent</a>.</p>
      </ol>
    </ol>
   </div>
   <h5 class="heading settled" data-level="4.1.3.2" id="report-budget"><span class="secno">4.1.3.2. </span><span class="content">Reporting Entropy Budget</span><a class="self-link" href="#report-budget"></a></h5>
   <p>Likewise, each time a call to <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#dom-fence-reportevent" id="ref-for-dom-fence-reportevent①">fence.reportEvent()</a> from a <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element⑧">fenced frame</a> originating via <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-selecturl" id="ref-for-dom-windowsharedstorage-selecturl①⑥">selectURL()</a></code> whose <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-destination" id="ref-for-dom-fenceevent-destination①">destination</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain①">contains</a> "<code>shared-storage-select-url</code>" and whose <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-eventtype" id="ref-for-dom-fenceevent-eventtype⑤">eventType</a> is triggered, there is a leak of up to logarithm base 2 of the number of main input <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑦">URLs</a> <a data-link-type="dfn" href="https://en.wikipedia.org/wiki/Entropy_(information_theory)#entropy-bits" id="ref-for-entropy-bits④">entropy bits</a>. The <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent①⑨">user agent</a> will need to set a per-<a data-link-type="dfn" href="#page-load" id="ref-for-page-load">page load</a> <a data-link-type="dfn" href="#reporting-entropy-allowance" id="ref-for-reporting-entropy-allowance">reporting entropy allowance</a> to restrict the information leaked, with <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="page-load">page load</dfn> referring to a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#top-level-traversable" id="ref-for-top-level-traversable⑥">top-level traversable</a>'s lifecycle.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="reporting-entropy-allowance">reporting entropy allowance</dfn> is a maximum allowance of <a data-link-type="dfn" href="https://en.wikipedia.org/wiki/Entropy_(information_theory)#entropy-bits" id="ref-for-entropy-bits⑤">entropy bits</a> that are permitted to leak via <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#dom-fence-reportevent" id="ref-for-dom-fence-reportevent②">fence.reportEvent()</a> during a given page load. This <a data-link-type="dfn" href="#reporting-entropy-allowance" id="ref-for-reporting-entropy-allowance①">allowance</a> is defined by the <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent②⓪">user agent</a>.</p>
   <p>Each <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#top-level-traversable" id="ref-for-top-level-traversable⑦">top-level traversable</a> will have a new <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-double" id="ref-for-idl-double①">double</a></code> <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="shared-storage-reporting-budget">shared storage reporting budget</dfn> associated to it which will be initialized with the value of <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent②①">user agent</a>'s <a data-link-type="dfn" href="#reporting-entropy-allowance" id="ref-for-reporting-entropy-allowance②">reporting entropy allowance</a> upon <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#top-level-traversable" id="ref-for-top-level-traversable⑧">top-level traversable</a>'s creation.</p>
   <p>When <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#dom-fence-reportevent" id="ref-for-dom-fence-reportevent③">fence.reportEvent()</a> is called with a <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#dom-fenceevent-destination" id="ref-for-dom-fenceevent-destination②">destination</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain②">containing</a> "<code>shared-storage-select-url</code>", it will be necessary to <a data-link-type="dfn" href="#charge-shared-storage-reporting-budget" id="ref-for-charge-shared-storage-reporting-budget">charge shared storage reporting budget</a> as below.</p>
   <div class="algorithm" data-algorithm="determine reporting budget to charge">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="determine-reporting-budget-to-charge">determine reporting budget to charge</dfn>, given a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①">Document</a></code> <var>sourceDocument</var>, run the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>debitSum</var> be 0.</p>
     <li data-md>
      <p>Let <var>node</var> be <var>sourceDocument</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#node-navigable" id="ref-for-node-navigable①">node navigable</a>.</p>
     <li data-md>
      <p>While <var>node</var> is not null:</p>
      <ol>
       <li data-md>
        <p>If <var>node</var> has a "fenced frame config struct":</p>
        <ol>
         <li data-md>
          <p>Let <var>pendingBits</var> be <var>node</var>’s "fenced frame config struct"'s <a data-link-type="dfn" href="#pending-shared-storage-budget-debit" id="ref-for-pending-shared-storage-budget-debit①">pending shared storage budget debit</a>.</p>
         <li data-md>
          <p>If <var>pendingBits</var> is greater than 0 and if "fenced frame config struct"'s <a data-link-type="dfn" href="#has-reported" id="ref-for-has-reported">has reported</a> is false, increment <var>debitSum</var> by <var>pendingBits</var></p>
        </ol>
       <li data-md>
        <p>Set <var>node</var> to <var>node</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#nav-parent" id="ref-for-nav-parent①">parent</a>.</p>
      </ol>
     <li data-md>
      <p>Return <var>debitSum</var>.</p>
    </ol>
   </div>
   <p class="issue" id="issue-c8b219be"><a class="self-link" href="#issue-c8b219be"></a> The "fenced frame config struct" and its boolean <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="has-reported">has reported</dfn> have not yet been added to the draft <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element⑨">Fenced Frame</a> specification. Some form of them will be added, although their names are subject to bikeshedding. <span class="todo">Fix the names when they are added.</span></p>
   <div class="algorithm" data-algorithm="charge shared storage reporting budget">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="charge-shared-storage-reporting-budget">charge shared storage reporting budget</dfn> given a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②">Document</a></code> <var>sourceDocument</var>, run the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>toCharge</var> be the result of running <a data-link-type="dfn" href="#determine-reporting-budget-to-charge" id="ref-for-determine-reporting-budget-to-charge">determine reporting budget to charge</a> with <var>sourceDocument</var>.</p>
     <li data-md>
      <p>Let <var>node</var> be <var>sourceDocument</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#node-navigable" id="ref-for-node-navigable②">node navigable</a>.</p>
     <li data-md>
      <p>Let <var>topNode</var> be the result of running <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#nav-top" id="ref-for-nav-top">get the top-level traversable</a> for <var>node</var>.</p>
     <li data-md>
      <p>If <var>topNode</var>’s <a data-link-type="dfn" href="#shared-storage-reporting-budget" id="ref-for-shared-storage-reporting-budget">shared storage reporting budget</a> is less than <var>toCharge</var>, return false.</p>
     <li data-md>
      <p>While <var>node</var> is not null:</p>
      <ol>
       <li data-md>
        <p>If <var>node</var> has a "fenced frame config struct" and if <var>node</var>’s "fenced frame config struct"'s <a data-link-type="dfn" href="#pending-shared-storage-budget-debit" id="ref-for-pending-shared-storage-budget-debit②">pending shared storage budget debit</a> is greater than 0, set <var>node</var>’s "fenced frame config struct"'s <a data-link-type="dfn" href="#has-reported" id="ref-for-has-reported①">has reported</a> to true.</p>
       <li data-md>
        <p>Set <var>node</var> to <var>node</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#nav-parent" id="ref-for-nav-parent②">parent</a>.</p>
      </ol>
     <li data-md>
      <p>Decrement <var>topNode</var>’s <a data-link-type="dfn" href="#shared-storage-reporting-budget" id="ref-for-shared-storage-reporting-budget①">shared storage reporting budget</a> by <var>toCharge</var>.</p>
     <li data-md>
      <p>Return true.</p>
    </ol>
   </div>
   <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent②②">user agent</a> may wish to set a timer to periodically <a data-link-type="dfn" href="#purge-expired-bit-debits-from-all-navigation-entropy-ledgers" id="ref-for-purge-expired-bit-debits-from-all-navigation-entropy-ledgers">purge expired bit debits from all navigation entropy ledgers</a>, as the <a data-link-type="dfn" href="#bit-debit-expired" id="ref-for-bit-debit-expired">expired</a> <a data-link-type="dfn" href="#bit-debit" id="ref-for-bit-debit⑦">bit debits</a> will no longer be needed.</p>
   <div class="algorithm" data-algorithm="purge expired bit debits from all navigation entropy ledgers">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="purge-expired-bit-debits-from-all-navigation-entropy-ledgers">purge expired bit debits from all navigation entropy ledgers</dfn>, run the following steps: 
    <ol>
     <li data-md>
      <p>For each <var>origin</var> -> <var>ledger</var> of <a data-link-type="dfn" href="https://infra.spec.whatwg.org#user-agent" id="ref-for-user-agent②③">user agent</a>'s <a data-link-type="dfn" href="#shared-storage-navigation-budget-table" id="ref-for-shared-storage-navigation-budget-table⑥">shared storage navigation budget table</a>:</p>
      <ol>
       <li data-md>
        <p>For each <var>bitDebit</var> in <var>ledger</var>, if the result of running <a data-link-type="dfn" href="#check-whether-a-bit-debit-is-expired" id="ref-for-check-whether-a-bit-debit-is-expired①">check whether a bit debit is expired</a> with <var>bitDebit</var> is true, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove">remove</a> <var>bitDebit</var> from <var>ledger</var>.</p>
      </ol>
    </ol>
   </div>
   <h4 class="heading settled" data-level="4.1.4" id="run-op"><span class="secno">4.1.4. </span><span class="content">Run Operation Methods</span><a class="self-link" href="#run-op"></a></h4>
   <div class="algorithm" data-algorithm="run(name, options)" data-algorithm-for="WindowSharedStorage">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WindowSharedStorage" data-dfn-type="method" data-export data-lt="run(name, options)|run(name)" id="dom-windowsharedstorage-run"><code>run(<var>name</var>, <var>options</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise①②">promise</a>.</p>
     <li data-md>
      <p>If <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule⑦">addModule()</a></code> has not yet been called, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑥">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①②">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>outsideSettings</var> be <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-worklet" id="ref-for-dom-windowsharedstorage-worklet①">worklet</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object⑤">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>agent</var> be the result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#obtain-a-worklet-agent" id="ref-for-obtain-a-worklet-agent">obtaining a worklet agent</a> given <var>outsideSettings</var>.</p>
     <li data-md>
      <p>Run the following steps in <var>agent</var>:</p>
      <ol>
       <li data-md>
        <p>If <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-worklet" id="ref-for-dom-windowsharedstorage-worklet②">worklet</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#module-map" id="ref-for-module-map①">module map</a> is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-is-empty" id="ref-for-map-is-empty④">empty</a>:</p>
        <ol>
         <li data-md>
          <p>Let <var>operationMap</var> be this <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope⑥">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-operation-map" id="ref-for-sharedstorageworkletglobalscope-operation-map①">operation map</a>.</p>
         <li data-md>
          <p>If <var>operationMap</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-exists" id="ref-for-map-exists③">contains</a> <var>name</var>:</p>
          <ol>
           <li data-md>
            <p>Let <var>operation</var> be <var>operationMap</var>[<var>name</var>].</p>
           <li data-md>
            <p>If <var>options</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-exists" id="ref-for-map-exists④">contains</a> <var>data</var>:</p>
            <ol>
             <li data-md>
              <p>Let <var>argumentsList</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org#list" id="ref-for-list③">list</a>.</p>
             <li data-md>
              <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org#list-append" id="ref-for-list-append③">Append</a> <var>data</var> to <var>argumentsList</var>.</p>
             <li data-md>
              <p><a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-call" id="ref-for-sec-call">Call</a> <var>operation</var> with <var>argumentsList</var>.</p>
            </ol>
           <li data-md>
            <p>Otherwise, <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-call" id="ref-for-sec-call①">call</a> <var>operation</var> without any arguments list.</p>
          </ol>
        </ol>
       <li data-md>
        <p>Resolve <var>promise</var> with undefined.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
     <li data-md>
      <p>If <var>options</var>["<code>keepAlive</code>"] is false, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#upon-fulfillment" id="ref-for-upon-fulfillment">upon fulfillment</a> of <var>promise</var> or <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#upon-rejection" id="ref-for-upon-rejection">upon rejection</a> of <var>promise</var>, run <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#terminate-a-worklet-global-scope" id="ref-for-terminate-a-worklet-global-scope">terminate a worklet global scope</a> with the associated <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope⑦">SharedStorageWorkletGlobalScope</a></code>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="selectURL(name, urls, options)" data-algorithm-for="WindowSharedStorage">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WindowSharedStorage" data-dfn-type="method" data-export data-lt="selectURL(name, urls, options)|selectURL(name, urls)" id="dom-windowsharedstorage-selecturl"><code>selectURL(<var>name</var>, <var>urls</var>, <var>options</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>resultPromise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise①③">promise</a>.</p>
     <li data-md>
      <p>If <var>urls</var> is empty or exceeds the maximum allowed length, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑦">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①③">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>urlList</var> be an empty <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/input.html#dom-input-list" id="ref-for-dom-input-list">list</a></code>.</p>
     <li data-md>
      <p>For each <var>urlWithMetadata</var> in <var>urls</var>:</p>
      <ol>
       <li data-md>
        <p>If <var>urlWithMetadata</var> has no field "<code>url</code>", return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑧">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①④">TypeError</a></code>.</p>
       <li data-md>
        <p>Otherwise, let <var>urlString</var> be <var>urlWithMetadata</var>["<code>url</code>"].</p>
       <li data-md>
        <p>Let <var>serializedUrl</var> be the result of running <a data-link-type="dfn" href="#get-the-canonical-url-string-if-valid" id="ref-for-get-the-canonical-url-string-if-valid①">get the canonical URL string if valid</a> with <var>urlString</var>.</p>
       <li data-md>
        <p>If <var>serializedUrl</var> is undefined, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑨">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①⑤">TypeError</a></code>.</p>
       <li data-md>
        <p>Otherwise, <a data-link-type="dfn" href="https://infra.spec.whatwg.org#list-append" id="ref-for-list-append④">append</a> <var>serializedUrl</var> to <var>urlList</var>.</p>
       <li data-md>
        <p>If <var>urlWithMetadata</var> has field "<code>reportingMetadata</code>":</p>
        <ol>
         <li data-md>
          <p>Let <var>reportingMetadata</var> be <var>urlWithMetadata</var>["<code>reportingMetadata</code>"].</p>
         <li data-md>
          <p>If the result of running <a data-link-type="dfn" href="#validate-reporting-metadata" id="ref-for-validate-reporting-metadata">validate reporting metadata</a> with <var>reportingMetadata</var> is false, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①⓪">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①⑥">TypeError</a></code>.</p>
        </ol>
      </ol>
     <li data-md>
      <p>If <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule" id="ref-for-dom-worklet-addmodule⑧">addModule()</a></code> has not yet been called, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①①">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①⑦">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>fencedFrameConfigStruct</var> be a "fenced frame config struct". <span class="todo">Add correct struct name as well as linking when Fenced Frame API updates their draft spec to include it.</span></p>
    </ol>
    <p class="issue" id="issue-0ddd316f"><a class="self-link" href="#issue-0ddd316f"></a> The "fenced frame config struct" and the following "obtain a <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#fencedframeconfig" id="ref-for-fencedframeconfig⑤">FencedFrameConfig</a></code> from a fenced frame config struct" algorithm have not yet been added to the draft <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element①⓪">Fenced Frame</a> specification. Some form of them will be added, although their names are subject to bikeshedding.</p>
    <ol>
     <li data-md>
      <p>If <var>options</var>["<code>resolveToConfig</code>"] is true, resolve <var>resultPromise</var> with the result of running "obtain a <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#fencedframeconfig" id="ref-for-fencedframeconfig⑥">FencedFrameConfig</a></code> from a fenced frame config struct" with <var>fencedFrameConfigStruct</var>. <span class="todo">Add correct struct and algorithms names as well as linking when Fenced Frame API updates their draft spec to include it.</span></p>
     <li data-md>
      <p>Othewise, resolve <var>resultPromise</var> to <var>fencedFrameConfigStruct</var>’s "urn uuid". <span class="todo">Add correct struct name and urn:uuid name as well as linking when Fenced Frame API updates their draft spec to include it.</span></p>
     <li data-md>
      <p>Let <var>indexPromise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise①④">promise</a>.</p>
     <li data-md>
      <p>Let <var>outsideSettings</var> be <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-worklet" id="ref-for-dom-windowsharedstorage-worklet③">worklet</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object⑥">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>agent</var> be the result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#obtain-a-worklet-agent" id="ref-for-obtain-a-worklet-agent①">obtaining a worklet agent</a> given <var>outsideSettings</var>.</p>
     <li data-md>
      <p>Run the following steps in <var>agent</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>index</var> be <a data-link-type="dfn" href="#default-index" id="ref-for-default-index③">default index</a>.</p>
       <li data-md>
        <p>If <code class="idl"><a data-link-type="idl" href="#dom-windowsharedstorage-worklet" id="ref-for-dom-windowsharedstorage-worklet④">worklet</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#module-map" id="ref-for-module-map②">module map</a> is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-is-empty" id="ref-for-map-is-empty⑤">empty</a>:</p>
        <ol>
         <li data-md>
          <p>Let <var>operationMap</var> be the associated <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope⑧">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-operation-map" id="ref-for-sharedstorageworkletglobalscope-operation-map②">operation map</a>.</p>
         <li data-md>
          <p>If <var>operationMap</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-exists" id="ref-for-map-exists⑤">contains</a> <var>name</var>:</p>
          <ol>
           <li data-md>
            <p>Let <var>operation</var> be <var>operationMap</var>[<var>name</var>].</p>
           <li data-md>
            <p>Let <var>argumentsList</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org#list" id="ref-for-list④">list</a>.</p>
           <li data-md>
            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org#list-append" id="ref-for-list-append⑤">Append</a> <var>urlList</var> to <var>argumentsList</var>.</p>
           <li data-md>
            <p>If <var>options</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org#map-exists" id="ref-for-map-exists⑥">contains</a> <var>data</var>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org#list-append" id="ref-for-list-append⑥">append</a> <var>data</var> to <var>argumentsList</var>.</p>
           <li data-md>
            <p>Let <var>operationResult</var> be the result of running <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-call" id="ref-for-sec-call②">Call</a> on <var>operation</var> with <var>argumentsList</var>.</p>
           <li data-md>
            <p>If <var>operationResult</var> has any error(s), then reject <var>indexPromise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①⑧">TypeError</a></code>.</p>
           <li data-md>
            <p>Otherwise:</p>
            <ol>
             <li data-md>
              <p>Set <var>index</var> to the result of casting <var>operationResult</var> to an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long">unsigned long</a></code>. If this throws an exception, catch it and reject <var>indexPromise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①⑨">TypeError</a></code>.</p>
             <li data-md>
              <p>Otherwise, if <var>index</var> is greater than <var>urlList</var>.<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size①">size</a>, then reject <var>indexPromise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②⓪">TypeError</a></code>.</p>
            </ol>
          </ol>
        </ol>
       <li data-md>
        <p>If <var>indexPromise</var> has not been rejected, resolve <var>indexPromise</var> with <var>index</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org#upon-fulfillment" id="ref-for-upon-fulfillment①">Upon fulfillment</a> of <var>indexPromise</var>, perform the following steps:</p>
        <ol>
         <li data-md>
          <p>Let <var>resultIndex</var> be the numerical value of <var>indexPromise</var>.</p>
         <li data-md>
          <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#windowsharedstorage" id="ref-for-windowsharedstorage⑧">WindowSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window⑧">Window</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#window-bc" id="ref-for-window-bc④">browsing context</a>.</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://tc39.es/ecma262/#assert" id="ref-for-assert⑥">Assert</a> that <var>context</var> is not null.</p>
         <li data-md>
          <p>Let <var>origin</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#active-document" id="ref-for-active-document①">active document</a>'s <a data-link-type="dfn" href="https://url.spec.whatwg.org#concept-url-origin" id="ref-for-concept-url-origin②">origin</a>.</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://tc39.es/ecma262/#assert" id="ref-for-assert⑦">Assert</a> that <var>origin</var> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-opaque-origin" id="ref-for-concept-opaque-origin②">opaque</a>.</p>
         <li data-md>
          <p>Let <var>remainingBudget</var> be the result of running <a data-link-type="dfn" href="#determine-remaining-navigation-budget" id="ref-for-determine-remaining-navigation-budget">determine remaining navigation budget</a> with <var>origin</var>.</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://tc39.es/ecma262/#assert" id="ref-for-assert⑧">Assert</a> that <var>remainingBudget</var> is not undefined.</p>
         <li data-md>
          <p>Let <var>listSize</var> be <var>urlList</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size②">size</a>.</p>
         <li data-md>
          <p>Let <var>pendingBits</var> be the logarithm base 2 of <var>listSize</var>.</p>
         <li data-md>
          <p>If <var>pendingBits</var> is greather than <var>remainingBudget</var>, set <var>resultIndex</var> to <a data-link-type="dfn" href="#default-index" id="ref-for-default-index④">default index</a>.</p>
         <li data-md>
          <p>Set <var>fencedFrameConfigStruct</var>’s <a data-link-type="dfn" href="#pending-shared-storage-budget-debit" id="ref-for-pending-shared-storage-budget-debit③">pending shared storage budget debit</a> to <var>pendingBits</var>.</p>
         <li data-md>
          <p>Set <var>fencedFrameConfigStruct</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑧">url</a> to <var>urlList</var>[<var>resultIndex</var>].</p>
         <li data-md>
          <p>Let <var>resultURLWithMetadata</var> be <var>urls</var>[<var>resultIndex</var>].</p>
         <li data-md>
          <p>If <var>resultURLWithMetadata</var> has field "<code>reportingMetadata</code>", run <a data-link-type="dfn" href="#register-reporting-metadata" id="ref-for-register-reporting-metadata②">register reporting metadata</a> with <var>resultURLWithMetadata</var>["<code>reportingMetadata</code>"].</p>
        </ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org#upon-rejection" id="ref-for-upon-rejection①">Upon rejection</a> of <var>indexPromise</var>, set <var>fencedFrameConfigStruct</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑨">url</a> to <var>urlList</var>[<a data-link-type="dfn" href="#default-index" id="ref-for-default-index⑤">default index</a>].</p>
      </ol>
     <li data-md>
      <p>Return <var>resultPromise</var>.</p>
     <li data-md>
      <p>If <var>options</var>["<code>keepAlive</code>"] is false, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#upon-fulfillment" id="ref-for-upon-fulfillment②">upon fulfillment</a> of <var>resultPromise</var> or <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#upon-rejection" id="ref-for-upon-rejection②">upon rejection</a> of <var>resultPromise</var>, run <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/worklets.html#terminate-a-worklet-global-scope" id="ref-for-terminate-a-worklet-global-scope①">terminate a worklet global scope</a> with the associated <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope⑨">SharedStorageWorkletGlobalScope</a></code>.</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="4.2" id="worklet-shared-storage"><span class="secno">4.2. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage②">WorkletSharedStorage</a></code> interface</span><a class="self-link" href="#worklet-shared-storage"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage③">WorkletSharedStorage</a></code> interface is as follows.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed⑦"><c- g>Exposed</c-></a>=(<c- n>SharedStorageWorklet</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="workletsharedstorage"><code><c- g>WorkletSharedStorage</c-></code></dfn> : <a data-link-type="idl-name" href="#sharedstorage" id="ref-for-sharedstorage④"><c- n>SharedStorage</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①⑤"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑧"><c- b>DOMString</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-workletsharedstorage-get" id="ref-for-dom-workletsharedstorage-get"><c- g>get</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑨"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="WorkletSharedStorage/get(key)" data-dfn-type="argument" data-export id="dom-workletsharedstorage-get-key-key"><code><c- g>key</c-></code><a class="self-link" href="#dom-workletsharedstorage-get-key-key"></a></dfn>);
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①⑥"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long①"><c- b>unsigned</c-> <c- b>long</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-workletsharedstorage-length" id="ref-for-dom-workletsharedstorage-length"><c- g>length</c-></a>();
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①⑦"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double" id="ref-for-idl-double②"><c- b>double</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-workletsharedstorage-remainingbudget" id="ref-for-dom-workletsharedstorage-remainingbudget"><c- g>remainingBudget</c-></a>();

  <c- b>async</c-> <c- b>iterable</c->&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①⓪"><c- b>DOMString</c-></a>, <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①①"><c- b>DOMString</c-></a>>;
};</pre>
   <h4 class="heading settled" data-level="4.2.1" id="worklet-setter"><span class="secno">4.2.1. </span><span class="content">Worklet Setter/Deleter Methods</span><a class="self-link" href="#worklet-setter"></a></h4>
   <div class="algorithm" data-algorithm="set(key, value, options)" data-algorithm-for="WorkletSharedStorage">
     The <dfn class="idl-code" data-dfn-for="WorkletSharedStorage" data-dfn-type="method" data-export id="dom-workletsharedstorage-set"><code>set(<var>key</var>, <var>value</var>, <var>options</var>)</code><a class="self-link" href="#dom-workletsharedstorage-set"></a></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise①⑧">promise</a>.</p>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage④">WorkletSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①⓪">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-outside-settings" id="ref-for-sharedstorageworkletglobalscope-outside-settings">outside settings</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context" id="ref-for-concept-environment-target-browsing-context">target browsing context</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://tc39.es/ecma262/#assert" id="ref-for-assert⑨">Assert</a> that <var>context</var> is not null.</p>
     <li data-md>
      <p>If <var>key</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length⑤">length</a> exceeds the <a data-link-type="dfn" href="#key-maximum-length" id="ref-for-key-maximum-length③">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①②">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②①">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>value</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length⑥">length</a> exceeds the <a data-link-type="dfn" href="#value-maximum-length" id="ref-for-value-maximum-length②">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①③">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②②">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#active-window" id="ref-for-active-window④">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object⑦">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①①">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps④">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>If <var>options</var>["<code>ignoreIfPresent</code>"] is true:</p>
        <ol>
         <li data-md>
          <p>Let <var>currentValue</var> be the result of running <a data-link-type="dfn" href="#shared-storage-database-retrieve-an-entry-from-the-database" id="ref-for-shared-storage-database-retrieve-an-entry-from-the-database③">retrieve an entry from the database</a> with <var>queue</var>, <var>environment</var>, and <var>key</var>.</p>
         <li data-md>
          <p>If <var>currentValue</var> is false, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①④">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②③">TypeError</a></code>.</p>
         <li data-md>
          <p>If <var>currentValue</var> is not undefined, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-resolved-with" id="ref-for-a-promise-resolved-with②">promise resolved</a> with undefined.</p>
        </ol>
       <li data-md>
        <p>If the result of running <a data-link-type="dfn" href="#shared-storage-database-store-an-entry-in-the-database" id="ref-for-shared-storage-database-store-an-entry-in-the-database④">store an entry in the database</a> with <var>queue</var>, <var>environment</var>, <var>key</var>, and <var>value</var> is false, reject <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②④">TypeError</a></code>.</p>
       <li data-md>
        <p>Otherwise, resolve <var>promise</var> with undefined.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="append(key, value)" data-algorithm-for="WorkletSharedStorage">
     The <dfn class="idl-code" data-dfn-for="WorkletSharedStorage" data-dfn-type="method" data-export id="dom-workletsharedstorage-append"><code>append(<var>key</var>, <var>value</var>)</code><a class="self-link" href="#dom-workletsharedstorage-append"></a></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise①⑨">promise</a>.</p>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage⑤">WorkletSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①①">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-outside-settings" id="ref-for-sharedstorageworkletglobalscope-outside-settings①">outside settings</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context" id="ref-for-concept-environment-target-browsing-context①">target browsing context</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://tc39.es/ecma262/#assert" id="ref-for-assert①⓪">Assert</a> that <var>context</var> is not null.</p>
     <li data-md>
      <p>If <var>key</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length⑦">length</a> exceeds the <a data-link-type="dfn" href="#key-maximum-length" id="ref-for-key-maximum-length④">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①⑤">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②⑤">TypeError</a></code>.</p>
     <li data-md>
      <p>If <var>value</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length⑧">length</a> exceeds the <a data-link-type="dfn" href="#value-maximum-length" id="ref-for-value-maximum-length③">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①⑥">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②⑥">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#active-window" id="ref-for-active-window⑤">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object⑧">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①②">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps⑤">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>currentValue</var> be the result of running <a data-link-type="dfn" href="#shared-storage-database-retrieve-an-entry-from-the-database" id="ref-for-shared-storage-database-retrieve-an-entry-from-the-database④">retrieve an entry from the database</a> with <var>queue</var>, <var>environment</var>, and <var>key</var>.</p>
       <li data-md>
        <p>If <var>currentValue</var> is false, return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①⑦">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②⑦">TypeError</a></code>.</p>
       <li data-md>
        <p>If <var>currentValue</var> is not undefined:</p>
        <ol>
         <li data-md>
          <p>Let <var>list</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org#list" id="ref-for-list⑤">list</a>.</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org#list-append" id="ref-for-list-append⑦">Append</a> <var>currentValue</var> to <var>list</var>.</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org#list-append" id="ref-for-list-append⑧">Append</a> <var>value</var> to <var>list</var>.</p>
         <li data-md>
          <p>Set <var>value</var> to the result of running <a data-link-type="dfn" href="https://infra.spec.whatwg.org#string-concatenate" id="ref-for-string-concatenate①">concatenate</a> on <var>list</var>.</p>
        </ol>
       <li data-md>
        <p>If the result of running <a data-link-type="dfn" href="#shared-storage-database-store-an-entry-in-the-database" id="ref-for-shared-storage-database-store-an-entry-in-the-database⑤">store an entry in the database</a> with <var>queue</var>, <var>environment</var>, <var>key</var>, and <var>value</var> is false, reject <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②⑧">TypeError</a></code>.</p>
       <li data-md>
        <p>Otherwise, resolve <var>promise</var> with undefined.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="delete(key)" data-algorithm-for="WorkletSharedStorage">
     The <dfn class="idl-code" data-dfn-for="WorkletSharedStorage" data-dfn-type="method" data-export id="dom-workletsharedstorage-delete"><code>delete(<var>key</var>)</code><a class="self-link" href="#dom-workletsharedstorage-delete"></a></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise②⓪">promise</a>.</p>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage⑥">WorkletSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①②">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-outside-settings" id="ref-for-sharedstorageworkletglobalscope-outside-settings②">outside settings</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context" id="ref-for-concept-environment-target-browsing-context②">target browsing context</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://tc39.es/ecma262/#assert" id="ref-for-assert①①">Assert</a> that <var>context</var> is not null.</p>
     <li data-md>
      <p>If <var>key</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length⑨">length</a> exceeds the <a data-link-type="dfn" href="#key-maximum-length" id="ref-for-key-maximum-length⑤">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①⑧">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②⑨">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#active-window" id="ref-for-active-window⑥">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object⑨">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①③">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps⑥">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>If the result of running <a data-link-type="dfn" href="#shared-storage-database-delete-an-entry-from-the-database" id="ref-for-shared-storage-database-delete-an-entry-from-the-database②">delete an entry from the database</a> with <var>queue</var>, <var>environment</var>, and <var>key</var> is false, reject <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③⓪">TypeError</a></code>.</p>
       <li data-md>
        <p>Otherwise, resolve <var>promise</var> with undefined.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="clear()" data-algorithm-for="WorkletSharedStorage">
     The <dfn class="idl-code" data-dfn-for="WorkletSharedStorage" data-dfn-type="method" data-export id="dom-workletsharedstorage-clear"><code>clear()</code><a class="self-link" href="#dom-workletsharedstorage-clear"></a></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise②①">promise</a>.</p>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage⑦">WorkletSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①③">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-outside-settings" id="ref-for-sharedstorageworkletglobalscope-outside-settings③">outside settings</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context" id="ref-for-concept-environment-target-browsing-context③">target browsing context</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://tc39.es/ecma262/#assert" id="ref-for-assert①②">Assert</a> that <var>context</var> is not null.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#active-window" id="ref-for-active-window⑦">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object①⓪">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①④">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps⑦">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>If the result of running <a data-link-type="dfn" href="#shared-storage-database-clear-all-entries-in-the-database" id="ref-for-shared-storage-database-clear-all-entries-in-the-database②">clear all entries in the database</a> with <var>queue</var> and <var>environment</var> is false, reject <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③①">TypeError</a></code>.</p>
       <li data-md>
        <p>Otherwise, resolve <var>promise</var> with undefined.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="4.2.2" id="getter"><span class="secno">4.2.2. </span><span class="content">Getter Methods</span><a class="self-link" href="#getter"></a></h4>
   <div class="algorithm" data-algorithm="get(key)" data-algorithm-for="WorkletSharedStorage">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WorkletSharedStorage" data-dfn-type="method" data-export id="dom-workletsharedstorage-get"><code>get(<var>key</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise②②">promise</a>.</p>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage⑧">WorkletSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①④">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-outside-settings" id="ref-for-sharedstorageworkletglobalscope-outside-settings④">outside settings</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context" id="ref-for-concept-environment-target-browsing-context④">target browsing context</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://tc39.es/ecma262/#assert" id="ref-for-assert①③">Assert</a> that <var>context</var> is not null.</p>
     <li data-md>
      <p>If <var>key</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length①⓪">length</a> exceeds the <a data-link-type="dfn" href="#key-maximum-length" id="ref-for-key-maximum-length⑥">maximum length</a>, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①⑨">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③②">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#active-window" id="ref-for-active-window⑧">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object①①">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①⑤">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps⑧">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>value</var> be the result of running <a data-link-type="dfn" href="#shared-storage-database-retrieve-an-entry-from-the-database" id="ref-for-shared-storage-database-retrieve-an-entry-from-the-database⑤">retrieve an entry from the database</a> with <var>queue</var>, <var>environment</var>, and <var>key</var>.</p>
       <li data-md>
        <p>If <var>value</var> is null, reject <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③③">TypeError</a></code>.</p>
       <li data-md>
        <p>Otherwise, if <var>value</var> is undefined, resolve <var>promise</var> with undefined.</p>
       <li data-md>
        <p>Otherwise, resolve <var>promise</var> with <var>value</var>.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="length()" data-algorithm-for="WorkletSharedStorage">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WorkletSharedStorage" data-dfn-type="method" data-export id="dom-workletsharedstorage-length"><code>length()</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise②③">promise</a>.</p>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage⑨">WorkletSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①⑤">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-outside-settings" id="ref-for-sharedstorageworkletglobalscope-outside-settings⑤">outside settings</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context" id="ref-for-concept-environment-target-browsing-context⑤">target browsing context</a>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#active-window" id="ref-for-active-window⑨">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object①②">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①⑥">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps⑨">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>numEntries</var> be the result of running <a data-link-type="dfn" href="#shared-storage-database-count-entries-in-the-database" id="ref-for-shared-storage-database-count-entries-in-the-database">count entries in the database</a> with <var>queue</var> and <var>environment</var>.</p>
       <li data-md>
        <p>If <var>numEntries</var> is undefined, reject <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③④">TypeError</a></code>.</p>
       <li data-md>
        <p>Otherwise, resolve <var>promise</var> with <var>numEntries</var>.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="remainingBudget()" data-algorithm-for="WorkletSharedStorage">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WorkletSharedStorage" data-dfn-type="method" data-export id="dom-workletsharedstorage-remainingbudget"><code>remainingBudget()</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise②④">promise</a>.</p>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage①⓪">WorkletSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①⑥">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-outside-settings" id="ref-for-sharedstorageworkletglobalscope-outside-settings⑥">outside settings</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context" id="ref-for-concept-environment-target-browsing-context⑥">target browsing context</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://tc39.es/ecma262/#assert" id="ref-for-assert①④">Assert</a> that <var>context</var> is not null.</p>
     <li data-md>
      <p>Let <var>origin</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#active-document" id="ref-for-active-document②">active document</a>'s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document-origin" id="ref-for-concept-document-origin①">origin</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://tc39.es/ecma262/#assert" id="ref-for-assert①⑤">Assert</a> that <var>origin</var> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-opaque-origin" id="ref-for-concept-opaque-origin③">opaque</a>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①⑦">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps①⓪">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>remainingBudget</var> be the result of running <a data-link-type="dfn" href="#determine-remaining-navigation-budget" id="ref-for-determine-remaining-navigation-budget①">determine remaining navigation budget</a> with <var>origin</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://tc39.es/ecma262/#assert" id="ref-for-assert①⑥">Assert</a> that <var>remainingBudget</var> is not undefined.</p>
       <li data-md>
        <p>Resolve <var>promise</var> with <var>remainingBudget</var>.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="4.2.3" id="iteration"><span class="secno">4.2.3. </span><span class="content">Iteration</span><a class="self-link" href="#iteration"></a></h4>
   <p>Each <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage①①">WorkletSharedStorage</a></code> <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-async-iterable" id="ref-for-idl-async-iterable">async iterator</a> instance has a <a data-link-type="dfn" href="https://infra.spec.whatwg.org#queue" id="ref-for-queue">queue</a> <dfn class="dfn-paneled" data-dfn-for="WorkletSharedStorageIterator" data-dfn-type="dfn" data-noexport id="workletsharedstorageiterator-pending-entries">pending entries</dfn> of <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry⑤">entries</a>, initially <a data-link-type="dfn" href="https://infra.spec.whatwg.org#list-is-empty" id="ref-for-list-is-empty">empty</a>.</p>
   <p>Each <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage①②">WorkletSharedStorage</a></code> <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-async-iterable" id="ref-for-idl-async-iterable①">async iterator</a> instance also has a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean③">boolean</a></code> <dfn class="dfn-paneled" data-dfn-for="WorkletSharedStorageIterator" data-dfn-type="dfn" data-noexport id="workletsharedstorageiterator-error">error</dfn>, initially false.</p>
   <p>The <a data-link-type="dfn" href="#workletsharedstorageiterator-asynchronous-iterator-initialization-steps" id="ref-for-workletsharedstorageiterator-asynchronous-iterator-initialization-steps">asynchronous iterator initialization steps</a> and <a data-link-type="dfn" href="#workletsharedstorageiterator-get-the-next-iteration-result" id="ref-for-workletsharedstorageiterator-get-the-next-iteration-result">get the next iteration result</a> algorithms defined below correspond to those referred to as the <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#asynchronous-iterator-initialization-steps" id="ref-for-asynchronous-iterator-initialization-steps">asynchronous iterator initialization steps</a> and <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#dfn-get-the-next-iteration-result" id="ref-for-dfn-get-the-next-iteration-result">get the next iteration result</a> algorithms in the <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#introduction" id="ref-for-introduction">Web IDL Standard</a>.</p>
   <div class="algorithm" data-algorithm="asynchronous iterator initialization steps" data-algorithm-for="WorkletSharedStorageIterator">
     The <dfn class="dfn-paneled" data-dfn-for="WorkletSharedStorageIterator" data-dfn-type="dfn" data-noexport id="workletsharedstorageiterator-asynchronous-iterator-initialization-steps">asynchronous iterator initialization steps</dfn> for a <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage①③">WorkletSharedStorage</a></code> <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-async-iterable" id="ref-for-idl-async-iterable②">async iterator</a> <var>iterator</var> are: 
    <ol>
     <li data-md>
      <p>Let <var>context</var> be <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage①④">WorkletSharedStorage</a></code>'s <code class="idl"><a data-link-type="idl" href="#sharedstorageworkletglobalscope" id="ref-for-sharedstorageworkletglobalscope①⑦">SharedStorageWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#sharedstorageworkletglobalscope-outside-settings" id="ref-for-sharedstorageworkletglobalscope-outside-settings⑦">outside settings</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context" id="ref-for-concept-environment-target-browsing-context⑦">target browsing context</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://tc39.es/ecma262/#assert" id="ref-for-assert①⑦">Assert</a> that <var>context</var> is not null.</p>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise②⑤">promise</a>.</p>
     <li data-md>
      <p>Let <var>environment</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#active-window" id="ref-for-active-window①⓪">active window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object①③">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>queue</var> be <var>context</var>’s associated <a data-link-type="dfn" href="#shared-storage-database-shared-storage-database-queue" id="ref-for-shared-storage-database-shared-storage-database-queue①⑧">shared storage database queue</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps①①">Enqueue the following steps</a> on <var>queue</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>entries</var> be the result of running <a data-link-type="dfn" href="#shared-storage-database-retrieve-all-entries-from-the-database" id="ref-for-shared-storage-database-retrieve-all-entries-from-the-database">retrieve all entries from the database</a> with <var>queue</var> and <var>environment</var>.</p>
       <li data-md>
        <p>If <var>entries</var> is failure, reject <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③⑤">TypeError</a></code>.</p>
       <li data-md>
        <p>Otherwise, resolve <var>promise</var> with <var>entries</var>.</p>
      </ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org#upon-fulfillment" id="ref-for-upon-fulfillment③">Upon fulfillment</a> of <var>promise</var>, run the following:</p>
      <ol>
       <li data-md>
        <p>Let <var>promiseEntries</var> be the value of <var>promise</var>.</p>
       <li data-md>
        <p>For each <a data-link-type="dfn" href="#shared-storage-database-entry" id="ref-for-shared-storage-database-entry⑥">entry</a> <var>entry</var> in <var>promiseEntries</var>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org#queue-enqueue" id="ref-for-queue-enqueue">enqueue</a> <var>entry</var> in <var>iterator</var>’s <a data-link-type="dfn" href="#workletsharedstorageiterator-pending-entries" id="ref-for-workletsharedstorageiterator-pending-entries">pending entries</a>.</p>
      </ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org#upon-rejection" id="ref-for-upon-rejection③">Upon rejection</a> of <var>promise</var>, set <var>iterator</var>’s <a data-link-type="dfn" href="#workletsharedstorageiterator-error" id="ref-for-workletsharedstorageiterator-error">error</a> to true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="get the next iteration result" data-algorithm-for="WorkletSharedStorageIterator">
     To<dfn class="dfn-paneled" data-dfn-for="WorkletSharedStorageIterator" data-dfn-type="dfn" data-noexport id="workletsharedstorageiterator-get-the-next-iteration-result">get the next iteration result</dfn>, given a <code class="idl"><a data-link-type="idl" href="#workletsharedstorage" id="ref-for-workletsharedstorage①⑤">WorkletSharedStorage</a></code>'s <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-async-iterable" id="ref-for-idl-async-iterable③">async iterator</a> <var>iterator</var>, run the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#idl-promise" id="ref-for-idl-promise②⑥">promise</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps" id="ref-for-enqueue-the-following-steps①②">Enqueue the following steps</a>:</p>
      <ol>
       <li data-md>
        <p>If <var>iterator</var>’s <a data-link-type="dfn" href="#workletsharedstorageiterator-error" id="ref-for-workletsharedstorageiterator-error①">error</a> is true, return a <a data-link-type="dfn" href="https://webidl.spec.whatwg.org#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②⓪">promise rejected</a> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③⑥">TypeError</a></code>.</p>
       <li data-md>
        <p>If <var>iterator</var>’s <a data-link-type="dfn" href="#workletsharedstorageiterator-pending-entries" id="ref-for-workletsharedstorageiterator-pending-entries①">pending entries</a> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org#list-is-empty" id="ref-for-list-is-empty①">empty</a>:</p>
        <ol>
         <li data-md>
          <p>Create an object <var>doneObject</var>.</p>
         <li data-md>
          <p>Resolve <var>promise</var> with <var>doneObject</var>.</p>
        </ol>
       <li data-md>
        <p>Let <var>entry</var> be the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org#queue-dequeue" id="ref-for-queue-dequeue">dequeueing</a> from <var>iterator</var>’s <a data-link-type="dfn" href="#workletsharedstorageiterator-pending-entries" id="ref-for-workletsharedstorageiterator-pending-entries②">pending entries</a>.</p>
       <li data-md>
        <p>Resolve <var>promise</var> with <var>entry</var>.</p>
      </ol>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="5" id="privacy"><span class="secno">5. </span><span class="content">Privacy Considerations</span><a class="self-link" href="#privacy"></a></h2>
   <p>The Shared Storage API attempts to provide the ability to use cross-site data for a range of use cases in a way that better protects user privacy than the use of third-party cookies. Shared Storage’s main privacy safeguard is that read access of the data stored in its storage may only occur within an embedder’s <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet①⑤">SharedStorageWorklet</a></code>. Well-defined limits restrict output of data from the <code class="idl"><a data-link-type="idl" href="#sharedstorageworklet" id="ref-for-sharedstorageworklet①⑥">SharedStorageWorklet</a></code> to a minimum.</p>
   <p>In particular, an embedder can select a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①⓪">URL</a> from a short list of <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①①">URL</a>s based on data in their shared storage and then display the result in a <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element①①">fenced frame</a>. The embedder will not be able to know which <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①②">URL</a> was chosen except through specifc mechanisms that will be better-mitigated in the longer term. Currently, a few bits of entropy can leak each time that the user clicks on the <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element①②">fenced frame</a> to initiate a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#top-level-traversable" id="ref-for-top-level-traversable⑨">top-frame</a> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigate③">navigation</a> and/or the <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element" id="ref-for-the-fencedframe-element①③">fenced frame</a> calls the <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#dom-fence-reportevent" id="ref-for-dom-fence-reportevent④">fence.reportEvent()</a> API.</p>
   <p>An embedder is also able to send aggregatable reports through the <a data-link-type="dfn" href="https://github.com/patcg-individual-drafts/private-aggregation-api/blob/main/README.md#private-aggregation" id="ref-for-private-aggregation③">Private Aggregation Service</a>, which adds noise in order to achieve differential privacy, uses a time delay to send reports, imposes limits on the number of reports sent, and processes the reports into aggregate data so that individual privacy is protected.</p>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification. </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a> 
    <p>This is an example of an informative example. </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this: </p>
   <p class="note" role="note">Note, this is an informative note.</p>
   <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
   <p>Requirements phrased in the imperative as part of algorithms
    (such as "strip any leading space characters"
    or "return false and abort these steps")
    are to be interpreted with the meaning of the key word
    ("must", "should", "may", etc)
    used in introducing the algorithm. </p>
   <p>Conformance requirements phrased as algorithms or specific steps
    can be implemented in any manner,
    so long as the end result is equivalent.
    In particular, the algorithms defined in this specification
    are intended to be easy to understand
    and are not intended to be performant.
    Implementers are encouraged to optimize. </p>
  </div>
<script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li>
    append(key, value)
    <ul>
     <li><a href="#dom-sharedstorage-append">method for SharedStorage</a><span>, in § 4</span>
     <li><a href="#dom-windowsharedstorage-append">method for WindowSharedStorage</a><span>, in § 4.1.1</span>
     <li><a href="#dom-workletsharedstorage-append">method for WorkletSharedStorage</a><span>, in § 4.2.1</span>
    </ul>
   <li><a href="#workletsharedstorageiterator-asynchronous-iterator-initialization-steps">asynchronous iterator initialization steps</a><span>, in § 4.2.3</span>
   <li><a href="#bit-debit">bit debit</a><span>, in § 4.1.3.1</span>
   <li><a href="#bit-debit-bits">bits</a><span>, in § 4.1.3.1</span>
   <li><a href="#calling-origin">calling origin</a><span>, in § 4.1.3.1</span>
   <li><a href="#charge-shared-storage-navigation-budget">charge shared storage navigation budget</a><span>, in § 4.1.3.1</span>
   <li><a href="#charge-shared-storage-reporting-budget">charge shared storage reporting budget</a><span>, in § 4.1.3.2</span>
   <li><a href="#check-and-update-module-added-status">check and update module added status</a><span>, in § 2</span>
   <li><a href="#check-whether-a-bit-debit-is-expired">check whether a bit debit is expired</a><span>, in § 4.1.3.1</span>
   <li>
    clear()
    <ul>
     <li><a href="#dom-sharedstorage-clear">method for SharedStorage</a><span>, in § 4</span>
     <li><a href="#dom-windowsharedstorage-clear">method for WindowSharedStorage</a><span>, in § 4.1.1</span>
     <li><a href="#dom-workletsharedstorage-clear">method for WorkletSharedStorage</a><span>, in § 4.2.1</span>
    </ul>
   <li><a href="#shared-storage-database-clear-all-entries-in-the-database">clear all entries in the database</a><span>, in § 3.3</span>
   <li><a href="#shared-storage-database-count-entries-in-the-database">count entries in the database</a><span>, in § 3.3</span>
   <li><a href="#create-a-shared-storage-bucket">create a shared storage bucket</a><span>, in § 3.1</span>
   <li><a href="#create-a-shared-storage-shelf">create a shared storage shelf</a><span>, in § 3.1</span>
   <li><a href="#dom-sharedstoragerunoperationmethodoptions-data">data</a><span>, in § 2.2</span>
   <li><a href="#default-entry-lifetime">default entry lifetime</a><span>, in § 3.2</span>
   <li><a href="#default-index">default index</a><span>, in § 4.1.3.1</span>
   <li><a href="#shared-storage-database-delete-an-entry-from-the-database">delete an entry from the database</a><span>, in § 3.3</span>
   <li>
    delete(key)
    <ul>
     <li><a href="#dom-sharedstorage-delete">method for SharedStorage</a><span>, in § 4</span>
     <li><a href="#dom-windowsharedstorage-delete">method for WindowSharedStorage</a><span>, in § 4.1.1</span>
     <li><a href="#dom-workletsharedstorage-delete">method for WorkletSharedStorage</a><span>, in § 4.2.1</span>
    </ul>
   <li><a href="#determine-remaining-navigation-budget">determine remaining navigation budget</a><span>, in § 4.1.3.1</span>
   <li><a href="#determine-reporting-budget-to-charge">determine reporting budget to charge</a><span>, in § 4.1.3.2</span>
   <li><a href="#shared-storage-database-determine-whether-an-entry-is-expired">determine whether an entry is expired</a><span>, in § 3.3</span>
   <li><a href="#shared-storage-database-entry">entry</a><span>, in § 3.2</span>
   <li><a href="#workletsharedstorageiterator-error">error</a><span>, in § 4.2.3</span>
   <li><a href="#bit-debit-expired">expired</a><span>, in § 4.1.3.1</span>
   <li><a href="#dom-workletsharedstorage-get">get(key)</a><span>, in § 4.2.2</span>
   <li><a href="#get-the-canonical-url-string-if-valid">get the canonical URL string if valid</a><span>, in § 4.1.2</span>
   <li><a href="#workletsharedstorageiterator-get-the-next-iteration-result">get the next iteration result</a><span>, in § 4.2.3</span>
   <li><a href="#has-navigated">has navigated</a><span>, in § 4.1.3.1</span>
   <li><a href="#has-reported">has reported</a><span>, in § 4.1.3.2</span>
   <li><a href="#dom-sharedstoragesetmethodoptions-ignoreifpresent">ignoreIfPresent</a><span>, in § 4</span>
   <li><a href="#selecturl-input-url-list">input URL list</a><span>, in § 4.1.3.1</span>
   <li><a href="#dom-sharedstoragerunoperationmethodoptions-keepalive">keepAlive</a><span>, in § 2.2</span>
   <li><a href="#entry-key">key</a><span>, in § 3.2</span>
   <li><a href="#value-struct-last-updated">last updated</a><span>, in § 3.2</span>
   <li><a href="#dom-workletsharedstorage-length">length()</a><span>, in § 4.2.2</span>
   <li>
    maximum length
    <ul>
     <li><a href="#key-maximum-length">dfn for key</a><span>, in § 3.2</span>
     <li><a href="#value-maximum-length">dfn for value</a><span>, in § 3.2</span>
    </ul>
   <li><a href="#module-added">module added</a><span>, in § 2</span>
   <li><a href="#navigation-budget-epoch">navigation budget epoch</a><span>, in § 4.1.3.1</span>
   <li><a href="#navigation-budget-lifetime">navigation budget lifetime</a><span>, in § 4.1.3.1</span>
   <li><a href="#navigation-entropy-allowance">navigation entropy allowance</a><span>, in § 4.1.3.1</span>
   <li><a href="#navigation-entropy-ledger">navigation entropy ledger</a><span>, in § 4.1.3.1</span>
   <li><a href="#obtain-a-shared-storage-bottle-map">obtain a shared storage bottle map</a><span>, in § 3.1</span>
   <li><a href="#obtain-a-shared-storage-shelf">obtain a shared storage shelf</a><span>, in § 3.1</span>
   <li><a href="#sharedstorageworkletglobalscope-operation-map">operation map</a><span>, in § 2.2</span>
   <li><a href="#sharedstorageworkletglobalscope-outside-settings">outside settings</a><span>, in § 2.2</span>
   <li><a href="#page-load">page load</a><span>, in § 4.1.3.2</span>
   <li><a href="#workletsharedstorageiterator-pending-entries">pending entries</a><span>, in § 4.2.3</span>
   <li><a href="#pending-shared-storage-budget-debit">pending shared storage budget debit</a><span>, in § 4.1.3.1</span>
   <li><a href="#purge-expired-bit-debits-from-all-navigation-entropy-ledgers">purge expired bit debits from all navigation entropy ledgers</a><span>, in § 4.1.3.2</span>
   <li><a href="#shared-storage-database-purge-expired-entries-from-the-database">purge expired entries from the database</a><span>, in § 3.3</span>
   <li><a href="#dom-sharedstorageworkletglobalscope-register">register(name, operationCtor)</a><span>, in § 2.3</span>
   <li><a href="#register-reporting-metadata">register reporting metadata</a><span>, in § 4.1.2</span>
   <li><a href="#dom-workletsharedstorage-remainingbudget">remainingBudget()</a><span>, in § 4.2.2</span>
   <li><a href="#calling-origin-remaining-navigation-budget">remaining navigation budget</a><span>, in § 4.1.3.1</span>
   <li><a href="#reporting-entropy-allowance">reporting entropy allowance</a><span>, in § 4.1.3.2</span>
   <li><a href="#dom-sharedstorageurlwithmetadata-reportingmetadata">reportingMetadata</a><span>, in § 4.1.2</span>
   <li><a href="#dom-sharedstoragerunoperationmethodoptions-resolvetoconfig">resolveToConfig</a><span>, in § 2.2</span>
   <li><a href="#shared-storage-database-retrieve-all-entries-from-the-database">retrieve all entries from the database</a><span>, in § 3.3</span>
   <li><a href="#shared-storage-database-retrieve-an-entry-from-the-database">retrieve an entry from the database</a><span>, in § 3.3</span>
   <li><a href="#dom-sharedstoragerunoperation-run">run(data)</a><span>, in § 2.2</span>
   <li><a href="#dom-sharedstorageselecturloperation-run">run(data, urls)</a><span>, in § 2.2</span>
   <li><a href="#dom-windowsharedstorage-run">run(name)</a><span>, in § 4.1.4</span>
   <li><a href="#dom-windowsharedstorage-run">run(name, options)</a><span>, in § 4.1.4</span>
   <li><a href="#dom-windowsharedstorage-selecturl">selectURL(name, urls)</a><span>, in § 4.1.4</span>
   <li><a href="#dom-windowsharedstorage-selecturl">selectURL(name, urls, options)</a><span>, in § 4.1.4</span>
   <li><a href="#dom-sharedstorage-set">set(key, value)</a><span>, in § 4</span>
   <li>
    set(key, value, options)
    <ul>
     <li><a href="#dom-sharedstorage-set">method for SharedStorage</a><span>, in § 4</span>
     <li><a href="#dom-windowsharedstorage-set">method for WindowSharedStorage</a><span>, in § 4.1.1</span>
     <li><a href="#dom-workletsharedstorage-set">method for WorkletSharedStorage</a><span>, in § 4.2.1</span>
    </ul>
   <li><a href="#shared-storage">shared storage</a><span>, in § 3.1</span>
   <li><a href="#sharedstorage">SharedStorage</a><span>, in § 4</span>
   <li><a href="#shared-storage-bucket">shared storage bucket</a><span>, in § 3.1</span>
   <li><a href="#shared-storage-database">shared storage database</a><span>, in § 3.2</span>
   <li><a href="#shared-storage-database-shared-storage-database-queue">shared storage database queue</a><span>, in § 3.2</span>
   <li><a href="#shared-storage-navigation-budget-table">shared storage navigation budget table</a><span>, in § 4.1.3.1</span>
   <li><a href="#sharedstorageoperation">SharedStorageOperation</a><span>, in § 2.2</span>
   <li><a href="#callbackdef-sharedstorageoperationconstructor">SharedStorageOperationConstructor</a><span>, in § 2.2</span>
   <li><a href="#shared-storage-reporting-budget">shared storage reporting budget</a><span>, in § 4.1.3.2</span>
   <li><a href="#typedefdef-sharedstorageresponse">SharedStorageResponse</a><span>, in § 4.1</span>
   <li><a href="#sharedstoragerunoperation">SharedStorageRunOperation</a><span>, in § 2.2</span>
   <li><a href="#dictdef-sharedstoragerunoperationmethodoptions">SharedStorageRunOperationMethodOptions</a><span>, in § 2.2</span>
   <li><a href="#sharedstorageselecturloperation">SharedStorageSelectURLOperation</a><span>, in § 2.2</span>
   <li><a href="#dictdef-sharedstoragesetmethodoptions">SharedStorageSetMethodOptions</a><span>, in § 4</span>
   <li><a href="#shared-storage-shed">shared storage shed</a><span>, in § 3.1</span>
   <li><a href="#dictdef-sharedstorageurlwithmetadata">SharedStorageUrlWithMetadata</a><span>, in § 4.1.2</span>
   <li><a href="#sharedstorageworklet">SharedStorageWorklet</a><span>, in § 2</span>
   <li><a href="#sharedstorageworkletglobalscope">SharedStorageWorkletGlobalScope</a><span>, in § 2.2</span>
   <li><a href="#shared-storage-database-store-an-entry-in-the-database">store an entry in the database</a><span>, in § 3.3</span>
   <li><a href="#bit-debit-timestamp">timestamp</a><span>, in § 4.1.3.1</span>
   <li><a href="#dom-sharedstorageurlwithmetadata-url">url</a><span>, in § 4.1.2</span>
   <li><a href="#validate-reporting-metadata">validate reporting metadata</a><span>, in § 4.1.2</span>
   <li><a href="#value-struct-value">value</a><span>, in § 3.2</span>
   <li><a href="#entry-value-struct">value struct</a><span>, in § 3.2</span>
   <li><a href="#windowsharedstorage">WindowSharedStorage</a><span>, in § 4.1</span>
   <li><a href="#dom-windowsharedstorage-worklet">worklet</a><span>, in § 4.1</span>
   <li><a href="#workletsharedstorage">WorkletSharedStorage</a><span>, in § 4.2</span>
  </ul>
  <aside aria-labelledby="infopaneltitle-for-07886e33695d0e7b473ef18f656ad7ac" class="dfn-panel" data-for="07886e33695d0e7b473ef18f656ad7ac" id="infopanel-for-07886e33695d0e7b473ef18f656ad7ac">
   <span id="infopaneltitle-for-07886e33695d0e7b473ef18f656ad7ac" style="display:none">Info about the 'Document' external reference.</span><a href="https://dom.spec.whatwg.org/#document">https://dom.spec.whatwg.org/#document</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-document">4.1.3.1. Navigation Entropy Budget</a>
    <li><a href="#ref-for-document①">4.1.3.2. Reporting Entropy Budget</a> <a href="#ref-for-document②">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-0527034ee7070fda15ffa50c34dbbc63" class="dfn-panel" data-for="0527034ee7070fda15ffa50c34dbbc63" id="infopanel-for-0527034ee7070fda15ffa50c34dbbc63">
   <span id="infopaneltitle-for-0527034ee7070fda15ffa50c34dbbc63" style="display:none">Info about the 'DOMHighResTimeStamp' external reference.</span><a href="https://w3c.github.io/hr-time/#dom-domhighrestimestamp">https://w3c.github.io/hr-time/#dom-domhighrestimestamp</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-domhighrestimestamp">3.2. The Shared Storage Database</a>
    <li><a href="#ref-for-dom-domhighrestimestamp①">4.1.3.1. Navigation Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-1f78bca61233b6a6957119204c181632" class="dfn-panel" data-for="1f78bca61233b6a6957119204c181632" id="infopanel-for-1f78bca61233b6a6957119204c181632">
   <span id="infopaneltitle-for-1f78bca61233b6a6957119204c181632" style="display:none">Info about the 'current wall time' external reference.</span><a href="https://w3c.github.io/hr-time/#dfn-current-wall-time">https://w3c.github.io/hr-time/#dfn-current-wall-time</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-current-wall-time">3.3. The Database Algorithms</a> <a href="#ref-for-dfn-current-wall-time①">(2)</a>
    <li><a href="#ref-for-dfn-current-wall-time②">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-dfn-current-wall-time③">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-9213a3aff5ff1021ab4c2d780aa70cee" class="dfn-panel" data-for="9213a3aff5ff1021ab4c2d780aa70cee" id="infopanel-for-9213a3aff5ff1021ab4c2d780aa70cee">
   <span id="infopaneltitle-for-9213a3aff5ff1021ab4c2d780aa70cee" style="display:none">Info about the 'duration' external reference.</span><a href="https://w3c.github.io/hr-time/#dfn-duration">https://w3c.github.io/hr-time/#dfn-duration</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-duration">3.2. The Shared Storage Database</a>
    <li><a href="#ref-for-dfn-duration①">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-dfn-duration②">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-7035dd3562cfc316632c23d976c085fe" class="dfn-panel" data-for="7035dd3562cfc316632c23d976c085fe" id="infopanel-for-7035dd3562cfc316632c23d976c085fe">
   <span id="infopaneltitle-for-7035dd3562cfc316632c23d976c085fe" style="display:none">Info about the 'FencedFrameConfig' external reference.</span><a href="https://wicg.github.io/fenced-frame/#fencedframeconfig">https://wicg.github.io/fenced-frame/#fencedframeconfig</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-fencedframeconfig">4.1. The WindowSharedStorage interface</a>
    <li><a href="#ref-for-fencedframeconfig①">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-fencedframeconfig②">(2)</a> <a href="#ref-for-fencedframeconfig③">(3)</a> <a href="#ref-for-fencedframeconfig④">(4)</a>
    <li><a href="#ref-for-fencedframeconfig⑤">4.1.4. Run Operation Methods</a> <a href="#ref-for-fencedframeconfig⑥">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-d1f0a86fd49be388d8b0159e241a1172" class="dfn-panel" data-for="d1f0a86fd49be388d8b0159e241a1172" id="infopanel-for-d1f0a86fd49be388d8b0159e241a1172">
   <span id="infopaneltitle-for-d1f0a86fd49be388d8b0159e241a1172" style="display:none">Info about the 'Window' external reference.</span><a href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window">https://html.spec.whatwg.org/multipage/nav-history-apis.html#window</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-window">4. The SharedStorage Interface</a> <a href="#ref-for-window①">(2)</a> <a href="#ref-for-window②">(3)</a> <a href="#ref-for-window③">(4)</a>
    <li><a href="#ref-for-window④">4.1.1. Window Setter/Deleter Methods</a> <a href="#ref-for-window⑤">(2)</a> <a href="#ref-for-window⑥">(3)</a> <a href="#ref-for-window⑦">(4)</a>
    <li><a href="#ref-for-window⑧">4.1.4. Run Operation Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-388c1a1bab7d7c206f9539992fa5c95b" class="dfn-panel" data-for="388c1a1bab7d7c206f9539992fa5c95b" id="infopanel-for-388c1a1bab7d7c206f9539992fa5c95b">
   <span id="infopaneltitle-for-388c1a1bab7d7c206f9539992fa5c95b" style="display:none">Info about the 'Worklet' external reference.</span><a href="https://html.spec.whatwg.org/multipage/worklets.html#worklet">https://html.spec.whatwg.org/multipage/worklets.html#worklet</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-worklet">2. The SharedStorageWorklet Interface</a> <a href="#ref-for-worklet①">(2)</a>
    <li><a href="#ref-for-worklet②">2.1. Monkey Patch for Worklets</a> <a href="#ref-for-worklet③">(2)</a> <a href="#ref-for-worklet④">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-f1c3158ad16b10a1e2f5e18807f043d3" class="dfn-panel" data-for="f1c3158ad16b10a1e2f5e18807f043d3" id="infopanel-for-f1c3158ad16b10a1e2f5e18807f043d3">
   <span id="infopaneltitle-for-f1c3158ad16b10a1e2f5e18807f043d3" style="display:none">Info about the 'WorkletGlobalScope' external reference.</span><a href="https://html.spec.whatwg.org/multipage/worklets.html#workletglobalscope">https://html.spec.whatwg.org/multipage/worklets.html#workletglobalscope</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-workletglobalscope">2.2. The SharedStorageWorkletGlobalScope</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-3d775bec5e86909f746c065c634670de" class="dfn-panel" data-for="3d775bec5e86909f746c065c634670de" id="infopanel-for-3d775bec5e86909f746c065c634670de">
   <span id="infopaneltitle-for-3d775bec5e86909f746c065c634670de" style="display:none">Info about the '[[getprototypeof]]()' external reference.</span><a href="https://tc39.es/ecma262/#sec-ordinary-object-internal-methods-and-internal-slots-getprototypeof">https://tc39.es/ecma262/#sec-ordinary-object-internal-methods-and-internal-slots-getprototypeof</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-ordinary-object-internal-methods-and-internal-slots-getprototypeof">2.3. Registering a Worklet</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-22506342275877ad373fb5e4f51039fd" class="dfn-panel" data-for="22506342275877ad373fb5e4f51039fd" id="infopanel-for-22506342275877ad373fb5e4f51039fd">
   <span id="infopaneltitle-for-22506342275877ad373fb5e4f51039fd" style="display:none">Info about the 'active document' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#active-document">https://html.spec.whatwg.org/multipage/webappapis.html#active-document</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-active-document">4.1.3.1. Navigation Entropy Budget</a>
    <li><a href="#ref-for-active-document①">4.1.4. Run Operation Methods</a>
    <li><a href="#ref-for-active-document②">4.2.2. Getter Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-30868129d3c8f56c49c59077d328b346" class="dfn-panel" data-for="30868129d3c8f56c49c59077d328b346" id="infopanel-for-30868129d3c8f56c49c59077d328b346">
   <span id="infopaneltitle-for-30868129d3c8f56c49c59077d328b346" style="display:none">Info about the 'active window' external reference.</span><a href="https://html.spec.whatwg.org/multipage/document-sequences.html#active-window">https://html.spec.whatwg.org/multipage/document-sequences.html#active-window</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-active-window">4.1.1. Window Setter/Deleter Methods</a> <a href="#ref-for-active-window①">(2)</a> <a href="#ref-for-active-window②">(3)</a> <a href="#ref-for-active-window③">(4)</a>
    <li><a href="#ref-for-active-window④">4.2.1. Worklet Setter/Deleter Methods</a> <a href="#ref-for-active-window⑤">(2)</a> <a href="#ref-for-active-window⑥">(3)</a> <a href="#ref-for-active-window⑦">(4)</a>
    <li><a href="#ref-for-active-window⑧">4.2.2. Getter Methods</a> <a href="#ref-for-active-window⑨">(2)</a>
    <li><a href="#ref-for-active-window①⓪">4.2.3. Iteration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-c15669f81d5b7cbafe13a97b7f6b9fdd" class="dfn-panel" data-for="c15669f81d5b7cbafe13a97b7f6b9fdd" id="infopanel-for-c15669f81d5b7cbafe13a97b7f6b9fdd">
   <span id="infopaneltitle-for-c15669f81d5b7cbafe13a97b7f6b9fdd" style="display:none">Info about the 'addModule(moduleURL, options)' external reference.</span><a href="https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule">https://html.spec.whatwg.org/multipage/worklets.html#dom-worklet-addmodule</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-worklet-addmodule">2. The SharedStorageWorklet Interface</a> <a href="#ref-for-dom-worklet-addmodule①">(2)</a> <a href="#ref-for-dom-worklet-addmodule②">(3)</a> <a href="#ref-for-dom-worklet-addmodule③">(4)</a> <a href="#ref-for-dom-worklet-addmodule④">(5)</a>
    <li><a href="#ref-for-dom-worklet-addmodule⑤">2.1. Monkey Patch for Worklets</a>
    <li><a href="#ref-for-dom-worklet-addmodule⑥">4. The SharedStorage Interface</a>
    <li><a href="#ref-for-dom-worklet-addmodule⑦">4.1.4. Run Operation Methods</a> <a href="#ref-for-dom-worklet-addmodule⑧">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-a4cc8d2421b518a3977f69799881f264" class="dfn-panel" data-for="a4cc8d2421b518a3977f69799881f264" id="infopanel-for-a4cc8d2421b518a3977f69799881f264">
   <span id="infopaneltitle-for-a4cc8d2421b518a3977f69799881f264" style="display:none">Info about the 'append (for list)' external reference.</span><a href="https://infra.spec.whatwg.org#list-append">https://infra.spec.whatwg.org#list-append</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-append">4.1.1. Window Setter/Deleter Methods</a> <a href="#ref-for-list-append①">(2)</a>
    <li><a href="#ref-for-list-append②">4.1.3.1. Navigation Entropy Budget</a>
    <li><a href="#ref-for-list-append③">4.1.4. Run Operation Methods</a> <a href="#ref-for-list-append④">(2)</a> <a href="#ref-for-list-append⑤">(3)</a> <a href="#ref-for-list-append⑥">(4)</a>
    <li><a href="#ref-for-list-append⑦">4.2.1. Worklet Setter/Deleter Methods</a> <a href="#ref-for-list-append⑧">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-404b9f69eaee28aad1cc6cf2e5a9de4f" class="dfn-panel" data-for="404b9f69eaee28aad1cc6cf2e5a9de4f" id="infopanel-for-404b9f69eaee28aad1cc6cf2e5a9de4f">
   <span id="infopaneltitle-for-404b9f69eaee28aad1cc6cf2e5a9de4f" style="display:none">Info about the 'append (for set)' external reference.</span><a href="https://infra.spec.whatwg.org#set-append">https://infra.spec.whatwg.org#set-append</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-append">3.1. Monkey Patch for the Storage Model</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-6a3e2fb0696b416fb90f7916d0e747c3" class="dfn-panel" data-for="6a3e2fb0696b416fb90f7916d0e747c3" id="infopanel-for-6a3e2fb0696b416fb90f7916d0e747c3">
   <span id="infopaneltitle-for-6a3e2fb0696b416fb90f7916d0e747c3" style="display:none">Info about the 'assert' external reference.</span><a href="https://tc39.es/ecma262/#assert">https://tc39.es/ecma262/#assert</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-assert">4.1.1. Window Setter/Deleter Methods</a> <a href="#ref-for-assert①">(2)</a> <a href="#ref-for-assert②">(3)</a> <a href="#ref-for-assert③">(4)</a>
    <li><a href="#ref-for-assert④">4.1.2. SharedStorageUrlWithMetadata and Reporting</a> <a href="#ref-for-assert⑤">(2)</a>
    <li><a href="#ref-for-assert⑥">4.1.4. Run Operation Methods</a> <a href="#ref-for-assert⑦">(2)</a> <a href="#ref-for-assert⑧">(3)</a>
    <li><a href="#ref-for-assert⑨">4.2.1. Worklet Setter/Deleter Methods</a> <a href="#ref-for-assert①⓪">(2)</a> <a href="#ref-for-assert①①">(3)</a> <a href="#ref-for-assert①②">(4)</a>
    <li><a href="#ref-for-assert①③">4.2.2. Getter Methods</a> <a href="#ref-for-assert①④">(2)</a> <a href="#ref-for-assert①⑤">(3)</a> <a href="#ref-for-assert①⑥">(4)</a>
    <li><a href="#ref-for-assert①⑦">4.2.3. Iteration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-b681a2f3d2b90fee3bdafd93a74a2a7e" class="dfn-panel" data-for="b681a2f3d2b90fee3bdafd93a74a2a7e" id="infopanel-for-b681a2f3d2b90fee3bdafd93a74a2a7e">
   <span id="infopaneltitle-for-b681a2f3d2b90fee3bdafd93a74a2a7e" style="display:none">Info about the 'async iterator' external reference.</span><a href="https://webidl.spec.whatwg.org#idl-async-iterable">https://webidl.spec.whatwg.org#idl-async-iterable</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-async-iterable">4.2.3. Iteration</a> <a href="#ref-for-idl-async-iterable①">(2)</a> <a href="#ref-for-idl-async-iterable②">(3)</a> <a href="#ref-for-idl-async-iterable③">(4)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-8affc0459b565735337bc1b2334a8f17" class="dfn-panel" data-for="8affc0459b565735337bc1b2334a8f17" id="infopanel-for-8affc0459b565735337bc1b2334a8f17">
   <span id="infopaneltitle-for-8affc0459b565735337bc1b2334a8f17" style="display:none">Info about the 'asynchronous iterator initialization steps' external reference.</span><a href="https://webidl.spec.whatwg.org#asynchronous-iterator-initialization-steps">https://webidl.spec.whatwg.org#asynchronous-iterator-initialization-steps</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-asynchronous-iterator-initialization-steps">4.2.3. Iteration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-616e4107fb5373731d00b82d54f0404b" class="dfn-panel" data-for="616e4107fb5373731d00b82d54f0404b" id="infopanel-for-616e4107fb5373731d00b82d54f0404b">
   <span id="infopaneltitle-for-616e4107fb5373731d00b82d54f0404b" style="display:none">Info about the 'backing map' external reference.</span><a href="https://storage.spec.whatwg.org/#storage-proxy-map-backing-map">https://storage.spec.whatwg.org/#storage-proxy-map-backing-map</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-storage-proxy-map-backing-map">3.1. Monkey Patch for the Storage Model</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-18bf74a446ca5e13885595f8a3b107ce" class="dfn-panel" data-for="18bf74a446ca5e13885595f8a3b107ce" id="infopanel-for-18bf74a446ca5e13885595f8a3b107ce">
   <span id="infopaneltitle-for-18bf74a446ca5e13885595f8a3b107ce" style="display:none">Info about the 'beacon' external reference.</span><a href="https://w3c.github.io/beacon/#beacon">https://w3c.github.io/beacon/#beacon</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-beacon">4.1.2. SharedStorageUrlWithMetadata and Reporting</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-c1cfc351a59b14257f942da7037d67db" class="dfn-panel" data-for="c1cfc351a59b14257f942da7037d67db" id="infopanel-for-c1cfc351a59b14257f942da7037d67db">
   <span id="infopaneltitle-for-c1cfc351a59b14257f942da7037d67db" style="display:none">Info about the 'beginning navigation' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#beginning-navigation">https://html.spec.whatwg.org/multipage/webappapis.html#beginning-navigation</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-beginning-navigation">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-beginning-navigation①">(2)</a> <a href="#ref-for-beginning-navigation②">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-f44481f55d5f861114cd827f131c07a7" class="dfn-panel" data-for="f44481f55d5f861114cd827f131c07a7" id="infopanel-for-f44481f55d5f861114cd827f131c07a7">
   <span id="infopaneltitle-for-f44481f55d5f861114cd827f131c07a7" style="display:none">Info about the 'bits of entropy' external reference.</span><a href="https://en.wikipedia.org/wiki/Entropy_(information_theory)#bits-of-entropy">https://en.wikipedia.org/wiki/Entropy_(information_theory)#bits-of-entropy</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-bits-of-entropy">4.1.3. Entropy Budgets</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-8c2b9baa2bcf87b7479bc5d28f0c925a" class="dfn-panel" data-for="8c2b9baa2bcf87b7479bc5d28f0c925a" id="infopanel-for-8c2b9baa2bcf87b7479bc5d28f0c925a">
   <span id="infopaneltitle-for-8c2b9baa2bcf87b7479bc5d28f0c925a" style="display:none">Info about the 'bottle map' external reference.</span><a href="https://storage.spec.whatwg.org/#bottle-map">https://storage.spec.whatwg.org/#bottle-map</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-bottle-map">3.1. Monkey Patch for the Storage Model</a> <a href="#ref-for-bottle-map①">(2)</a> <a href="#ref-for-bottle-map②">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-5db590bc82ac7edd15fc4ebd1b0c25f0" class="dfn-panel" data-for="5db590bc82ac7edd15fc4ebd1b0c25f0" id="infopanel-for-5db590bc82ac7edd15fc4ebd1b0c25f0">
   <span id="infopaneltitle-for-5db590bc82ac7edd15fc4ebd1b0c25f0" style="display:none">Info about the 'browsing context' external reference.</span><a href="https://html.spec.whatwg.org/multipage/document-sequences.html#browsing-context">https://html.spec.whatwg.org/multipage/document-sequences.html#browsing-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-context">3.2. The Shared Storage Database</a> <a href="#ref-for-browsing-context①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-3324d83e3eb9483c08cbb2bdcd28541e" class="dfn-panel" data-for="3324d83e3eb9483c08cbb2bdcd28541e" id="infopanel-for-3324d83e3eb9483c08cbb2bdcd28541e">
   <span id="infopaneltitle-for-3324d83e3eb9483c08cbb2bdcd28541e" style="display:none">Info about the 'browsing context (for Window)' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#window-bc">https://html.spec.whatwg.org/multipage/webappapis.html#window-bc</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-window-bc">4.1.1. Window Setter/Deleter Methods</a> <a href="#ref-for-window-bc①">(2)</a> <a href="#ref-for-window-bc②">(3)</a> <a href="#ref-for-window-bc③">(4)</a>
    <li><a href="#ref-for-window-bc④">4.1.4. Run Operation Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-7bed712fb187b01e9a5fb930d421c3c9" class="dfn-panel" data-for="7bed712fb187b01e9a5fb930d421c3c9" id="infopanel-for-7bed712fb187b01e9a5fb930d421c3c9">
   <span id="infopaneltitle-for-7bed712fb187b01e9a5fb930d421c3c9" style="display:none">Info about the 'bucket map' external reference.</span><a href="https://storage.spec.whatwg.org/#bucket-map">https://storage.spec.whatwg.org/#bucket-map</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-bucket-map">3.1. Monkey Patch for the Storage Model</a> <a href="#ref-for-bucket-map①">(2)</a> <a href="#ref-for-bucket-map②">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-664d5dfcb76cca05487dc6cce044cd55" class="dfn-panel" data-for="664d5dfcb76cca05487dc6cce044cd55" id="infopanel-for-664d5dfcb76cca05487dc6cce044cd55">
   <span id="infopaneltitle-for-664d5dfcb76cca05487dc6cce044cd55" style="display:none">Info about the 'call' external reference.</span><a href="https://tc39.es/ecma262/#sec-call">https://tc39.es/ecma262/#sec-call</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-call">4.1.4. Run Operation Methods</a> <a href="#ref-for-sec-call①">(2)</a> <a href="#ref-for-sec-call②">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-34df733e79df1618644af3634528503d" class="dfn-panel" data-for="34df733e79df1618644af3634528503d" id="infopanel-for-34df733e79df1618644af3634528503d">
   <span id="infopaneltitle-for-34df733e79df1618644af3634528503d" style="display:none">Info about the 'clear' external reference.</span><a href="https://infra.spec.whatwg.org#map-clear">https://infra.spec.whatwg.org#map-clear</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-clear">3.3. The Database Algorithms</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-481e7c6ccf92a42ccc11b2540aaaef2e" class="dfn-panel" data-for="481e7c6ccf92a42ccc11b2540aaaef2e" id="infopanel-for-481e7c6ccf92a42ccc11b2540aaaef2e">
   <span id="infopaneltitle-for-481e7c6ccf92a42ccc11b2540aaaef2e" style="display:none">Info about the 'client-side storage partitioning' external reference.</span><a href="https://privacycg.github.io/storage-partitioning/#client-side-storage-partitioning">https://privacycg.github.io/storage-partitioning/#client-side-storage-partitioning</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-client-side-storage-partitioning">1. Introduction</a>
    <li><a href="#ref-for-client-side-storage-partitioning①">3.1. Monkey Patch for the Storage Model</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-44c58372ad24111c2ccd1234622ccdf9" class="dfn-panel" data-for="44c58372ad24111c2ccd1234622ccdf9" id="infopanel-for-44c58372ad24111c2ccd1234622ccdf9">
   <span id="infopaneltitle-for-44c58372ad24111c2ccd1234622ccdf9" style="display:none">Info about the 'concatenate' external reference.</span><a href="https://infra.spec.whatwg.org#string-concatenate">https://infra.spec.whatwg.org#string-concatenate</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-string-concatenate">4.1.1. Window Setter/Deleter Methods</a>
    <li><a href="#ref-for-string-concatenate①">4.2.1. Worklet Setter/Deleter Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-da54ce46772fbdbd3d501b2a7bd2f90f" class="dfn-panel" data-for="da54ce46772fbdbd3d501b2a7bd2f90f" id="infopanel-for-da54ce46772fbdbd3d501b2a7bd2f90f">
   <span id="infopaneltitle-for-da54ce46772fbdbd3d501b2a7bd2f90f" style="display:none">Info about the 'contains' external reference.</span><a href="https://infra.spec.whatwg.org#map-exists">https://infra.spec.whatwg.org#map-exists</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-exists">2.3. Registering a Worklet</a>
    <li><a href="#ref-for-map-exists①">3.3. The Database Algorithms</a>
    <li><a href="#ref-for-map-exists②">4.1.3.1. Navigation Entropy Budget</a>
    <li><a href="#ref-for-map-exists③">4.1.4. Run Operation Methods</a> <a href="#ref-for-map-exists④">(2)</a> <a href="#ref-for-map-exists⑤">(3)</a> <a href="#ref-for-map-exists⑥">(4)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-cce127bd5d61bd0a4f5a90c2bf2bc498" class="dfn-panel" data-for="cce127bd5d61bd0a4f5a90c2bf2bc498" id="infopanel-for-cce127bd5d61bd0a4f5a90c2bf2bc498">
   <span id="infopaneltitle-for-cce127bd5d61bd0a4f5a90c2bf2bc498" style="display:none">Info about the 'dequeue' external reference.</span><a href="https://infra.spec.whatwg.org#queue-dequeue">https://infra.spec.whatwg.org#queue-dequeue</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-queue-dequeue">4.2.3. Iteration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-f3af8084c3b5229419ad0d3d9f2bec30" class="dfn-panel" data-for="f3af8084c3b5229419ad0d3d9f2bec30" id="infopanel-for-f3af8084c3b5229419ad0d3d9f2bec30">
   <span id="infopaneltitle-for-f3af8084c3b5229419ad0d3d9f2bec30" style="display:none">Info about the 'destination' external reference.</span><a href="https://wicg.github.io/fenced-frame/#dom-fenceevent-destination">https://wicg.github.io/fenced-frame/#dom-fenceevent-destination</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-fenceevent-destination">4.1.2. SharedStorageUrlWithMetadata and Reporting</a>
    <li><a href="#ref-for-dom-fenceevent-destination①">4.1.3.2. Reporting Entropy Budget</a> <a href="#ref-for-dom-fenceevent-destination②">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-c3a97cf56c441f3a1a6268eb6800109e" class="dfn-panel" data-for="c3a97cf56c441f3a1a6268eb6800109e" id="infopanel-for-c3a97cf56c441f3a1a6268eb6800109e">
   <span id="infopaneltitle-for-c3a97cf56c441f3a1a6268eb6800109e" style="display:none">Info about the 'dictionary' external reference.</span><a href="https://webidl.spec.whatwg.org#dfn-dictionary">https://webidl.spec.whatwg.org#dfn-dictionary</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-dictionary">2.2. The SharedStorageWorkletGlobalScope</a>
    <li><a href="#ref-for-dfn-dictionary①">4.1.2. SharedStorageUrlWithMetadata and Reporting</a> <a href="#ref-for-dfn-dictionary②">(2)</a> <a href="#ref-for-dfn-dictionary③">(3)</a> <a href="#ref-for-dfn-dictionary④">(4)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-8cbd8b5ce00843118ae0df0e9b5c2b48" class="dfn-panel" data-for="8cbd8b5ce00843118ae0df0e9b5c2b48" id="infopanel-for-8cbd8b5ce00843118ae0df0e9b5c2b48">
   <span id="infopaneltitle-for-8cbd8b5ce00843118ae0df0e9b5c2b48" style="display:none">Info about the 'empty (for list)' external reference.</span><a href="https://infra.spec.whatwg.org#list-is-empty">https://infra.spec.whatwg.org#list-is-empty</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-is-empty">4.2.3. Iteration</a> <a href="#ref-for-list-is-empty①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-b328c8757f0a52215bd1026c3f6a610d" class="dfn-panel" data-for="b328c8757f0a52215bd1026c3f6a610d" id="infopanel-for-b328c8757f0a52215bd1026c3f6a610d">
   <span id="infopaneltitle-for-b328c8757f0a52215bd1026c3f6a610d" style="display:none">Info about the 'empty (for map)' external reference.</span><a href="https://infra.spec.whatwg.org#map-is-empty">https://infra.spec.whatwg.org#map-is-empty</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-is-empty">4.1.2. SharedStorageUrlWithMetadata and Reporting</a> <a href="#ref-for-map-is-empty①">(2)</a> <a href="#ref-for-map-is-empty②">(3)</a> <a href="#ref-for-map-is-empty③">(4)</a>
    <li><a href="#ref-for-map-is-empty④">4.1.4. Run Operation Methods</a> <a href="#ref-for-map-is-empty⑤">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-f88dc56692320f33ee7e25b6b7b36a2e" class="dfn-panel" data-for="f88dc56692320f33ee7e25b6b7b36a2e" id="infopanel-for-f88dc56692320f33ee7e25b6b7b36a2e">
   <span id="infopaneltitle-for-f88dc56692320f33ee7e25b6b7b36a2e" style="display:none">Info about the 'ending navigation' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#ending-navigation">https://html.spec.whatwg.org/multipage/webappapis.html#ending-navigation</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ending-navigation">4.1.3.1. Navigation Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-912227903ca1afb6cedeb2e1f8af1552" class="dfn-panel" data-for="912227903ca1afb6cedeb2e1f8af1552" id="infopanel-for-912227903ca1afb6cedeb2e1f8af1552">
   <span id="infopaneltitle-for-912227903ca1afb6cedeb2e1f8af1552" style="display:none">Info about the 'enqueue' external reference.</span><a href="https://infra.spec.whatwg.org#queue-enqueue">https://infra.spec.whatwg.org#queue-enqueue</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-queue-enqueue">4.2.3. Iteration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-9364fab91c2493fa9c139fb1e585204d" class="dfn-panel" data-for="9364fab91c2493fa9c139fb1e585204d" id="infopanel-for-9364fab91c2493fa9c139fb1e585204d">
   <span id="infopaneltitle-for-9364fab91c2493fa9c139fb1e585204d" style="display:none">Info about the 'enqueue the following steps' external reference.</span><a href="https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps">https://html.spec.whatwg.org/multipage/infrastructure.html#enqueue-the-following-steps</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enqueue-the-following-steps">4.1.1. Window Setter/Deleter Methods</a> <a href="#ref-for-enqueue-the-following-steps①">(2)</a> <a href="#ref-for-enqueue-the-following-steps②">(3)</a> <a href="#ref-for-enqueue-the-following-steps③">(4)</a>
    <li><a href="#ref-for-enqueue-the-following-steps④">4.2.1. Worklet Setter/Deleter Methods</a> <a href="#ref-for-enqueue-the-following-steps⑤">(2)</a> <a href="#ref-for-enqueue-the-following-steps⑥">(3)</a> <a href="#ref-for-enqueue-the-following-steps⑦">(4)</a>
    <li><a href="#ref-for-enqueue-the-following-steps⑧">4.2.2. Getter Methods</a> <a href="#ref-for-enqueue-the-following-steps⑨">(2)</a> <a href="#ref-for-enqueue-the-following-steps①⓪">(3)</a>
    <li><a href="#ref-for-enqueue-the-following-steps①①">4.2.3. Iteration</a> <a href="#ref-for-enqueue-the-following-steps①②">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-de81a3f6e9ad8253438fc391812357c1" class="dfn-panel" data-for="de81a3f6e9ad8253438fc391812357c1" id="infopanel-for-de81a3f6e9ad8253438fc391812357c1">
   <span id="infopaneltitle-for-de81a3f6e9ad8253438fc391812357c1" style="display:none">Info about the 'entropy bits' external reference.</span><a href="https://en.wikipedia.org/wiki/Entropy_(information_theory)#entropy-bits">https://en.wikipedia.org/wiki/Entropy_(information_theory)#entropy-bits</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-entropy-bits">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-entropy-bits①">(2)</a> <a href="#ref-for-entropy-bits②">(3)</a> <a href="#ref-for-entropy-bits③">(4)</a>
    <li><a href="#ref-for-entropy-bits④">4.1.3.2. Reporting Entropy Budget</a> <a href="#ref-for-entropy-bits⑤">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-f1b190f56f01259f63ca50355353f5ca" class="dfn-panel" data-for="f1b190f56f01259f63ca50355353f5ca" id="infopanel-for-f1b190f56f01259f63ca50355353f5ca">
   <span id="infopaneltitle-for-f1b190f56f01259f63ca50355353f5ca" style="display:none">Info about the 'entry' external reference.</span><a href="https://infra.spec.whatwg.org#map-entry">https://infra.spec.whatwg.org#map-entry</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-entry">2.3. Registering a Worklet</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-f33dd611caae87733cd018725bcf2176" class="dfn-panel" data-for="f33dd611caae87733cd018725bcf2176" id="infopanel-for-f33dd611caae87733cd018725bcf2176">
   <span id="infopaneltitle-for-f33dd611caae87733cd018725bcf2176" style="display:none">Info about the 'environment' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#environment">https://html.spec.whatwg.org/multipage/webappapis.html#environment</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-environment">4. The SharedStorage Interface</a>
    <li><a href="#ref-for-environment①">4.1.3.1. Navigation Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-d815dc723d8b4fe4b1166e2013ec62b7" class="dfn-panel" data-for="d815dc723d8b4fe4b1166e2013ec62b7" id="infopanel-for-d815dc723d8b4fe4b1166e2013ec62b7">
   <span id="infopaneltitle-for-d815dc723d8b4fe4b1166e2013ec62b7" style="display:none">Info about the 'environment settings object' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-environment-settings-object">2.2. The SharedStorageWorkletGlobalScope</a>
    <li><a href="#ref-for-environment-settings-object①">3.1. Monkey Patch for the Storage Model</a> <a href="#ref-for-environment-settings-object②">(2)</a>
    <li><a href="#ref-for-environment-settings-object③">3.3. The Database Algorithms</a> <a href="#ref-for-environment-settings-object④">(2)</a> <a href="#ref-for-environment-settings-object⑤">(3)</a> <a href="#ref-for-environment-settings-object⑥">(4)</a> <a href="#ref-for-environment-settings-object⑦">(5)</a> <a href="#ref-for-environment-settings-object⑧">(6)</a> <a href="#ref-for-environment-settings-object⑨">(7)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-3b83f59e81f5377a554f5a6d04a10e90" class="dfn-panel" data-for="3b83f59e81f5377a554f5a6d04a10e90" id="infopanel-for-3b83f59e81f5377a554f5a6d04a10e90">
   <span id="infopaneltitle-for-3b83f59e81f5377a554f5a6d04a10e90" style="display:none">Info about the 'eventdata' external reference.</span><a href="https://wicg.github.io/fenced-frame/#dom-fenceevent-eventdata">https://wicg.github.io/fenced-frame/#dom-fenceevent-eventdata</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-fenceevent-eventdata">4.1.2. SharedStorageUrlWithMetadata and Reporting</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-e7c5b1cf1df191e0055611f969d3df54" class="dfn-panel" data-for="e7c5b1cf1df191e0055611f969d3df54" id="infopanel-for-e7c5b1cf1df191e0055611f969d3df54">
   <span id="infopaneltitle-for-e7c5b1cf1df191e0055611f969d3df54" style="display:none">Info about the 'eventtype' external reference.</span><a href="https://wicg.github.io/fenced-frame/#dom-fenceevent-eventtype">https://wicg.github.io/fenced-frame/#dom-fenceevent-eventtype</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-fenceevent-eventtype">4.1.2. SharedStorageUrlWithMetadata and Reporting</a> <a href="#ref-for-dom-fenceevent-eventtype①">(2)</a> <a href="#ref-for-dom-fenceevent-eventtype②">(3)</a> <a href="#ref-for-dom-fenceevent-eventtype③">(4)</a> <a href="#ref-for-dom-fenceevent-eventtype④">(5)</a>
    <li><a href="#ref-for-dom-fenceevent-eventtype⑤">4.1.3.2. Reporting Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-5f3303fb0eb47cba2f99e76886ff261b" class="dfn-panel" data-for="5f3303fb0eb47cba2f99e76886ff261b" id="infopanel-for-5f3303fb0eb47cba2f99e76886ff261b">
   <span id="infopaneltitle-for-5f3303fb0eb47cba2f99e76886ff261b" style="display:none">Info about the 'fence.reportevent()' external reference.</span><a href="https://wicg.github.io/fenced-frame/#dom-fence-reportevent">https://wicg.github.io/fenced-frame/#dom-fence-reportevent</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-fence-reportevent">4.1.2. SharedStorageUrlWithMetadata and Reporting</a>
    <li><a href="#ref-for-dom-fence-reportevent①">4.1.3.2. Reporting Entropy Budget</a> <a href="#ref-for-dom-fence-reportevent②">(2)</a> <a href="#ref-for-dom-fence-reportevent③">(3)</a>
    <li><a href="#ref-for-dom-fence-reportevent④">5. Privacy Considerations</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-5c64ef658c32f9405b423bd4f9ce157d" class="dfn-panel" data-for="5c64ef658c32f9405b423bd4f9ce157d" id="infopanel-for-5c64ef658c32f9405b423bd4f9ce157d">
   <span id="infopaneltitle-for-5c64ef658c32f9405b423bd4f9ce157d" style="display:none">Info about the 'fenced frame' external reference.</span><a href="https://wicg.github.io/fenced-frame/#the-fencedframe-element">https://wicg.github.io/fenced-frame/#the-fencedframe-element</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-the-fencedframe-element">1. Introduction</a>
    <li><a href="#ref-for-the-fencedframe-element①">4.1.2. SharedStorageUrlWithMetadata and Reporting</a> <a href="#ref-for-the-fencedframe-element②">(2)</a> <a href="#ref-for-the-fencedframe-element③">(3)</a>
    <li><a href="#ref-for-the-fencedframe-element④">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-the-fencedframe-element⑤">(2)</a> <a href="#ref-for-the-fencedframe-element⑥">(3)</a> <a href="#ref-for-the-fencedframe-element⑦">(4)</a>
    <li><a href="#ref-for-the-fencedframe-element⑧">4.1.3.2. Reporting Entropy Budget</a> <a href="#ref-for-the-fencedframe-element⑨">(2)</a>
    <li><a href="#ref-for-the-fencedframe-element①⓪">4.1.4. Run Operation Methods</a>
    <li><a href="#ref-for-the-fencedframe-element①①">5. Privacy Considerations</a> <a href="#ref-for-the-fencedframe-element①②">(2)</a> <a href="#ref-for-the-fencedframe-element①③">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-37742f5816e7f0b1f164eea8f9b02958" class="dfn-panel" data-for="37742f5816e7f0b1f164eea8f9b02958" id="infopanel-for-37742f5816e7f0b1f164eea8f9b02958">
   <span id="infopaneltitle-for-37742f5816e7f0b1f164eea8f9b02958" style="display:none">Info about the 'fenceevent' external reference.</span><a href="https://wicg.github.io/fenced-frame/#dictdef-fenceevent">https://wicg.github.io/fenced-frame/#dictdef-fenceevent</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-fenceevent">4.1.2. SharedStorageUrlWithMetadata and Reporting</a> <a href="#ref-for-dictdef-fenceevent①">(2)</a> <a href="#ref-for-dictdef-fenceevent②">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-552e97ed54637294ee331442b4e8b44d" class="dfn-panel" data-for="552e97ed54637294ee331442b4e8b44d" id="infopanel-for-552e97ed54637294ee331442b4e8b44d">
   <span id="infopaneltitle-for-552e97ed54637294ee331442b4e8b44d" style="display:none">Info about the 'function' external reference.</span><a href="https://tc39.es/ecma262/#function-object">https://tc39.es/ecma262/#function-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-function-object">2.2. The SharedStorageWorkletGlobalScope</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-31c272b02f1a06d30699ce8c07bf8026" class="dfn-panel" data-for="31c272b02f1a06d30699ce8c07bf8026" id="infopanel-for-31c272b02f1a06d30699ce8c07bf8026">
   <span id="infopaneltitle-for-31c272b02f1a06d30699ce8c07bf8026" style="display:none">Info about the 'get' external reference.</span><a href="https://infra.spec.whatwg.org#map-get">https://infra.spec.whatwg.org#map-get</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-get">3.3. The Database Algorithms</a> <a href="#ref-for-map-get①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-d146be4d92af5032f41b813a3987d802" class="dfn-panel" data-for="d146be4d92af5032f41b813a3987d802" id="infopanel-for-d146be4d92af5032f41b813a3987d802">
   <span id="infopaneltitle-for-d146be4d92af5032f41b813a3987d802" style="display:none">Info about the 'get the next iteration result' external reference.</span><a href="https://webidl.spec.whatwg.org#dfn-get-the-next-iteration-result">https://webidl.spec.whatwg.org#dfn-get-the-next-iteration-result</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-get-the-next-iteration-result">4.2.3. Iteration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-efe020bb14953eee823e8ef1865182e0" class="dfn-panel" data-for="efe020bb14953eee823e8ef1865182e0" id="infopanel-for-efe020bb14953eee823e8ef1865182e0">
   <span id="infopaneltitle-for-efe020bb14953eee823e8ef1865182e0" style="display:none">Info about the 'get the top-level traversable' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#nav-top">https://html.spec.whatwg.org/multipage/webappapis.html#nav-top</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-nav-top">4.1.3.2. Reporting Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-1c8026e077428d132cb556dbcf505732" class="dfn-panel" data-for="1c8026e077428d132cb556dbcf505732" id="infopanel-for-1c8026e077428d132cb556dbcf505732">
   <span id="infopaneltitle-for-1c8026e077428d132cb556dbcf505732" style="display:none">Info about the 'getmethod()' external reference.</span><a href="https://tc39.es/ecma262/#sec-getmethod">https://tc39.es/ecma262/#sec-getmethod</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-getmethod">2.3. Registering a Worklet</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-da1c6ad2874b1fc0e888db36ff0d8b85" class="dfn-panel" data-for="da1c6ad2874b1fc0e888db36ff0d8b85" id="infopanel-for-da1c6ad2874b1fc0e888db36ff0d8b85">
   <span id="infopaneltitle-for-da1c6ad2874b1fc0e888db36ff0d8b85" style="display:none">Info about the 'isconstructor()' external reference.</span><a href="https://tc39.es/ecma262/#sec-isconstructor">https://tc39.es/ecma262/#sec-isconstructor</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-isconstructor">2.3. Registering a Worklet</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-403a0897c127ffef37d041adb9486b1c" class="dfn-panel" data-for="403a0897c127ffef37d041adb9486b1c" id="infopanel-for-403a0897c127ffef37d041adb9486b1c">
   <span id="infopaneltitle-for-403a0897c127ffef37d041adb9486b1c" style="display:none">Info about the 'item' external reference.</span><a href="https://infra.spec.whatwg.org#list-item">https://infra.spec.whatwg.org#list-item</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-item">4.1.3.1. Navigation Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-03e78949041409fd84dd5f4f06c70de3" class="dfn-panel" data-for="03e78949041409fd84dd5f4f06c70de3" id="infopanel-for-03e78949041409fd84dd5f4f06c70de3">
   <span id="infopaneltitle-for-03e78949041409fd84dd5f4f06c70de3" style="display:none">Info about the 'key' external reference.</span><a href="https://infra.spec.whatwg.org#map-key">https://infra.spec.whatwg.org#map-key</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-key">2.3. Registering a Worklet</a>
    <li><a href="#ref-for-map-key①">4.1.2. SharedStorageUrlWithMetadata and Reporting</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-72936eecec62d59f24339c044925a9ad" class="dfn-panel" data-for="72936eecec62d59f24339c044925a9ad" id="infopanel-for-72936eecec62d59f24339c044925a9ad">
   <span id="infopaneltitle-for-72936eecec62d59f24339c044925a9ad" style="display:none">Info about the 'list' external reference.</span><a href="https://infra.spec.whatwg.org#list">https://infra.spec.whatwg.org#list</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list">2.2. The SharedStorageWorkletGlobalScope</a>
    <li><a href="#ref-for-list①">4.1.1. Window Setter/Deleter Methods</a>
    <li><a href="#ref-for-list②">4.1.3.1. Navigation Entropy Budget</a>
    <li><a href="#ref-for-list③">4.1.4. Run Operation Methods</a> <a href="#ref-for-list④">(2)</a>
    <li><a href="#ref-for-list⑤">4.2.1. Worklet Setter/Deleter Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-5c2c6ee506100ca78ae26ae3cb376fd3" class="dfn-panel" data-for="5c2c6ee506100ca78ae26ae3cb376fd3" id="infopanel-for-5c2c6ee506100ca78ae26ae3cb376fd3">
   <span id="infopaneltitle-for-5c2c6ee506100ca78ae26ae3cb376fd3" style="display:none">Info about the 'list (for HTMLInputElement)' external reference.</span><a href="https://html.spec.whatwg.org/multipage/input.html#dom-input-list">https://html.spec.whatwg.org/multipage/input.html#dom-input-list</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-input-list">4.1.4. Run Operation Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-fb724007dc55f8e55a928d6d33fbbaef" class="dfn-panel" data-for="fb724007dc55f8e55a928d6d33fbbaef" id="infopanel-for-fb724007dc55f8e55a928d6d33fbbaef">
   <span id="infopaneltitle-for-fb724007dc55f8e55a928d6d33fbbaef" style="display:none">Info about the 'map' external reference.</span><a href="https://infra.spec.whatwg.org#ordered-map">https://infra.spec.whatwg.org#ordered-map</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ordered-map">2.2. The SharedStorageWorkletGlobalScope</a>
    <li><a href="#ref-for-ordered-map①">3.1. Monkey Patch for the Storage Model</a> <a href="#ref-for-ordered-map②">(2)</a>
    <li><a href="#ref-for-ordered-map③">4.1.2. SharedStorageUrlWithMetadata and Reporting</a>
    <li><a href="#ref-for-ordered-map④">4.1.3.1. Navigation Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-638c4e281de58d39ae40c4fa51dd247b" class="dfn-panel" data-for="638c4e281de58d39ae40c4fa51dd247b" id="infopanel-for-638c4e281de58d39ae40c4fa51dd247b">
   <span id="infopaneltitle-for-638c4e281de58d39ae40c4fa51dd247b" style="display:none">Info about the 'module map' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#module-map">https://html.spec.whatwg.org/multipage/webappapis.html#module-map</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-module-map">2.2. The SharedStorageWorkletGlobalScope</a>
    <li><a href="#ref-for-module-map①">4.1.4. Run Operation Methods</a> <a href="#ref-for-module-map②">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-3b4d9e0bde382093069451ebd3a62bd0" class="dfn-panel" data-for="3b4d9e0bde382093069451ebd3a62bd0" id="infopanel-for-3b4d9e0bde382093069451ebd3a62bd0">
   <span id="infopaneltitle-for-3b4d9e0bde382093069451ebd3a62bd0" style="display:none">Info about the 'module script' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#module-script">https://html.spec.whatwg.org/multipage/webappapis.html#module-script</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-module-script">2. The SharedStorageWorklet Interface</a> <a href="#ref-for-module-script①">(2)</a> <a href="#ref-for-module-script②">(3)</a>
    <li><a href="#ref-for-module-script③">2.2. The SharedStorageWorkletGlobalScope</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-9b61a10aca6020532301db95d903ae46" class="dfn-panel" data-for="9b61a10aca6020532301db95d903ae46" id="infopanel-for-9b61a10aca6020532301db95d903ae46">
   <span id="infopaneltitle-for-9b61a10aca6020532301db95d903ae46" style="display:none">Info about the 'navigable' external reference.</span><a href="https://html.spec.whatwg.org/multipage/document-sequences.html#navigable">https://html.spec.whatwg.org/multipage/document-sequences.html#navigable</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigable">4.1.3.1. Navigation Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-566b28e53fa11b6a6ff3a9d32626c2c5" class="dfn-panel" data-for="566b28e53fa11b6a6ff3a9d32626c2c5" id="infopanel-for-566b28e53fa11b6a6ff3a9d32626c2c5">
   <span id="infopaneltitle-for-566b28e53fa11b6a6ff3a9d32626c2c5" style="display:none">Info about the 'navigate' external reference.</span><a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigate">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-navigate①">(2)</a> <a href="#ref-for-navigate②">(3)</a>
    <li><a href="#ref-for-navigate③">5. Privacy Considerations</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-6b50287cacc5ac8cf8db87f957c01da4" class="dfn-panel" data-for="6b50287cacc5ac8cf8db87f957c01da4" id="infopanel-for-6b50287cacc5ac8cf8db87f957c01da4">
   <span id="infopaneltitle-for-6b50287cacc5ac8cf8db87f957c01da4" style="display:none">Info about the 'node navigable' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#node-navigable">https://html.spec.whatwg.org/multipage/webappapis.html#node-navigable</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-node-navigable">4.1.3.1. Navigation Entropy Budget</a>
    <li><a href="#ref-for-node-navigable①">4.1.3.2. Reporting Entropy Budget</a> <a href="#ref-for-node-navigable②">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-864fca052f1ae73974ad92254108fb4b" class="dfn-panel" data-for="864fca052f1ae73974ad92254108fb4b" id="infopanel-for-864fca052f1ae73974ad92254108fb4b">
   <span id="infopaneltitle-for-864fca052f1ae73974ad92254108fb4b" style="display:none">Info about the 'object' external reference.</span><a href="https://tc39.es/ecma262/#sec-object-type">https://tc39.es/ecma262/#sec-object-type</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-object-type">2.3. Registering a Worklet</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-922557257eaf67c31019f987b1db3f65" class="dfn-panel" data-for="922557257eaf67c31019f987b1db3f65" id="infopanel-for-922557257eaf67c31019f987b1db3f65">
   <span id="infopaneltitle-for-922557257eaf67c31019f987b1db3f65" style="display:none">Info about the 'obtaining a worklet agent' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#obtain-a-worklet-agent">https://html.spec.whatwg.org/multipage/webappapis.html#obtain-a-worklet-agent</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-a-worklet-agent">4.1.4. Run Operation Methods</a> <a href="#ref-for-obtain-a-worklet-agent①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-8a1ed4f3c2e0da791ce75c1b48916865" class="dfn-panel" data-for="8a1ed4f3c2e0da791ce75c1b48916865" id="infopanel-for-8a1ed4f3c2e0da791ce75c1b48916865">
   <span id="infopaneltitle-for-8a1ed4f3c2e0da791ce75c1b48916865" style="display:none">Info about the 'opaque origin' external reference.</span><a href="https://html.spec.whatwg.org/multipage/browsers.html#concept-opaque-origin">https://html.spec.whatwg.org/multipage/browsers.html#concept-opaque-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-opaque-origin">3.1. Monkey Patch for the Storage Model</a>
    <li><a href="#ref-for-concept-opaque-origin①">4.1.3.1. Navigation Entropy Budget</a>
    <li><a href="#ref-for-concept-opaque-origin②">4.1.4. Run Operation Methods</a>
    <li><a href="#ref-for-concept-opaque-origin③">4.2.2. Getter Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-e66f9f7d45934e77669cb907bd0c7636" class="dfn-panel" data-for="e66f9f7d45934e77669cb907bd0c7636" id="infopanel-for-e66f9f7d45934e77669cb907bd0c7636">
   <span id="infopaneltitle-for-e66f9f7d45934e77669cb907bd0c7636" style="display:none">Info about the 'origin' external reference.</span><a href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">https://html.spec.whatwg.org/multipage/browsers.html#concept-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-origin">3.1. Monkey Patch for the Storage Model</a> <a href="#ref-for-concept-origin①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-9c5cdbb5c3dd225a70ea0af45a02c608" class="dfn-panel" data-for="9c5cdbb5c3dd225a70ea0af45a02c608" id="infopanel-for-9c5cdbb5c3dd225a70ea0af45a02c608">
   <span id="infopaneltitle-for-9c5cdbb5c3dd225a70ea0af45a02c608" style="display:none">Info about the 'origin (for document)' external reference.</span><a href="https://dom.spec.whatwg.org/#concept-document-origin">https://dom.spec.whatwg.org/#concept-document-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-document-origin">4.1.3.1. Navigation Entropy Budget</a>
    <li><a href="#ref-for-concept-document-origin①">4.2.2. Getter Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-8941680dbae2de74bf6821b8c18fe6ba" class="dfn-panel" data-for="8941680dbae2de74bf6821b8c18fe6ba" id="infopanel-for-8941680dbae2de74bf6821b8c18fe6ba">
   <span id="infopaneltitle-for-8941680dbae2de74bf6821b8c18fe6ba" style="display:none">Info about the 'origin (for url)' external reference.</span><a href="https://url.spec.whatwg.org#concept-url-origin">https://url.spec.whatwg.org#concept-url-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-origin">3.1. Monkey Patch for the Storage Model</a>
    <li><a href="#ref-for-concept-url-origin①">4.1.3.1. Navigation Entropy Budget</a>
    <li><a href="#ref-for-concept-url-origin②">4.1.4. Run Operation Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-415a479d0f2716a263c8aeb1eb9eccc2" class="dfn-panel" data-for="415a479d0f2716a263c8aeb1eb9eccc2" id="infopanel-for-415a479d0f2716a263c8aeb1eb9eccc2">
   <span id="infopaneltitle-for-415a479d0f2716a263c8aeb1eb9eccc2" style="display:none">Info about the 'parent' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#nav-parent">https://html.spec.whatwg.org/multipage/webappapis.html#nav-parent</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-nav-parent">4.1.3.1. Navigation Entropy Budget</a>
    <li><a href="#ref-for-nav-parent①">4.1.3.2. Reporting Entropy Budget</a> <a href="#ref-for-nav-parent②">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-7dda08a341a002533188016c9ab2c2e9" class="dfn-panel" data-for="7dda08a341a002533188016c9ab2c2e9" id="infopanel-for-7dda08a341a002533188016c9ab2c2e9">
   <span id="infopaneltitle-for-7dda08a341a002533188016c9ab2c2e9" style="display:none">Info about the 'promise' external reference.</span><a href="https://webidl.spec.whatwg.org#idl-promise">https://webidl.spec.whatwg.org#idl-promise</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-promise⑧">4.1.1. Window Setter/Deleter Methods</a> <a href="#ref-for-idl-promise⑨">(2)</a> <a href="#ref-for-idl-promise①⓪">(3)</a> <a href="#ref-for-idl-promise①①">(4)</a>
    <li><a href="#ref-for-idl-promise①②">4.1.4. Run Operation Methods</a> <a href="#ref-for-idl-promise①③">(2)</a> <a href="#ref-for-idl-promise①④">(3)</a>
    <li><a href="#ref-for-idl-promise①⑧">4.2.1. Worklet Setter/Deleter Methods</a> <a href="#ref-for-idl-promise①⑨">(2)</a> <a href="#ref-for-idl-promise②⓪">(3)</a> <a href="#ref-for-idl-promise②①">(4)</a>
    <li><a href="#ref-for-idl-promise②②">4.2.2. Getter Methods</a> <a href="#ref-for-idl-promise②③">(2)</a> <a href="#ref-for-idl-promise②④">(3)</a>
    <li><a href="#ref-for-idl-promise②⑤">4.2.3. Iteration</a> <a href="#ref-for-idl-promise②⑥">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-8d16650a184a26d81e148cb157cca1a9" class="dfn-panel" data-for="8d16650a184a26d81e148cb157cca1a9" id="infopanel-for-8d16650a184a26d81e148cb157cca1a9">
   <span id="infopaneltitle-for-8d16650a184a26d81e148cb157cca1a9" style="display:none">Info about the 'promise rejected' external reference.</span><a href="https://webidl.spec.whatwg.org#a-promise-rejected-with">https://webidl.spec.whatwg.org#a-promise-rejected-with</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-a-promise-rejected-with">2.1. Monkey Patch for Worklets</a>
    <li><a href="#ref-for-a-promise-rejected-with①">4.1.1. Window Setter/Deleter Methods</a> <a href="#ref-for-a-promise-rejected-with②">(2)</a> <a href="#ref-for-a-promise-rejected-with③">(3)</a> <a href="#ref-for-a-promise-rejected-with④">(4)</a> <a href="#ref-for-a-promise-rejected-with⑤">(5)</a>
    <li><a href="#ref-for-a-promise-rejected-with⑥">4.1.4. Run Operation Methods</a> <a href="#ref-for-a-promise-rejected-with⑦">(2)</a> <a href="#ref-for-a-promise-rejected-with⑧">(3)</a> <a href="#ref-for-a-promise-rejected-with⑨">(4)</a> <a href="#ref-for-a-promise-rejected-with①⓪">(5)</a> <a href="#ref-for-a-promise-rejected-with①①">(6)</a>
    <li><a href="#ref-for-a-promise-rejected-with①②">4.2.1. Worklet Setter/Deleter Methods</a> <a href="#ref-for-a-promise-rejected-with①③">(2)</a> <a href="#ref-for-a-promise-rejected-with①④">(3)</a> <a href="#ref-for-a-promise-rejected-with①⑤">(4)</a> <a href="#ref-for-a-promise-rejected-with①⑥">(5)</a> <a href="#ref-for-a-promise-rejected-with①⑦">(6)</a> <a href="#ref-for-a-promise-rejected-with①⑧">(7)</a>
    <li><a href="#ref-for-a-promise-rejected-with①⑨">4.2.2. Getter Methods</a>
    <li><a href="#ref-for-a-promise-rejected-with②⓪">4.2.3. Iteration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-caab08a991b65588cb3aa567e150914c" class="dfn-panel" data-for="caab08a991b65588cb3aa567e150914c" id="infopanel-for-caab08a991b65588cb3aa567e150914c">
   <span id="infopaneltitle-for-caab08a991b65588cb3aa567e150914c" style="display:none">Info about the 'promise resolved' external reference.</span><a href="https://webidl.spec.whatwg.org#a-promise-resolved-with">https://webidl.spec.whatwg.org#a-promise-resolved-with</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-a-promise-resolved-with">4.1.1. Window Setter/Deleter Methods</a> <a href="#ref-for-a-promise-resolved-with①">(2)</a>
    <li><a href="#ref-for-a-promise-resolved-with②">4.2.1. Worklet Setter/Deleter Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-ffebca42635d9366dd093a2e716bf0a7" class="dfn-panel" data-for="ffebca42635d9366dd093a2e716bf0a7" id="infopanel-for-ffebca42635d9366dd093a2e716bf0a7">
   <span id="infopaneltitle-for-ffebca42635d9366dd093a2e716bf0a7" style="display:none">Info about the 'proxy map reference set' external reference.</span><a href="https://storage.spec.whatwg.org/#storage-bottle-proxy-map-reference-set">https://storage.spec.whatwg.org/#storage-bottle-proxy-map-reference-set</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-storage-bottle-proxy-map-reference-set">3.1. Monkey Patch for the Storage Model</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-7e56922f5cbe4d3973ccc5e2dac6bc39" class="dfn-panel" data-for="7e56922f5cbe4d3973ccc5e2dac6bc39" id="infopanel-for-7e56922f5cbe4d3973ccc5e2dac6bc39">
   <span id="infopaneltitle-for-7e56922f5cbe4d3973ccc5e2dac6bc39" style="display:none">Info about the 'queue' external reference.</span><a href="https://infra.spec.whatwg.org#queue">https://infra.spec.whatwg.org#queue</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-queue">4.2.3. Iteration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-2e5089d3e927d8ac2d7ecd6eb1d79329" class="dfn-panel" data-for="2e5089d3e927d8ac2d7ecd6eb1d79329" id="infopanel-for-2e5089d3e927d8ac2d7ecd6eb1d79329">
   <span id="infopaneltitle-for-2e5089d3e927d8ac2d7ecd6eb1d79329" style="display:none">Info about the 'quota (for storage bottle)' external reference.</span><a href="https://storage.spec.whatwg.org/#storage-bottle-quota">https://storage.spec.whatwg.org/#storage-bottle-quota</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-storage-bottle-quota">3.1. Monkey Patch for the Storage Model</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-b744ad90a49f07627ab4513f6dbee5f9" class="dfn-panel" data-for="b744ad90a49f07627ab4513f6dbee5f9" id="infopanel-for-b744ad90a49f07627ab4513f6dbee5f9">
   <span id="infopaneltitle-for-b744ad90a49f07627ab4513f6dbee5f9" style="display:none">Info about the 'quota (for storage endpoint)' external reference.</span><a href="https://storage.spec.whatwg.org/#storage-endpoint-quota">https://storage.spec.whatwg.org/#storage-endpoint-quota</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-storage-endpoint-quota">3.1. Monkey Patch for the Storage Model</a> <a href="#ref-for-storage-endpoint-quota①">(2)</a> <a href="#ref-for-storage-endpoint-quota②">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-10db1a6b8bd6a17900305dab273015d0" class="dfn-panel" data-for="10db1a6b8bd6a17900305dab273015d0" id="infopanel-for-10db1a6b8bd6a17900305dab273015d0">
   <span id="infopaneltitle-for-10db1a6b8bd6a17900305dab273015d0" style="display:none">Info about the 'register' external reference.</span><a href="https://storage.spec.whatwg.org/#registered-storage-endpoints">https://storage.spec.whatwg.org/#registered-storage-endpoints</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-registered-storage-endpoints">3. Shared Storage’s Backend</a>
    <li><a href="#ref-for-registered-storage-endpoints①">3.1. Monkey Patch for the Storage Model</a> <a href="#ref-for-registered-storage-endpoints②">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-bfb9cb6617f81a424ab20212af73bae3" class="dfn-panel" data-for="bfb9cb6617f81a424ab20212af73bae3" id="infopanel-for-bfb9cb6617f81a424ab20212af73bae3">
   <span id="infopaneltitle-for-bfb9cb6617f81a424ab20212af73bae3" style="display:none">Info about the 'relevant settings object' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-relevant-settings-object">2.2. The SharedStorageWorkletGlobalScope</a>
    <li><a href="#ref-for-relevant-settings-object①">4.1.1. Window Setter/Deleter Methods</a> <a href="#ref-for-relevant-settings-object②">(2)</a> <a href="#ref-for-relevant-settings-object③">(3)</a> <a href="#ref-for-relevant-settings-object④">(4)</a>
    <li><a href="#ref-for-relevant-settings-object⑤">4.1.4. Run Operation Methods</a> <a href="#ref-for-relevant-settings-object⑥">(2)</a>
    <li><a href="#ref-for-relevant-settings-object⑦">4.2.1. Worklet Setter/Deleter Methods</a> <a href="#ref-for-relevant-settings-object⑧">(2)</a> <a href="#ref-for-relevant-settings-object⑨">(3)</a> <a href="#ref-for-relevant-settings-object①⓪">(4)</a>
    <li><a href="#ref-for-relevant-settings-object①①">4.2.2. Getter Methods</a> <a href="#ref-for-relevant-settings-object①②">(2)</a>
    <li><a href="#ref-for-relevant-settings-object①③">4.2.3. Iteration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-cae5d92a36994a4483a8ce0bae1c5451" class="dfn-panel" data-for="cae5d92a36994a4483a8ce0bae1c5451" id="infopanel-for-cae5d92a36994a4483a8ce0bae1c5451">
   <span id="infopaneltitle-for-cae5d92a36994a4483a8ce0bae1c5451" style="display:none">Info about the 'set' external reference.</span><a href="https://infra.spec.whatwg.org#map-set">https://infra.spec.whatwg.org#map-set</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-set">2.3. Registering a Worklet</a>
    <li><a href="#ref-for-map-set①">3.3. The Database Algorithms</a>
    <li><a href="#ref-for-map-set②">4.1.2. SharedStorageUrlWithMetadata and Reporting</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-c74fc5b3d0f64d7ccd0e984abb5d55d6" class="dfn-panel" data-for="c74fc5b3d0f64d7ccd0e984abb5d55d6" id="infopanel-for-c74fc5b3d0f64d7ccd0e984abb5d55d6">
   <span id="infopaneltitle-for-c74fc5b3d0f64d7ccd0e984abb5d55d6" style="display:none">Info about the 'size' external reference.</span><a href="https://infra.spec.whatwg.org#map-size">https://infra.spec.whatwg.org#map-size</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-size">3.1. Monkey Patch for the Storage Model</a>
    <li><a href="#ref-for-map-size①">3.3. The Database Algorithms</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-60e0259e78998a2c29a6de1c2023b4ae" class="dfn-panel" data-for="60e0259e78998a2c29a6de1c2023b4ae" id="infopanel-for-60e0259e78998a2c29a6de1c2023b4ae">
   <span id="infopaneltitle-for-60e0259e78998a2c29a6de1c2023b4ae" style="display:none">Info about the 'start a new parallel queue' external reference.</span><a href="https://html.spec.whatwg.org/multipage/infrastructure.html#starting-a-new-parallel-queue">https://html.spec.whatwg.org/multipage/infrastructure.html#starting-a-new-parallel-queue</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-starting-a-new-parallel-queue">3.2. The Shared Storage Database</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-762beba33f3ad0dfbf19a9c82f4ec357" class="dfn-panel" data-for="762beba33f3ad0dfbf19a9c82f4ec357" id="infopanel-for-762beba33f3ad0dfbf19a9c82f4ec357">
   <span id="infopaneltitle-for-762beba33f3ad0dfbf19a9c82f4ec357" style="display:none">Info about the 'storage bottle' external reference.</span><a href="https://storage.spec.whatwg.org/#storage-bottle">https://storage.spec.whatwg.org/#storage-bottle</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-storage-bottle">3.1. Monkey Patch for the Storage Model</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dcb2985190de22ddc1fac361fc18de5a" class="dfn-panel" data-for="dcb2985190de22ddc1fac361fc18de5a" id="infopanel-for-dcb2985190de22ddc1fac361fc18de5a">
   <span id="infopaneltitle-for-dcb2985190de22ddc1fac361fc18de5a" style="display:none">Info about the 'storage bucket' external reference.</span><a href="https://storage.spec.whatwg.org/#storage-bucket">https://storage.spec.whatwg.org/#storage-bucket</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-storage-bucket">3.1. Monkey Patch for the Storage Model</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-eac294a94562316c9055281be6430038" class="dfn-panel" data-for="eac294a94562316c9055281be6430038" id="infopanel-for-eac294a94562316c9055281be6430038">
   <span id="infopaneltitle-for-eac294a94562316c9055281be6430038" style="display:none">Info about the 'storage endpoint' external reference.</span><a href="https://storage.spec.whatwg.org/#storage-endpoint">https://storage.spec.whatwg.org/#storage-endpoint</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-storage-endpoint">3. Shared Storage’s Backend</a>
    <li><a href="#ref-for-storage-endpoint①">3.1. Monkey Patch for the Storage Model</a> <a href="#ref-for-storage-endpoint②">(2)</a> <a href="#ref-for-storage-endpoint③">(3)</a> <a href="#ref-for-storage-endpoint④">(4)</a> <a href="#ref-for-storage-endpoint⑤">(5)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-cb62c16bb1c9a575c599982c20df5323" class="dfn-panel" data-for="cb62c16bb1c9a575c599982c20df5323" id="infopanel-for-cb62c16bb1c9a575c599982c20df5323">
   <span id="infopaneltitle-for-cb62c16bb1c9a575c599982c20df5323" style="display:none">Info about the 'storage identifier' external reference.</span><a href="https://storage.spec.whatwg.org/#storage-identifier">https://storage.spec.whatwg.org/#storage-identifier</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-storage-identifier">3.1. Monkey Patch for the Storage Model</a> <a href="#ref-for-storage-identifier①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-e50703fb7898b2f1420fa901f5314d60" class="dfn-panel" data-for="e50703fb7898b2f1420fa901f5314d60" id="infopanel-for-e50703fb7898b2f1420fa901f5314d60">
   <span id="infopaneltitle-for-e50703fb7898b2f1420fa901f5314d60" style="display:none">Info about the 'storage key' external reference.</span><a href="https://storage.spec.whatwg.org/#storage-key">https://storage.spec.whatwg.org/#storage-key</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-storage-key">3.1. Monkey Patch for the Storage Model</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-73a1d6afeb04580aedc52a0437d3bfd2" class="dfn-panel" data-for="73a1d6afeb04580aedc52a0437d3bfd2" id="infopanel-for-73a1d6afeb04580aedc52a0437d3bfd2">
   <span id="infopaneltitle-for-73a1d6afeb04580aedc52a0437d3bfd2" style="display:none">Info about the 'storage model' external reference.</span><a href="https://storage.spec.whatwg.org/#model">https://storage.spec.whatwg.org/#model</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-model">3. Shared Storage’s Backend</a>
    <li><a href="#ref-for-model①">3.1. Monkey Patch for the Storage Model</a> <a href="#ref-for-model②">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-b9ee5749da394769624aa65c98d75a96" class="dfn-panel" data-for="b9ee5749da394769624aa65c98d75a96" id="infopanel-for-b9ee5749da394769624aa65c98d75a96">
   <span id="infopaneltitle-for-b9ee5749da394769624aa65c98d75a96" style="display:none">Info about the 'storage proxy map' external reference.</span><a href="https://storage.spec.whatwg.org/#storage-proxy-map">https://storage.spec.whatwg.org/#storage-proxy-map</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-storage-proxy-map">3.1. Monkey Patch for the Storage Model</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-de243662dafa6105374205e64111d467" class="dfn-panel" data-for="de243662dafa6105374205e64111d467" id="infopanel-for-de243662dafa6105374205e64111d467">
   <span id="infopaneltitle-for-de243662dafa6105374205e64111d467" style="display:none">Info about the 'storage shed' external reference.</span><a href="https://storage.spec.whatwg.org/#storage-shed">https://storage.spec.whatwg.org/#storage-shed</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-storage-shed">3.1. Monkey Patch for the Storage Model</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-4ae96685c778dd1d6d81ae3c132bce0e" class="dfn-panel" data-for="4ae96685c778dd1d6d81ae3c132bce0e" id="infopanel-for-4ae96685c778dd1d6d81ae3c132bce0e">
   <span id="infopaneltitle-for-4ae96685c778dd1d6d81ae3c132bce0e" style="display:none">Info about the 'storage shelf' external reference.</span><a href="https://storage.spec.whatwg.org/#storage-shelf">https://storage.spec.whatwg.org/#storage-shelf</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-storage-shelf">3.1. Monkey Patch for the Storage Model</a> <a href="#ref-for-storage-shelf①">(2)</a> <a href="#ref-for-storage-shelf②">(3)</a> <a href="#ref-for-storage-shelf③">(4)</a> <a href="#ref-for-storage-shelf④">(5)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-3454daa78ff554a5f17f57b16fa72e61" class="dfn-panel" data-for="3454daa78ff554a5f17f57b16fa72e61" id="infopanel-for-3454daa78ff554a5f17f57b16fa72e61">
   <span id="infopaneltitle-for-3454daa78ff554a5f17f57b16fa72e61" style="display:none">Info about the 'storage type' external reference.</span><a href="https://storage.spec.whatwg.org/#storage-type">https://storage.spec.whatwg.org/#storage-type</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-storage-type">3.1. Monkey Patch for the Storage Model</a> <a href="#ref-for-storage-type①">(2)</a> <a href="#ref-for-storage-type②">(3)</a> <a href="#ref-for-storage-type③">(4)</a> <a href="#ref-for-storage-type④">(5)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-a8f48fb35292efd21a347f15fdac6334" class="dfn-panel" data-for="a8f48fb35292efd21a347f15fdac6334" id="infopanel-for-a8f48fb35292efd21a347f15fdac6334">
   <span id="infopaneltitle-for-a8f48fb35292efd21a347f15fdac6334" style="display:none">Info about the 'string' external reference.</span><a href="https://infra.spec.whatwg.org#string">https://infra.spec.whatwg.org#string</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-string">2.2. The SharedStorageWorkletGlobalScope</a> <a href="#ref-for-string①">(2)</a>
    <li><a href="#ref-for-string②">3.2. The Shared Storage Database</a> <a href="#ref-for-string③">(2)</a>
    <li><a href="#ref-for-string④">4.1.2. SharedStorageUrlWithMetadata and Reporting</a> <a href="#ref-for-string⑤">(2)</a> <a href="#ref-for-string⑥">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-f4cd6265b36800faa2839af29623c32c" class="dfn-panel" data-for="f4cd6265b36800faa2839af29623c32c" id="infopanel-for-f4cd6265b36800faa2839af29623c32c">
   <span id="infopaneltitle-for-f4cd6265b36800faa2839af29623c32c" style="display:none">Info about the 'struct' external reference.</span><a href="https://infra.spec.whatwg.org#struct">https://infra.spec.whatwg.org#struct</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-struct">3.2. The Shared Storage Database</a>
    <li><a href="#ref-for-struct①">4.1.3.1. Navigation Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-88acb424f236089050e7f4c429bc07ea" class="dfn-panel" data-for="88acb424f236089050e7f4c429bc07ea" id="infopanel-for-88acb424f236089050e7f4c429bc07ea">
   <span id="infopaneltitle-for-88acb424f236089050e7f4c429bc07ea" style="display:none">Info about the 'target browsing context' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-environment-target-browsing-context">4.2.1. Worklet Setter/Deleter Methods</a> <a href="#ref-for-concept-environment-target-browsing-context①">(2)</a> <a href="#ref-for-concept-environment-target-browsing-context②">(3)</a> <a href="#ref-for-concept-environment-target-browsing-context③">(4)</a>
    <li><a href="#ref-for-concept-environment-target-browsing-context④">4.2.2. Getter Methods</a> <a href="#ref-for-concept-environment-target-browsing-context⑤">(2)</a> <a href="#ref-for-concept-environment-target-browsing-context⑥">(3)</a>
    <li><a href="#ref-for-concept-environment-target-browsing-context⑦">4.2.3. Iteration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-6d1f737f1fe3dbd01f26fbf2f2644f9c" class="dfn-panel" data-for="6d1f737f1fe3dbd01f26fbf2f2644f9c" id="infopanel-for-6d1f737f1fe3dbd01f26fbf2f2644f9c">
   <span id="infopaneltitle-for-6d1f737f1fe3dbd01f26fbf2f2644f9c" style="display:none">Info about the 'terminate a worklet global scope' external reference.</span><a href="https://html.spec.whatwg.org/multipage/worklets.html#terminate-a-worklet-global-scope">https://html.spec.whatwg.org/multipage/worklets.html#terminate-a-worklet-global-scope</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-terminate-a-worklet-global-scope">4.1.4. Run Operation Methods</a> <a href="#ref-for-terminate-a-worklet-global-scope①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-18f65fd908c664da61d3d9b2e9d11bdd" class="dfn-panel" data-for="18f65fd908c664da61d3d9b2e9d11bdd" id="infopanel-for-18f65fd908c664da61d3d9b2e9d11bdd">
   <span id="infopaneltitle-for-18f65fd908c664da61d3d9b2e9d11bdd" style="display:none">Info about the 'top-frame' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#top-level-traversable">https://html.spec.whatwg.org/multipage/webappapis.html#top-level-traversable</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-top-level-traversable">1. Introduction</a> <a href="#ref-for-top-level-traversable①">(2)</a>
    <li><a href="#ref-for-top-level-traversable②">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-top-level-traversable③">(2)</a> <a href="#ref-for-top-level-traversable④">(3)</a> <a href="#ref-for-top-level-traversable⑤">(4)</a>
    <li><a href="#ref-for-top-level-traversable⑥">4.1.3.2. Reporting Entropy Budget</a> <a href="#ref-for-top-level-traversable⑦">(2)</a> <a href="#ref-for-top-level-traversable⑧">(3)</a>
    <li><a href="#ref-for-top-level-traversable⑨">5. Privacy Considerations</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-9a385596636f5af6591597c38324e449" class="dfn-panel" data-for="9a385596636f5af6591597c38324e449" id="infopanel-for-9a385596636f5af6591597c38324e449">
   <span id="infopaneltitle-for-9a385596636f5af6591597c38324e449" style="display:none">Info about the 'top-level traversable' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#top-level-traversable">https://html.spec.whatwg.org/multipage/webappapis.html#top-level-traversable</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-top-level-traversable">1. Introduction</a> <a href="#ref-for-top-level-traversable①">(2)</a>
    <li><a href="#ref-for-top-level-traversable②">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-top-level-traversable③">(2)</a> <a href="#ref-for-top-level-traversable④">(3)</a> <a href="#ref-for-top-level-traversable⑤">(4)</a>
    <li><a href="#ref-for-top-level-traversable⑥">4.1.3.2. Reporting Entropy Budget</a> <a href="#ref-for-top-level-traversable⑦">(2)</a> <a href="#ref-for-top-level-traversable⑧">(3)</a>
    <li><a href="#ref-for-top-level-traversable⑨">5. Privacy Considerations</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-0e2f334f68df47e02e59c1bb0e056e13" class="dfn-panel" data-for="0e2f334f68df47e02e59c1bb0e056e13" id="infopanel-for-0e2f334f68df47e02e59c1bb0e056e13">
   <span id="infopaneltitle-for-0e2f334f68df47e02e59c1bb0e056e13" style="display:none">Info about the 'traversable navigable' external reference.</span><a href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-traversable">https://html.spec.whatwg.org/multipage/document-sequences.html#nav-traversable</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-nav-traversable">4.1.3.1. Navigation Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-c6a6e18a0bfb0f6727343f416cd90c01" class="dfn-panel" data-for="c6a6e18a0bfb0f6727343f416cd90c01" id="infopanel-for-c6a6e18a0bfb0f6727343f416cd90c01">
   <span id="infopaneltitle-for-c6a6e18a0bfb0f6727343f416cd90c01" style="display:none">Info about the 'unix epoch' external reference.</span><a href="https://w3c.github.io/hr-time/#dfn-unix-epoch">https://w3c.github.io/hr-time/#dfn-unix-epoch</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-unix-epoch">3.2. The Shared Storage Database</a>
    <li><a href="#ref-for-dfn-unix-epoch①">4.1.3.1. Navigation Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dcf29be761156b598247854e294e3705" class="dfn-panel" data-for="dcf29be761156b598247854e294e3705" id="infopanel-for-dcf29be761156b598247854e294e3705">
   <span id="infopaneltitle-for-dcf29be761156b598247854e294e3705" style="display:none">Info about the 'upon fulfillment' external reference.</span><a href="https://webidl.spec.whatwg.org#upon-fulfillment">https://webidl.spec.whatwg.org#upon-fulfillment</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-upon-fulfillment">4.1.4. Run Operation Methods</a> <a href="#ref-for-upon-fulfillment①">(2)</a> <a href="#ref-for-upon-fulfillment②">(3)</a>
    <li><a href="#ref-for-upon-fulfillment③">4.2.3. Iteration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-f4113d72a91aadf0789f9e5cf76669be" class="dfn-panel" data-for="f4113d72a91aadf0789f9e5cf76669be" id="infopanel-for-f4113d72a91aadf0789f9e5cf76669be">
   <span id="infopaneltitle-for-f4113d72a91aadf0789f9e5cf76669be" style="display:none">Info about the 'upon rejection' external reference.</span><a href="https://webidl.spec.whatwg.org#upon-rejection">https://webidl.spec.whatwg.org#upon-rejection</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-upon-rejection">4.1.4. Run Operation Methods</a> <a href="#ref-for-upon-rejection①">(2)</a> <a href="#ref-for-upon-rejection②">(3)</a>
    <li><a href="#ref-for-upon-rejection③">4.2.3. Iteration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-9f1060e036985eef125ae551d5923654" class="dfn-panel" data-for="9f1060e036985eef125ae551d5923654" id="infopanel-for-9f1060e036985eef125ae551d5923654">
   <span id="infopaneltitle-for-9f1060e036985eef125ae551d5923654" style="display:none">Info about the 'url parser' external reference.</span><a href="https://url.spec.whatwg.org#concept-url-parser">https://url.spec.whatwg.org#concept-url-parser</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-parser">4.1.2. SharedStorageUrlWithMetadata and Reporting</a> <a href="#ref-for-concept-url-parser①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-98a8c263bf696e702c5230677356610b" class="dfn-panel" data-for="98a8c263bf696e702c5230677356610b" id="infopanel-for-98a8c263bf696e702c5230677356610b">
   <span id="infopaneltitle-for-98a8c263bf696e702c5230677356610b" style="display:none">Info about the 'user agent' external reference.</span><a href="https://infra.spec.whatwg.org#user-agent">https://infra.spec.whatwg.org#user-agent</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-user-agent">3.1. Monkey Patch for the Storage Model</a> <a href="#ref-for-user-agent①">(2)</a> <a href="#ref-for-user-agent②">(3)</a>
    <li><a href="#ref-for-user-agent③">3.2. The Shared Storage Database</a> <a href="#ref-for-user-agent④">(2)</a> <a href="#ref-for-user-agent⑤">(3)</a> <a href="#ref-for-user-agent⑥">(4)</a>
    <li><a href="#ref-for-user-agent⑦">3.3. The Database Algorithms</a>
    <li><a href="#ref-for-user-agent⑧">4.1.3. Entropy Budgets</a>
    <li><a href="#ref-for-user-agent⑨">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-user-agent①⓪">(2)</a> <a href="#ref-for-user-agent①①">(3)</a> <a href="#ref-for-user-agent①②">(4)</a> <a href="#ref-for-user-agent①③">(5)</a> <a href="#ref-for-user-agent①④">(6)</a> <a href="#ref-for-user-agent①⑤">(7)</a> <a href="#ref-for-user-agent①⑥">(8)</a> <a href="#ref-for-user-agent①⑦">(9)</a> <a href="#ref-for-user-agent①⑧">(10)</a>
    <li><a href="#ref-for-user-agent①⑨">4.1.3.2. Reporting Entropy Budget</a> <a href="#ref-for-user-agent②⓪">(2)</a> <a href="#ref-for-user-agent②①">(3)</a> <a href="#ref-for-user-agent②②">(4)</a> <a href="#ref-for-user-agent②③">(5)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-2100e84f8b949d8a0b6baaf762471a43" class="dfn-panel" data-for="2100e84f8b949d8a0b6baaf762471a43" id="infopanel-for-2100e84f8b949d8a0b6baaf762471a43">
   <span id="infopaneltitle-for-2100e84f8b949d8a0b6baaf762471a43" style="display:none">Info about the 'value' external reference.</span><a href="https://infra.spec.whatwg.org#map-value">https://infra.spec.whatwg.org#map-value</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-value">4.1.2. SharedStorageUrlWithMetadata and Reporting</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-81a3f446d4ec5b7ccd239f33895a87fc" class="dfn-panel" data-for="81a3f446d4ec5b7ccd239f33895a87fc" id="infopanel-for-81a3f446d4ec5b7ccd239f33895a87fc">
   <span id="infopaneltitle-for-81a3f446d4ec5b7ccd239f33895a87fc" style="display:none">Info about the 'web idl standard' external reference.</span><a href="https://webidl.spec.whatwg.org#introduction">https://webidl.spec.whatwg.org#introduction</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-introduction">4.2.3. Iteration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-1500392fd3bfa55622e01ffbd82d8dd7" class="dfn-panel" data-for="1500392fd3bfa55622e01ffbd82d8dd7" id="infopanel-for-1500392fd3bfa55622e01ffbd82d8dd7">
   <span id="infopaneltitle-for-1500392fd3bfa55622e01ffbd82d8dd7" style="display:none">Info about the 'worklet global scope type' external reference.</span><a href="https://html.spec.whatwg.org/multipage/worklets.html#worklet-global-scope-type">https://html.spec.whatwg.org/multipage/worklets.html#worklet-global-scope-type</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-worklet-global-scope-type">2.2. The SharedStorageWorkletGlobalScope</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-4ab072d8bc76dd7348f291f60d1f0c69" class="dfn-panel" data-for="4ab072d8bc76dd7348f291f60d1f0c69" id="infopanel-for-4ab072d8bc76dd7348f291f60d1f0c69">
   <span id="infopaneltitle-for-4ab072d8bc76dd7348f291f60d1f0c69" style="display:none">Info about the 'worklets' external reference.</span><a href="https://html.spec.whatwg.org/multipage/worklets.html#worklets">https://html.spec.whatwg.org/multipage/worklets.html#worklets</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-worklets">2.1. Monkey Patch for Worklets</a> <a href="#ref-for-worklets①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-eb75379b05abc264a531a791358e1eba" class="dfn-panel" data-for="eb75379b05abc264a531a791358e1eba" id="infopanel-for-eb75379b05abc264a531a791358e1eba">
   <span id="infopaneltitle-for-eb75379b05abc264a531a791358e1eba" style="display:none">Info about the 'contain' external reference.</span><a href="https://infra.spec.whatwg.org/#list-contain">https://infra.spec.whatwg.org/#list-contain</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-contain">4.1.2. SharedStorageUrlWithMetadata and Reporting</a>
    <li><a href="#ref-for-list-contain①">4.1.3.2. Reporting Entropy Budget</a> <a href="#ref-for-list-contain②">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-3875a727a3224d295450f00d93777fbd" class="dfn-panel" data-for="3875a727a3224d295450f00d93777fbd" id="infopanel-for-3875a727a3224d295450f00d93777fbd">
   <span id="infopaneltitle-for-3875a727a3224d295450f00d93777fbd" style="display:none">Info about the 'getting the values' external reference.</span><a href="https://infra.spec.whatwg.org/#map-getting-the-values">https://infra.spec.whatwg.org/#map-getting-the-values</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-getting-the-values">3.3. The Database Algorithms</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-81b03c84949641fc3081227509aab38f" class="dfn-panel" data-for="81b03c84949641fc3081227509aab38f" id="infopanel-for-81b03c84949641fc3081227509aab38f">
   <span id="infopaneltitle-for-81b03c84949641fc3081227509aab38f" style="display:none">Info about the 'length' external reference.</span><a href="https://infra.spec.whatwg.org/#string-length">https://infra.spec.whatwg.org/#string-length</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-string-length">4.1.1. Window Setter/Deleter Methods</a> <a href="#ref-for-string-length①">(2)</a> <a href="#ref-for-string-length②">(3)</a> <a href="#ref-for-string-length③">(4)</a> <a href="#ref-for-string-length④">(5)</a>
    <li><a href="#ref-for-string-length⑤">4.2.1. Worklet Setter/Deleter Methods</a> <a href="#ref-for-string-length⑥">(2)</a> <a href="#ref-for-string-length⑦">(3)</a> <a href="#ref-for-string-length⑧">(4)</a> <a href="#ref-for-string-length⑨">(5)</a>
    <li><a href="#ref-for-string-length①⓪">4.2.2. Getter Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-fadc27e826887faf120674544589ae68" class="dfn-panel" data-for="fadc27e826887faf120674544589ae68" id="infopanel-for-fadc27e826887faf120674544589ae68">
   <span id="infopaneltitle-for-fadc27e826887faf120674544589ae68" style="display:none">Info about the 'remove (for list)' external reference.</span><a href="https://infra.spec.whatwg.org/#list-remove">https://infra.spec.whatwg.org/#list-remove</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-remove">4.1.3.2. Reporting Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-5191a0c00b6ec5f93646e492ae7ec62c" class="dfn-panel" data-for="5191a0c00b6ec5f93646e492ae7ec62c" id="infopanel-for-5191a0c00b6ec5f93646e492ae7ec62c">
   <span id="infopaneltitle-for-5191a0c00b6ec5f93646e492ae7ec62c" style="display:none">Info about the 'remove (for map)' external reference.</span><a href="https://infra.spec.whatwg.org/#map-remove">https://infra.spec.whatwg.org/#map-remove</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-remove">3.3. The Database Algorithms</a> <a href="#ref-for-map-remove①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-bed8381510f5967f5d37a33de776e857" class="dfn-panel" data-for="bed8381510f5967f5d37a33de776e857" id="infopanel-for-bed8381510f5967f5d37a33de776e857">
   <span id="infopaneltitle-for-bed8381510f5967f5d37a33de776e857" style="display:none">Info about the 'size' external reference.</span><a href="https://infra.spec.whatwg.org/#list-size">https://infra.spec.whatwg.org/#list-size</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-size">4.1.3.1. Navigation Entropy Budget</a>
    <li><a href="#ref-for-list-size①">4.1.4. Run Operation Methods</a> <a href="#ref-for-list-size②">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-954959f9e7bfc13ff9d9416457ba456d" class="dfn-panel" data-for="954959f9e7bfc13ff9d9416457ba456d" id="infopanel-for-954959f9e7bfc13ff9d9416457ba456d">
   <span id="infopaneltitle-for-954959f9e7bfc13ff9d9416457ba456d" style="display:none">Info about the 'legitimate use cases' external reference.</span><a href="https://github.com/WICG/shared-storage#example-scenarios">https://github.com/WICG/shared-storage#example-scenarios</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-example-scenarios">1. Introduction</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-42e72e3aa2b805865905b73c6fa0282e" class="dfn-panel" data-for="42e72e3aa2b805865905b73c6fa0282e" id="infopanel-for-42e72e3aa2b805865905b73c6fa0282e">
   <span id="infopaneltitle-for-42e72e3aa2b805865905b73c6fa0282e" style="display:none">Info about the 'private aggregation' external reference.</span><a href="https://github.com/patcg-individual-drafts/private-aggregation-api/blob/main/README.md#private-aggregation">https://github.com/patcg-individual-drafts/private-aggregation-api/blob/main/README.md#private-aggregation</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-private-aggregation">1. Introduction</a>
    <li><a href="#ref-for-private-aggregation①">2. The SharedStorageWorklet Interface</a>
    <li><a href="#ref-for-private-aggregation②">2.2. The SharedStorageWorkletGlobalScope</a>
    <li><a href="#ref-for-private-aggregation③">5. Privacy Considerations</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-40b6c52ddb2a775a0eb7ff546dd9e8b6" class="dfn-panel" data-for="40b6c52ddb2a775a0eb7ff546dd9e8b6" id="infopanel-for-40b6c52ddb2a775a0eb7ff546dd9e8b6">
   <span id="infopaneltitle-for-40b6c52ddb2a775a0eb7ff546dd9e8b6" style="display:none">Info about the 'URL' external reference.</span><a href="https://url.spec.whatwg.org/#url">https://url.spec.whatwg.org/#url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-url">2.2. The SharedStorageWorkletGlobalScope</a> <a href="#ref-for-url①">(2)</a>
    <li><a href="#ref-for-url②">4.1.2. SharedStorageUrlWithMetadata and Reporting</a> <a href="#ref-for-url③">(2)</a> <a href="#ref-for-url④">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-fc05c76e016d3aec6a25a91c066500c8" class="dfn-panel" data-for="fc05c76e016d3aec6a25a91c066500c8" id="infopanel-for-fc05c76e016d3aec6a25a91c066500c8">
   <span id="infopaneltitle-for-fc05c76e016d3aec6a25a91c066500c8" style="display:none">Info about the 'url' external reference.</span><a href="https://url.spec.whatwg.org/#concept-url">https://url.spec.whatwg.org/#concept-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url">4.1.2. SharedStorageUrlWithMetadata and Reporting</a> <a href="#ref-for-concept-url①">(2)</a> <a href="#ref-for-concept-url②">(3)</a> <a href="#ref-for-concept-url③">(4)</a>
    <li><a href="#ref-for-concept-url④">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-concept-url⑤">(2)</a> <a href="#ref-for-concept-url⑥">(3)</a>
    <li><a href="#ref-for-concept-url⑦">4.1.3.2. Reporting Entropy Budget</a>
    <li><a href="#ref-for-concept-url⑧">4.1.4. Run Operation Methods</a> <a href="#ref-for-concept-url⑨">(2)</a>
    <li><a href="#ref-for-concept-url①⓪">5. Privacy Considerations</a> <a href="#ref-for-concept-url①①">(2)</a> <a href="#ref-for-concept-url①②">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-4cd5cba6c3b356beb9ed1d910eaf8ee9" class="dfn-panel" data-for="4cd5cba6c3b356beb9ed1d910eaf8ee9" id="infopanel-for-4cd5cba6c3b356beb9ed1d910eaf8ee9">
   <span id="infopaneltitle-for-4cd5cba6c3b356beb9ed1d910eaf8ee9" style="display:none">Info about the 'url serializer' external reference.</span><a href="https://url.spec.whatwg.org/#concept-url-serializer">https://url.spec.whatwg.org/#concept-url-serializer</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-serializer">4.1.2. SharedStorageUrlWithMetadata and Reporting</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-d0f238a61de9310f1738a214749fab18" class="dfn-panel" data-for="d0f238a61de9310f1738a214749fab18" id="infopanel-for-d0f238a61de9310f1738a214749fab18">
   <span id="infopaneltitle-for-d0f238a61de9310f1738a214749fab18" style="display:none">Info about the 'DOMString' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-DOMString">https://webidl.spec.whatwg.org/#idl-DOMString</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-DOMString">2.2. The SharedStorageWorkletGlobalScope</a>
    <li><a href="#ref-for-idl-DOMString①">4. The SharedStorage Interface</a> <a href="#ref-for-idl-DOMString②">(2)</a> <a href="#ref-for-idl-DOMString③">(3)</a> <a href="#ref-for-idl-DOMString④">(4)</a> <a href="#ref-for-idl-DOMString⑤">(5)</a>
    <li><a href="#ref-for-idl-DOMString⑥">4.1. The WindowSharedStorage interface</a> <a href="#ref-for-idl-DOMString⑦">(2)</a>
    <li><a href="#ref-for-idl-DOMString⑧">4.2. The WorkletSharedStorage interface</a> <a href="#ref-for-idl-DOMString⑨">(2)</a> <a href="#ref-for-idl-DOMString①⓪">(3)</a> <a href="#ref-for-idl-DOMString①①">(4)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dde049eb112f043fc45407ec0d4cb457" class="dfn-panel" data-for="dde049eb112f043fc45407ec0d4cb457" id="infopanel-for-dde049eb112f043fc45407ec0d4cb457">
   <span id="infopaneltitle-for-dde049eb112f043fc45407ec0d4cb457" style="display:none">Info about the 'Exposed' external reference.</span><a href="https://webidl.spec.whatwg.org/#Exposed">https://webidl.spec.whatwg.org/#Exposed</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-Exposed">2. The SharedStorageWorklet Interface</a>
    <li><a href="#ref-for-Exposed①">2.2. The SharedStorageWorkletGlobalScope</a> <a href="#ref-for-Exposed②">(2)</a> <a href="#ref-for-Exposed③">(3)</a> <a href="#ref-for-Exposed④">(4)</a>
    <li><a href="#ref-for-Exposed⑤">4. The SharedStorage Interface</a>
    <li><a href="#ref-for-Exposed⑥">4.1. The WindowSharedStorage interface</a>
    <li><a href="#ref-for-Exposed⑦">4.2. The WorkletSharedStorage interface</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-30e8367dc9a547b9096d98ba691987d9" class="dfn-panel" data-for="30e8367dc9a547b9096d98ba691987d9" id="infopanel-for-30e8367dc9a547b9096d98ba691987d9">
   <span id="infopaneltitle-for-30e8367dc9a547b9096d98ba691987d9" style="display:none">Info about the 'FrozenArray' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-frozen-array">https://webidl.spec.whatwg.org/#idl-frozen-array</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-frozen-array">2.2. The SharedStorageWorkletGlobalScope</a>
    <li><a href="#ref-for-idl-frozen-array①">4.1. The WindowSharedStorage interface</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-87854fa3332c5bf035dec1c1725d8450" class="dfn-panel" data-for="87854fa3332c5bf035dec1c1725d8450" id="infopanel-for-87854fa3332c5bf035dec1c1725d8450">
   <span id="infopaneltitle-for-87854fa3332c5bf035dec1c1725d8450" style="display:none">Info about the 'Global' external reference.</span><a href="https://webidl.spec.whatwg.org/#Global">https://webidl.spec.whatwg.org/#Global</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-Global">2.2. The SharedStorageWorkletGlobalScope</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-93669c631ec1ef8e696b4c083bdbe12c" class="dfn-panel" data-for="93669c631ec1ef8e696b4c083bdbe12c" id="infopanel-for-93669c631ec1ef8e696b4c083bdbe12c">
   <span id="infopaneltitle-for-93669c631ec1ef8e696b4c083bdbe12c" style="display:none">Info about the 'Promise' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-promise">https://webidl.spec.whatwg.org/#idl-promise</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-promise">2.2. The SharedStorageWorkletGlobalScope</a> <a href="#ref-for-idl-promise①">(2)</a>
    <li><a href="#ref-for-idl-promise②">4. The SharedStorage Interface</a> <a href="#ref-for-idl-promise③">(2)</a> <a href="#ref-for-idl-promise④">(3)</a> <a href="#ref-for-idl-promise⑤">(4)</a>
    <li><a href="#ref-for-idl-promise⑥">4.1. The WindowSharedStorage interface</a> <a href="#ref-for-idl-promise⑦">(2)</a>
    <li><a href="#ref-for-idl-promise①⑤">4.2. The WorkletSharedStorage interface</a> <a href="#ref-for-idl-promise①⑥">(2)</a> <a href="#ref-for-idl-promise①⑦">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-3f9c3eac015894a734faa8068fd8c2a1" class="dfn-panel" data-for="3f9c3eac015894a734faa8068fd8c2a1" id="infopanel-for-3f9c3eac015894a734faa8068fd8c2a1">
   <span id="infopaneltitle-for-3f9c3eac015894a734faa8068fd8c2a1" style="display:none">Info about the 'TypeError' external reference.</span><a href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror">https://webidl.spec.whatwg.org/#exceptiondef-typeerror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-exceptiondef-typeerror">2.1. Monkey Patch for Worklets</a>
    <li><a href="#ref-for-exceptiondef-typeerror①">2.3. Registering a Worklet</a> <a href="#ref-for-exceptiondef-typeerror②">(2)</a> <a href="#ref-for-exceptiondef-typeerror③">(3)</a> <a href="#ref-for-exceptiondef-typeerror④">(4)</a> <a href="#ref-for-exceptiondef-typeerror⑤">(5)</a> <a href="#ref-for-exceptiondef-typeerror⑥">(6)</a>
    <li><a href="#ref-for-exceptiondef-typeerror⑦">4.1.1. Window Setter/Deleter Methods</a> <a href="#ref-for-exceptiondef-typeerror⑧">(2)</a> <a href="#ref-for-exceptiondef-typeerror⑨">(3)</a> <a href="#ref-for-exceptiondef-typeerror①⓪">(4)</a> <a href="#ref-for-exceptiondef-typeerror①①">(5)</a>
    <li><a href="#ref-for-exceptiondef-typeerror①②">4.1.4. Run Operation Methods</a> <a href="#ref-for-exceptiondef-typeerror①③">(2)</a> <a href="#ref-for-exceptiondef-typeerror①④">(3)</a> <a href="#ref-for-exceptiondef-typeerror①⑤">(4)</a> <a href="#ref-for-exceptiondef-typeerror①⑥">(5)</a> <a href="#ref-for-exceptiondef-typeerror①⑦">(6)</a> <a href="#ref-for-exceptiondef-typeerror①⑧">(7)</a> <a href="#ref-for-exceptiondef-typeerror①⑨">(8)</a> <a href="#ref-for-exceptiondef-typeerror②⓪">(9)</a>
    <li><a href="#ref-for-exceptiondef-typeerror②①">4.2.1. Worklet Setter/Deleter Methods</a> <a href="#ref-for-exceptiondef-typeerror②②">(2)</a> <a href="#ref-for-exceptiondef-typeerror②③">(3)</a> <a href="#ref-for-exceptiondef-typeerror②④">(4)</a> <a href="#ref-for-exceptiondef-typeerror②⑤">(5)</a> <a href="#ref-for-exceptiondef-typeerror②⑥">(6)</a> <a href="#ref-for-exceptiondef-typeerror②⑦">(7)</a> <a href="#ref-for-exceptiondef-typeerror②⑧">(8)</a> <a href="#ref-for-exceptiondef-typeerror②⑨">(9)</a> <a href="#ref-for-exceptiondef-typeerror③⓪">(10)</a> <a href="#ref-for-exceptiondef-typeerror③①">(11)</a>
    <li><a href="#ref-for-exceptiondef-typeerror③②">4.2.2. Getter Methods</a> <a href="#ref-for-exceptiondef-typeerror③③">(2)</a> <a href="#ref-for-exceptiondef-typeerror③④">(3)</a>
    <li><a href="#ref-for-exceptiondef-typeerror③⑤">4.2.3. Iteration</a> <a href="#ref-for-exceptiondef-typeerror③⑥">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-e270bcd7cdb4abe27bc3bb16a1975937" class="dfn-panel" data-for="e270bcd7cdb4abe27bc3bb16a1975937" id="infopanel-for-e270bcd7cdb4abe27bc3bb16a1975937">
   <span id="infopaneltitle-for-e270bcd7cdb4abe27bc3bb16a1975937" style="display:none">Info about the 'USVString' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-USVString">https://webidl.spec.whatwg.org/#idl-USVString</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-USVString">4.1. The WindowSharedStorage interface</a>
    <li><a href="#ref-for-idl-USVString①">4.1.2. SharedStorageUrlWithMetadata and Reporting</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-8eec6bb7878bb17dddbbb727b8d77c28" class="dfn-panel" data-for="8eec6bb7878bb17dddbbb727b8d77c28" id="infopanel-for-8eec6bb7878bb17dddbbb727b8d77c28">
   <span id="infopaneltitle-for-8eec6bb7878bb17dddbbb727b8d77c28" style="display:none">Info about the 'any' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-any">https://webidl.spec.whatwg.org/#idl-any</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-any">4. The SharedStorage Interface</a> <a href="#ref-for-idl-any①">(2)</a> <a href="#ref-for-idl-any②">(3)</a> <a href="#ref-for-idl-any③">(4)</a>
    <li><a href="#ref-for-idl-any④">4.1. The WindowSharedStorage interface</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-f8062b07e25ed0281f5cbfb9a54070b4" class="dfn-panel" data-for="f8062b07e25ed0281f5cbfb9a54070b4" id="infopanel-for-f8062b07e25ed0281f5cbfb9a54070b4">
   <span id="infopaneltitle-for-f8062b07e25ed0281f5cbfb9a54070b4" style="display:none">Info about the 'boolean' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-boolean">https://webidl.spec.whatwg.org/#idl-boolean</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-boolean">2.2. The SharedStorageWorkletGlobalScope</a> <a href="#ref-for-idl-boolean①">(2)</a>
    <li><a href="#ref-for-idl-boolean②">4. The SharedStorage Interface</a>
    <li><a href="#ref-for-idl-boolean③">4.2.3. Iteration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-d3fd0dc5b12c87e613395fec1824ac77" class="dfn-panel" data-for="d3fd0dc5b12c87e613395fec1824ac77" id="infopanel-for-d3fd0dc5b12c87e613395fec1824ac77">
   <span id="infopaneltitle-for-d3fd0dc5b12c87e613395fec1824ac77" style="display:none">Info about the 'double' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-double">https://webidl.spec.whatwg.org/#idl-double</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-double">4.1.3.1. Navigation Entropy Budget</a>
    <li><a href="#ref-for-idl-double①">4.1.3.2. Reporting Entropy Budget</a>
    <li><a href="#ref-for-idl-double②">4.2. The WorkletSharedStorage interface</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-a189a0d7ce5bc36522126b11ca418f0a" class="dfn-panel" data-for="a189a0d7ce5bc36522126b11ca418f0a" id="infopanel-for-a189a0d7ce5bc36522126b11ca418f0a">
   <span id="infopaneltitle-for-a189a0d7ce5bc36522126b11ca418f0a" style="display:none">Info about the 'long' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-long">https://webidl.spec.whatwg.org/#idl-long</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-long">2.2. The SharedStorageWorkletGlobalScope</a> <a href="#ref-for-idl-long①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-5039223412f0d0a24ee17570f82d3d59" class="dfn-panel" data-for="5039223412f0d0a24ee17570f82d3d59" id="infopanel-for-5039223412f0d0a24ee17570f82d3d59">
   <span id="infopaneltitle-for-5039223412f0d0a24ee17570f82d3d59" style="display:none">Info about the 'object' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-object">https://webidl.spec.whatwg.org/#idl-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-object">2.2. The SharedStorageWorkletGlobalScope</a> <a href="#ref-for-idl-object①">(2)</a> <a href="#ref-for-idl-object②">(3)</a>
    <li><a href="#ref-for-idl-object③">4.1.2. SharedStorageUrlWithMetadata and Reporting</a> <a href="#ref-for-idl-object④">(2)</a> <a href="#ref-for-idl-object⑤">(3)</a> <a href="#ref-for-idl-object⑥">(4)</a> <a href="#ref-for-idl-object⑦">(5)</a> <a href="#ref-for-idl-object⑧">(6)</a> <a href="#ref-for-idl-object⑨">(7)</a> <a href="#ref-for-idl-object①⓪">(8)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-cee863f1f2ec91066cfb7f5d309d59dc" class="dfn-panel" data-for="cee863f1f2ec91066cfb7f5d309d59dc" id="infopanel-for-cee863f1f2ec91066cfb7f5d309d59dc">
   <span id="infopaneltitle-for-cee863f1f2ec91066cfb7f5d309d59dc" style="display:none">Info about the 'undefined' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-undefined">https://webidl.spec.whatwg.org/#idl-undefined</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-undefined">2.2. The SharedStorageWorkletGlobalScope</a> <a href="#ref-for-idl-undefined①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-03fa8b99cc63b35d2e7dcadb686676f1" class="dfn-panel" data-for="03fa8b99cc63b35d2e7dcadb686676f1" id="infopanel-for-03fa8b99cc63b35d2e7dcadb686676f1">
   <span id="infopaneltitle-for-03fa8b99cc63b35d2e7dcadb686676f1" style="display:none">Info about the 'unsigned long' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-unsigned-long">https://webidl.spec.whatwg.org/#idl-unsigned-long</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-unsigned-long">4.1.4. Run Operation Methods</a>
    <li><a href="#ref-for-idl-unsigned-long①">4.2. The WorkletSharedStorage interface</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-ca482fe3208753d4c9cdd9b2f9259484" class="dfn-panel" data-for="ca482fe3208753d4c9cdd9b2f9259484" id="infopanel-for-ca482fe3208753d4c9cdd9b2f9259484">
   <span id="infopaneltitle-for-ca482fe3208753d4c9cdd9b2f9259484" style="display:none">Info about the 'register()' external reference.</span><a href="https://w3c.github.io/webrtc-identity/#dom-rtcidentityproviderregistrar-register">https://w3c.github.io/webrtc-identity/#dom-rtcidentityproviderregistrar-register</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-rtcidentityproviderregistrar-register">2.2. The SharedStorageWorkletGlobalScope</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="07886e33695d0e7b473ef18f656ad7ac">Document</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HR-TIME-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="0527034ee7070fda15ffa50c34dbbc63">DOMHighResTimeStamp</span>
     <li><span class="dfn-paneled" id="1f78bca61233b6a6957119204c181632">current wall time</span>
     <li><span class="dfn-paneled" id="9213a3aff5ff1021ab4c2d780aa70cee">duration</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="7035dd3562cfc316632c23d976c085fe">FencedFrameConfig</span>
     <li><span class="dfn-paneled" id="d1f0a86fd49be388d8b0159e241a1172">Window</span>
     <li><span class="dfn-paneled" id="388c1a1bab7d7c206f9539992fa5c95b">Worklet</span>
     <li><span class="dfn-paneled" id="f1c3158ad16b10a1e2f5e18807f043d3">WorkletGlobalScope</span>
     <li><span class="dfn-paneled" id="3d775bec5e86909f746c065c634670de">[[getprototypeof]]()</span>
     <li><span class="dfn-paneled" id="22506342275877ad373fb5e4f51039fd">active document</span>
     <li><span class="dfn-paneled" id="30868129d3c8f56c49c59077d328b346">active window</span>
     <li><span class="dfn-paneled" id="c15669f81d5b7cbafe13a97b7f6b9fdd">addModule(moduleURL, options)</span>
     <li><span class="dfn-paneled" id="a4cc8d2421b518a3977f69799881f264">append <small>(for list)</small></span>
     <li><span class="dfn-paneled" id="404b9f69eaee28aad1cc6cf2e5a9de4f">append <small>(for set)</small></span>
     <li><span class="dfn-paneled" id="6a3e2fb0696b416fb90f7916d0e747c3">assert</span>
     <li><span class="dfn-paneled" id="b681a2f3d2b90fee3bdafd93a74a2a7e">async iterator</span>
     <li><span class="dfn-paneled" id="8affc0459b565735337bc1b2334a8f17">asynchronous iterator initialization steps</span>
     <li><span class="dfn-paneled" id="616e4107fb5373731d00b82d54f0404b">backing map</span>
     <li><span class="dfn-paneled" id="18bf74a446ca5e13885595f8a3b107ce">beacon</span>
     <li><span class="dfn-paneled" id="c1cfc351a59b14257f942da7037d67db">beginning navigation</span>
     <li><span class="dfn-paneled" id="f44481f55d5f861114cd827f131c07a7">bits of entropy</span>
     <li><span class="dfn-paneled" id="8c2b9baa2bcf87b7479bc5d28f0c925a">bottle map</span>
     <li><span class="dfn-paneled" id="5db590bc82ac7edd15fc4ebd1b0c25f0">browsing context</span>
     <li><span class="dfn-paneled" id="3324d83e3eb9483c08cbb2bdcd28541e">browsing context <small>(for Window)</small></span>
     <li><span class="dfn-paneled" id="7bed712fb187b01e9a5fb930d421c3c9">bucket map</span>
     <li><span class="dfn-paneled" id="664d5dfcb76cca05487dc6cce044cd55">call</span>
     <li><span class="dfn-paneled" id="34df733e79df1618644af3634528503d">clear</span>
     <li><span class="dfn-paneled" id="481e7c6ccf92a42ccc11b2540aaaef2e">client-side storage partitioning</span>
     <li><span class="dfn-paneled" id="44c58372ad24111c2ccd1234622ccdf9">concatenate</span>
     <li><span class="dfn-paneled" id="da54ce46772fbdbd3d501b2a7bd2f90f">contains</span>
     <li><span class="dfn-paneled" id="cce127bd5d61bd0a4f5a90c2bf2bc498">dequeue</span>
     <li><span class="dfn-paneled" id="f3af8084c3b5229419ad0d3d9f2bec30">destination</span>
     <li><span class="dfn-paneled" id="c3a97cf56c441f3a1a6268eb6800109e">dictionary</span>
     <li><span class="dfn-paneled" id="8cbd8b5ce00843118ae0df0e9b5c2b48">empty <small>(for list)</small></span>
     <li><span class="dfn-paneled" id="b328c8757f0a52215bd1026c3f6a610d">empty <small>(for map)</small></span>
     <li><span class="dfn-paneled" id="f88dc56692320f33ee7e25b6b7b36a2e">ending navigation</span>
     <li><span class="dfn-paneled" id="912227903ca1afb6cedeb2e1f8af1552">enqueue</span>
     <li><span class="dfn-paneled" id="9364fab91c2493fa9c139fb1e585204d">enqueue the following steps</span>
     <li><span class="dfn-paneled" id="de81a3f6e9ad8253438fc391812357c1">entropy bits</span>
     <li><span class="dfn-paneled" id="f1b190f56f01259f63ca50355353f5ca">entry</span>
     <li><span class="dfn-paneled" id="f33dd611caae87733cd018725bcf2176">environment</span>
     <li><span class="dfn-paneled" id="d815dc723d8b4fe4b1166e2013ec62b7">environment settings object</span>
     <li><span class="dfn-paneled" id="3b83f59e81f5377a554f5a6d04a10e90">eventdata</span>
     <li><span class="dfn-paneled" id="e7c5b1cf1df191e0055611f969d3df54">eventtype</span>
     <li><span class="dfn-paneled" id="5f3303fb0eb47cba2f99e76886ff261b">fence.reportevent()</span>
     <li><span class="dfn-paneled" id="5c64ef658c32f9405b423bd4f9ce157d">fenced frame</span>
     <li><span class="dfn-paneled" id="37742f5816e7f0b1f164eea8f9b02958">fenceevent</span>
     <li><span class="dfn-paneled" id="552e97ed54637294ee331442b4e8b44d">function</span>
     <li><span class="dfn-paneled" id="31c272b02f1a06d30699ce8c07bf8026">get</span>
     <li><span class="dfn-paneled" id="d146be4d92af5032f41b813a3987d802">get the next iteration result</span>
     <li><span class="dfn-paneled" id="efe020bb14953eee823e8ef1865182e0">get the top-level traversable</span>
     <li><span class="dfn-paneled" id="1c8026e077428d132cb556dbcf505732">getmethod()</span>
     <li><span class="dfn-paneled" id="da1c6ad2874b1fc0e888db36ff0d8b85">isconstructor()</span>
     <li><span class="dfn-paneled" id="403a0897c127ffef37d041adb9486b1c">item</span>
     <li><span class="dfn-paneled" id="03e78949041409fd84dd5f4f06c70de3">key</span>
     <li><span class="dfn-paneled" id="72936eecec62d59f24339c044925a9ad">list</span>
     <li><span class="dfn-paneled" id="5c2c6ee506100ca78ae26ae3cb376fd3">list <small>(for HTMLInputElement)</small></span>
     <li><span class="dfn-paneled" id="fb724007dc55f8e55a928d6d33fbbaef">map</span>
     <li><span class="dfn-paneled" id="638c4e281de58d39ae40c4fa51dd247b">module map</span>
     <li><span class="dfn-paneled" id="3b4d9e0bde382093069451ebd3a62bd0">module script</span>
     <li><span class="dfn-paneled" id="9b61a10aca6020532301db95d903ae46">navigable</span>
     <li><span class="dfn-paneled" id="566b28e53fa11b6a6ff3a9d32626c2c5">navigate</span>
     <li><span class="dfn-paneled" id="6b50287cacc5ac8cf8db87f957c01da4">node navigable</span>
     <li><span class="dfn-paneled" id="864fca052f1ae73974ad92254108fb4b">object</span>
     <li><span class="dfn-paneled" id="922557257eaf67c31019f987b1db3f65">obtaining a worklet agent</span>
     <li><span class="dfn-paneled" id="8a1ed4f3c2e0da791ce75c1b48916865">opaque origin</span>
     <li><span class="dfn-paneled" id="e66f9f7d45934e77669cb907bd0c7636">origin</span>
     <li><span class="dfn-paneled" id="9c5cdbb5c3dd225a70ea0af45a02c608">origin <small>(for document)</small></span>
     <li><span class="dfn-paneled" id="8941680dbae2de74bf6821b8c18fe6ba">origin <small>(for url)</small></span>
     <li><span class="dfn-paneled" id="415a479d0f2716a263c8aeb1eb9eccc2">parent</span>
     <li><span class="dfn-paneled" id="7dda08a341a002533188016c9ab2c2e9">promise</span>
     <li><span class="dfn-paneled" id="8d16650a184a26d81e148cb157cca1a9">promise rejected</span>
     <li><span class="dfn-paneled" id="caab08a991b65588cb3aa567e150914c">promise resolved</span>
     <li><span class="dfn-paneled" id="ffebca42635d9366dd093a2e716bf0a7">proxy map reference set</span>
     <li><span class="dfn-paneled" id="7e56922f5cbe4d3973ccc5e2dac6bc39">queue</span>
     <li><span class="dfn-paneled" id="2e5089d3e927d8ac2d7ecd6eb1d79329">quota <small>(for storage bottle)</small></span>
     <li><span class="dfn-paneled" id="b744ad90a49f07627ab4513f6dbee5f9">quota <small>(for storage endpoint)</small></span>
     <li><span class="dfn-paneled" id="10db1a6b8bd6a17900305dab273015d0">register</span>
     <li><span class="dfn-paneled" id="bfb9cb6617f81a424ab20212af73bae3">relevant settings object</span>
     <li><span class="dfn-paneled" id="cae5d92a36994a4483a8ce0bae1c5451">set</span>
     <li><span class="dfn-paneled" id="c74fc5b3d0f64d7ccd0e984abb5d55d6">size</span>
     <li><span class="dfn-paneled" id="60e0259e78998a2c29a6de1c2023b4ae">start a new parallel queue</span>
     <li><span class="dfn-paneled" id="762beba33f3ad0dfbf19a9c82f4ec357">storage bottle</span>
     <li><span class="dfn-paneled" id="dcb2985190de22ddc1fac361fc18de5a">storage bucket</span>
     <li><span class="dfn-paneled" id="eac294a94562316c9055281be6430038">storage endpoint</span>
     <li><span class="dfn-paneled" id="cb62c16bb1c9a575c599982c20df5323">storage identifier</span>
     <li><span class="dfn-paneled" id="e50703fb7898b2f1420fa901f5314d60">storage key</span>
     <li><span class="dfn-paneled" id="73a1d6afeb04580aedc52a0437d3bfd2">storage model</span>
     <li><span class="dfn-paneled" id="b9ee5749da394769624aa65c98d75a96">storage proxy map</span>
     <li><span class="dfn-paneled" id="de243662dafa6105374205e64111d467">storage shed</span>
     <li><span class="dfn-paneled" id="4ae96685c778dd1d6d81ae3c132bce0e">storage shelf</span>
     <li><span class="dfn-paneled" id="3454daa78ff554a5f17f57b16fa72e61">storage type</span>
     <li><span class="dfn-paneled" id="a8f48fb35292efd21a347f15fdac6334">string</span>
     <li><span class="dfn-paneled" id="f4cd6265b36800faa2839af29623c32c">struct</span>
     <li><span class="dfn-paneled" id="88acb424f236089050e7f4c429bc07ea">target browsing context</span>
     <li><span class="dfn-paneled" id="6d1f737f1fe3dbd01f26fbf2f2644f9c">terminate a worklet global scope</span>
     <li><span class="dfn-paneled" id="18f65fd908c664da61d3d9b2e9d11bdd">top-frame</span>
     <li><span class="dfn-paneled" id="9a385596636f5af6591597c38324e449">top-level traversable</span>
     <li><span class="dfn-paneled" id="0e2f334f68df47e02e59c1bb0e056e13">traversable navigable</span>
     <li><span class="dfn-paneled" id="c6a6e18a0bfb0f6727343f416cd90c01">unix epoch</span>
     <li><span class="dfn-paneled" id="dcf29be761156b598247854e294e3705">upon fulfillment</span>
     <li><span class="dfn-paneled" id="f4113d72a91aadf0789f9e5cf76669be">upon rejection</span>
     <li><span class="dfn-paneled" id="9f1060e036985eef125ae551d5923654">url parser</span>
     <li><span class="dfn-paneled" id="98a8c263bf696e702c5230677356610b">user agent</span>
     <li><span class="dfn-paneled" id="2100e84f8b949d8a0b6baaf762471a43">value</span>
     <li><span class="dfn-paneled" id="81a3f446d4ec5b7ccd239f33895a87fc">web idl standard</span>
     <li><span class="dfn-paneled" id="1500392fd3bfa55622e01ffbd82d8dd7">worklet global scope type</span>
     <li><span class="dfn-paneled" id="4ab072d8bc76dd7348f291f60d1f0c69">worklets</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="eb75379b05abc264a531a791358e1eba">contain</span>
     <li><span class="dfn-paneled" id="3875a727a3224d295450f00d93777fbd">getting the values</span>
     <li><span class="dfn-paneled" id="81b03c84949641fc3081227509aab38f">length</span>
     <li><span class="dfn-paneled" id="fadc27e826887faf120674544589ae68">remove <small>(for list)</small></span>
     <li><span class="dfn-paneled" id="5191a0c00b6ec5f93646e492ae7ec62c">remove <small>(for map)</small></span>
     <li><span class="dfn-paneled" id="bed8381510f5967f5d37a33de776e857">size</span>
    </ul>
   <li>
    <a data-link-type="biblio">[MD]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="954959f9e7bfc13ff9d9416457ba456d">legitimate use cases</span>
     <li><span class="dfn-paneled" id="42e72e3aa2b805865905b73c6fa0282e">private aggregation</span>
    </ul>
   <li>
    <a data-link-type="biblio">[URL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="40b6c52ddb2a775a0eb7ff546dd9e8b6">URL</span>
     <li><span class="dfn-paneled" id="fc05c76e016d3aec6a25a91c066500c8">url</span>
     <li><span class="dfn-paneled" id="4cd5cba6c3b356beb9ed1d910eaf8ee9">url serializer</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="d0f238a61de9310f1738a214749fab18">DOMString</span>
     <li><span class="dfn-paneled" id="dde049eb112f043fc45407ec0d4cb457">Exposed</span>
     <li><span class="dfn-paneled" id="30e8367dc9a547b9096d98ba691987d9">FrozenArray</span>
     <li><span class="dfn-paneled" id="87854fa3332c5bf035dec1c1725d8450">Global</span>
     <li><span class="dfn-paneled" id="93669c631ec1ef8e696b4c083bdbe12c">Promise</span>
     <li><span class="dfn-paneled" id="3f9c3eac015894a734faa8068fd8c2a1">TypeError</span>
     <li><span class="dfn-paneled" id="e270bcd7cdb4abe27bc3bb16a1975937">USVString</span>
     <li><span class="dfn-paneled" id="8eec6bb7878bb17dddbbb727b8d77c28">any</span>
     <li><span class="dfn-paneled" id="f8062b07e25ed0281f5cbfb9a54070b4">boolean</span>
     <li><span class="dfn-paneled" id="d3fd0dc5b12c87e613395fec1824ac77">double</span>
     <li><span class="dfn-paneled" id="a189a0d7ce5bc36522126b11ca418f0a">long</span>
     <li><span class="dfn-paneled" id="5039223412f0d0a24ee17570f82d3d59">object</span>
     <li><span class="dfn-paneled" id="cee863f1f2ec91066cfb7f5d309d59dc">undefined</span>
     <li><span class="dfn-paneled" id="03fa8b99cc63b35d2e7dcadb686676f1">unsigned long</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBRTC-IDENTITY]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="ca482fe3208753d4c9cdd9b2f9259484">register()</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-hr-time-3">[HR-TIME-3]
   <dd>Yoav Weiss. <a href="https://w3c.github.io/hr-time/"><cite>High Resolution Time</cite></a>. URL: <a href="https://w3c.github.io/hr-time/">https://w3c.github.io/hr-time/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-url">[URL]
   <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
   <dt id="biblio-webrtc-identity">[WEBRTC-IDENTITY]
   <dd>Cullen Jennings; Martin Thomson. <a href="https://w3c.github.io/webrtc-identity/"><cite>Identity for WebRTC 1.0</cite></a>. URL: <a href="https://w3c.github.io/webrtc-identity/">https://w3c.github.io/webrtc-identity/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->)]
<c- b>interface</c-> <a href="#sharedstorageworklet"><code><c- g>SharedStorageWorklet</c-></code></a> : <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/worklets.html#worklet"><c- n>Worklet</c-></a> {
};
[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>SharedStorageWorklet</c->, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Global"><c- g>Global</c-></a>=<a data-link-type="idl-name" href="#sharedstorageworklet"><c- n>SharedStorageWorklet</c-></a>]
<c- b>interface</c-> <a href="#sharedstorageworkletglobalscope"><code><c- g>SharedStorageWorkletGlobalScope</c-></code></a> : <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/worklets.html#workletglobalscope"><c- n>WorkletGlobalScope</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-sharedstorageworkletglobalscope-register"><c- g>register</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-sharedstorageworkletglobalscope-register-name-operationctor-name"><code><c- g>name</c-></code></a>,
                     <a data-link-type="idl-name" href="#callbackdef-sharedstorageoperationconstructor"><c- n>SharedStorageOperationConstructor</c-></a> <a href="#dom-sharedstorageworkletglobalscope-register-name-operationctor-operationctor"><code><c- g>operationCtor</c-></code></a>);
};

<c- b>callback</c-> <a href="#callbackdef-sharedstorageoperationconstructor"><code><c- g>SharedStorageOperationConstructor</c-></code></a> =
  <a data-link-type="idl-name" href="#sharedstorageoperation"><c- n>SharedStorageOperation</c-></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sharedstoragerunoperationmethodoptions"><c- n>SharedStorageRunOperationMethodOptions</c-></a> <a href="#dom-sharedstorageoperationconstructor-options"><code><c- g>options</c-></code></a>);

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>SharedStorageWorklet</c->]
<c- b>interface</c-> <a href="#sharedstorageoperation"><code><c- g>SharedStorageOperation</c-></code></a> {
};

<c- b>dictionary</c-> <a href="#dictdef-sharedstoragerunoperationmethodoptions"><code><c- g>SharedStorageRunOperationMethodOptions</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object"><c- b>object</c-></a> <a data-type="object " href="#dom-sharedstoragerunoperationmethodoptions-data"><code><c- g>data</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-sharedstoragerunoperationmethodoptions-resolvetoconfig"><code><c- g>resolveToConfig</c-></code></a> = <c- b>false</c->;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-sharedstoragerunoperationmethodoptions-keepalive"><code><c- g>keepAlive</c-></code></a> = <c- b>false</c->;
};
[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>SharedStorageWorklet</c->]
<c- b>interface</c-> <a href="#sharedstoragerunoperation"><code><c- g>SharedStorageRunOperation</c-></code></a> : <a data-link-type="idl-name" href="#sharedstorageoperation"><c- n>SharedStorageOperation</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>> <a href="#dom-sharedstoragerunoperation-run"><code><c- g>run</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object"><c- b>object</c-></a> <a href="#dom-sharedstoragerunoperation-run-data-data"><code><c- g>data</c-></code></a>);
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>SharedStorageWorklet</c->]
<c- b>interface</c-> <a href="#sharedstorageselecturloperation"><code><c- g>SharedStorageSelectURLOperation</c-></code></a> : <a data-link-type="idl-name" href="#sharedstorageoperation"><c- n>SharedStorageOperation</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long"><c- b>long</c-></a>> <a href="#dom-sharedstorageselecturloperation-run"><code><c- g>run</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object"><c- b>object</c-></a> <a href="#dom-sharedstorageselecturloperation-run-data-urls-data"><code><c- g>data</c-></code></a>,
                    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-sharedstorageurlwithmetadata"><c- n>SharedStorageUrlWithMetadata</c-></a>> <a href="#dom-sharedstorageselecturloperation-run-data-urls-urls"><code><c- g>urls</c-></code></a>);
};
[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>SharedStorageWorklet</c->)]
<c- b>interface</c-> <a href="#sharedstorage"><code><c- g>SharedStorage</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a>> <a href="#dom-sharedstorage-set"><code><c- g>set</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-sharedstorage-set-key-value-options-key"><code><c- g>key</c-></code></a>,
                   <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-sharedstorage-set-key-value-options-value"><code><c- g>value</c-></code></a>,
                   <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sharedstoragesetmethodoptions"><c- n>SharedStorageSetMethodOptions</c-></a> <a href="#dom-sharedstorage-set-key-value-options-options"><code><c- g>options</c-></code></a> = {});
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a>> <a href="#dom-sharedstorage-append"><code><c- g>append</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-sharedstorage-append-key-value-key"><code><c- g>key</c-></code></a>,
                      <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-sharedstorage-append-key-value-value"><code><c- g>value</c-></code></a>);
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a>> <a href="#dom-sharedstorage-delete"><code><c- g>delete</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-sharedstorage-delete-key-key"><code><c- g>key</c-></code></a>);
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a>> <a href="#dom-sharedstorage-clear"><code><c- g>clear</c-></code></a>();
};

<c- b>dictionary</c-> <a href="#dictdef-sharedstoragesetmethodoptions"><code><c- g>SharedStorageSetMethodOptions</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-sharedstoragesetmethodoptions-ignoreifpresent"><code><c- g>ignoreIfPresent</c-></code></a> = <c- b>false</c->;
};
<c- b>typedef</c-> (<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="https://wicg.github.io/fenced-frame/#fencedframeconfig"><c- n>FencedFrameConfig</c-></a>) <a href="#typedefdef-sharedstorageresponse"><code><c- g>SharedStorageResponse</c-></code></a>;

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->)]
<c- b>interface</c-> <a href="#windowsharedstorage"><code><c- g>WindowSharedStorage</c-></code></a> : <a data-link-type="idl-name" href="#sharedstorage"><c- n>SharedStorage</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-windowsharedstorage-run"><c- g>run</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-windowsharedstorage-run-name-options-name"><code><c- g>name</c-></code></a>,
                   <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sharedstoragerunoperationmethodoptions"><c- n>SharedStorageRunOperationMethodOptions</c-></a> <a href="#dom-windowsharedstorage-run-name-options-options"><code><c- g>options</c-></code></a> = {});
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#typedefdef-sharedstorageresponse"><c- n>SharedStorageResponse</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-windowsharedstorage-selecturl"><c- g>selectURL</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-windowsharedstorage-selecturl-name-urls-options-name"><code><c- g>name</c-></code></a>,
                               <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-sharedstorageurlwithmetadata"><c- n>SharedStorageUrlWithMetadata</c-></a>> <a href="#dom-windowsharedstorage-selecturl-name-urls-options-urls"><code><c- g>urls</c-></code></a>,
                               <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sharedstoragerunoperationmethodoptions"><c- n>SharedStorageRunOperationMethodOptions</c-></a> <a href="#dom-windowsharedstorage-selecturl-name-urls-options-options"><code><c- g>options</c-></code></a> = {});

  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#sharedstorageworklet"><c- n>SharedStorageWorklet</c-></a> <a data-readonly data-type="SharedStorageWorklet" href="#dom-windowsharedstorage-worklet"><code><c- g>worklet</c-></code></a>;
};
<c- b>dictionary</c-> <a href="#dictdef-sharedstorageurlwithmetadata"><code><c- g>SharedStorageUrlWithMetadata</c-></code></a> {
  <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString " href="#dom-sharedstorageurlwithmetadata-url"><code><c- g>url</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object"><c- b>object</c-></a> <a data-type="object " href="#dom-sharedstorageurlwithmetadata-reportingmetadata"><code><c- g>reportingMetadata</c-></code></a>;
};
[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>SharedStorageWorklet</c->)]
<c- b>interface</c-> <a href="#workletsharedstorage"><code><c- g>WorkletSharedStorage</c-></code></a> : <a data-link-type="idl-name" href="#sharedstorage"><c- n>SharedStorage</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-workletsharedstorage-get"><c- g>get</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-workletsharedstorage-get-key-key"><code><c- g>key</c-></code></a>);
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-workletsharedstorage-length"><c- g>length</c-></a>();
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double"><c- b>double</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-workletsharedstorage-remainingbudget"><c- g>remainingBudget</c-></a>();

  <c- b>async</c-> <c- b>iterable</c->&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>, <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>>;
};
</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> The "fenced frame config struct" and its boolean <span>has navigated</span> have not yet been added to the draft <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element">Fenced Frame</a> specification. Some form of them will be added, although their names are subject to bikeshedding. <span class="todo">Fix the names when they are added.</span> <a class="issue-return" href="#issue-7ff511a8" title="Jump to section">↵</a></div>
   <div class="issue"> The "fenced frame config struct" and its boolean <span>has reported</span> have not yet been added to the draft <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element">Fenced Frame</a> specification. Some form of them will be added, although their names are subject to bikeshedding. <span class="todo">Fix the names when they are added.</span> <a class="issue-return" href="#issue-c8b219be" title="Jump to section">↵</a></div>
   <div class="issue"> The "fenced frame config struct" and the following "obtain a <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/fenced-frame/#fencedframeconfig">FencedFrameConfig</a></code> from a fenced frame config struct" algorithm have not yet been added to the draft <a data-link-type="dfn" href="https://wicg.github.io/fenced-frame/#the-fencedframe-element">Fenced Frame</a> specification. Some form of them will be added, although their names are subject to bikeshedding. <a class="issue-return" href="#issue-0ddd316f" title="Jump to section">↵</a></div>
  </div>
  <aside aria-labelledby="infopaneltitle-for-sharedstorageworklet" class="dfn-panel" data-for="sharedstorageworklet" id="infopanel-for-sharedstorageworklet">
   <span id="infopaneltitle-for-sharedstorageworklet" style="display:none">Info about the 'SharedStorageWorklet' definition.</span><b><a href="#sharedstorageworklet">#sharedstorageworklet</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sharedstorageworklet">2. The SharedStorageWorklet Interface</a> <a href="#ref-for-sharedstorageworklet①">(2)</a> <a href="#ref-for-sharedstorageworklet②">(3)</a> <a href="#ref-for-sharedstorageworklet③">(4)</a> <a href="#ref-for-sharedstorageworklet④">(5)</a> <a href="#ref-for-sharedstorageworklet⑤">(6)</a> <a href="#ref-for-sharedstorageworklet⑥">(7)</a>
    <li><a href="#ref-for-sharedstorageworklet⑦">2.2. The SharedStorageWorkletGlobalScope</a> <a href="#ref-for-sharedstorageworklet⑧">(2)</a> <a href="#ref-for-sharedstorageworklet⑨">(3)</a>
    <li><a href="#ref-for-sharedstorageworklet①⓪">4. The SharedStorage Interface</a> <a href="#ref-for-sharedstorageworklet①①">(2)</a> <a href="#ref-for-sharedstorageworklet①②">(3)</a> <a href="#ref-for-sharedstorageworklet①③">(4)</a>
    <li><a href="#ref-for-sharedstorageworklet①④">4.1. The WindowSharedStorage interface</a>
    <li><a href="#ref-for-sharedstorageworklet①⑤">5. Privacy Considerations</a> <a href="#ref-for-sharedstorageworklet①⑥">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-module-added" class="dfn-panel" data-for="module-added" id="infopanel-for-module-added">
   <span id="infopaneltitle-for-module-added" style="display:none">Info about the 'module added' definition.</span><b><a href="#module-added">#module-added</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-module-added">2. The SharedStorageWorklet Interface</a> <a href="#ref-for-module-added①">(2)</a> <a href="#ref-for-module-added②">(3)</a>
    <li><a href="#ref-for-module-added③">2.1. Monkey Patch for Worklets</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-check-and-update-module-added-status" class="dfn-panel" data-for="check-and-update-module-added-status" id="infopanel-for-check-and-update-module-added-status">
   <span id="infopaneltitle-for-check-and-update-module-added-status" style="display:none">Info about the 'check and update module added status' definition.</span><b><a href="#check-and-update-module-added-status">#check-and-update-module-added-status</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-check-and-update-module-added-status">2. The SharedStorageWorklet Interface</a>
    <li><a href="#ref-for-check-and-update-module-added-status①">2.1. Monkey Patch for Worklets</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-sharedstorageworkletglobalscope" class="dfn-panel" data-for="sharedstorageworkletglobalscope" id="infopanel-for-sharedstorageworkletglobalscope">
   <span id="infopaneltitle-for-sharedstorageworkletglobalscope" style="display:none">Info about the 'SharedStorageWorkletGlobalScope' definition.</span><b><a href="#sharedstorageworkletglobalscope">#sharedstorageworkletglobalscope</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sharedstorageworkletglobalscope">2.2. The SharedStorageWorkletGlobalScope</a> <a href="#ref-for-sharedstorageworkletglobalscope①">(2)</a> <a href="#ref-for-sharedstorageworkletglobalscope②">(3)</a> <a href="#ref-for-sharedstorageworkletglobalscope③">(4)</a> <a href="#ref-for-sharedstorageworkletglobalscope④">(5)</a>
    <li><a href="#ref-for-sharedstorageworkletglobalscope⑤">2.3. Registering a Worklet</a>
    <li><a href="#ref-for-sharedstorageworkletglobalscope⑥">4.1.4. Run Operation Methods</a> <a href="#ref-for-sharedstorageworkletglobalscope⑦">(2)</a> <a href="#ref-for-sharedstorageworkletglobalscope⑧">(3)</a> <a href="#ref-for-sharedstorageworkletglobalscope⑨">(4)</a>
    <li><a href="#ref-for-sharedstorageworkletglobalscope①⓪">4.2.1. Worklet Setter/Deleter Methods</a> <a href="#ref-for-sharedstorageworkletglobalscope①①">(2)</a> <a href="#ref-for-sharedstorageworkletglobalscope①②">(3)</a> <a href="#ref-for-sharedstorageworkletglobalscope①③">(4)</a>
    <li><a href="#ref-for-sharedstorageworkletglobalscope①④">4.2.2. Getter Methods</a> <a href="#ref-for-sharedstorageworkletglobalscope①⑤">(2)</a> <a href="#ref-for-sharedstorageworkletglobalscope①⑥">(3)</a>
    <li><a href="#ref-for-sharedstorageworkletglobalscope①⑦">4.2.3. Iteration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-callbackdef-sharedstorageoperationconstructor" class="dfn-panel" data-for="callbackdef-sharedstorageoperationconstructor" id="infopanel-for-callbackdef-sharedstorageoperationconstructor">
   <span id="infopaneltitle-for-callbackdef-sharedstorageoperationconstructor" style="display:none">Info about the 'SharedStorageOperationConstructor' definition.</span><b><a href="#callbackdef-sharedstorageoperationconstructor">#callbackdef-sharedstorageoperationconstructor</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-sharedstorageoperationconstructor">2.2. The SharedStorageWorkletGlobalScope</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-sharedstorageoperation" class="dfn-panel" data-for="sharedstorageoperation" id="infopanel-for-sharedstorageoperation">
   <span id="infopaneltitle-for-sharedstorageoperation" style="display:none">Info about the 'SharedStorageOperation' definition.</span><b><a href="#sharedstorageoperation">#sharedstorageoperation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sharedstorageoperation">2.2. The SharedStorageWorkletGlobalScope</a> <a href="#ref-for-sharedstorageoperation①">(2)</a> <a href="#ref-for-sharedstorageoperation②">(3)</a> <a href="#ref-for-sharedstorageoperation③">(4)</a> <a href="#ref-for-sharedstorageoperation④">(5)</a> <a href="#ref-for-sharedstorageoperation⑤">(6)</a>
    <li><a href="#ref-for-sharedstorageoperation⑥">4. The SharedStorage Interface</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dictdef-sharedstoragerunoperationmethodoptions" class="dfn-panel" data-for="dictdef-sharedstoragerunoperationmethodoptions" id="infopanel-for-dictdef-sharedstoragerunoperationmethodoptions">
   <span id="infopaneltitle-for-dictdef-sharedstoragerunoperationmethodoptions" style="display:none">Info about the 'SharedStorageRunOperationMethodOptions' definition.</span><b><a href="#dictdef-sharedstoragerunoperationmethodoptions">#dictdef-sharedstoragerunoperationmethodoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-sharedstoragerunoperationmethodoptions">2.2. The SharedStorageWorkletGlobalScope</a>
    <li><a href="#ref-for-dictdef-sharedstoragerunoperationmethodoptions①">4.1. The WindowSharedStorage interface</a> <a href="#ref-for-dictdef-sharedstoragerunoperationmethodoptions②">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-sharedstorageworkletglobalscope-outside-settings" class="dfn-panel" data-for="sharedstorageworkletglobalscope-outside-settings" id="infopanel-for-sharedstorageworkletglobalscope-outside-settings">
   <span id="infopaneltitle-for-sharedstorageworkletglobalscope-outside-settings" style="display:none">Info about the 'outside settings' definition.</span><b><a href="#sharedstorageworkletglobalscope-outside-settings">#sharedstorageworkletglobalscope-outside-settings</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sharedstorageworkletglobalscope-outside-settings">4.2.1. Worklet Setter/Deleter Methods</a> <a href="#ref-for-sharedstorageworkletglobalscope-outside-settings①">(2)</a> <a href="#ref-for-sharedstorageworkletglobalscope-outside-settings②">(3)</a> <a href="#ref-for-sharedstorageworkletglobalscope-outside-settings③">(4)</a>
    <li><a href="#ref-for-sharedstorageworkletglobalscope-outside-settings④">4.2.2. Getter Methods</a> <a href="#ref-for-sharedstorageworkletglobalscope-outside-settings⑤">(2)</a> <a href="#ref-for-sharedstorageworkletglobalscope-outside-settings⑥">(3)</a>
    <li><a href="#ref-for-sharedstorageworkletglobalscope-outside-settings⑦">4.2.3. Iteration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-sharedstorageworkletglobalscope-operation-map" class="dfn-panel" data-for="sharedstorageworkletglobalscope-operation-map" id="infopanel-for-sharedstorageworkletglobalscope-operation-map">
   <span id="infopaneltitle-for-sharedstorageworkletglobalscope-operation-map" style="display:none">Info about the 'operation map' definition.</span><b><a href="#sharedstorageworkletglobalscope-operation-map">#sharedstorageworkletglobalscope-operation-map</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sharedstorageworkletglobalscope-operation-map">2.3. Registering a Worklet</a>
    <li><a href="#ref-for-sharedstorageworkletglobalscope-operation-map①">4.1.4. Run Operation Methods</a> <a href="#ref-for-sharedstorageworkletglobalscope-operation-map②">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-sharedstoragerunoperation" class="dfn-panel" data-for="sharedstoragerunoperation" id="infopanel-for-sharedstoragerunoperation">
   <span id="infopaneltitle-for-sharedstoragerunoperation" style="display:none">Info about the 'SharedStorageRunOperation' definition.</span><b><a href="#sharedstoragerunoperation">#sharedstoragerunoperation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sharedstoragerunoperation">2.2. The SharedStorageWorkletGlobalScope</a> <a href="#ref-for-sharedstoragerunoperation①">(2)</a> <a href="#ref-for-sharedstoragerunoperation②">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-sharedstorageselecturloperation" class="dfn-panel" data-for="sharedstorageselecturloperation" id="infopanel-for-sharedstorageselecturloperation">
   <span id="infopaneltitle-for-sharedstorageselecturloperation" style="display:none">Info about the 'SharedStorageSelectURLOperation' definition.</span><b><a href="#sharedstorageselecturloperation">#sharedstorageselecturloperation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sharedstorageselecturloperation">2.2. The SharedStorageWorkletGlobalScope</a> <a href="#ref-for-sharedstorageselecturloperation①">(2)</a>
    <li><a href="#ref-for-sharedstorageselecturloperation②">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-sharedstorageselecturloperation③">(2)</a> <a href="#ref-for-sharedstorageselecturloperation④">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-sharedstorageworkletglobalscope-register" class="dfn-panel" data-for="dom-sharedstorageworkletglobalscope-register" id="infopanel-for-dom-sharedstorageworkletglobalscope-register">
   <span id="infopaneltitle-for-dom-sharedstorageworkletglobalscope-register" style="display:none">Info about the 'register(name, operationCtor)' definition.</span><b><a href="#dom-sharedstorageworkletglobalscope-register">#dom-sharedstorageworkletglobalscope-register</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-sharedstorageworkletglobalscope-register">2.2. The SharedStorageWorkletGlobalScope</a> <a href="#ref-for-dom-sharedstorageworkletglobalscope-register①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-shared-storage-shed" class="dfn-panel" data-for="shared-storage-shed" id="infopanel-for-shared-storage-shed">
   <span id="infopaneltitle-for-shared-storage-shed" style="display:none">Info about the 'shared storage shed' definition.</span><b><a href="#shared-storage-shed">#shared-storage-shed</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-shared-storage-shed">3.1. Monkey Patch for the Storage Model</a> <a href="#ref-for-shared-storage-shed①">(2)</a> <a href="#ref-for-shared-storage-shed②">(3)</a> <a href="#ref-for-shared-storage-shed③">(4)</a> <a href="#ref-for-shared-storage-shed④">(5)</a> <a href="#ref-for-shared-storage-shed⑤">(6)</a> <a href="#ref-for-shared-storage-shed⑥">(7)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-shared-storage" class="dfn-panel" data-for="shared-storage" id="infopanel-for-shared-storage">
   <span id="infopaneltitle-for-shared-storage" style="display:none">Info about the 'shared storage' definition.</span><b><a href="#shared-storage">#shared-storage</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-shared-storage">2. The SharedStorageWorklet Interface</a> <a href="#ref-for-shared-storage①">(2)</a>
    <li><a href="#ref-for-shared-storage②">3.1. Monkey Patch for the Storage Model</a> <a href="#ref-for-shared-storage③">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-obtain-a-shared-storage-shelf" class="dfn-panel" data-for="obtain-a-shared-storage-shelf" id="infopanel-for-obtain-a-shared-storage-shelf">
   <span id="infopaneltitle-for-obtain-a-shared-storage-shelf" style="display:none">Info about the 'obtain a shared storage shelf' definition.</span><b><a href="#obtain-a-shared-storage-shelf">#obtain-a-shared-storage-shelf</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-a-shared-storage-shelf">3.1. Monkey Patch for the Storage Model</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-create-a-shared-storage-shelf" class="dfn-panel" data-for="create-a-shared-storage-shelf" id="infopanel-for-create-a-shared-storage-shelf">
   <span id="infopaneltitle-for-create-a-shared-storage-shelf" style="display:none">Info about the 'create a shared storage shelf' definition.</span><b><a href="#create-a-shared-storage-shelf">#create-a-shared-storage-shelf</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-create-a-shared-storage-shelf">3.1. Monkey Patch for the Storage Model</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-shared-storage-bucket" class="dfn-panel" data-for="shared-storage-bucket" id="infopanel-for-shared-storage-bucket">
   <span id="infopaneltitle-for-shared-storage-bucket" style="display:none">Info about the 'shared storage bucket' definition.</span><b><a href="#shared-storage-bucket">#shared-storage-bucket</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-shared-storage-bucket">3.1. Monkey Patch for the Storage Model</a> <a href="#ref-for-shared-storage-bucket①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-create-a-shared-storage-bucket" class="dfn-panel" data-for="create-a-shared-storage-bucket" id="infopanel-for-create-a-shared-storage-bucket">
   <span id="infopaneltitle-for-create-a-shared-storage-bucket" style="display:none">Info about the 'create a shared storage bucket' definition.</span><b><a href="#create-a-shared-storage-bucket">#create-a-shared-storage-bucket</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-create-a-shared-storage-bucket">3.1. Monkey Patch for the Storage Model</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-obtain-a-shared-storage-bottle-map" class="dfn-panel" data-for="obtain-a-shared-storage-bottle-map" id="infopanel-for-obtain-a-shared-storage-bottle-map">
   <span id="infopaneltitle-for-obtain-a-shared-storage-bottle-map" style="display:none">Info about the 'obtain a shared storage bottle map' definition.</span><b><a href="#obtain-a-shared-storage-bottle-map">#obtain-a-shared-storage-bottle-map</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-a-shared-storage-bottle-map">3.3. The Database Algorithms</a> <a href="#ref-for-obtain-a-shared-storage-bottle-map①">(2)</a> <a href="#ref-for-obtain-a-shared-storage-bottle-map②">(3)</a> <a href="#ref-for-obtain-a-shared-storage-bottle-map③">(4)</a> <a href="#ref-for-obtain-a-shared-storage-bottle-map④">(5)</a> <a href="#ref-for-obtain-a-shared-storage-bottle-map⑤">(6)</a> <a href="#ref-for-obtain-a-shared-storage-bottle-map⑥">(7)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-shared-storage-database" class="dfn-panel" data-for="shared-storage-database" id="infopanel-for-shared-storage-database">
   <span id="infopaneltitle-for-shared-storage-database" style="display:none">Info about the 'shared storage database' definition.</span><b><a href="#shared-storage-database">#shared-storage-database</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-shared-storage-database">3.2. The Shared Storage Database</a> <a href="#ref-for-shared-storage-database①">(2)</a> <a href="#ref-for-shared-storage-database②">(3)</a> <a href="#ref-for-shared-storage-database③">(4)</a> <a href="#ref-for-shared-storage-database④">(5)</a>
    <li><a href="#ref-for-shared-storage-database⑤">3.3. The Database Algorithms</a>
    <li><a href="#ref-for-shared-storage-database⑥">4. The SharedStorage Interface</a> <a href="#ref-for-shared-storage-database⑦">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-shared-storage-database-shared-storage-database-queue" class="dfn-panel" data-for="shared-storage-database-shared-storage-database-queue" id="infopanel-for-shared-storage-database-shared-storage-database-queue">
   <span id="infopaneltitle-for-shared-storage-database-shared-storage-database-queue" style="display:none">Info about the 'shared storage database queue' definition.</span><b><a href="#shared-storage-database-shared-storage-database-queue">#shared-storage-database-shared-storage-database-queue</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-shared-storage-database-shared-storage-database-queue">3.3. The Database Algorithms</a> <a href="#ref-for-shared-storage-database-shared-storage-database-queue①">(2)</a> <a href="#ref-for-shared-storage-database-shared-storage-database-queue②">(3)</a> <a href="#ref-for-shared-storage-database-shared-storage-database-queue③">(4)</a> <a href="#ref-for-shared-storage-database-shared-storage-database-queue④">(5)</a> <a href="#ref-for-shared-storage-database-shared-storage-database-queue⑤">(6)</a> <a href="#ref-for-shared-storage-database-shared-storage-database-queue⑥">(7)</a>
    <li><a href="#ref-for-shared-storage-database-shared-storage-database-queue⑦">4.1.1. Window Setter/Deleter Methods</a> <a href="#ref-for-shared-storage-database-shared-storage-database-queue⑧">(2)</a> <a href="#ref-for-shared-storage-database-shared-storage-database-queue⑨">(3)</a> <a href="#ref-for-shared-storage-database-shared-storage-database-queue①⓪">(4)</a>
    <li><a href="#ref-for-shared-storage-database-shared-storage-database-queue①①">4.2.1. Worklet Setter/Deleter Methods</a> <a href="#ref-for-shared-storage-database-shared-storage-database-queue①②">(2)</a> <a href="#ref-for-shared-storage-database-shared-storage-database-queue①③">(3)</a> <a href="#ref-for-shared-storage-database-shared-storage-database-queue①④">(4)</a>
    <li><a href="#ref-for-shared-storage-database-shared-storage-database-queue①⑤">4.2.2. Getter Methods</a> <a href="#ref-for-shared-storage-database-shared-storage-database-queue①⑥">(2)</a> <a href="#ref-for-shared-storage-database-shared-storage-database-queue①⑦">(3)</a>
    <li><a href="#ref-for-shared-storage-database-shared-storage-database-queue①⑧">4.2.3. Iteration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-shared-storage-database-entry" class="dfn-panel" data-for="shared-storage-database-entry" id="infopanel-for-shared-storage-database-entry">
   <span id="infopaneltitle-for-shared-storage-database-entry" style="display:none">Info about the 'entry' definition.</span><b><a href="#shared-storage-database-entry">#shared-storage-database-entry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-shared-storage-database-entry">3.2. The Shared Storage Database</a> <a href="#ref-for-shared-storage-database-entry①">(2)</a> <a href="#ref-for-shared-storage-database-entry②">(3)</a> <a href="#ref-for-shared-storage-database-entry③">(4)</a> <a href="#ref-for-shared-storage-database-entry④">(5)</a>
    <li><a href="#ref-for-shared-storage-database-entry⑤">4.2.3. Iteration</a> <a href="#ref-for-shared-storage-database-entry⑥">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-entry-key" class="dfn-panel" data-for="entry-key" id="infopanel-for-entry-key">
   <span id="infopaneltitle-for-entry-key" style="display:none">Info about the 'key' definition.</span><b><a href="#entry-key">#entry-key</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-entry-key">3.2. The Shared Storage Database</a> <a href="#ref-for-entry-key①">(2)</a> <a href="#ref-for-entry-key②">(3)</a> <a href="#ref-for-entry-key③">(4)</a>
    <li><a href="#ref-for-entry-key④">3.3. The Database Algorithms</a> <a href="#ref-for-entry-key⑤">(2)</a> <a href="#ref-for-entry-key⑥">(3)</a> <a href="#ref-for-entry-key⑦">(4)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-key-maximum-length" class="dfn-panel" data-for="key-maximum-length" id="infopanel-for-key-maximum-length">
   <span id="infopaneltitle-for-key-maximum-length" style="display:none">Info about the 'maximum length' definition.</span><b><a href="#key-maximum-length">#key-maximum-length</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-key-maximum-length">4.1.1. Window Setter/Deleter Methods</a> <a href="#ref-for-key-maximum-length①">(2)</a> <a href="#ref-for-key-maximum-length②">(3)</a>
    <li><a href="#ref-for-key-maximum-length③">4.2.1. Worklet Setter/Deleter Methods</a> <a href="#ref-for-key-maximum-length④">(2)</a> <a href="#ref-for-key-maximum-length⑤">(3)</a>
    <li><a href="#ref-for-key-maximum-length⑥">4.2.2. Getter Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-entry-value-struct" class="dfn-panel" data-for="entry-value-struct" id="infopanel-for-entry-value-struct">
   <span id="infopaneltitle-for-entry-value-struct" style="display:none">Info about the 'value struct' definition.</span><b><a href="#entry-value-struct">#entry-value-struct</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-entry-value-struct">3.2. The Shared Storage Database</a>
    <li><a href="#ref-for-entry-value-struct①">3.3. The Database Algorithms</a> <a href="#ref-for-entry-value-struct②">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-value-struct-value" class="dfn-panel" data-for="value-struct-value" id="infopanel-for-value-struct-value">
   <span id="infopaneltitle-for-value-struct-value" style="display:none">Info about the 'value' definition.</span><b><a href="#value-struct-value">#value-struct-value</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-value-struct-value">3.2. The Shared Storage Database</a>
    <li><a href="#ref-for-value-struct-value①">3.3. The Database Algorithms</a> <a href="#ref-for-value-struct-value②">(2)</a> <a href="#ref-for-value-struct-value③">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-value-struct-last-updated" class="dfn-panel" data-for="value-struct-last-updated" id="infopanel-for-value-struct-last-updated">
   <span id="infopaneltitle-for-value-struct-last-updated" style="display:none">Info about the 'last updated' definition.</span><b><a href="#value-struct-last-updated">#value-struct-last-updated</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-value-struct-last-updated">3.3. The Database Algorithms</a> <a href="#ref-for-value-struct-last-updated①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-value-maximum-length" class="dfn-panel" data-for="value-maximum-length" id="infopanel-for-value-maximum-length">
   <span id="infopaneltitle-for-value-maximum-length" style="display:none">Info about the 'maximum length' definition.</span><b><a href="#value-maximum-length">#value-maximum-length</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-value-maximum-length">4.1.1. Window Setter/Deleter Methods</a> <a href="#ref-for-value-maximum-length①">(2)</a>
    <li><a href="#ref-for-value-maximum-length②">4.2.1. Worklet Setter/Deleter Methods</a> <a href="#ref-for-value-maximum-length③">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-default-entry-lifetime" class="dfn-panel" data-for="default-entry-lifetime" id="infopanel-for-default-entry-lifetime">
   <span id="infopaneltitle-for-default-entry-lifetime" style="display:none">Info about the 'default entry lifetime' definition.</span><b><a href="#default-entry-lifetime">#default-entry-lifetime</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-entry-lifetime">3.2. The Shared Storage Database</a>
    <li><a href="#ref-for-default-entry-lifetime①">3.3. The Database Algorithms</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-shared-storage-database-store-an-entry-in-the-database" class="dfn-panel" data-for="shared-storage-database-store-an-entry-in-the-database" id="infopanel-for-shared-storage-database-store-an-entry-in-the-database">
   <span id="infopaneltitle-for-shared-storage-database-store-an-entry-in-the-database" style="display:none">Info about the 'store an entry in the database' definition.</span><b><a href="#shared-storage-database-store-an-entry-in-the-database">#shared-storage-database-store-an-entry-in-the-database</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-shared-storage-database-store-an-entry-in-the-database">3.2. The Shared Storage Database</a> <a href="#ref-for-shared-storage-database-store-an-entry-in-the-database①">(2)</a>
    <li><a href="#ref-for-shared-storage-database-store-an-entry-in-the-database②">4.1.1. Window Setter/Deleter Methods</a> <a href="#ref-for-shared-storage-database-store-an-entry-in-the-database③">(2)</a>
    <li><a href="#ref-for-shared-storage-database-store-an-entry-in-the-database④">4.2.1. Worklet Setter/Deleter Methods</a> <a href="#ref-for-shared-storage-database-store-an-entry-in-the-database⑤">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-shared-storage-database-retrieve-an-entry-from-the-database" class="dfn-panel" data-for="shared-storage-database-retrieve-an-entry-from-the-database" id="infopanel-for-shared-storage-database-retrieve-an-entry-from-the-database">
   <span id="infopaneltitle-for-shared-storage-database-retrieve-an-entry-from-the-database" style="display:none">Info about the 'retrieve an entry from the database' definition.</span><b><a href="#shared-storage-database-retrieve-an-entry-from-the-database">#shared-storage-database-retrieve-an-entry-from-the-database</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-shared-storage-database-retrieve-an-entry-from-the-database">3.2. The Shared Storage Database</a>
    <li><a href="#ref-for-shared-storage-database-retrieve-an-entry-from-the-database①">4.1.1. Window Setter/Deleter Methods</a> <a href="#ref-for-shared-storage-database-retrieve-an-entry-from-the-database②">(2)</a>
    <li><a href="#ref-for-shared-storage-database-retrieve-an-entry-from-the-database③">4.2.1. Worklet Setter/Deleter Methods</a> <a href="#ref-for-shared-storage-database-retrieve-an-entry-from-the-database④">(2)</a>
    <li><a href="#ref-for-shared-storage-database-retrieve-an-entry-from-the-database⑤">4.2.2. Getter Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-shared-storage-database-delete-an-entry-from-the-database" class="dfn-panel" data-for="shared-storage-database-delete-an-entry-from-the-database" id="infopanel-for-shared-storage-database-delete-an-entry-from-the-database">
   <span id="infopaneltitle-for-shared-storage-database-delete-an-entry-from-the-database" style="display:none">Info about the 'delete an entry from the database' definition.</span><b><a href="#shared-storage-database-delete-an-entry-from-the-database">#shared-storage-database-delete-an-entry-from-the-database</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-shared-storage-database-delete-an-entry-from-the-database">3.2. The Shared Storage Database</a>
    <li><a href="#ref-for-shared-storage-database-delete-an-entry-from-the-database①">4.1.1. Window Setter/Deleter Methods</a>
    <li><a href="#ref-for-shared-storage-database-delete-an-entry-from-the-database②">4.2.1. Worklet Setter/Deleter Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-shared-storage-database-clear-all-entries-in-the-database" class="dfn-panel" data-for="shared-storage-database-clear-all-entries-in-the-database" id="infopanel-for-shared-storage-database-clear-all-entries-in-the-database">
   <span id="infopaneltitle-for-shared-storage-database-clear-all-entries-in-the-database" style="display:none">Info about the 'clear all entries in the database' definition.</span><b><a href="#shared-storage-database-clear-all-entries-in-the-database">#shared-storage-database-clear-all-entries-in-the-database</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-shared-storage-database-clear-all-entries-in-the-database">3.2. The Shared Storage Database</a>
    <li><a href="#ref-for-shared-storage-database-clear-all-entries-in-the-database①">4.1.1. Window Setter/Deleter Methods</a>
    <li><a href="#ref-for-shared-storage-database-clear-all-entries-in-the-database②">4.2.1. Worklet Setter/Deleter Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-shared-storage-database-retrieve-all-entries-from-the-database" class="dfn-panel" data-for="shared-storage-database-retrieve-all-entries-from-the-database" id="infopanel-for-shared-storage-database-retrieve-all-entries-from-the-database">
   <span id="infopaneltitle-for-shared-storage-database-retrieve-all-entries-from-the-database" style="display:none">Info about the 'retrieve all entries from the database' definition.</span><b><a href="#shared-storage-database-retrieve-all-entries-from-the-database">#shared-storage-database-retrieve-all-entries-from-the-database</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-shared-storage-database-retrieve-all-entries-from-the-database">4.2.3. Iteration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-shared-storage-database-count-entries-in-the-database" class="dfn-panel" data-for="shared-storage-database-count-entries-in-the-database" id="infopanel-for-shared-storage-database-count-entries-in-the-database">
   <span id="infopaneltitle-for-shared-storage-database-count-entries-in-the-database" style="display:none">Info about the 'count entries in the database' definition.</span><b><a href="#shared-storage-database-count-entries-in-the-database">#shared-storage-database-count-entries-in-the-database</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-shared-storage-database-count-entries-in-the-database">4.2.2. Getter Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-shared-storage-database-purge-expired-entries-from-the-database" class="dfn-panel" data-for="shared-storage-database-purge-expired-entries-from-the-database" id="infopanel-for-shared-storage-database-purge-expired-entries-from-the-database">
   <span id="infopaneltitle-for-shared-storage-database-purge-expired-entries-from-the-database" style="display:none">Info about the 'purge expired entries from the database' definition.</span><b><a href="#shared-storage-database-purge-expired-entries-from-the-database">#shared-storage-database-purge-expired-entries-from-the-database</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-shared-storage-database-purge-expired-entries-from-the-database">3.2. The Shared Storage Database</a> <a href="#ref-for-shared-storage-database-purge-expired-entries-from-the-database①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-shared-storage-database-determine-whether-an-entry-is-expired" class="dfn-panel" data-for="shared-storage-database-determine-whether-an-entry-is-expired" id="infopanel-for-shared-storage-database-determine-whether-an-entry-is-expired">
   <span id="infopaneltitle-for-shared-storage-database-determine-whether-an-entry-is-expired" style="display:none">Info about the 'determine whether an entry is expired' definition.</span><b><a href="#shared-storage-database-determine-whether-an-entry-is-expired">#shared-storage-database-determine-whether-an-entry-is-expired</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-shared-storage-database-determine-whether-an-entry-is-expired">3.3. The Database Algorithms</a> <a href="#ref-for-shared-storage-database-determine-whether-an-entry-is-expired①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-sharedstorage" class="dfn-panel" data-for="sharedstorage" id="infopanel-for-sharedstorage">
   <span id="infopaneltitle-for-sharedstorage" style="display:none">Info about the 'SharedStorage' definition.</span><b><a href="#sharedstorage">#sharedstorage</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sharedstorage">4. The SharedStorage Interface</a> <a href="#ref-for-sharedstorage①">(2)</a> <a href="#ref-for-sharedstorage②">(3)</a>
    <li><a href="#ref-for-sharedstorage③">4.1. The WindowSharedStorage interface</a>
    <li><a href="#ref-for-sharedstorage④">4.2. The WorkletSharedStorage interface</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dictdef-sharedstoragesetmethodoptions" class="dfn-panel" data-for="dictdef-sharedstoragesetmethodoptions" id="infopanel-for-dictdef-sharedstoragesetmethodoptions">
   <span id="infopaneltitle-for-dictdef-sharedstoragesetmethodoptions" style="display:none">Info about the 'SharedStorageSetMethodOptions' definition.</span><b><a href="#dictdef-sharedstoragesetmethodoptions">#dictdef-sharedstoragesetmethodoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-sharedstoragesetmethodoptions">4. The SharedStorage Interface</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-typedefdef-sharedstorageresponse" class="dfn-panel" data-for="typedefdef-sharedstorageresponse" id="infopanel-for-typedefdef-sharedstorageresponse">
   <span id="infopaneltitle-for-typedefdef-sharedstorageresponse" style="display:none">Info about the 'SharedStorageResponse' definition.</span><b><a href="#typedefdef-sharedstorageresponse">#typedefdef-sharedstorageresponse</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-typedefdef-sharedstorageresponse">4.1. The WindowSharedStorage interface</a>
    <li><a href="#ref-for-typedefdef-sharedstorageresponse①">4.1.2. SharedStorageUrlWithMetadata and Reporting</a>
    <li><a href="#ref-for-typedefdef-sharedstorageresponse②">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-typedefdef-sharedstorageresponse③">(2)</a> <a href="#ref-for-typedefdef-sharedstorageresponse④">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-windowsharedstorage" class="dfn-panel" data-for="windowsharedstorage" id="infopanel-for-windowsharedstorage">
   <span id="infopaneltitle-for-windowsharedstorage" style="display:none">Info about the 'WindowSharedStorage' definition.</span><b><a href="#windowsharedstorage">#windowsharedstorage</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-windowsharedstorage">4. The SharedStorage Interface</a> <a href="#ref-for-windowsharedstorage①">(2)</a>
    <li><a href="#ref-for-windowsharedstorage②">4.1. The WindowSharedStorage interface</a> <a href="#ref-for-windowsharedstorage③">(2)</a>
    <li><a href="#ref-for-windowsharedstorage④">4.1.1. Window Setter/Deleter Methods</a> <a href="#ref-for-windowsharedstorage⑤">(2)</a> <a href="#ref-for-windowsharedstorage⑥">(3)</a> <a href="#ref-for-windowsharedstorage⑦">(4)</a>
    <li><a href="#ref-for-windowsharedstorage⑧">4.1.4. Run Operation Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-windowsharedstorage-worklet" class="dfn-panel" data-for="dom-windowsharedstorage-worklet" id="infopanel-for-dom-windowsharedstorage-worklet">
   <span id="infopaneltitle-for-dom-windowsharedstorage-worklet" style="display:none">Info about the 'worklet' definition.</span><b><a href="#dom-windowsharedstorage-worklet">#dom-windowsharedstorage-worklet</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-windowsharedstorage-worklet">4. The SharedStorage Interface</a>
    <li><a href="#ref-for-dom-windowsharedstorage-worklet①">4.1.4. Run Operation Methods</a> <a href="#ref-for-dom-windowsharedstorage-worklet②">(2)</a> <a href="#ref-for-dom-windowsharedstorage-worklet③">(3)</a> <a href="#ref-for-dom-windowsharedstorage-worklet④">(4)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dictdef-sharedstorageurlwithmetadata" class="dfn-panel" data-for="dictdef-sharedstorageurlwithmetadata" id="infopanel-for-dictdef-sharedstorageurlwithmetadata">
   <span id="infopaneltitle-for-dictdef-sharedstorageurlwithmetadata" style="display:none">Info about the 'SharedStorageUrlWithMetadata' definition.</span><b><a href="#dictdef-sharedstorageurlwithmetadata">#dictdef-sharedstorageurlwithmetadata</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-sharedstorageurlwithmetadata">2.2. The SharedStorageWorkletGlobalScope</a> <a href="#ref-for-dictdef-sharedstorageurlwithmetadata①">(2)</a>
    <li><a href="#ref-for-dictdef-sharedstorageurlwithmetadata②">4.1. The WindowSharedStorage interface</a>
    <li><a href="#ref-for-dictdef-sharedstorageurlwithmetadata③">4.1.2. SharedStorageUrlWithMetadata and Reporting</a> <a href="#ref-for-dictdef-sharedstorageurlwithmetadata④">(2)</a> <a href="#ref-for-dictdef-sharedstorageurlwithmetadata⑤">(3)</a>
    <li><a href="#ref-for-dictdef-sharedstorageurlwithmetadata⑥">4.1.3.1. Navigation Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-sharedstorageurlwithmetadata-url" class="dfn-panel" data-for="dom-sharedstorageurlwithmetadata-url" id="infopanel-for-dom-sharedstorageurlwithmetadata-url">
   <span id="infopaneltitle-for-dom-sharedstorageurlwithmetadata-url" style="display:none">Info about the 'url' definition.</span><b><a href="#dom-sharedstorageurlwithmetadata-url">#dom-sharedstorageurlwithmetadata-url</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-sharedstorageurlwithmetadata-url">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-dom-sharedstorageurlwithmetadata-url①">(2)</a> <a href="#ref-for-dom-sharedstorageurlwithmetadata-url②">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-sharedstorageurlwithmetadata-reportingmetadata" class="dfn-panel" data-for="dom-sharedstorageurlwithmetadata-reportingmetadata" id="infopanel-for-dom-sharedstorageurlwithmetadata-reportingmetadata">
   <span id="infopaneltitle-for-dom-sharedstorageurlwithmetadata-reportingmetadata" style="display:none">Info about the 'reportingMetadata' definition.</span><b><a href="#dom-sharedstorageurlwithmetadata-reportingmetadata">#dom-sharedstorageurlwithmetadata-reportingmetadata</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-sharedstorageurlwithmetadata-reportingmetadata">4.1.2. SharedStorageUrlWithMetadata and Reporting</a> <a href="#ref-for-dom-sharedstorageurlwithmetadata-reportingmetadata①">(2)</a> <a href="#ref-for-dom-sharedstorageurlwithmetadata-reportingmetadata②">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-validate-reporting-metadata" class="dfn-panel" data-for="validate-reporting-metadata" id="infopanel-for-validate-reporting-metadata">
   <span id="infopaneltitle-for-validate-reporting-metadata" style="display:none">Info about the 'validate reporting metadata' definition.</span><b><a href="#validate-reporting-metadata">#validate-reporting-metadata</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-validate-reporting-metadata">4.1.4. Run Operation Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-get-the-canonical-url-string-if-valid" class="dfn-panel" data-for="get-the-canonical-url-string-if-valid" id="infopanel-for-get-the-canonical-url-string-if-valid">
   <span id="infopaneltitle-for-get-the-canonical-url-string-if-valid" style="display:none">Info about the 'get the canonical URL string if valid' definition.</span><b><a href="#get-the-canonical-url-string-if-valid">#get-the-canonical-url-string-if-valid</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-get-the-canonical-url-string-if-valid">4.1.2. SharedStorageUrlWithMetadata and Reporting</a>
    <li><a href="#ref-for-get-the-canonical-url-string-if-valid①">4.1.4. Run Operation Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-register-reporting-metadata" class="dfn-panel" data-for="register-reporting-metadata" id="infopanel-for-register-reporting-metadata">
   <span id="infopaneltitle-for-register-reporting-metadata" style="display:none">Info about the 'register reporting metadata' definition.</span><b><a href="#register-reporting-metadata">#register-reporting-metadata</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-register-reporting-metadata">4.1.2. SharedStorageUrlWithMetadata and Reporting</a> <a href="#ref-for-register-reporting-metadata①">(2)</a>
    <li><a href="#ref-for-register-reporting-metadata②">4.1.4. Run Operation Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-calling-origin" class="dfn-panel" data-for="calling-origin" id="infopanel-for-calling-origin">
   <span id="infopaneltitle-for-calling-origin" style="display:none">Info about the 'calling origin' definition.</span><b><a href="#calling-origin">#calling-origin</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-calling-origin">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-calling-origin①">(2)</a> <a href="#ref-for-calling-origin②">(3)</a> <a href="#ref-for-calling-origin③">(4)</a> <a href="#ref-for-calling-origin④">(5)</a> <a href="#ref-for-calling-origin⑤">(6)</a> <a href="#ref-for-calling-origin⑥">(7)</a> <a href="#ref-for-calling-origin⑦">(8)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-navigation-entropy-allowance" class="dfn-panel" data-for="navigation-entropy-allowance" id="infopanel-for-navigation-entropy-allowance">
   <span id="infopaneltitle-for-navigation-entropy-allowance" style="display:none">Info about the 'navigation entropy allowance' definition.</span><b><a href="#navigation-entropy-allowance">#navigation-entropy-allowance</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-entropy-allowance">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-navigation-entropy-allowance①">(2)</a> <a href="#ref-for-navigation-entropy-allowance②">(3)</a> <a href="#ref-for-navigation-entropy-allowance③">(4)</a> <a href="#ref-for-navigation-entropy-allowance④">(5)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-navigation-budget-lifetime" class="dfn-panel" data-for="navigation-budget-lifetime" id="infopanel-for-navigation-budget-lifetime">
   <span id="infopaneltitle-for-navigation-budget-lifetime" style="display:none">Info about the 'navigation budget lifetime' definition.</span><b><a href="#navigation-budget-lifetime">#navigation-budget-lifetime</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-budget-lifetime">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-navigation-budget-lifetime①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-navigation-budget-epoch" class="dfn-panel" data-for="navigation-budget-epoch" id="infopanel-for-navigation-budget-epoch">
   <span id="infopaneltitle-for-navigation-budget-epoch" style="display:none">Info about the 'navigation budget epoch' definition.</span><b><a href="#navigation-budget-epoch">#navigation-budget-epoch</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-budget-epoch">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-navigation-budget-epoch①">(2)</a> <a href="#ref-for-navigation-budget-epoch②">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-shared-storage-navigation-budget-table" class="dfn-panel" data-for="shared-storage-navigation-budget-table" id="infopanel-for-shared-storage-navigation-budget-table">
   <span id="infopaneltitle-for-shared-storage-navigation-budget-table" style="display:none">Info about the 'shared storage navigation budget table' definition.</span><b><a href="#shared-storage-navigation-budget-table">#shared-storage-navigation-budget-table</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-shared-storage-navigation-budget-table">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-shared-storage-navigation-budget-table①">(2)</a> <a href="#ref-for-shared-storage-navigation-budget-table②">(3)</a> <a href="#ref-for-shared-storage-navigation-budget-table③">(4)</a> <a href="#ref-for-shared-storage-navigation-budget-table④">(5)</a> <a href="#ref-for-shared-storage-navigation-budget-table⑤">(6)</a>
    <li><a href="#ref-for-shared-storage-navigation-budget-table⑥">4.1.3.2. Reporting Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-navigation-entropy-ledger" class="dfn-panel" data-for="navigation-entropy-ledger" id="infopanel-for-navigation-entropy-ledger">
   <span id="infopaneltitle-for-navigation-entropy-ledger" style="display:none">Info about the 'navigation entropy ledger' definition.</span><b><a href="#navigation-entropy-ledger">#navigation-entropy-ledger</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-entropy-ledger">4.1.3.1. Navigation Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-bit-debit" class="dfn-panel" data-for="bit-debit" id="infopanel-for-bit-debit">
   <span id="infopaneltitle-for-bit-debit" style="display:none">Info about the 'bit debit' definition.</span><b><a href="#bit-debit">#bit-debit</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-bit-debit">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-bit-debit①">(2)</a> <a href="#ref-for-bit-debit②">(3)</a> <a href="#ref-for-bit-debit③">(4)</a> <a href="#ref-for-bit-debit④">(5)</a> <a href="#ref-for-bit-debit⑤">(6)</a> <a href="#ref-for-bit-debit⑥">(7)</a>
    <li><a href="#ref-for-bit-debit⑦">4.1.3.2. Reporting Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-bit-debit-bits" class="dfn-panel" data-for="bit-debit-bits" id="infopanel-for-bit-debit-bits">
   <span id="infopaneltitle-for-bit-debit-bits" style="display:none">Info about the 'bits' definition.</span><b><a href="#bit-debit-bits">#bit-debit-bits</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-bit-debit-bits">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-bit-debit-bits①">(2)</a> <a href="#ref-for-bit-debit-bits②">(3)</a> <a href="#ref-for-bit-debit-bits③">(4)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-bit-debit-timestamp" class="dfn-panel" data-for="bit-debit-timestamp" id="infopanel-for-bit-debit-timestamp">
   <span id="infopaneltitle-for-bit-debit-timestamp" style="display:none">Info about the 'timestamp' definition.</span><b><a href="#bit-debit-timestamp">#bit-debit-timestamp</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-bit-debit-timestamp">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-bit-debit-timestamp①">(2)</a> <a href="#ref-for-bit-debit-timestamp②">(3)</a> <a href="#ref-for-bit-debit-timestamp③">(4)</a> <a href="#ref-for-bit-debit-timestamp④">(5)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-bit-debit-expired" class="dfn-panel" data-for="bit-debit-expired" id="infopanel-for-bit-debit-expired">
   <span id="infopaneltitle-for-bit-debit-expired" style="display:none">Info about the 'expired' definition.</span><b><a href="#bit-debit-expired">#bit-debit-expired</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-bit-debit-expired">4.1.3.2. Reporting Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-calling-origin-remaining-navigation-budget" class="dfn-panel" data-for="calling-origin-remaining-navigation-budget" id="infopanel-for-calling-origin-remaining-navigation-budget">
   <span id="infopaneltitle-for-calling-origin-remaining-navigation-budget" style="display:none">Info about the 'remaining navigation budget' definition.</span><b><a href="#calling-origin-remaining-navigation-budget">#calling-origin-remaining-navigation-budget</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-calling-origin-remaining-navigation-budget">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-calling-origin-remaining-navigation-budget①">(2)</a> <a href="#ref-for-calling-origin-remaining-navigation-budget②">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-selecturl-input-url-list" class="dfn-panel" data-for="selecturl-input-url-list" id="infopanel-for-selecturl-input-url-list">
   <span id="infopaneltitle-for-selecturl-input-url-list" style="display:none">Info about the 'input URL list' definition.</span><b><a href="#selecturl-input-url-list">#selecturl-input-url-list</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-selecturl-input-url-list">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-selecturl-input-url-list①">(2)</a> <a href="#ref-for-selecturl-input-url-list②">(3)</a> <a href="#ref-for-selecturl-input-url-list③">(4)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-default-index" class="dfn-panel" data-for="default-index" id="infopanel-for-default-index">
   <span id="infopaneltitle-for-default-index" style="display:none">Info about the 'default index' definition.</span><b><a href="#default-index">#default-index</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-index">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-default-index①">(2)</a> <a href="#ref-for-default-index②">(3)</a>
    <li><a href="#ref-for-default-index③">4.1.4. Run Operation Methods</a> <a href="#ref-for-default-index④">(2)</a> <a href="#ref-for-default-index⑤">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-determine-remaining-navigation-budget" class="dfn-panel" data-for="determine-remaining-navigation-budget" id="infopanel-for-determine-remaining-navigation-budget">
   <span id="infopaneltitle-for-determine-remaining-navigation-budget" style="display:none">Info about the 'determine remaining navigation budget' definition.</span><b><a href="#determine-remaining-navigation-budget">#determine-remaining-navigation-budget</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-determine-remaining-navigation-budget">4.1.4. Run Operation Methods</a>
    <li><a href="#ref-for-determine-remaining-navigation-budget①">4.2.2. Getter Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-check-whether-a-bit-debit-is-expired" class="dfn-panel" data-for="check-whether-a-bit-debit-is-expired" id="infopanel-for-check-whether-a-bit-debit-is-expired">
   <span id="infopaneltitle-for-check-whether-a-bit-debit-is-expired" style="display:none">Info about the 'check whether a bit debit is expired' definition.</span><b><a href="#check-whether-a-bit-debit-is-expired">#check-whether-a-bit-debit-is-expired</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-check-whether-a-bit-debit-is-expired">4.1.3.1. Navigation Entropy Budget</a>
    <li><a href="#ref-for-check-whether-a-bit-debit-is-expired①">4.1.3.2. Reporting Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-pending-shared-storage-budget-debit" class="dfn-panel" data-for="pending-shared-storage-budget-debit" id="infopanel-for-pending-shared-storage-budget-debit">
   <span id="infopaneltitle-for-pending-shared-storage-budget-debit" style="display:none">Info about the 'pending shared storage budget debit' definition.</span><b><a href="#pending-shared-storage-budget-debit">#pending-shared-storage-budget-debit</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-pending-shared-storage-budget-debit">4.1.3.1. Navigation Entropy Budget</a>
    <li><a href="#ref-for-pending-shared-storage-budget-debit①">4.1.3.2. Reporting Entropy Budget</a> <a href="#ref-for-pending-shared-storage-budget-debit②">(2)</a>
    <li><a href="#ref-for-pending-shared-storage-budget-debit③">4.1.4. Run Operation Methods</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-has-navigated" class="dfn-panel" data-for="has-navigated" id="infopanel-for-has-navigated">
   <span id="infopaneltitle-for-has-navigated" style="display:none">Info about the 'has navigated' definition.</span><b><a href="#has-navigated">#has-navigated</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-has-navigated">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-has-navigated①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-charge-shared-storage-navigation-budget" class="dfn-panel" data-for="charge-shared-storage-navigation-budget" id="infopanel-for-charge-shared-storage-navigation-budget">
   <span id="infopaneltitle-for-charge-shared-storage-navigation-budget" style="display:none">Info about the 'charge shared storage navigation budget' definition.</span><b><a href="#charge-shared-storage-navigation-budget">#charge-shared-storage-navigation-budget</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-charge-shared-storage-navigation-budget">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-charge-shared-storage-navigation-budget①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-page-load" class="dfn-panel" data-for="page-load" id="infopanel-for-page-load">
   <span id="infopaneltitle-for-page-load" style="display:none">Info about the 'page load' definition.</span><b><a href="#page-load">#page-load</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-page-load">4.1.3.2. Reporting Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-reporting-entropy-allowance" class="dfn-panel" data-for="reporting-entropy-allowance" id="infopanel-for-reporting-entropy-allowance">
   <span id="infopaneltitle-for-reporting-entropy-allowance" style="display:none">Info about the 'reporting entropy allowance' definition.</span><b><a href="#reporting-entropy-allowance">#reporting-entropy-allowance</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reporting-entropy-allowance">4.1.3.2. Reporting Entropy Budget</a> <a href="#ref-for-reporting-entropy-allowance①">(2)</a> <a href="#ref-for-reporting-entropy-allowance②">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-shared-storage-reporting-budget" class="dfn-panel" data-for="shared-storage-reporting-budget" id="infopanel-for-shared-storage-reporting-budget">
   <span id="infopaneltitle-for-shared-storage-reporting-budget" style="display:none">Info about the 'shared storage reporting budget' definition.</span><b><a href="#shared-storage-reporting-budget">#shared-storage-reporting-budget</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-shared-storage-reporting-budget">4.1.3.2. Reporting Entropy Budget</a> <a href="#ref-for-shared-storage-reporting-budget①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-determine-reporting-budget-to-charge" class="dfn-panel" data-for="determine-reporting-budget-to-charge" id="infopanel-for-determine-reporting-budget-to-charge">
   <span id="infopaneltitle-for-determine-reporting-budget-to-charge" style="display:none">Info about the 'determine reporting budget to charge' definition.</span><b><a href="#determine-reporting-budget-to-charge">#determine-reporting-budget-to-charge</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-determine-reporting-budget-to-charge">4.1.3.2. Reporting Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-has-reported" class="dfn-panel" data-for="has-reported" id="infopanel-for-has-reported">
   <span id="infopaneltitle-for-has-reported" style="display:none">Info about the 'has reported' definition.</span><b><a href="#has-reported">#has-reported</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-has-reported">4.1.3.2. Reporting Entropy Budget</a> <a href="#ref-for-has-reported①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-charge-shared-storage-reporting-budget" class="dfn-panel" data-for="charge-shared-storage-reporting-budget" id="infopanel-for-charge-shared-storage-reporting-budget">
   <span id="infopaneltitle-for-charge-shared-storage-reporting-budget" style="display:none">Info about the 'charge shared storage reporting budget' definition.</span><b><a href="#charge-shared-storage-reporting-budget">#charge-shared-storage-reporting-budget</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-charge-shared-storage-reporting-budget">4.1.3.2. Reporting Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-purge-expired-bit-debits-from-all-navigation-entropy-ledgers" class="dfn-panel" data-for="purge-expired-bit-debits-from-all-navigation-entropy-ledgers" id="infopanel-for-purge-expired-bit-debits-from-all-navigation-entropy-ledgers">
   <span id="infopaneltitle-for-purge-expired-bit-debits-from-all-navigation-entropy-ledgers" style="display:none">Info about the 'purge expired bit debits from all navigation entropy ledgers' definition.</span><b><a href="#purge-expired-bit-debits-from-all-navigation-entropy-ledgers">#purge-expired-bit-debits-from-all-navigation-entropy-ledgers</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-purge-expired-bit-debits-from-all-navigation-entropy-ledgers">4.1.3.2. Reporting Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-windowsharedstorage-run" class="dfn-panel" data-for="dom-windowsharedstorage-run" id="infopanel-for-dom-windowsharedstorage-run">
   <span id="infopaneltitle-for-dom-windowsharedstorage-run" style="display:none">Info about the 'run(name, options)' definition.</span><b><a href="#dom-windowsharedstorage-run">#dom-windowsharedstorage-run</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-windowsharedstorage-run">4.1. The WindowSharedStorage interface</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-windowsharedstorage-selecturl" class="dfn-panel" data-for="dom-windowsharedstorage-selecturl" id="infopanel-for-dom-windowsharedstorage-selecturl">
   <span id="infopaneltitle-for-dom-windowsharedstorage-selecturl" style="display:none">Info about the 'selectURL(name, urls, options)' definition.</span><b><a href="#dom-windowsharedstorage-selecturl">#dom-windowsharedstorage-selecturl</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-windowsharedstorage-selecturl">2. The SharedStorageWorklet Interface</a>
    <li><a href="#ref-for-dom-windowsharedstorage-selecturl①">4.1. The WindowSharedStorage interface</a>
    <li><a href="#ref-for-dom-windowsharedstorage-selecturl②">4.1.2. SharedStorageUrlWithMetadata and Reporting</a> <a href="#ref-for-dom-windowsharedstorage-selecturl③">(2)</a>
    <li><a href="#ref-for-dom-windowsharedstorage-selecturl④">4.1.3. Entropy Budgets</a>
    <li><a href="#ref-for-dom-windowsharedstorage-selecturl⑤">4.1.3.1. Navigation Entropy Budget</a> <a href="#ref-for-dom-windowsharedstorage-selecturl⑥">(2)</a> <a href="#ref-for-dom-windowsharedstorage-selecturl⑦">(3)</a> <a href="#ref-for-dom-windowsharedstorage-selecturl⑧">(4)</a> <a href="#ref-for-dom-windowsharedstorage-selecturl⑨">(5)</a> <a href="#ref-for-dom-windowsharedstorage-selecturl①⓪">(6)</a> <a href="#ref-for-dom-windowsharedstorage-selecturl①①">(7)</a> <a href="#ref-for-dom-windowsharedstorage-selecturl①②">(8)</a> <a href="#ref-for-dom-windowsharedstorage-selecturl①③">(9)</a> <a href="#ref-for-dom-windowsharedstorage-selecturl①④">(10)</a> <a href="#ref-for-dom-windowsharedstorage-selecturl①⑤">(11)</a>
    <li><a href="#ref-for-dom-windowsharedstorage-selecturl①⑥">4.1.3.2. Reporting Entropy Budget</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-workletsharedstorage" class="dfn-panel" data-for="workletsharedstorage" id="infopanel-for-workletsharedstorage">
   <span id="infopaneltitle-for-workletsharedstorage" style="display:none">Info about the 'WorkletSharedStorage' definition.</span><b><a href="#workletsharedstorage">#workletsharedstorage</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-workletsharedstorage">4. The SharedStorage Interface</a> <a href="#ref-for-workletsharedstorage①">(2)</a>
    <li><a href="#ref-for-workletsharedstorage②">4.2. The WorkletSharedStorage interface</a> <a href="#ref-for-workletsharedstorage③">(2)</a>
    <li><a href="#ref-for-workletsharedstorage④">4.2.1. Worklet Setter/Deleter Methods</a> <a href="#ref-for-workletsharedstorage⑤">(2)</a> <a href="#ref-for-workletsharedstorage⑥">(3)</a> <a href="#ref-for-workletsharedstorage⑦">(4)</a>
    <li><a href="#ref-for-workletsharedstorage⑧">4.2.2. Getter Methods</a> <a href="#ref-for-workletsharedstorage⑨">(2)</a> <a href="#ref-for-workletsharedstorage①⓪">(3)</a>
    <li><a href="#ref-for-workletsharedstorage①①">4.2.3. Iteration</a> <a href="#ref-for-workletsharedstorage①②">(2)</a> <a href="#ref-for-workletsharedstorage①③">(3)</a> <a href="#ref-for-workletsharedstorage①④">(4)</a> <a href="#ref-for-workletsharedstorage①⑤">(5)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-workletsharedstorage-get" class="dfn-panel" data-for="dom-workletsharedstorage-get" id="infopanel-for-dom-workletsharedstorage-get">
   <span id="infopaneltitle-for-dom-workletsharedstorage-get" style="display:none">Info about the 'get(key)' definition.</span><b><a href="#dom-workletsharedstorage-get">#dom-workletsharedstorage-get</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-workletsharedstorage-get">4.2. The WorkletSharedStorage interface</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-workletsharedstorage-length" class="dfn-panel" data-for="dom-workletsharedstorage-length" id="infopanel-for-dom-workletsharedstorage-length">
   <span id="infopaneltitle-for-dom-workletsharedstorage-length" style="display:none">Info about the 'length()' definition.</span><b><a href="#dom-workletsharedstorage-length">#dom-workletsharedstorage-length</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-workletsharedstorage-length">4.2. The WorkletSharedStorage interface</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-workletsharedstorage-remainingbudget" class="dfn-panel" data-for="dom-workletsharedstorage-remainingbudget" id="infopanel-for-dom-workletsharedstorage-remainingbudget">
   <span id="infopaneltitle-for-dom-workletsharedstorage-remainingbudget" style="display:none">Info about the 'remainingBudget()' definition.</span><b><a href="#dom-workletsharedstorage-remainingbudget">#dom-workletsharedstorage-remainingbudget</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-workletsharedstorage-remainingbudget">4.2. The WorkletSharedStorage interface</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-workletsharedstorageiterator-pending-entries" class="dfn-panel" data-for="workletsharedstorageiterator-pending-entries" id="infopanel-for-workletsharedstorageiterator-pending-entries">
   <span id="infopaneltitle-for-workletsharedstorageiterator-pending-entries" style="display:none">Info about the 'pending entries' definition.</span><b><a href="#workletsharedstorageiterator-pending-entries">#workletsharedstorageiterator-pending-entries</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-workletsharedstorageiterator-pending-entries">4.2.3. Iteration</a> <a href="#ref-for-workletsharedstorageiterator-pending-entries①">(2)</a> <a href="#ref-for-workletsharedstorageiterator-pending-entries②">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-workletsharedstorageiterator-error" class="dfn-panel" data-for="workletsharedstorageiterator-error" id="infopanel-for-workletsharedstorageiterator-error">
   <span id="infopaneltitle-for-workletsharedstorageiterator-error" style="display:none">Info about the 'error' definition.</span><b><a href="#workletsharedstorageiterator-error">#workletsharedstorageiterator-error</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-workletsharedstorageiterator-error">4.2.3. Iteration</a> <a href="#ref-for-workletsharedstorageiterator-error①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-workletsharedstorageiterator-asynchronous-iterator-initialization-steps" class="dfn-panel" data-for="workletsharedstorageiterator-asynchronous-iterator-initialization-steps" id="infopanel-for-workletsharedstorageiterator-asynchronous-iterator-initialization-steps">
   <span id="infopaneltitle-for-workletsharedstorageiterator-asynchronous-iterator-initialization-steps" style="display:none">Info about the 'asynchronous iterator initialization steps' definition.</span><b><a href="#workletsharedstorageiterator-asynchronous-iterator-initialization-steps">#workletsharedstorageiterator-asynchronous-iterator-initialization-steps</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-workletsharedstorageiterator-asynchronous-iterator-initialization-steps">4.2.3. Iteration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-workletsharedstorageiterator-get-the-next-iteration-result" class="dfn-panel" data-for="workletsharedstorageiterator-get-the-next-iteration-result" id="infopanel-for-workletsharedstorageiterator-get-the-next-iteration-result">
   <span id="infopaneltitle-for-workletsharedstorageiterator-get-the-next-iteration-result" style="display:none">Info about the 'get the next iteration result' definition.</span><b><a href="#workletsharedstorageiterator-get-the-next-iteration-result">#workletsharedstorageiterator-get-the-next-iteration-result</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-workletsharedstorageiterator-get-the-next-iteration-result">4.2.3. Iteration</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */
"use strict";
{
    function queryAll(sel) {
        return [].slice.call(document.querySelectorAll(sel));
    }

    // Add popup behavior to all dfns to show the corresponding dfn-panel.
    var dfns = document.querySelectorAll('.dfn-paneled');
    for (let dfn of dfns) { insertDfnPopupAction(dfn); }

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });

    function hideAllDfnPanels() {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>hideDfnPanel(el));
    }

    function showDfnPanel(dfnPanel, dfn) {
        hideAllDfnPanels(); // Only display one at this time.
        dfn.setAttribute("aria-expanded", "true");
        dfnPanel.classList.add("on");
        dfnPanel.style.left = "5px";
        dfnPanel.style.top = "0px";
        const panelRect = dfnPanel.getBoundingClientRect();
        const panelWidth = panelRect.right - panelRect.left;
        if (panelRect.right > document.body.scrollWidth) {
            // Panel's overflowing the screen.
            // Just drop it below the dfn and flip it rightward instead.
            // This still wont' fix things if the screen is *really* wide,
            // but fixing that's a lot harder without 'anchor()'.
            dfnPanel.style.top = "1.5em";
            dfnPanel.style.left = "auto";
            dfnPanel.style.right = "0px";
        }
    }

    function pinDfnPanel(dfnPanel) {
        // Switch it to "activated" state, which pins it.
        dfnPanel.classList.add("activated");
        dfnPanel.style.left = null;
        dfnPanel.style.top = null;
    }

    function hideDfnPanel(dfnPanel, dfn) {
        if(!dfn) {
            dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
        }
        dfn.setAttribute("aria-expanded", "false")
        dfnPanel.classList.remove("on");
        dfnPanel.classList.remove("activated");
    }

    function toggleDfnPanel(dfnPanel, dfn) {
        if(dfnPanel.classList.contains("on")) {
            hideDfnPanel(dfnPanel, dfn);
        } else {
            showDfnPanel(dfnPanel, dfn);
        }
    }

    function insertDfnPopupAction(dfn) {
        // Find dfn panel
        const dfnPanel = document.querySelector(`.dfn-panel[data-for='${dfn.id}']`);
        if (dfnPanel) {
            const panelWrapper = document.createElement('span');
            panelWrapper.appendChild(dfnPanel);
            panelWrapper.style.position = "relative";
            panelWrapper.style.height = "0px";
            dfn.insertAdjacentElement("afterend", panelWrapper);
            dfn.setAttribute('role', 'button');
            dfn.setAttribute('aria-expanded', 'false')
            dfn.tabIndex = 0;
            dfn.classList.add('has-dfn-panel');
            dfn.addEventListener('click', (event) => {
                showDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
            });
            dfn.addEventListener('keypress', (event) => {
                const kc = event.keyCode;
                // 32->Space, 13->Enter
                if(kc == 32 || kc == 13) {
                    toggleDfnPanel(dfnPanel, dfn);
                    event.stopPropagation();
                    event.preventDefault();
                }
            });

            dfnPanel.addEventListener('click', (event) => {
                pinDfnPanel(dfnPanel);
                event.stopPropagation();
            });

            dfnPanel.addEventListener('keydown', (event) => {
                if(event.keyCode == 27) { // Escape key
                    hideDfnPanel(dfnPanel, dfn);
                    event.stopPropagation();
                    event.preventDefault();
                }
            })

        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + dfn.id + "']");
        }
    }
}
</script>
<script>/* script-var-click-highlighting */

    "use strict";
    {
        document.addEventListener("click", e=>{
            if(e.target.nodeName == "VAR") {
                highlightSameAlgoVars(e.target);
            }
        });
        const indexCounts = new Map();
        const indexNames = new Map();
        function highlightSameAlgoVars(v) {
            // Find the algorithm container.
            let algoContainer = null;
            let searchEl = v;
            while(algoContainer == null && searchEl != document.body) {
                searchEl = searchEl.parentNode;
                if(searchEl.hasAttribute("data-algorithm")) {
                    algoContainer = searchEl;
                }
            }

            // Not highlighting document-global vars,
            // too likely to be unrelated.
            if(algoContainer == null) return;

            const algoName = algoContainer.getAttribute("data-algorithm");
            const varName = getVarName(v);
            const addClass = !v.classList.contains("selected");
            let highlightClass = null;
            if(addClass) {
                const index = chooseHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] += 1;
                indexNames.set(algoName+"///"+varName, index);
                highlightClass = nameFromIndex(index);
            } else {
                const index = previousHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] -= 1;
                highlightClass = nameFromIndex(index);
            }

            // Find all same-name vars, and toggle their class appropriately.
            for(const el of algoContainer.querySelectorAll("var")) {
                if(getVarName(el) == varName) {
                    el.classList.toggle("selected", addClass);
                    el.classList.toggle(highlightClass, addClass);
                }
            }
        }
        function getVarName(el) {
            return el.textContent.replace(/(\s|\xa0)+/, " ").trim();
        }
        function chooseHighlightIndex(algoName, varName) {
            let indexes = null;
            if(indexCounts.has(algoName)) {
                indexes = indexCounts.get(algoName);
            } else {
                // 7 classes right now
                indexes = [0,0,0,0,0,0,0];
                indexCounts.set(algoName, indexes);
            }

            // If the element was recently unclicked,
            // *and* that color is still unclaimed,
            // give it back the same color.
            const lastIndex = previousHighlightIndex(algoName, varName);
            if(indexes[lastIndex] === 0) return lastIndex;

            // Find the earliest index with the lowest count.
            const minCount = Math.min.apply(null, indexes);
            let index = null;
            for(var i = 0; i < indexes.length; i++) {
                if(indexes[i] == minCount) {
                    return i;
                }
            }
        }
        function previousHighlightIndex(algoName, varName) {
            return indexNames.get(algoName+"///"+varName);
        }
        function nameFromIndex(index) {
            return "selected" + index;
        }
    }
    </script>